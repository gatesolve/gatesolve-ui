/*! For license information please see 4.6ad76ffc.chunk.js.LICENSE.txt */
(this["webpackJsonpgatesolve-ui"]=this["webpackJsonpgatesolve-ui"]||[]).push([[4],Array(76).concat([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},,function(e,t){function n(e,t,n,r,i,a,o){try{var s=e[a](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,a){var o=e.apply(t,r);function s(e){n(o,i,a,s,u,"next",e)}function u(e){n(o,i,a,s,u,"throw",e)}s(void 0)}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88);t.METADATA_KEY=r;var i=n(292);t.Container=i.Container;var a=n(110);t.BindingScopeEnum=a.BindingScopeEnum,t.BindingTypeEnum=a.BindingTypeEnum,t.TargetTypeEnum=a.TargetTypeEnum;var o=n(308);t.AsyncContainerModule=o.AsyncContainerModule,t.ContainerModule=o.ContainerModule;var s=n(309);t.injectable=s.injectable;var u=n(310);t.tagged=u.tagged;var c=n(311);t.named=c.named;var l=n(220);t.inject=l.inject,t.LazyServiceIdentifer=l.LazyServiceIdentifer;var h=n(312);t.optional=h.optional;var f=n(313);t.unmanaged=f.unmanaged;var d=n(314);t.multiInject=d.multiInject;var p=n(315);t.targetName=p.targetName;var v=n(316);t.postConstruct=v.postConstruct;var y=n(218);t.MetadataReader=y.MetadataReader;var g=n(138);t.id=g.id;var m=n(126);t.decorate=m.decorate;var b=n(223);t.traverseAncerstors=b.traverseAncerstors,t.taggedConstraint=b.taggedConstraint,t.namedConstraint=b.namedConstraint,t.typeConstraint=b.typeConstraint;var _=n(147);t.getServiceIdentifierAsString=_.getServiceIdentifierAsString;var w=n(317);t.multiBindToService=w.multiBindToService},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={EventBus:Symbol("EventBus"),Context:Symbol("Context"),QueryRunner:Symbol("QueryRunner"),LocationResolver:Symbol("LocationResolver"),HydraTemplateFetcher:Symbol("HydraTemplateFetcher"),HypermediaTreeFetcher:Symbol("HypermediaTreeFetcher"),HypermediaTreeProvider:Symbol("HypermediaTreeProvider"),HypermediaTreeFetcherFactory:Symbol("HypermediaTreeFetcherFactory"),CatalogFetcher:Symbol("CatalogFetcher"),CatalogProvider:Symbol("CatalogProvider"),ConnectionsProvider:Symbol("ConnectionsProvider"),ConnectionsFetcher:Symbol("ConnectionsFetcher"),ConnectionsFetcherFactory:Symbol("ConnectionsFetcherFactory"),StopsProvider:Symbol("StopsProvider"),StopsFetcher:Symbol("StopsFetcher"),StopsFetcherFactory:Symbol("StopsFetcherFactory"),RoutableTileProvider:Symbol("TileProvider"),RoutableTileFetcher:Symbol("TileFetcher"),FootpathsProvider:Symbol("FootpathsProvider"),PublicTransportPlanner:Symbol("PublicTransportPlanner"),PublicTransportPlannerFactory:Symbol("PublicTransportPlannerFactory"),ProfileFetcher:Symbol("ProfileFetcher"),ProfileProvider:Symbol("ProfileProvider"),RoadPlanner:Symbol("RoadPlanner"),RoadPlannerFactory:Symbol("RoadPlannerFactory"),PathfinderProvider:Symbol("PathfinderProvider"),ShortestPathAlgorithm:Symbol("ShortestPathAlgorithm"),ShortestPathTreeAlgorithm:Symbol("ShortestPathTreeAlgorithm"),ReachableStopsFinder:Symbol("ReachableStopsFinder"),JourneyExtractor:Symbol("JourneyExtractor"),LDFetch:Symbol("LDFetch"),LDLoader:Symbol("LDLoader")};t.default=r},function(e,t,n){var r=n(167);e.exports=function(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=r(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}},function(e,t,n){var r=n(103),i=n(226),a=n(321);e.exports=function(e){return function(){var t,n=r(e);if(i()){var o=r(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return a(this,t)}}},function(e,t,n){var r=n(181);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t,n){var r=n(228),i=n(324),a=n(167),o=n(229);e.exports=function(e,t){return r(e)||i(e,t)||a(e,t)||o()}},function(e,t,n){"use strict";var r,i=n(76),a=n(77),o=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var u=n(141),c=n(80),l=r=function(){function e(){i(this,e),this.emitter=new u.EventEmitter}return a(e,[{key:"eventNames",value:function(){return this.emitter.eventNames()}},{key:"rawListeners",value:function(e){return this.emitter.rawListeners(e)}},{key:"getMaxListeners",value:function(){return this.emitter.getMaxListeners()}},{key:"off",value:function(e,t){return this.emitter.off(e,t),this}},{key:"prependOnceListener",value:function(e,t){return this.emitter.prependOnceListener(e,t),this}},{key:"prependListener",value:function(e,t){return this.emitter.prependListener(e,t),this}},{key:"addListener",value:function(e,t){return this.emitter.addListener(e,t),this}},{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.emitter).emit.apply(t,[e].concat(r))}},{key:"listenerCount",value:function(e){return this.emitter.listenerCount(e)}},{key:"listeners",value:function(e){return this.emitter.listeners(e)}},{key:"on",value:function(e,t){return this.emitter.on(e,t),this}},{key:"once",value:function(e,t){return this.emitter.once(e,t),this}},{key:"removeAllListeners",value:function(e){return this.emitter.removeAllListeners(e),this}},{key:"removeListener",value:function(e,t){return this.emitter.removeListener(e,t),this}},{key:"setMaxListeners",value:function(e){return this.emitter.setMaxListeners(e),this}}],[{key:"getInstance",value:function(){return r.instance||(r.instance=new r),r.instance}}]),e}();l=r=o([c.injectable(),s("design:paramtypes",[])],l),t.default=l},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Query="query",e.SubQuery="sub-query",e.AbortQuery="abort-query",e.InvalidQuery="invalid-query",e.Warning="warning",e.ConnectionPrefetch="connection-prefetch",e.ConnectionIteratorView="connection-iterator-view",e.ConnectionScan="connection-scan",e.FinalReachableStops="final-reachable-stops",e.InitialReachableStops="initial-reachable-stops",e.AddedNewTransferProfile="added-new-transfer-profile",e.ReachableLocation="ReachableLocation",e.ReachableID="ReachableID",e.ReachableTile="ReachableTile",e.ReachableTransfer="ReachableTransfer",e.ResourceFetch="ResourceFetch",e.ZoiZone="ZoiZone"}(r||(r={})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NAMED_TAG="named",t.NAME_TAG="name",t.UNMANAGED_TAG="unmanaged",t.OPTIONAL_TAG="optional",t.INJECT_TAG="inject",t.MULTI_INJECT_TAG="multi_inject",t.TAGGED="inversify:tagged",t.TAGGED_PROP="inversify:tagged_props",t.PARAM_TYPES="inversify:paramtypes",t.DESIGN_PARAM_TYPES="design:paramtypes",t.POST_CONSTRUCT="post_construct"},function(e,t,n){(function(t){var r=n(141).EventEmitter,i=a.STATES=["INIT","OPEN","CLOSING","CLOSED","ENDED","DESTROYED"];function a(){if(!(this instanceof a))return new a;r.call(this),this.on("newListener",c),this._state=1,this._readable=!1}function o(e,t){e.emit(t)}function s(e,t){e._end(t)}function u(e){t(s,e)}function c(e){"data"===e&&(this.removeListener("newListener",c),this._addSingleListener("readable",l),this.readable&&t(h,l,this))}function l(){for(var e;this._hasListeners("data")&&null!==(e=this.read());)this.emit("data",e);this._hasListeners("data")||this.done||(this.removeListener("readable",l),this._addSingleListener("newListener",c))}function h(e,t){e.call(t)}function f(e,t,n){e.getProperty(n,(function(e){t.setProperty(n,e)}))}function d(){if(!(this instanceof d))return new d;a.call(this),this._changeState(4,!0)}function p(e){if(!(this instanceof p))return new p(e);a.call(this),this._item=e,null===e?this.close():this.readable=!0}function v(e){return this instanceof v?(a.call(this),e&&e.length>0?(this._buffer=Array.prototype.slice.call(e),void(this.readable=!0)):this.close()):new v(e)}function y(e){if(!(this instanceof y))return new y(e);a.call(this);var t,n=(e=e||{}).step,r=e.end,i=e.start;this._step=n=isFinite(n)?~~n:1,t=n>=0?1/0:-1/0,this._last=r=isFinite(r)?~~r:r===-t?r:t,this._next=i="number"!==typeof i?0:isFinite(i)?~~i:i,!isFinite(i)||(n>=0?i>r:i<r)?this.close():this.readable=!0}function g(e){if(!(this instanceof g))return new g(e);a.call(this);var n=(e=e||{}).maxBufferSize,r=e.autoStart;this._state=0,this._buffer=[],this._pushedCount=0,this.maxBufferSize=n,this._reading=!0,t(m,this,!1!==r||r)}function m(e,t){e._init(t)}function b(e){e._reading||(e._reading=!0,t(_,e))}function _(e){e._reading=!1,e._fillBuffer()}function w(e,t){if(!(this instanceof w))return new w(e,t);e&&A(e.read)||(t||(t=e),e=t&&t.source),g.call(this,t),e&&(this.source=e),this._optional=!(!t||!t.optional),this._destroySource=!t||!1!==t.destroySource}function x(){return this._source}function T(e){this._destination.emit("error",e)}function S(){this._destination._closeWhenDone()}function k(){this._destination._fillBuffer()}function M(e,t,n){var r,i=e._source;i&&!i.ended&&null!==(r=i.read())?e._optional?P(e,r,t):e._transform(r,t):n()}function P(e,t,n){var r=e._pushedCount;e._transform(t,(function(){r===e._pushedCount&&e._push(t),n()}))}function I(e,t){if(!(this instanceof I))return new I(e,t);if(w.call(this,e,t),t=t||!A(e&&e.read)&&e){var n=t.limit,r=t.offset,i=t.filter,a=t.map,o=A(t)?t:t.transform,s=t.prepend,u=t.append;r===1/0||n===-1/0?this._limit=0:(isFinite(r)&&(this._offset=Math.max(~~r,0)),isFinite(n)&&(this._limit=Math.max(~~n,0)),A(i)&&(this._filter=i),A(a)&&(this._map=a),A(o)&&(this._transform=o)),s&&(this._prepender=s.on?s:new v(s)),u&&(this._appender=u.on?u:new v(u))}}function j(e,t,n,r){var i,a=e._source;if(a&&!a.ended){for(0===e._limit&&e.close();!e.closed&&e._pushedCount<t&&null!==(i=a.read());)if(e._filter(i)&&(0===e._offset||!e._offset--)){var o=null===e._map?i:e._map(i);if(null===o)e._optional&&e._push(i);else{if(null!==e._transform)return void(e._optional?P(e,o,n):e._transform(o,n));e._push(o)}0===--e._limit&&e.close()}r()}else r()}function O(e,t){if(!(this instanceof O))return new O(e,t);w.call(this,e,t),this._transformerQueue=[]}function R(e){if(!(this instanceof R))return new R(e);a.call(this),this._readPosition=0,e&&(this.source=e)}function N(e,t,n,r){t.getProperty(n,(function(t){e._properties&&n in e._properties||r(t)}))}function C(e){var t,n=[];if(this.readAt=function(t){var r=null;return t<n.length?r=n[t]:e.ended||null===(r=e.read())||(n[t]=r),r},this.endsAt=function(t){return t===n.length&&e.ended},this.register=function(e){t&&t.push(e)},this.unregister=function(e){var n;t&&(n=t.indexOf(e))>=0&&t.splice(n,1)},!e.ended){function r(){for(var e=0;e<t.length;e++)t[e].readable=!0}function i(e){for(var n=0;n<t.length;n++)t[n].emit("error",e)}t=[],e.on("readable",r),e.on("end",(function a(){for(var o=0;o<t.length;o++)t[o]._readPosition===n.length&&t[o].close();t=null,e.removeListener("end",a),e.removeListener("error",i),e.removeListener("readable",r)})),e.on("error",i)}}function A(e){return"function"===typeof e}i.forEach((function(e,t){a[e]=t})),function e(t){t.prototype=Object.create(this.prototype,{constructor:{value:t,configurable:!0,writable:!0}}),t.subclass=e}.call(r,a),a.prototype._changeState=function(e,n){var r=e>this._state&&this._state<4;return r&&(this._state=e,4===e&&(n?t(o,this,"end"):this.emit("end"))),r},a.prototype.read=function(){return null},a.prototype.each=function(e,t){this.on("data",t?e.bind(t):e)},a.prototype._hasListeners=function(e){return this._events&&e in this._events},a.prototype._addSingleListener=function(e,t){var n=this._events&&this._events[e];n&&!(A(n)?n!==t:n.indexOf(t)<0)||this.on(e,t)},a.prototype.close=function(){this._changeState(3)&&u(this)},a.prototype.destroy=function(e){if(!this.done){var t=this;this._destroy(e,(function(n){(e=e||n)&&t.emit("error",e),s(t,!0)}))}},a.prototype._destroy=function(e,t){t()},a.prototype._end=function(e){this._changeState(e?5:4)&&(this._readable=!1,this.removeAllListeners("readable"),this.removeAllListeners("data"),this.removeAllListeners("end"))},Object.defineProperty(a.prototype,"readable",{get:function(){return this._readable},set:function(e){e=!!e&&!this.done,this._readable!==e&&(this._readable=e,e&&t(o,this,"readable"))},enumerable:!0}),Object.defineProperty(a.prototype,"closed",{get:function(){return this._state>=2},enumerable:!0}),Object.defineProperty(a.prototype,"ended",{get:function(){return 4===this._state},enumerable:!0}),Object.defineProperty(a.prototype,"destroyed",{get:function(){return 5===this._state},enumerable:!0}),Object.defineProperty(a.prototype,"done",{get:function(){return this._state>=4},enumerable:!0}),a.prototype.getProperty=function(e,n){var r,i=this._properties;if(!n)return i&&i[e];i&&e in i?t(n,i[e]):((r=this._propertyCallbacks)||(this._propertyCallbacks=r=Object.create(null)),e in r?r[e].push(n):r[e]=[n])},a.prototype.setProperty=function(e,n){(this._properties||(this._properties=Object.create(null)))[e]=n;var r,i=this._propertyCallbacks;if(r=i&&i[e]){for(e in delete i[e],1===r.length?t(r[0],n):t((function(){for(var e=0;e<r.length;e++)r[e](n)})),i)return;delete this._propertyCallbacks}},a.prototype.getProperties=function(){var e=this._properties,t={};for(var n in e)t[n]=e[n];return t},a.prototype.setProperties=function(e){for(var t in e)this.setProperty(t,e[t])},a.prototype.copyProperties=function(e,t){for(var n=0;n<t.length;n++)f(e,this,t[n])},a.prototype.toString=function(){var e=this._toStringDetails();return"["+this.constructor.name+(e?" "+e+"]":"]")},a.prototype._toStringDetails=function(){},a.subclass(d),a.subclass(p),p.prototype.read=function(){var e=this._item;return this._item=null,this.close(),e},p.prototype._toStringDetails=function(){return null===this._item?"":"("+this._item+")"},a.subclass(v),v.prototype.read=function(){var e=this._buffer,t=null;return e&&(t=e.shift(),e.length||(delete this._buffer,this.close())),t},v.prototype._toStringDetails=function(){return"("+(this._buffer&&this._buffer.length||0)+")"},v.prototype._destroy=function(e,t){delete this._buffer,t()},a.subclass(y),y.prototype.read=function(){if(this.closed)return null;var e=this._next,t=this._step,n=this._last,r=this._next+=t;return(t>=0?r>n:r<n)&&this.close(),e},y.prototype._toStringDetails=function(){return"("+this._next+"..."+this._last+")"},a.range=function(e,t,n){return new y({start:e,end:t,step:n})},a.subclass(g),Object.defineProperty(g.prototype,"maxBufferSize",{set:function(e){e!==1/0&&(e=isFinite(e)?Math.max(~~e,1):4),this._maxBufferSize!==e&&(this._maxBufferSize=e,1===this._state&&this._fillBuffer())},get:function(){return this._maxBufferSize},enumerable:!0}),g.prototype._init=function(e){var t=this;this._reading=!0,this._begin((function(){if(!t)throw new Error("done callback called multiple times");t._reading=!1,t._changeState(1),e?b(t):t.readable=!0,t=null}))},g.prototype._begin=function(e){e()},g.prototype.read=function(){if(this.done)return null;var e,t=this._buffer;return t.length?e=t.shift():(e=null,this.readable=!1),!this._reading&&t.length<this._maxBufferSize&&(this.closed?t.length||u(this):b(this)),e},g.prototype._read=function(e,t){t()},g.prototype._push=function(e){this.done||(this._pushedCount++,this._buffer.push(e),this.readable=!0)},g.prototype._fillBuffer=function(){var e,t=this;this._reading||(this.closed?this._completeClose():(e=Math.min(this._maxBufferSize-this._buffer.length,128))>0&&(this._pushedCount=0,this._reading=!0,this._read(e,(function(){if(!e)throw new Error("done callback called multiple times");e=0,t._reading=!1,t.closed?t._completeClose():t._pushedCount&&(t.readable=!0,t._buffer.length<t._maxBufferSize/2&&b(t))}))))},g.prototype.close=function(){this._reading?this._changeState(2):this._completeClose()},g.prototype._completeClose=function(){if(this._changeState(3)){var e=this;this._reading=!0,this._flush((function(){if(!e._reading)throw new Error("done callback called multiple times");e._reading=!1,e._buffer.length||u(e)}))}},g.prototype._destroy=function(e,t){this._buffer=[],t()},g.prototype._flush=function(e){e()},g.prototype._toStringDetails=function(){var e=this._buffer,t=e.length;return"{"+(t?"next: "+e[0]+", ":"")+"buffer: "+t+"}"},g.subclass(w),Object.defineProperty(w.prototype,"source",{set:function(e){this._validateSource(e),this._source=e,e._destination=this,e.ended?this.close():(e.on("end",S),e.on("readable",k),e.on("error",T))},get:x,enumerable:!0}),w.prototype._validateSource=function(e,t){if(this._source)throw new Error("The source cannot be changed after it has been set");if(!e||!A(e.read)||!A(e.on))throw new Error("Invalid source: "+e);if(!t&&e._destination)throw new Error("The source already has a destination")},w.prototype._read=function(e,n){var r=this;M(r,(function i(){r._pushedCount<e&&!r.closed?t(M,r,i,n):n()}),n)},w.prototype._transform=function(e,t){this._push(e),t()},w.prototype._closeWhenDone=function(){this.close()},w.prototype._end=function(e){var t=this._source;t&&(t.removeListener("end",S),t.removeListener("error",T),t.removeListener("readable",k),delete t._destination,this._destroySource&&t.destroy()),g.prototype._end.call(this,e)},a.wrap=w,w.subclass(I),I.prototype._offset=0,I.prototype._limit=1/0,I.prototype._filter=function(){return!0},I.prototype._map=null,I.prototype._transform=null,I.prototype._read=function(e,n){var r=this;j(r,e,(function i(){t(j,r,e,i,n)}),n)},I.prototype._begin=function(e){this._insert(this._prepender,e),delete this._prepender},I.prototype._flush=function(e){this._insert(this._appender,e),delete this._appender},I.prototype._insert=function(e,t){var n=this;function r(e){n._push(e)}!e||e.ended?t():(e.on("data",r),e.on("end",(function n(){e.removeListener("data",r),e.removeListener("end",n),t()})))},a.prototype.transform=function(e){return new I(this,e)},a.prototype.map=function(e,t){return this.transform({map:t?e.bind(t):e})},a.prototype.filter=function(e,t){return this.transform({filter:t?e.bind(t):e})},a.prototype.prepend=function(e){return this.transform({prepend:e})},a.prototype.append=function(e){return this.transform({append:e})},a.prototype.surround=function(e,t){return this.transform({prepend:e,append:t})},a.prototype.skip=function(e){return this.transform({offset:e})},a.prototype.take=function(e){return this.transform({limit:e})},a.prototype.range=function(e,t){return this.transform({offset:e,limit:Math.max(t-e+1,0)})},w.subclass(O),O.prototype._read=function(e,t){for(var n,r,i,a=this._transformerQueue,o=this._source,s=this._optional;(r=a[0])&&r.transformer.ended;)s&&null!==r.item&&(this._push(r.item),e--),(i=(r=a.shift()).transformer).removeListener("end",k),i.removeListener("readable",k),i.removeListener("error",T);for(;o&&!o.ended&&a.length<this._maxBufferSize&&null!==(n=this._source.read());)(i=this._createTransformer(n)||new d)._destination=this,i.on("end",k),i.on("readable",k),i.on("error",T),a.push({transformer:i,item:n});if(r=a[0])for(i=r.transformer;e-- >0&&null!==(n=i.read());)this._push(n),s&&(r.item=null);else o&&o.ended&&this.close();t()},O.prototype._createTransformer=p,O.prototype._closeWhenDone=function(){this._transformerQueue.length||this.close()},w.subclass(R),Object.defineProperty(R.prototype,"source",{set:function(e){var t=e&&e._destination;this._validateSource(e,!t||t instanceof C),this._source=e,t||(t=e._destination=new C(e)),t.endsAt(0)?this.close():(t.register(this),null!==t.readAt(0)&&(this.readable=!0));var n=this._propertyCallbacks;for(var r in n)for(var i=n[r],a=0;a<i.length;a++)N(this,e,r,i[a])},get:x,enumerable:!0}),R.prototype.getProperty=function(e,t){var n=this._properties,r=this._source,i=n&&e in n;if(!t)return i?n[e]:r&&r.getProperty(e);a.prototype.getProperty.call(this,e,t),r&&!i&&N(this,r,e,t)},R.prototype.getProperties=function(){var e=this._source?this._source.getProperties():{},t=this._properties;for(var n in t)e[n]=t[n];return e},R.prototype._toStringDetails=function(){var e=this._source;return"{source: "+(e?e.toString():"none")+"}"},R.prototype.read=function(){var e=this._source,t=null;if(!this.done&&e){var n=e._destination;null!==(t=n.readAt(this._readPosition))?this._readPosition++:this.readable=!1,n.endsAt(this._readPosition)&&this.close()}return t},R.prototype._end=function(e){var t=this._source&&this._source._destination;t&&t.unregister(this),g.prototype._end.call(this,e)},R.prototype.close=a.prototype.close,a.prototype.clone=function(){return new R(this)},e.exports=a,a.AsyncIterator=a,a.EmptyIterator=a.empty=d,a.SingletonIterator=a.single=p,a.ArrayIterator=a.fromArray=v,a.IntegerIterator=y,a.BufferedIterator=g,a.TransformIterator=w,a.SimpleTransformIterator=I,a.MultiTransformIterator=O,a.ClonedIterator=R}).call(this,n(140).setImmediate)},function(e,t,n){"use strict";var r=n(85),i=n(78),a=n(82),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=f(n(463)),p=n(80),v=f(n(111)),y=f(n(106)),g=f(n(81)),m=f(n(99)),b=f(n(148)),_=function(){function e(t,n,r,i){s(this,e),this.locationResolver=i,this.shortestPath=n,this.shortestPathTree=t,this.routableTileRegistry=v.default.getInstance(),this.profileProvider=r,this.graphs={},this.embeddings=[],this.embedded=new Set}return u(e,[{key:"getShortestPathAlgorithm",value:function(e){var t=this.getGraphForProfile(e);return this.shortestPath.createInstance(t,this.locationResolver)}},{key:"getShortestPathTreeAlgorithm",value:function(e){var t=this.getGraphForProfile(e);return this.shortestPathTree.createInstance(t)}},{key:"registerEdges",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u,c,l,h,f,d,p,v,y;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0,r=Object.keys(this.graphs);case 1:if(!(n<r.length)){e.next=49;break}return o=r[n],e.next=5,this.profileProvider.getProfile(o);case 5:s=e.sent,u=a(t),e.prev=7,u.s();case 9:if((c=u.n()).done){e.next=38;break}if(l=c.value,h=this.routableTileRegistry.getWay(l),s.hasAccess(h)){e.next=14;break}return e.abrupt("continue",36);case 14:f=a(h.getParts()),e.prev=15,f.s();case 17:if((d=f.n()).done){e.next=28;break}if(p=d.value,v=this.routableTileRegistry.getNode(p.from),y=this.routableTileRegistry.getNode(p.to),!v||!y){e.next=26;break}if(!s.isObstacle(v)&&!s.isObstacle(y)){e.next=24;break}return e.abrupt("continue",26);case 24:this.addEdge(s,v,y,h,p.distance),s.isOneWay(h)||this.addEdge(s,y,v,h,p.distance);case 26:e.next=17;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(15),f.e(e.t0);case 33:return e.prev=33,f.f(),e.finish(33);case 36:e.next=9;break;case 38:e.next=43;break;case 40:e.prev=40,e.t1=e.catch(7),u.e(e.t1);case 43:return e.prev=43,u.f(),e.finish(43);case 46:n++,e.next=1;break;case 49:case"end":return e.stop()}}),e,this,[[7,40,43,46],[15,30,33,36]])})));return function(t){return e.apply(this,arguments)}}()},{key:"embedLocation",value:function(){var e=o(i.mark((function e(t,n){var o,s,u,c,l,h,f,d,p,v,y,g,b,_,w,x,T,S,k,M,P,I,j,O,R,N,C,A,E,D=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=D.length>2&&void 0!==D[2]&&D[2],e.t0=a,e.next=4,this.profileProvider.getProfiles();case 4:e.t1=e.sent,s=(0,e.t0)(e.t1),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=64;break}if(c=u.value,!this.embedded.has(c.getID()+m.default.getId(t))){e.next=12;break}return e.abrupt("continue",62);case 12:this.embedded.add(c.getID()+m.default.getId(t)),l=1/0,h=void 0,f=a(n.getWays()),e.prev=16,f.s();case 18:if((d=f.n()).done){e.next=53;break}if(p=d.value,v=this.routableTileRegistry.getWay(p),c.hasAccess(v)&&!1!==v.reachable){e.next=23;break}return e.abrupt("continue",51);case 23:y=a(v.segments),e.prev=24,y.s();case 26:if((g=y.n()).done){e.next=43;break}b=g.value,_=0;case 29:if(!(_<b.length-1)){e.next=41;break}if(w=b[_],x=this.routableTileRegistry.getNode(w),T=b[_+1],S=this.routableTileRegistry.getNode(T),x&&S){e.next=36;break}return e.abrupt("continue",38);case 36:(k=this.segmentDistToPoint(x,S,t))<l&&(l=k,h=[v,x,S]);case 38:_++,e.next=29;break;case 41:e.next=26;break;case 43:e.next=48;break;case 45:e.prev=45,e.t2=e.catch(24),y.e(e.t2);case 48:return e.prev=48,y.f(),e.finish(48);case 51:e.next=18;break;case 53:e.next=58;break;case 55:e.prev=55,e.t3=e.catch(16),f.e(e.t3);case 58:return e.prev=58,f.f(),e.finish(58);case 61:if(h){M=r(h,3),P=M[0],I=M[1],j=M[2],O=this.projectOntoSegment(I,j,t),R={way:P,segA:I,segB:j,intersection:O,point:t},N=a(this.embeddings);try{for(N.s();!(C=N.n()).done;)A=C.value,m.default.getId(A.segA)===m.default.getId(I)&&m.default.getId(A.segB)===m.default.getId(j)&&(this.addEdge(c,O,A.intersection,P),this.addEdge(c,A.intersection,O,P))}catch(i){N.e(i)}finally{N.f()}this.embeddings.push(R),E=c.isOneWay(P),o?(this.addEdge(c,O,t,P),this.addEdge(c,I,O,P),E||this.addEdge(c,j,O,P)):(this.addEdge(c,t,O,P),this.addEdge(c,O,j,P),E||this.addEdge(c,O,I,P))}case 62:e.next=8;break;case 64:e.next=69;break;case 66:e.prev=66,e.t4=e.catch(6),s.e(e.t4);case 69:return e.prev=69,s.f(),e.finish(69);case 72:case"end":return e.stop()}}),e,this,[[6,66,69,72],[16,55,58,61],[24,45,48,51]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getGraphForProfile",value:function(e){if(!this.graphs[e.getID()]){var t=new b.default(e.getID());this.graphs[e.getID()]=t;var n,r=a(this.routableTileRegistry.getWays());try{for(r.s();!(n=r.n()).done;){var i=n.value;if(e.hasAccess(i)){var o,s=a(i.getParts());try{for(s.s();!(o=s.n()).done;){var u=o.value,c=this.routableTileRegistry.getNode(u.from),l=this.routableTileRegistry.getNode(u.to);if(c&&l){if(e.isObstacle(c)||e.isObstacle(l))continue;this.addEdge(e,c,l,i,u.distance,t),e.isOneWay(i)||this.addEdge(e,l,c,i,u.distance,t)}}}catch(h){s.e(h)}finally{s.f()}}}}catch(h){r.e(h)}finally{r.f()}}return this.graphs[e.getID()]}},{key:"addEdge",value:function(e,t,n,r,i,a){a=a||this.getGraphForProfile(e),i=i||e.getDistance(t,n,r)||.01;var o=e.getDuration(t,n,r)||1,s=e.getCost(t,n,r)||1;a.addEdge(m.default.getId(t),m.default.getId(n),r.id,i,o,s)}},{key:"segmentDistToPoint",value:function(e,t,n){var r,i=e.longitude,a=t.longitude,o=n.longitude,s=e.latitude,u=t.latitude,c=n.latitude,l=a-i,h=u-s,f=l*l+h*h;(r=f?((o-i)*l+(c-s)*h)/f:1/0)>1?r=1:r<0&&(r=0);var d={longitude:i+r*l,latitude:s+r*h};return m.default.getDistanceBetweenLocations(n,d)}},{key:"projectOntoSegment",value:function(e,t,n){var r,i=d.default("EPSG:4326","EPSG:3857",[e.longitude,e.latitude]),a=d.default("EPSG:4326","EPSG:3857",[t.longitude,t.latitude]),o=d.default("EPSG:4326","EPSG:3857",[n.longitude,n.latitude]),s=i[0],u=a[0],c=o[0],l=i[1],h=a[1],f=o[1],p=u-s,v=h-l,y=p*p+v*v;(r=y?((c-s)*p+(f-l)*v)/y:1/0)>1?r=1:r<0&&(r=0);var g=s+r*p,m=l+r*v,b=d.default("EPSG:3857","EPSG:4326",[g,m]);return{longitude:b[0],latitude:b[1]}}}]),e}();_=c([p.injectable(),h(0,p.inject(g.default.ShortestPathTreeAlgorithm)),h(1,p.inject(g.default.ShortestPathAlgorithm)),h(2,p.inject(g.default.ProfileProvider)),h(3,p.inject(g.default.LocationResolver)),l("design:paramtypes",[Object,Object,y.default,Object])],_),t.default=_},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Base="base",e.Transit="transit"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r=n(193),i=n(82),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(80),l=n(252),h=n(108),f=u(n(105)),d=function(){function e(){a(this,e),this.collectionFields=new Set}return o(e,[{key:"defineCollection",value:function(e){this.collectionFields.add(e)}},{key:"process",value:function(e,t){for(var n=this._extractEntities(e),r=0,a=Object.values(n);r<a.length;r++){var o,s=a[r],u=i(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=c.process(s);l&&c.addEntity(l)}}catch(h){u.e(h)}finally{u.f()}}return t.map((function(e){return e.getContents()}))}},{key:"disambiguateBlankNodes",value:function(e,t){var n,r=i(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;"BlankNode"===a.subject.termType&&(a.subject.value="".concat(t,"#").concat(a.subject.value)),"BlankNode"===a.object.termType&&(a.object.value="".concat(t,"#").concat(a.object.value))}}catch(o){r.e(o)}finally{r.f()}}},{key:"_parseValue",value:function(e,t){var n=t.object,r=n.value;if("BlankNode"===n.termType)return e[r];if("NamedNode"===n.termType&&e[r])return e[r];if("Literal"===n.termType){var i=n.datatype.value;if(i===f.default.inNS(h.XMLS,"string"))return r;if(i===f.default.inNS(h.XMLS,"boolean"))return"true"===r;if(i===f.default.inNS(h.XMLS,"double"))return parseFloat(r);if(i===f.default.inNS(h.XMLS,"integer"))return parseInt(r,10);if(i===f.default.inNS(h.GEOSPARQL,"wktLiteral"))return this.parseWktLiteral(r)}return r}},{key:"parseWktLiteral",value:function(e){var t=e.split(" "),n=r(t),i=n[0],a=n.slice(1);return l("<http://www.opengis.net/def/crs/OGC/1.3/CRS84>"===i?a.join(" "):e)}},{key:"_extractEntities",value:function(e){var t,n={},r=i(e);try{for(r.s();!(t=r.n()).done;){var a=t.value.subject.value;a in n||(n[a]={id:a})}}catch(p){r.e(p)}finally{r.f()}var o,s=i(e);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=u.subject.value,l=u.predicate.value,h=n[c],f=this._parseValue(n,u);if(this.collectionFields.has(l)){var d=h[l]||[];d.push(f),h[l]=d}else h[l]=f}}catch(p){s.e(p)}finally{s.f()}return n}}]),e}();d=s([c.injectable()],d),t.LDLoader=d},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DUPLICATED_INJECTABLE_DECORATOR="Cannot apply @injectable decorator multiple times.",t.DUPLICATED_METADATA="Metadata key was used more than once in a parameter:",t.NULL_ARGUMENT="NULL argument",t.KEY_NOT_FOUND="Key Not Found",t.AMBIGUOUS_MATCH="Ambiguous match found for serviceIdentifier:",t.CANNOT_UNBIND="Could not unbind serviceIdentifier:",t.NOT_REGISTERED="No matching bindings found for serviceIdentifier:",t.MISSING_INJECTABLE_ANNOTATION="Missing required @injectable annotation in:",t.MISSING_INJECT_ANNOTATION="Missing required @inject or @multiInject annotation in:",t.UNDEFINED_INJECT_ANNOTATION=function(e){return"@inject called with undefined this could mean that the class "+e+" has a circular dependency problem. You can use a LazyServiceIdentifer to  overcome this limitation."},t.CIRCULAR_DEPENDENCY="Circular dependency found:",t.NOT_IMPLEMENTED="Sorry, this feature is not fully implemented yet.",t.INVALID_BINDING_TYPE="Invalid binding type:",t.NO_MORE_SNAPSHOTS_AVAILABLE="No snapshot available to restore.",t.INVALID_MIDDLEWARE_RETURN="Invalid return type in middleware. Middleware must return!",t.INVALID_FUNCTION_BINDING="Value provided to function binding must be a function!",t.INVALID_TO_SELF_VALUE="The toSelf function can only be applied when a constructor is used as service identifier",t.INVALID_DECORATOR_OPERATION="The @inject @multiInject @tagged and @named decorators must be applied to the parameters of a class constructor or a class property.",t.ARGUMENTS_LENGTH_MISMATCH=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"The number of constructor arguments in the derived class "+e[0]+" must be >= than the number of constructor arguments of its base class."},t.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT="Invalid Container constructor argument. Container options must be an object.",t.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE="Invalid Container option. Default scope must be a string ('singleton' or 'transient').",t.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE="Invalid Container option. Auto bind injectable must be a boolean",t.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK="Invalid Container option. Skip base check must be a boolean",t.MULTIPLE_POST_CONSTRUCT_METHODS="Cannot apply @postConstruct decorator multiple times in the same class",t.POST_CONSTRUCT_ERROR=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"@postConstruct error in class "+e[0]+": "+e[1]},t.CIRCULAR_DEPENDENCY_IN_FACTORY=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return"It looks like there is a circular dependency in one of the '"+e[0]+"' bindings. Please investigate bindings withservice identifier '"+e[1]+"'."},t.STACK_OVERFLOW="Maximum call stack size exceeded"},function(e,t,n){"use strict";(function(t,r){var i=n(78),a=n(79),o=n(85),s=n(82),u=n(116),c=n(104),l=n(188).IdentifierIssuer,h=n(107),f=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,d=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,p=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,v={accept:"application/ld+json, application/json"},y={};e.exports=y,y.IdentifierIssuer=l;var g="function"===typeof t&&t,m=g?function(e){return g(e)}:function(e){return setTimeout(e,0)};function b(e,t,n){y.nextTick((function(){return e(t,n)}))}"object"===typeof r&&"function"===typeof r.nextTick?y.nextTick=r.nextTick:y.nextTick=m,y.setImmediate=g?m:y.nextTick,y.clone=function(e){if(e&&"object"===typeof e){var t;if(c.isArray(e)){t=[];for(var n=0;n<e.length;++n)t[n]=y.clone(e[n])}else if(e instanceof Map){t=new Map;var r,i=s(e);try{for(i.s();!(r=i.n()).done;){var a=o(r.value,2),u=a[0],l=a[1];t.set(u,y.clone(l))}}catch(v){i.e(v)}finally{i.f()}}else if(e instanceof Set){t=new Set;var h,f=s(e);try{for(f.s();!(h=f.n()).done;){var d=h.value;t.add(y.clone(d))}}catch(v){f.e(v)}finally{f.f()}}else if(c.isObject(e))for(var p in t={},e)t[p]=y.clone(e[p]);else t=e.toString();return t}return e},y.asArray=function(e){return Array.isArray(e)?e:[e]},y.buildHeaders=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e).some((function(e){return"accept"===e.toLowerCase()}));if(t)throw new RangeError('Accept header may not be specified; only "'+v.accept+'" is supported.');return Object.assign({Accept:v.accept},e)},y.parseLinkHeader=function(e){for(var t={},n=e.match(f),r=0;r<n.length;++r){var i=n[r].match(d);if(i){for(var a={target:i[1]},o=i[2];i=p.exec(o);)a[i[1]]=void 0===i[2]?i[3]:i[2];var s=a.rel||"";Array.isArray(t[s])?t[s].push(a):t.hasOwnProperty(s)?t[s]=[t[s],a]:t[s]=a}}return t},y.validateTypeValue=function(e){if(!c.isString(e)&&!c.isEmptyObject(e)){var t=!1;if(c.isArray(e)){t=!0;for(var n=0;n<e.length;++n)if(!c.isString(e[n])){t=!1;break}}if(!t)throw new h('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, or an empty object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},y.hasProperty=function(e,t){if(e.hasOwnProperty(t)){var n=e[t];return!c.isArray(n)||n.length>0}return!1},y.hasValue=function(e,t,n){if(y.hasProperty(e,t)){var r=e[t],i=u.isList(r);if(c.isArray(r)||i){i&&(r=r["@list"]);for(var a=0;a<r.length;++a)if(y.compareValues(n,r[a]))return!0}else if(!c.isArray(n))return y.compareValues(n,r)}return!1},y.addValue=function(e,t,n,r){if("propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1),"valueIsArray"in r||(r.valueIsArray=!1),"allowDuplicate"in r||(r.allowDuplicate=!0),r.valueIsArray)e[t]=n;else if(c.isArray(n)){0===n.length&&r.propertyIsArray&&!e.hasOwnProperty(t)&&(e[t]=[]);for(var i=0;i<n.length;++i)y.addValue(e,t,n[i],r)}else if(e.hasOwnProperty(t)){var a=!r.allowDuplicate&&y.hasValue(e,t,n);c.isArray(e[t])||a&&!r.propertyIsArray||(e[t]=[e[t]]),a||e[t].push(n)}else e[t]=r.propertyIsArray?[n]:n},y.getValues=function(e,t){return[].concat(e[t]||[])},y.removeProperty=function(e,t){delete e[t]},y.removeValue=function(e,t,n,r){"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);var i=y.getValues(e,t).filter((function(e){return!y.compareValues(e,n)}));0===i.length?y.removeProperty(e,t):1!==i.length||r.propertyIsArray?e[t]=i:e[t]=i[0]},y.relabelBlankNodes=function(e,t){return function e(t,n){if(c.isArray(n))for(var r=0;r<n.length;++r)n[r]=e(t,n[r]);else if(u.isList(n))n["@list"]=e(t,n["@list"]);else if(c.isObject(n)){u.isBlankNode(n)&&(n["@id"]=t.getId(n["@id"]));for(var i=Object.keys(n).sort(),a=0;a<i.length;++a){var o=i[a];"@id"!==o&&(n[o]=e(t,n[o]))}}return n}((t=t||{}).issuer||new l("_:b"),e)},y.compareValues=function(e,t){return e===t||(!(!u.isValue(e)||!u.isValue(t)||e["@value"]!==t["@value"]||e["@type"]!==t["@type"]||e["@language"]!==t["@language"]||e["@index"]!==t["@index"])||!!(c.isObject(e)&&"@id"in e&&c.isObject(t)&&"@id"in t)&&e["@id"]===t["@id"])},y.compareShortestLeast=function(e,t){return e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1},y.normalizeDocumentLoader=function(e){return e.length<2?y.callbackify(e):function(){var t=a(i.mark((function t(n){var r,a=arguments;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a[1],t.abrupt("return",new Promise((function(t,i){try{e(n,(function(e,n){if("function"===typeof r)return b(r,e,n);e?i(e):t(n)}))}catch(a){if("function"===typeof r)return b(r,a);i(a)}})));case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},y.callbackify=function(e){return a(i.mark((function t(){var n,r,a,o,s,u=arguments;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=u.length,r=new Array(n),a=0;a<n;a++)r[a]=u[a];return"function"===typeof(o=r[r.length-1])&&r.pop(),t.prev=3,t.next=6,e.apply(null,r);case 6:s=t.sent,t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(3),"function"!==typeof o){t.next=13;break}return t.abrupt("return",b(o,t.t0));case 13:throw t.t0;case 14:if("function"!==typeof o){t.next=16;break}return t.abrupt("return",b(o,null,s));case 16:return t.abrupt("return",s);case 17:case"end":return t.stop()}}),t,null,[[3,9]])})))}}).call(this,n(140).setImmediate,n(95))},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(111)),d=n(318),p=l(n(113)),v=l(n(90)),y=l(n(81)),g=n(139),m=function(){function e(t,n){a(this,e),this.tiles={},this.pathfinderProvider=t,this.fetcher=n,this.registry=f.default.getInstance()}return o(e,[{key:"wait",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.values(this.tiles));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIdForLocation",value:function(e,t){var n=g.lat_to_tile(t.latitude,e),r=g.long_to_tile(t.longitude,e),i=new p.default(e,r,n);return this.getIdForTileCoords(i)}},{key:"getIdForTileCoords",value:function(e){return"https://tiles.openplanner.team/planet/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}},{key:"getByLocation",value:function(e,t){var n=this.lat2tile(t.latitude,e),r=this.long2tile(t.longitude,e),i=new p.default(e,r,n);return this.getByTileCoords(i)}},{key:"getByTileCoords",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForTileCoords(t),e.next=3,this.getByUrl(n);case 3:return(i=e.sent).coordinate=t,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getmultipleByLocation",value:function(){var e=i(r.mark((function e(t,n){var i,a=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(n.map((function(e){return a.getByLocation(t,e)})));case 2:return i=e.sent,e.abrupt("return",new d.RoutableTileSet(i));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMultipleByTileCoords",value:function(){var e=i(r.mark((function e(t){var n,i=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(t.map((function(e){return i.getByTileCoords(e)})));case 2:return n=e.sent,e.abrupt("return",new d.RoutableTileSet(n));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getByUrl",value:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tiles[t]){e.next=6;break}return this.tiles[t]=this.fetcher.get(t),e.next=4,this.tiles[t];case 4:n=e.sent,this.pathfinderProvider.registerEdges(n.getWays());case 6:return e.next=8,this.tiles[t];case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"long2tile",value:function(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}},{key:"lat2tile",value:function(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}}]),e}();m=s([h.injectable(),c(0,h.inject(y.default.PathfinderProvider)),c(1,h.inject(y.default.RoutableTileFetcher)),u("design:paramtypes",[v.default,Object])],m),t.default=m},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(325)),s=function(){function e(){r(this,e)}return i(e,null,[{key:"getDistanceBetweenLocations",value:function(e,t){var n=e.longitude,r=e.latitude,i=t.longitude,a=t.latitude;return void 0===n||void 0===r||void 0===i||void 0===a?Number.POSITIVE_INFINITY:o.default({latitude:r,longitude:n},{latitude:a,longitude:i},{unit:"meter"})}},{key:"getDistanceBetweenStops",value:function(e,t){return this.getDistanceBetweenLocations(e,t)}},{key:"getId",value:function(e){return"id"in e?e.id:"geo:".concat(e.latitude,",").concat(e.longitude)}}]),e}();t.default=s},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Initial="reachableStopsSearchInitial",e.Transfer="reachableStopsSearchTransfer",e.Final="reachableStopsSearchFinal"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Train="train",e.Bus="bus",e.Walking="walking",e.Profile="profile"}(r||(r={})),t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=function(){function e(e,t){this.key=e,this.value=t}return e.prototype.toString=function(){return this.key===r.NAMED_TAG?"named: "+this.value.toString()+" ":"tagged: { key:"+this.key.toString()+", value: "+this.value+" }"},e}();t.Metadata=i},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){"use strict";var r={};e.exports=r,r.isArray=Array.isArray,r.isBoolean=function(e){return"boolean"===typeof e||"[object Boolean]"===Object.prototype.toString.call(e)},r.isDouble=function(e){return r.isNumber(e)&&-1!==String(e).indexOf(".")},r.isEmptyObject=function(e){return r.isObject(e)&&0===Object.keys(e).length},r.isNumber=function(e){return"number"===typeof e||"[object Number]"===Object.prototype.toString.call(e)},r.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},r.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},r.isString=function(e){return"string"===typeof e||"[object String]"===Object.prototype.toString.call(e)},r.isUndefined=function(e){return"undefined"===typeof e}},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,null,[{key:"inNS",value:function(e,t){var n=e[e.length-1];return"/"===n||"#"===n?"".concat(e).concat(t):"".concat(e,"#").concat(t)}},{key:"fakeExpand",value:function(e,t){return this.inNS(e,t.substring(4))}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(81)),d=function(){function e(t){a(this,e),this.profiles={},this.fetcher=t,this.developmentProfile=void 0,this.developmentProfileCounter=0}return o(e,[{key:"parseDevelopmentProfile",value:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.developmentProfileCounter+=1,e.next=3,this.fetcher.parseProfileBlob(t,""+this.developmentProfileCounter);case 3:return n=e.sent,this.developmentProfile,this.developmentProfile=n,this.profiles[this.developmentProfile.getID()]=Promise.resolve(n),e.abrupt("return",n.getID());case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addProfile",value:function(e){this.profiles[e.getID()]=Promise.resolve(e)}},{key:"getProfile",value:function(e){return void 0===this.profiles[e]&&(this.profiles[e]=this.fetcher.get(e)),this.profiles[e]}},{key:"getProfiles",value:function(){return Promise.all(Object.values(this.profiles))}}]),e}();d=s([h.injectable(),c(0,h.inject(f.default.ProfileFetcher)),u("design:paramtypes",[Object])],d),t.default=d},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=n(169);e.exports=function(e){a(n,e);var t=i(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"An unspecified JSON-LD error occurred.",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"jsonld.Error",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r(this,n),(e=t.call(this,i)).name=a,e.message=i,e.details=o,e}return n}(o(Error))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.XMLS="http://www.w3.org/2001/XMLSchema",t.HYDRA="http://www.w3.org/ns/hydra/core",t.OSM="https://w3id.org/openstreetmap/terms",t.GEO="http://www.w3.org/2003/01/geo/wgs84_pos",t.GEOSPARQL="http://www.opengis.net/ont/geosparql#",t.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns",t.RDFS="http://www.w3.org/2000/01/rdf-schema",t.ROUTE="https://w3id.org/routabletiles/terms#",t.PLANNER="https://planner.js.org/terms#",t.PROFILE="https://w3id.org/openplannerteam/profile#",t.TREE="https://w3id.org/tree#",t.LC="http://semweb.mmlab.be/ns/linkedconnections#",t.DCAT="http://www.w3.org/ns/dcat#",t.DCT="http://purl.org/dc/terms/",t.GTFS="http://vocab.gtfs.org/terms#"},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},o=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(80),c=s(n(128)),l=s(n(86)),h=s(n(87)),f=function(){function e(){r(this,e),this.ldFetchBase=new c.default({headers:{Accept:"application/ld+json"}}),this.eventBus=l.default.getInstance(),this.setupEvents()}return i(e,[{key:"get",value:function(e){return this.ldFetchBase.get(e)}},{key:"setupEvents",value:function(){var e=this;this.httpStartTimes={},this.ldFetchBase.on("request",(function(t){return e.httpStartTimes[t]=new Date})),this.ldFetchBase.on("redirect",(function(t){return e.httpStartTimes[t.to]=e.httpStartTimes[t.from]})),this.ldFetchBase.on("response",(function(t){var n=(new Date).getTime()-e.httpStartTimes[t].getTime();e.eventBus.emit(h.default.ResourceFetch,{url:t,duration:n})}))}}]),e}();f=a([u.injectable(),o("design:paramtypes",[])],f),t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingScopeEnum={Request:"Request",Singleton:"Singleton",Transient:"Transient"};t.BindingTypeEnum={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"};t.TargetTypeEnum={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"}},function(e,t,n){"use strict";var r,i=n(76),a=n(77),o=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},s=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var u=n(80),c=r=function(){function e(){i(this,e),this.nodes={},this.ways={}}return a(e,[{key:"registerNode",value:function(e){this.nodes[e.id]=e}},{key:"registerWay",value:function(e){this.ways[e.id]?this.ways[e.id]=e.mergeDefinitions(this.ways[e.id]):this.ways[e.id]=e}},{key:"getNode",value:function(e){return this.nodes[e]}},{key:"getWay",value:function(e){return this.ways[e]}},{key:"getNodes",value:function(){return Object.values(this.nodes)}},{key:"getWays",value:function(){return Object.values(this.ways)}}],[{key:"getInstance",value:function(){return r.instance||(r.instance=new r),r.instance}}]),e}();c=r=o([u.injectable(),s("design:paramtypes",[])],c),t.default=c},function(e,t,n){var r=n(319),i=n(225),a=n(167),o=n(320);e.exports=function(e){return r(e)||i(e)||a(e)||o()}},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i){r(this,e),this.zoom=t,this.x=n,this.y=i}return i(e,[{key:"contains",value:function(e){var t=Math.pow(2,e.zoom-this.zoom),n=Math.floor(e.x/t),r=Math.floor(e.y/t);return n===this.x&&r===this.y}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),s=function(){function e(){r(this,e)}return i(e,[{key:"setContainer",value:function(e){this.container=e}},{key:"getContainer",value:function(){return this.container}}]),e}();s=a([o.injectable()],s),t.default=s},function(e,t,n){"use strict";(function(e){var r=n(331),i=n(332),a=n(234);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?s(e,0):f(e,t);if("Buffer"===t.type&&a(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(u.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return j(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return P(this,t,n);case"latin1":case"binary":return I(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"===typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(e,a)===c(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var h=!0,f=0;f<u;f++)if(c(e,a+f)!==c(t,f)){h=!1;break}if(h)return a}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!==0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function _(e,t,n,r){return G(U(t,e.length-n),e,n,r)}function w(e,t,n,r){return G(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function x(e,t,n,r){return w(e,t,n,r)}function T(e,t,n,r){return G(q(t),e,n,r)}function S(e,t,n,r){return G(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,c=e[i],l=null,h=c>239?4:c>223?3:c>191?2:1;if(i+h<=n)switch(h){case 1:c<128&&(l=c);break;case 2:128===(192&(a=e[i+1]))&&(u=(31&c)<<6|63&a)>127&&(l=u);break;case 3:a=e[i+1],o=e[i+2],128===(192&a)&&128===(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128===(192&a)&&128===(192&o)&&128===(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=o(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"===typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return h(null,e)},u.allocUnsafeSlow=function(e){return h(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=p,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):v.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),c=this.slice(r,i),l=e.slice(t,n),h=0;h<s;++h)if(c[h]!==l[h]){a=c[h],o=l[h];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return x(this,e,t,n);case"base64":return T(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function I(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function j(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=F(e[a]);return i}function O(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function R(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function C(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function A(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function E(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,a){return a||E(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function L(e,t,n,r,a){return a||E(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||N(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):A(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);N(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):C(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):C(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):A(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):A(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:U(new u(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function q(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(B,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function G(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(40))},function(e,t,n){"use strict";var r=n(104),i={};e.exports=i,i.isSubject=function(e){return!(!r.isObject(e)||"@value"in e||"@set"in e||"@list"in e)&&(Object.keys(e).length>1||!("@id"in e))},i.isSubjectReference=function(e){return r.isObject(e)&&1===Object.keys(e).length&&"@id"in e},i.isValue=function(e){return r.isObject(e)&&"@value"in e},i.isList=function(e){return r.isObject(e)&&"@list"in e},i.isGraph=function(e){return r.isObject(e)&&"@graph"in e&&1===Object.keys(e).filter((function(e){return"@id"!==e&&"@index"!==e})).length},i.isSimpleGraph=function(e){return i.isGraph(e)&&!("@id"in e)},i.isBlankNode=function(e){return!!r.isObject(e)&&("@id"in e?0===e["@id"].indexOf("_:"):0===Object.keys(e).length||!("@value"in e||"@set"in e||"@list"in e))}},function(e,t,n){"use strict";var r=n(78),i=n(85),a=n(82),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=l(n(196)),f=n(80),d=n(131),p=n(462),v=l(n(158)),y=l(n(174)),g=l(n(86)),m=l(n(87)),b=l(n(279)),_="http://semweb.mmlab.be/ns/linkedconnections#arrivalDelay",w="http://semweb.mmlab.be/ns/linkedconnections#departureDelay",x="http://vocab.gtfs.org/terms#pickupType",T="http://vocab.gtfs.org/terms#route",S="http://vocab.gtfs.org/terms#trip",k=function(){function e(){s(this,e)}return u(e,[{key:"setTravelMode",value:function(e){this.travelMode=e}},{key:"get",value:function(){var e=o(r.mark((function e(t){var n,o,s,u,c,l,f,k,M,P,I,j,O,R,N,C,A,E,D,L,B,F,U,q,G,z,W,V,H,X,Q,Y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.next=3,h.default(t);case 3:return o=e.sent,s=this.parseResponseLength(o),u=(new Date).getTime()-n.getTime(),e.next=8,o.text();case 8:if(c=e.sent,200!==o.status&&g.default.getInstance().emit(m.default.Warning,"".concat(t," responded with status code ").concat(o.status)),200!==o.status||!c){e.next=24;break}l=JSON.parse(c),f=[],k=new b.default(l["@context"]),M=a(l["@graph"]);try{for(M.s();!(P=M.n()).done;){for(I=P.value,j=0,O=Object.entries(I);j<O.length;j++)R=i(O[j],2),N=R[0],C=R[1],I[k.resolveIdentifier(N)]=C;A=k.resolveIdentifier(I["@id"]),E=new Date(I["http://semweb.mmlab.be/ns/linkedconnections#arrivalTime"]),D=k.resolveIdentifier(I["http://semweb.mmlab.be/ns/linkedconnections#arrivalStop"]),L=I[_]?parseFloat(I[_]):0,B=new Date(I["http://semweb.mmlab.be/ns/linkedconnections#departureTime"]),F=k.resolveIdentifier(I["http://semweb.mmlab.be/ns/linkedconnections#departureStop"]),U=I[w]?parseFloat(I[w]):0,q=I[S]?k.resolveIdentifier(I[S]):null,G=I[T]?k.resolveIdentifier(I[T]):null,z=I["http://vocab.gtfs.org/terms#dropOffType"]?k.resolveIdentifier(I["http://vocab.gtfs.org/terms#dropOffType"]):v.default.Regular,W=I[x]?k.resolveIdentifier(I[x]):y.default.Regular,V=I["http://vocab.gtfs.org/terms#headsign"]||null,(H={id:A,travelMode:this.travelMode,arrivalTime:E,arrivalStop:D,arrivalDelay:L,departureTime:B,departureStop:F,departureDelay:U,tripId:q,route:G,dropOffType:z,pickupType:W,headsign:V}).departureTime<H.arrivalTime&&f.push(H)}}catch(r){M.e(r)}finally{M.f()}return X=l["@id"],Q=l["hydra:next"],Y=l["hydra:previous"],f.sort((function(e,t){return e.departureTime.getTime()!==t.departureTime.getTime()?e.departureTime.getTime()-t.departureTime.getTime():e.arrivalTime.getTime()!==t.arrivalTime.getTime()?e.arrivalTime.getTime()-t.arrivalTime.getTime():e.id.localeCompare(t.id)})),g.default.getInstance().emit(m.default.ResourceFetch,{datatype:d.DataType.Connections,url:t,duration:u,size:s}),e.abrupt("return",new p.LinkedConnectionsPage(X,f,Y,Q));case 24:return e.abrupt("return",new p.LinkedConnectionsPage(t,[],void 0,void 0));case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseLength",value:function(e){if(e.headers.get("content-length"))return parseInt(e.headers.get("content-length"),10);try{return e.body._chunkSize}catch(t){}}}]),e}();k=c([f.injectable()],k),t.default=k},function(e,t,n){"use strict";var r=n(112),i=n(78),a=n(79),o=n(82),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(81)),v=f(n(156)),y=n(157),g=f(n(401)),m=function(){function e(t,n){s(this,e),this.sources=[],this.singleProviders=[],this.connectionsFetcherFactory=t,this.templateFetcher=n}return u(e,[{key:"addConnectionSource",value:function(e){this.sources.push(e),this.singleProviders.push(new g.default(this.connectionsFetcherFactory,e,this.templateFetcher))}},{key:"getSources",value:function(){return this.sources}},{key:"prefetchConnections",value:function(e,t){var n,r=o(this.singleProviders);try{for(r.s();!(n=r.n()).done;){n.value.prefetchConnections(e,t)}}catch(i){r.e(i)}finally{r.f()}}},{key:"createIterator",value:function(){var e=a(i.mark((function e(t){var n,r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.singleProviders.map((function(e){return e.createIterator(t)})));case 2:if(n=e.sent,r=t.backward?y.backwardsConnectionsSelector:y.forwardsConnectionSelector,!t.excludedModes){e.next=8;break}return e.abrupt("return",new v.default(n,r,!0).filter((function(e){return!t.excludedModes.has(e.travelMode)})));case 8:return e.abrupt("return",new v.default(n,r,!0));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"appendIterator",value:function(){var e=a(i.mark((function e(t,n){var a,s,u,c,l,h,f,d,p,g,m,b,_,w,x;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.singleProviders.map((function(e){return e.createIterator(t)})));case 2:a=e.sent,s=t.backward?y.backwardsConnectionsSelector:y.forwardsConnectionSelector,u=n.listeners("data"),c=n.listeners("readable"),l=n.listeners("end"),n.removeAllListeners(),h=new v.default([].concat(r(a),[n]),s,!0),f=o(u);try{for(f.s();!(d=f.n()).done;)p=d.value,h.addListener("data",p)}catch(i){f.e(i)}finally{f.f()}g=o(c);try{for(g.s();!(m=g.n()).done;)b=m.value,h.addListener("readable",b)}catch(i){g.e(i)}finally{g.f()}_=o(l);try{for(_.s();!(w=_.n()).done;)x=w.value,h.addListener("end",x)}catch(i){_.e(i)}finally{_.f()}return e.abrupt("return",h);case 16:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getByUrl",value:function(e){throw new Error("Not implemented yet")}},{key:"getByTime",value:function(e){throw new Error("Method not implemented because the semantics would be ambiguous.")}}]),e}();m=c([d.injectable(),h(0,d.inject(p.default.ConnectionsFetcherFactory)),h(1,d.inject(p.default.HydraTemplateFetcher)),l("design:paramtypes",[Function,Object])],m),t.default=m},function(e,t,n){"use strict";var r,i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(128)),v=n(406),y=n(407),g=n(94),m=n(155),b=f(n(81)),_=n(108),w=f(n(105)),x=function(){function e(t){s(this,e),this.ldFetch=t,this.ldLoader=new g.LDLoader,this.ldLoader.defineCollection(w.default.inNS(_.HYDRA,"mapping"))}return u(e,[{key:"get",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ldFetch.get(t);case 2:return n=e.sent,r=n.triples,o=this.ldLoader.process(r,[this.getView()]),s=a(o,1),(u=s[0]).id=t,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getView",value:function(){var e=new m.ThingView(y.HydraTemplate.create);return e.addFilter((function(e){return void 0!==e[w.default.inNS(_.HYDRA,"template")]})),e.addMapping(w.default.inNS(_.HYDRA,"template"),"template"),e.addMapping(w.default.inNS(_.HYDRA,"mapping"),"mappings",this.getMappingView()),e}},{key:"getMappingView",value:function(){var e=new m.ThingView(v.HydraTemplateMapping.create);return e.addFilter((function(e){return void 0!==e[w.default.inNS(_.HYDRA,"variable")]})),e.addMapping(w.default.inNS(_.HYDRA,"variable"),"variable"),e.addMapping(w.default.inNS(_.HYDRA,"required"),"required"),e.addMapping(w.default.inNS(_.HYDRA,"property"),"property"),e}}]),e}();x=c([d.injectable(),h(0,d.inject(b.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.default&&p.default)?r:Object])],x),t.default=x},function(e,t,n){"use strict";var r,i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=n(187),v=f(n(128)),y=f(n(409)),g=f(n(412)),m=f(n(413)),b=f(n(414)),_=n(94),w=n(155),x=f(n(81)),T=n(108),S=f(n(105)),k=function(){function e(t){s(this,e),this.ldFetch=t,this.ldLoader=new _.LDLoader,this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasAccessRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasOnewayRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasSpeedRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasPriorityRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasObstacleRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasObstacleTimeRules")),this.ldLoader.defineCollection(S.default.inNS(T.PROFILE,"hasProximityRules"))}return u(e,[{key:"parseProfileBlob",value:function(){var e=o(i.mark((function e(t,n){var r,o,s,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.toRDF(t);case 2:return r=e.sent,o=this.ldLoader.process(r,[this.getView()]),s=a(o,1),(u=s[0]).id=n,e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"get",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ldFetch.get(t);case 2:return n=e.sent,r=n.triples,o=this.ldLoader.process(r,[this.getView()]),s=a(o,1),(u=s[0]).id=t,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getView",value:function(){var e=new w.ThingView(y.default.create);return e.addFilter((function(e){return void 0!==e[S.default.inNS(T.PROFILE,"hasAccessRules")]||void 0!==e[S.default.inNS(T.PROFILE,"hasOnewayRules")]||void 0!==e[S.default.inNS(T.PROFILE,"hasSpeedRules")]||void 0!==e[S.default.inNS(T.PROFILE,"hasPriorityRules")]||void 0!==e[S.default.inNS(T.PROFILE,"hasObstacleRules")]||void 0!==e[S.default.inNS(T.PROFILE,"hasObstacleTimeRules")]})),e.addMapping(S.default.inNS(T.PROFILE,"hasAccessRules"),"accessRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasOnewayRules"),"onewayRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasSpeedRules"),"speedRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasPriorityRules"),"priorityRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasObstacleRules"),"obstacleRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasObstacleTimeRules"),"obstacleTimeRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasProximityRules"),"proximityRules",this.getRuleView()),e.addMapping(S.default.inNS(T.PROFILE,"hasMaxSpeed"),"maxSpeed"),e.addMapping(S.default.inNS(T.PROFILE,"usePublicTransport"),"usePublicTransport"),e}},{key:"getRuleView",value:function(){var e=new w.ThingView(b.default.create);return e.addFilter((function(e){return void 0!==e[S.default.inNS(T.PROFILE,"concludes")]})),e.addMapping(S.default.inNS(T.PROFILE,"concludes"),"conclusion",this.getConclusionView()),e.addMapping(S.default.inNS(T.PROFILE,"match"),"condition",this.getConditionView()),e.addMapping(S.default.inNS(T.PROFILE,"hasOrder"),"order"),e}},{key:"getConditionView",value:function(){var e=new w.ThingView(m.default.create);return e.addFilter((function(e){return void 0!==e[S.default.inNS(T.PROFILE,"hasPredicate")]||void 0!==e[S.default.inNS(T.PROFILE,"hasObject")]})),e.addMapping(S.default.inNS(T.PROFILE,"hasPredicate"),"predicate"),e.addMapping(S.default.inNS(T.PROFILE,"hasObject"),"object"),e}},{key:"getConclusionView",value:function(){var e=new w.ThingView(g.default.create);return e.addFilter((function(e){return void 0!==e[S.default.inNS(T.PROFILE,"hasAccess")]||void 0!==e[S.default.inNS(T.PROFILE,"isOneway")]||void 0!==e[S.default.inNS(T.PROFILE,"isReversed")]||void 0!==e[S.default.inNS(T.PROFILE,"hasSpeed")]||void 0!==e[S.default.inNS(T.PROFILE,"isObstacle")]||void 0!==e[S.default.inNS(T.PROFILE,"hasPriority")]||void 0!==e[S.default.inNS(T.PROFILE,"hasObstacleTime")]})),e.addMapping(S.default.inNS(T.PROFILE,"hasAccess"),"hasAccess"),e.addMapping(S.default.inNS(T.PROFILE,"isOneway"),"isOneway"),e.addMapping(S.default.inNS(T.PROFILE,"isReversed"),"isReversed"),e.addMapping(S.default.inNS(T.PROFILE,"hasSpeed"),"speed"),e.addMapping(S.default.inNS(T.PROFILE,"isObstacle"),"isObstacle"),e.addMapping(S.default.inNS(T.PROFILE,"hasPriority"),"priority"),e.addMapping(S.default.inNS(T.PROFILE,"hasObstacleTime"),"obstacleTime"),e}}]),e}();k=c([d.injectable(),h(0,d.inject(x.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof v.default&&v.default)?r:Object])],k),t.default=k},function(e,t,n){"use strict";var r=n(112),i=n(78),a=n(79),o=n(82),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(81)),v=function(){function e(t){s(this,e),this.sources=[],this.stopsFetchers=[],this.cachedStops=[],this.stopsFetcherFactory=t}return u(e,[{key:"addStopSource",value:function(e){this.sources.push(e),this.cachedStops=[],this.allStops=null,this.stopsFetchers.push(this.stopsFetcherFactory(e.accessUrl))}},{key:"getSources",value:function(){return this.sources}},{key:"prefetchStops",value:function(){var e,t=o(this.stopsFetchers);try{for(t.s();!(e=t.n()).done;){e.value.prefetchStops()}}catch(n){t.e(n)}finally{t.f()}}},{key:"getStopById",value:function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(this.stopsFetchers.map((function(e){return e.getStopById(t)}))).then((function(e){return e.find((function(e){return void 0!==e}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllStops",value:function(){var e=a(i.mark((function e(){var t=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.allStops){e.next=4;break}if(!(this.cachedStops.length>0)){e.next=3;break}return e.abrupt("return",Promise.resolve(this.cachedStops));case 3:this.allStops=Promise.all(this.stopsFetchers.map((function(e){return e.getAllStops()}))).then((function(e){var n;return t.cachedStops=(n=[]).concat.apply(n,r(e)),t.cachedStops}));case 4:return e.abrupt("return",this.allStops);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();v=c([d.injectable(),h(0,d.inject(p.default.StopsFetcherFactory)),l("design:paramtypes",[Function])],v),t.default=v},function(e,t,n){"use strict";var r=n(85),i=n(78),a=n(82),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=h(n(196)),d=n(80),p=n(131),v=n(227),y=n(417),g=h(n(111)),m=n(418),b=h(n(86)),_=h(n(87)),w=n(108),x=h(n(105)),T=function(){function e(){s(this,e),this.routableTileRegistry=g.default.getInstance()}return u(e,[{key:"get",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u,c,l,h,d,y,g,m,w;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.next=3,f.default(t);case 3:return r=e.sent,e.next=6,r.text();case 6:if(o=e.sent,200!==r.status&&b.default.getInstance().emit(_.default.Warning,"".concat(t," responded with status code ").concat(r.status)),200!==r.status||!o){e.next=20;break}s=JSON.parse(o),u={},c={},l=this.parseResponseLength(r),h=(new Date).getTime()-n.getTime(),d=a(s["@graph"]);try{for(d.s();!(y=d.n()).done;)"osm:Node"===(g=y.value)["@type"]?(m=this.createNode(g),u[m.id]=m):"osm:Way"===g["@type"]&&(w=this.createWay(g),c[w.id]=w)}catch(i){d.e(i)}finally{d.f()}return b.default.getInstance().emit(_.default.ResourceFetch,{DataType:p.DataType.RoutableTile,url:t,duration:h,size:l}),e.abrupt("return",this.processTileData(t,u,c));case 20:return e.abrupt("return",new v.RoutableTile(t,new Set,new Set));case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseLength",value:function(e){if(e.headers.get("content-length"))return parseInt(e.headers.get("content-length"),10);try{return e.body._outOffset}catch(t){}}},{key:"processTileData",value:function(e,t,n){for(var r=0,i=Object.values(t);r<i.length;r++){var a=i[r];this.routableTileRegistry.registerNode(a)}for(var o=0,s=Object.values(n);o<s.length;o++){var u=s[o];this.routableTileRegistry.registerWay(u)}return new v.RoutableTile(e,new Set(Object.keys(t)),new Set(Object.keys(n)))}},{key:"createNode",value:function(e){var t=e["@id"],n=new y.RoutableTileNode(t);n.latitude=parseFloat(e["geo:lat"]),n.longitude=parseFloat(e["geo:long"]);for(var i=0,a=Object.entries(e);i<a.length;i++){var o=r(a[i],2),s=o[0],u=o[1];if("osm:hasTag"===s)n.freeformTags=u;else if(0===s.indexOf("osm:")){var c=x.default.fakeExpand(w.OSM,s);if(0===u.toString().indexOf("osm:")){var l=x.default.fakeExpand(w.OSM,u.toString());n.definedTags[c]=l}else n.definedTags[c]=u}}return n}},{key:"createWay",value:function(e){var t=e["@id"],n=new m.RoutableTileWay(t);if(e["osm:maxspeed"]&&(n.maxSpeed=parseFloat(e["osm:maxspeed"])),e["osm:hasNodes"])n.segments=[e["osm:hasNodes"]];else{var i=e["osm:hasEdges"];n.segments=[i["osm:hasNodes"]],n.distances=[i["osm:hasWeights"]]}n.name=e["osm:name"];for(var a=0,o=Object.entries(e);a<o.length;a++){var s=r(o[a],2),u=s[0],c=s[1];if("osm:hasNodes"!==u&&"osm:hasWeights"!==u)if("osm:hasTag"===u)n.freeformTags=c;else if(0===u.indexOf("osm:")){var l=x.default.fakeExpand(w.OSM,u);if(0===c.toString().indexOf("osm:")){var h=x.default.fakeExpand(w.OSM,c.toString());n.definedTags[l]=h}else n.definedTags[l]=c}}return n}}]),e}();T=c([d.injectable(),l("design:paramtypes",[])],T),t.default=T},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=n(80),u=o(n(420)),c=function(){function e(){r(this,e)}return i(e,[{key:"createInstance",value:function(e){return new u.default(e)}}]),e}();c=a([s.injectable()],c),t.default=c},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(89),d=n(80),p=h(n(101)),v=h(n(86)),y=h(n(87)),g=h(n(81)),m=h(n(159)),b=h(n(146)),_=h(n(200)),w=h(n(258)),x=function(){function e(t){o(this,e),this.bestArrivalTime=[],this.locationResolver=t,this.eventBus=v.default.getInstance()}return s(e,[{key:"extractJourneys",value:function(){var e=a(r.mark((function e(t,n){var a,o,s,u,c,l,h,d,p,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=w.default.filterInfinity(t),o=n.from[0],s=n.to[0],u=[],c=a[o.id]){e.next=7;break}return e.abrupt("return",new f.ArrayIterator(u));case 7:l=i(c),e.prev=8,l.s();case 10:if((h=l.n()).done){e.next=33;break}d=h.value,p=0;case 13:if(!(p<d.transferProfiles.length)){e.next=31;break}if(v=d.transferProfiles[p],!this.checkBestArrivalTime(v,o,s)){e.next=28;break}return e.prev=16,e.t0=u,e.next=20,this.extractJourney(o,s,v,p,a);case 20:e.t1=e.sent,e.t0.push.call(e.t0,e.t1),this.setBestArrivalTime(o,s,v.arrivalTime),e.next=28;break;case 25:e.prev=25,e.t2=e.catch(16),this.eventBus&&this.eventBus.emit(y.default.Warning,e.t2);case 28:p++,e.next=13;break;case 31:e.next=10;break;case 33:e.next=38;break;case 35:e.prev=35,e.t3=e.catch(8),l.e(e.t3);case 38:return e.prev=38,l.f(),e.finish(38);case 41:return e.abrupt("return",new f.ArrayIterator(u.reverse()));case 42:case"end":return e.stop()}}),e,this,[[8,35,38,41],[16,25]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"checkBestArrivalTime",value:function(e,t,n){if(!(e.arrivalTime<1/0))return!1;var r=this.bestArrivalTime[t.id];if(!r)return!0;var i=r[n.id];return!i||e.arrivalTime<i}},{key:"setBestArrivalTime",value:function(e,t,n){this.bestArrivalTime[e.id]||(this.bestArrivalTime[e.id]=[]),this.bestArrivalTime[e.id][t.id]=n}},{key:"extractJourney",value:function(){var e=a(r.mark((function e(t,n,i,a,o){var s,u,c,l,h,f,d,v,y,g,w,x,T,S,k,M,P,I,j,O,R;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s=b.default.create(),u=i,c=i.departureTime,l=a,h=t;case 5:if(!(l>=0)){e.next=36;break}return f=u.enterConnection,d=u.exitConnection,e.next=10,this.locationResolver.resolve(f.departureStop);case 10:return v=e.sent,e.next=13,this.locationResolver.resolve(d.arrivalStop);case 13:if(y=e.sent,g=f.departureTime.getTime(),c!==g&&(w=0,s.legs.length>0&&(w=c-s.legs[s.legs.length-1].getStopTime().getTime()),x=_.default.create(h,v,{minimum:g-c},null,new Date(c-w),new Date(g-w)),T=new m.default(p.default.Walking,[x]),s.appendLeg(T)),(S=_.default.createFromConnections(f,d)).startLocation=v,S.stopLocation=y,k=new m.default(d.travelMode,[S]),s.appendLeg(k),h=y,l--,s.legs[s.legs.length-1].getStopLocation().id!==n.id){e.next=25;break}return e.abrupt("break",36);case 25:if(!(l>=0)){e.next=33;break}for(M=o[h.id],P=M.length-1,u=M[P].transferProfiles[l],c=u.departureTime;P>=0&&c<d.arrivalTime.getTime();)u=M[--P].transferProfiles[l],c=u.departureTime;if(-1!==P){e.next=33;break}return e.abrupt("return",Promise.reject("Can't find next connection"));case 33:-1===l&&(I=d.arrivalTime,(j=new Date(u.arrivalTime)).getTime()!==I.getTime()&&(O=_.default.create(h,n,{minimum:j.getTime()-I.getTime()},null,I,j),R=new m.default(p.default.Walking,[O]),s.appendLeg(R))),e.next=5;break;case 36:if(s.legs[s.legs.length-1].getStopLocation().id===n.id){e.next=38;break}return e.abrupt("return",Promise.reject("Can't reach arrival stop:"));case 38:return e.abrupt("return",s);case 39:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a){return e.apply(this,arguments)}}()}]),e}();x=u([d.injectable(),l(0,d.inject(g.default.LocationResolver)),c("design:paramtypes",[Object])],x),t.default=x},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(263)),d=l(n(81)),p=l(n(425)),v=function(){function e(t){a(this,e),this.stopsProvider=t,this.defaultLocationResolver=new p.default(this.stopsProvider)}return o(e,[{key:"resolve",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t||this.isId(t)){e.next=13;break}if(!t.includes("geo:")){e.next=6;break}if(!(n=/geo:([\-0-9.]+),([\-0-9.]+)/.exec(t))||!n.length){e.next=6;break}return e.abrupt("return",{latitude:parseFloat(n[1]),longitude:parseFloat(n[2])});case 6:return e.next=8,this.stopsProvider.getAllStops();case 8:if(this.allStops=e.sent,!(i=this.allStops.find((function(e){return e.name===t})))){e.next=12;break}return e.abrupt("return",i);case 12:return e.abrupt("return",Promise.reject(new f.default('Location "'.concat(t,'" is a string, but not an ID and not a valid stop name'))));case 13:return e.abrupt("return",this.defaultLocationResolver.resolve(t));case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isId",value:function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")}}]),e}();v=s([h.injectable(),c(0,h.inject(d.default.StopsProvider)),u("design:paramtypes",[Object])],v),t.default=v},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(88);function a(e,t,n,i,a){var o={},s="number"===typeof a,u=void 0!==a&&s?a.toString():n;if(s&&void 0!==n)throw new Error(r.INVALID_DECORATOR_OPERATION);Reflect.hasOwnMetadata(e,t)&&(o=Reflect.getMetadata(e,t));var c=o[u];if(Array.isArray(c))for(var l=0,h=c;l<h.length;l++){var f=h[l];if(f.key===i.key)throw new Error(r.DUPLICATED_METADATA+" "+f.key.toString())}else c=[];c.push(i),o[u]=c,Reflect.defineMetadata(e,o,t)}function o(e,t){Reflect.decorate(e,t)}function s(e,t){return function(n,r){t(n,r,e)}}t.tagParameter=function(e,t,n,r){a(i.TAGGED,e,t,r,n)},t.tagProperty=function(e,t,n){a(i.TAGGED_PROP,e.constructor,t,n)},t.decorate=function(e,t,n){"number"===typeof n?o([s(n,e)],t):"string"===typeof n?Reflect.decorate([e],t,n):o([e],t)}},function(e,t,n){"use strict";var r,i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(128)),v=n(395),y=n(396),g=f(n(397)),m=n(94),b=n(155),_=f(n(81)),w=n(108),x=f(n(105)),T=function(){function e(t){s(this,e),this.ldFetch=t,this.ldLoader=new m.LDLoader,this.ldLoader.defineCollection(x.default.inNS(w.DCAT,"distribution")),this.ldLoader.defineCollection(x.default.inNS(w.DCAT,"dataset")),this.ldLoader.defineCollection(x.default.inNS(w.DCAT,"mediaType"))}return u(e,[{key:"get",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ldFetch.get(t);case 2:return n=e.sent,r=n.triples,o=this.ldLoader.process(r,[this.getView()]),s=a(o,1),(u=s[0]).id=t,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getView",value:function(){var e=new b.ThingView(v.Catalog.create);return e.addFilter((function(e){return void 0!==e[x.default.inNS(w.DCAT,"dataset")]})),e.addMapping(x.default.inNS(w.DCT,"publisher"),"publisher"),e.addMapping(x.default.inNS(w.DCAT,"dataset"),"datasets",this.getDatasetView()),e}},{key:"getDatasetView",value:function(){var e=new b.ThingView(y.Dataset.create);return e.addFilter((function(e){return void 0!==e[x.default.inNS(w.DCAT,"distribution")]})),e.addMapping(x.default.inNS(w.DCT,"subject"),"subject"),e.addMapping(x.default.inNS(w.DCT,"description"),"description"),e.addMapping(x.default.inNS(w.DCT,"title"),"title"),e.addMapping(x.default.inNS(w.DCT,"spatial"),"area"),e.addMapping(x.default.inNS(w.DCAT,"accessRights"),"rights"),e.addMapping(x.default.inNS(w.DCAT,"distribution"),"distributions",this.getDistributionView()),e}},{key:"getDistributionView",value:function(){var e=new b.ThingView(g.default.create);return e.addMapping(x.default.inNS(w.DCAT,"accessURL"),"accessUrl"),e.addMapping(x.default.inNS(w.DCAT,"mediaType"),"mediatypes"),e}}]),e}();T=c([d.injectable(),h(0,d.inject(_.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.default&&p.default)?r:Object])],T),t.default=T},function(e,t,n){var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=n(83),c=n(84),l=(n(231),n(232)),h=n(329),f=n(210),d=n(353),p=n(355).DOMParser,v=n(357),y=n(390),g=n(394),m=n(187),b=n(195),_=n(141);e.exports=function(e){"use strict";c(n,e);var t=u(n);function n(e){var r;o(this,n),(r=t.call(this)).prefixes={};var i="application/trig;q=1.0,application/n-quads,application/ld+json;q=.9,application/rdf+xml;q=.8,text/turtle,application/n-triples";return e&&e.headers?r.fetcher=new h(i,e.headers):r.fetcher=new h(i),r.fetcher.on("cache-miss",(function(e){r.emit("cache-miss",e)})),r.fetcher.on("cache-hit",(function(e){r.emit("cache-hit",e)})),r.fetcher.on("downloaded",(function(e){r.emit("downloaded",e)})),r}return s(n,[{key:"frame",value:function(){var e=a(r.mark((function e(t,n){var a,o,s,u,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=4;break}return e.next=3,this.get(t).then((function(e){return e.triples}));case 3:t=e.sent;case 4:a={"@graph":[]},o={},s=i(t);try{for(s.s();!(u=s.n()).done;)"BlankNode"===(c=u.value).subject.termType&&(c.subject.value="_:"+c.subject.value),"BlankNode"===c.predicate.termType&&(c.predicate.value="_:"+c.predicate.value),"BlankNode"===c.object.termType&&(c.object.value="_:"+c.object.value),"BlankNode"===c.graph.termType&&(c.graph.value="_:"+c.graph.value),c.graph.value&&!o[c.graph.value]&&(o[c.graph.value]={"@id":c.graph.value,"@graph":[]}),l={"@id":c.subject.value},"Literal"===c.object.termType?(l[c.predicate.value]={"@value":c.object.value},c.predicate.language&&(l[c.predicate.value]["@language"]=c.object.language),c.object.datatype&&(l[c.predicate.value]["@type"]=c.object.datatype.value)):"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"===c.predicate.value?l["@type"]=c.object.value:l[c.predicate.value]={"@id":c.object.value},c.graph.value?o[c.graph.value]["@graph"].push(l):a["@graph"].push(l)}catch(r){s.e(r)}finally{s.f()}return a["@graph"].push(Object.values(o)),e.abrupt("return",m.frame(a,n));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addPrefix",value:function(e,t){this.prefixes[e]=t}},{key:"getCacheStats",value:function(){return this.fetcher.getCacheStats()}},{key:"get",value:function(e){var t=this;return this.emit("request",e),this.fetcher.get(e).then((function(n){e!==n.url&&t.emit("redirect",{from:e,to:n.url}),t.emit("response",n.url);var r=[],i={},a=l.defer();if("application/ld+json"===n.type||"application/json"===n.type)return new v({documentIRI:n.url,factory:b}).parse(n.body,(function(e,o,s){t.emit("parsed",n.url),e?a.reject(e):o?r.push(o):(i=Object.assign(t.prefixes,i),a.resolve({triples:r,prefixes:i,statusCode:n.statusCode,url:n.url})),s&&(i=Object.assign(i,s))})),a.promise;if("text/html"===n.type){for(var o=[],s=0,u=g(n.body,n.url),c=u.querySelectorAll("script[type*='application/ld+json']"),h=0;h<c.length;h++){var m=c[h];o[h]=l.defer();new v({documentIRI:n.url}).parse(m.textContent,(function(e,t,n){t?r.push(t):e?(console.error("WARNING: an error was given while processing a JSON-LD snippet: ",e),o[s].resolve(),s++):(o[s].resolve(),s++)}))}new y({documentIRI:n.url,factory:b}).parse(u,(function(e,o,s){t.emit("parsed",n.url),e?a.reject(e):o?r.push(o):(i=Object.assign(t.prefixes,i),a.resolve()),s&&(i=Object.assign(i,s))}));var _=[a].concat(o).map((function(e){return e.promise}));return l.all(_).then((function(){return{triples:r,prefixes:i,statusCode:n.statusCode,url:n.url}}))}if(["application/trig","application/n-quads","text/turtle","application/n-triples","text/n3"].indexOf(n.type.toLowerCase())>-1)new f.Parser({documentIRI:n.url,factory:b}).parse(n.body,(function(e,o,s){t.emit("parsed",n.url),e?a.reject(e):o?r.push(o):(i=Object.assign(i,t.prefixes),a.resolve({triples:r,prefixes:i,statusCode:n.statusCode,url:n.url})),s&&(i=Object.assign(i,s))}));else if(["application/rdf+xml"].indexOf(n.type.toLowerCase())>-1){(new d).parse((new p).parseFromString(n.body),n.url,n.url,(function(e){t.emit("parsed",n.url),e?r.push(e):a.resolve({triples:r,statusCode:n.statusCode,url:n.url})}))}else a.resolve({statusCode:n.statusCode,triples:r,prefixes:i,url:n.url,error:"Cannot parse "+n.type});return a.promise}))}}]),n}(_)},function(e,t){"function"===typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},o=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(80),l=u(n(81)),h=function(){function e(t){r(this,e),this.catalogs={},this.fetcher=t}return i(e,[{key:"getCatalog",value:function(e){return void 0===this.catalogs[e]&&(this.catalogs[e]=this.fetcher.get(e)),this.catalogs[e]}},{key:"getCatalogs",value:function(){return Promise.all(Object.values(this.catalogs))}}]),e}();h=a([c.injectable(),s(0,c.inject(l.default.CatalogFetcher)),o("design:paramtypes",[Object])],h),t.default=h},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(197),n(166);var i=r(n(253)),a=r(n(266)),o=r(n(267)),s=r(n(268)),u=r(n(111)),c=r(n(86)),l=r(n(203)),h=r(n(101)),f=r(n(87)),d=r(n(269)),p=r(n(135)),v=r(n(270)),y=r(n(272)),g=r(n(202)),m=r(n(274)),b=r(n(275)),_=r(n(276)),w=r(n(277)),x=r(n(278)),T=n(253);t.IsochroneGenerator=T.default;var S=n(266);t.TrafficEstimator=S.default;var k=n(267);t.createPlanner=k.default;var M=n(268);t.classifyDataSource=M.default,t.EventBus=c.default.getInstance(),t.RoutableTileRegistry=u.default.getInstance();var P=n(203);t.DataType=P.default;var I=n(101);t.TravelMode=I.default;var j=n(87);t.EventType=j.default;var O=n(269);t.QueryMode=O.default;var R=n(135);t.Units=R.default;var N=n(270);t.DissectPlanner=N.default;var C=n(272);t.FlexibleProfileTransitPlanner=C.default;var A=n(202);t.FlexibleRoadPlanner=A.default;var E=n(274);t.FlexibleTransitPlanner=E.default;var D=n(275);t.GeospatialFragmentedPlanner=D.default;var L=n(276);t.ReducedCarPlanner=L.default;var B=n(277);t.TriangleTransitPlanner=B.default;var F=n(278);t.ZoiDemoPlanner=F.default,t.default={IsochroneGenerator:i.default,TrafficEstimator:a.default,classifyDataSource:s.default,createPlanner:o.default,RoutableTileRegistry:t.RoutableTileRegistry,EventBus:t.EventBus,TravelMode:h.default,EventType:f.default,Units:p.default,QueryMode:d.default,DataType:l.default,DissectPlanner:v.default,FlexibleProfileTransitPlanner:y.default,FlexibleRoadPlanner:g.default,FlexibleTransitPlanner:m.default,GeospatialFragmentedPlanner:b.default,ReducedCarPlanner:_.default,TriangleTransitPlanner:w.default,ZoiDemoPlanner:x.default}},function(e,t,n){var r=n(400);function i(t,n,a){return"undefined"!==typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var a=Object.getOwnPropertyDescriptor(i,t);return a.get?a.get.call(n):a.value}},i(t,n,a||t)}e.exports=i},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(89),d=n(80),p=h(n(171)),v=h(n(111)),y=h(n(113)),g=h(n(93)),m=h(n(101)),b=h(n(86)),_=h(n(87)),w=h(n(90)),x=h(n(81)),T=h(n(99)),S=n(139),k=h(n(159)),M=h(n(146)),P=function(){function e(t,n,r,i){o(this,e),this.tileProvider=t,this.pathfinderProvider=n,this.profileProvider=r,this.locationResolver=i,this.registry=v.default.getInstance(),this.eventBus=b.default.getInstance(),this.reachedTiles=new Set}return s(e,[{key:"plan",value:function(){var e=a(r.mark((function e(t){var n,a,o,s,u,c,l,h,d,p,v,y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,a=t.to,o=t.profileID,s=[],e.next=4,this.profileProvider.getProfile(o);case 4:if(u=e.sent,!(n&&a&&n.length&&a.length)){e.next=40;break}c=i(n),e.prev=7,c.s();case 9:if((l=c.n()).done){e.next=32;break}h=l.value,d=i(a),e.prev=12,d.s();case 14:if((p=d.n()).done){e.next=22;break}return v=p.value,e.next=18,this.getPathBetweenLocations(h,v,u);case 18:(y=e.sent)&&s.push(y);case 20:e.next=14;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),d.e(e.t0);case 27:return e.prev=27,d.f(),e.finish(27);case 30:e.next=9;break;case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(7),c.e(e.t1);case 37:return e.prev=37,c.f(),e.finish(37);case 40:return e.abrupt("return",new f.ArrayIterator(s));case 41:case"end":return e.stop()}}),e,this,[[7,34,37,40],[12,24,27,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPathBetweenLocations",value:function(){var e=a(r.mark((function e(t,n,i){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([this.embedLocation(t),this.embedLocation(n,!0)]);case 2:return e.abrupt("return",this._innerPath(t,n,i));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_innerPath",value:function(){var e=a(r.mark((function e(t,n,a){var o,s,u,c,l,h,f,d,p,v,y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pathfinderProvider.getShortestPathAlgorithm(a);case 2:return o=e.sent,s=10*T.default.getDistanceBetweenLocations(t,n)+1e3,e.next=6,o.queryPath(T.default.getId(t),T.default.getId(n),s);case 6:u=e.sent,c=[],l={},h=i(u),e.prev=10,h.s();case 12:if((f=h.n()).done){e.next=24;break}return d=f.value,e.next=16,this.locationResolver.resolve(d.to);case 16:return p=e.sent,e.next=19,this.locationResolver.resolve(d.from);case 19:v=e.sent,c.push({startLocation:v,stopLocation:p,through:d.through,duration:{average:d.duration},distance:d.distance}),d.through&&(l[d.through]=this.registry.getWay(d.through));case 22:e.next=12;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(10),h.e(e.t0);case 29:return e.prev=29,h.f(),e.finish(29);case 32:return y=new k.default(m.default.Profile,c),e.abrupt("return",new M.default([y],l));case 34:case"end":return e.stop()}}),e,this,[[10,26,29,32]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=a(r.mark((function e(t){var n,o=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.tileProvider.getIdForTileCoords(t),this.reachedTiles.has(n)){e.next=3;break}return e.delegateYield(r.mark((function e(){var s,u,c,l,h,f,d,p,v,y,g,m,b,w;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.tileProvider.getByTileCoords(t);case 2:s=e.sent,o.eventBus.emit(_.default.ReachableTile,t),o.reachedTiles.add(n),u=new Set,c=i(s.getNodes());try{for(c.s();!(l=c.n()).done;)h=l.value,f=o.registry.getNode(h),s.contains(f)||u.add(h)}catch(x){c.e(x)}finally{c.f()}return d=o,e.t0=i,e.next=12,o.profileProvider.getProfiles();case 12:e.t1=e.sent,p=(0,e.t0)(e.t1);try{for(p.s();!(v=p.n()).done;){y=v.value,g=o.pathfinderProvider.getShortestPathAlgorithm(y),m=i(u);try{for(m.s();!(b=m.n()).done;)w=b.value,g.setBreakPoint(w,function(){var e=a(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.registry.getNode(t),i=S.toTileCoordinate(n.latitude,n.longitude),e.next=4,d.fetchTile(i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(x){m.e(x)}finally{m.f()}}}catch(x){p.e(x)}finally{p.f()}case 15:case"end":return e.stop()}}),e)}))(),"t0",3);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"embedLocation",value:function(){var e=a(r.mark((function e(t){var n,i,a,o,s,u,c=this,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],i=14,a=.005,o={top:t.latitude+a,bottom:t.latitude-a,left:t.longitude-a,right:t.longitude+a},s=p.default.tilesInBbox(o,i).map((function(e){var t=new y.default(i,e.x,e.y);return c.fetchTile(t),t})),e.next=7,this.tileProvider.getMultipleByTileCoords(s);case 7:return u=e.sent,e.next=10,this.pathfinderProvider.embedLocation(t,u,n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();P=u([d.injectable(),l(0,d.inject(x.default.RoutableTileProvider)),l(0,d.tagged("phase",g.default.Base)),l(1,d.inject(x.default.PathfinderProvider)),l(2,d.inject(x.default.ProfileProvider)),l(3,d.inject(x.default.LocationResolver)),c("design:paramtypes",[Object,w.default,Object,Object])],P),t.default=P},function(e,t,n){"use strict";var r=n(78),i=n(112),a=n(192),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(280),p=n(80),v=f(n(175)),y=f(n(81)),g=f(n(259)),m=function(){function e(t,n){s(this,e),this.stopsProvider=t,this.roadPlanner=n,this.prepare()}return u(e,[{key:"findReachableStops",value:function(){var e=o(r.mark((function e(t,n,s,u,c){var l,h,f,d,p,y,m,b,_=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h=new Date,f=new Date(h.getTime()+s),d=n===v.default.Target?"to":"from",p=n===v.default.Target?"from":"to",a(l={},d,[t]),a(l,"minimumDepartureTime",h),a(l,"maximumArrivalTime",f),a(l,"minimumWalkingSpeed",u),a(l,"profileID",c),y=l,e.next=7,this.getNearbyStops(t);case 7:return m=e.sent,b=[],e.next=11,Promise.all(m.map(function(){var e=o(r.mark((function e(t){var n,o,s,u,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object.assign({},y,a({},p,[t])),e.next=3,_.roadPlanner.plan(n);case 3:return o=e.sent,s=o.map((function(e){return e.legs.reduce((function(e,t){return e+t.getAverageDuration()}),0)})),e.next=7,g.default.toArray(s);case 7:(u=e.sent).length&&(c=Math.min.apply(Math,i(u)),b.push({stop:t,duration:c}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:return e.abrupt("return",b);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i,a){return e.apply(this,arguments)}}()},{key:"getNearbyStops",value:function(){var e=o(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.triangles){e.next=3;break}return e.next=3,this.prepare();case 3:return n=this.triangles.find(t.longitude,t.latitude),i=[this.trianglePoints[n]],e.abrupt("return",i);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"prepare",value:function(){var e=o(r.mark((function e(){var t,n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stopsProvider.getAllStops();case 2:this.trianglePoints=e.sent,this.trianglePoints&&this.trianglePoints.length&&(n=function(e){return e.latitude},t=function(e){return e.longitude},this.triangles=d.Delaunay.from(this.trianglePoints,t,n));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();m=c([p.injectable(),h(0,p.inject(y.default.StopsProvider)),h(1,p.inject(y.default.RoadPlanner)),l("design:paramtypes",[Object,Object])],m),t.default=m},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,null,[{key:"toSpeed",value:function(e,t){return e/t*3600}},{key:"toDistance",value:function(e,t){return t*e/3600}},{key:"toDuration",value:function(e,t){return e/t*3600|0}},{key:"fromHours",value:function(e){return 36e5*e}},{key:"fromMinutes",value:function(e){return 6e4*e}},{key:"fromSeconds",value:function(e){return 1e3*e}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(89),l=n(260),h=u(n(198)),f=u(n(101)),d=u(n(86)),p=u(n(87)),v=u(n(81)),y=n(108),g=u(n(105)),m=u(n(259)),b=u(n(135)),_=u(n(146)),w=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.default;o(this,e),this.context=t.get(v.default.Context),this.context.setContainer(t),this.queryRunner=t.get(v.default.QueryRunner),this.profileProvider=t.get(v.default.ProfileProvider),this.eventBus=d.default.getInstance(),this.roadPlanner=t.get(v.default.RoadPlanner),this.connectionsProvider=t.get(v.default.ConnectionsProvider),this.catalogProvider=t.get(v.default.CatalogProvider),this.stopsProvider=t.get(v.default.StopsProvider),this.locationResolver=t.get(v.default.LocationResolver),this.activeProfileID="https://hdelva.be/profile/pedestrian"}return s(e,[{key:"addConnectionSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:f.default.Train;this.connectionsProvider.addConnectionSource({accessUrl:e,travelMode:t})}},{key:"addStopSource",value:function(e){this.stopsProvider.addStopSource({accessUrl:e})}},{key:"getConnectionSources",value:function(){return this.connectionsProvider.getSources()}},{key:"getStopsSources",value:function(){return this.stopsProvider.getSources()}},{key:"addCatalogSource",value:function(){var e=a(r.mark((function e(t){var n,a,o,s,u,c,l;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.catalogProvider.getCatalog(t);case 2:n=e.sent,a=i(n.datasets);try{for(a.s();!(o=a.n()).done;){s=o.value,u=i(s.distributions);try{for(u.s();!(c=u.n()).done;)l=c.value,s.subject===g.default.inNS(y.LC,"Connection")?this.connectionsProvider.addConnectionSource({accessUrl:l.accessUrl,travelMode:f.default.Train}):s.subject===g.default.inNS(y.GTFS,"Stop")&&this.stopsProvider.addStopSource({accessUrl:l.accessUrl})}catch(r){u.e(r)}finally{u.f()}}}catch(r){a.e(r)}finally{a.f()}case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"completePath",value:function(){var e=a(r.mark((function e(t){var n,a,o,s,u,c,l,h,d,p,v,y,g,b,w,x;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=_.default.create(),s=i(t.legs),e.prev=2,s.s();case 4:if((u=s.n()).done){e.next=26;break}if((c=u.value).getTravelMode()!==f.default.Walking){e.next=11;break}a||(a=c.getStartLocation()),o=c.getStopLocation(),e.next=24;break;case 11:if(!o){e.next=23;break}return e.next=14,this.roadPlanner.plan({from:[a],to:[o],profileID:this.activeProfileID});case 14:return l=e.sent,e.next=17,m.default.toArray(l);case 17:h=e.sent,d=i(h[0].legs);try{for(d.s();!(p=d.n()).done;)v=p.value,n.appendLeg(v)}catch(r){d.e(r)}finally{d.f()}n.updateContext(h[0].getContext()),a=null,o=null;case 23:n.appendLeg(c);case 24:e.next=4;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(2),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:if(!o){e.next=46;break}return e.next=37,this.roadPlanner.plan({from:[a],to:[o],profileID:this.activeProfileID});case 37:return y=e.sent,e.next=40,m.default.toArray(y);case 40:g=e.sent,b=i(g[0].legs);try{for(b.s();!(w=b.n()).done;)x=w.value,n.appendLeg(x)}catch(r){b.e(r)}finally{b.f()}n.updateContext(g[0].getContext()),a=null,o=null;case 46:return e.abrupt("return",n);case 47:case"end":return e.stop()}}),e,this,[[2,28,31,34]])})));return function(t){return e.apply(this,arguments)}}()},{key:"query",value:function(e){var t=this;this.eventBus.emit(p.default.Query,e),e.profileID=this.activeProfileID;var n=new l.PromiseProxyIterator((function(){return t.queryRunner.run(e)}));if(this.eventBus.once(p.default.AbortQuery,(function(){n.close()})),n.on("error",(function(e){e&&e.eventType&&t.eventBus.emit(e.eventType,e.message)})),e.minimized)return n;var i=new c.BufferedIterator;return n.on("data",function(){var e=a(r.mark((function e(a){var o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.completePath(a);case 2:o=e.sent,i._push(o),n.closed&&i.close();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),i}},{key:"prefetchStops",value:function(){var e=this.context.getContainer().get(v.default.StopsProvider);e&&e.prefetchStops()}},{key:"prefetchConnections",value:function(e,t){this.connectionsProvider.prefetchConnections(e,t)}},{key:"setDevelopmentProfile",value:function(){var e=a(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.profileProvider.parseDevelopmentProfile(t);case 2:return n=e.sent,e.abrupt("return",this.setProfileID(n));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setProfileID",value:function(e){return this.activeProfileID=e,this}},{key:"getAllStops",value:function(){var e=this.context.getContainer().get(v.default.StopsProvider);return e?e.getAllStops():Promise.reject()}},{key:"resolveLocation",value:function(e){return this.locationResolver.resolve(e)}}]),e}();t.default=w,w.Units=b.default},function(e,t,n){"use strict";var r,i=n(82),a=n(78),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(128)),v=n(131),y=f(n(86)),g=f(n(81)),m=function(){function e(t){s(this,e),this.ldFetch=t}return u(e,[{key:"addStopSource",value:function(e){throw new Error("Method not implemented.")}},{key:"getSources",value:function(){return[{accessUrl:this.accessUrl}]}},{key:"setAccessUrl",value:function(e){this.accessUrl=e}},{key:"prefetchStops",value:function(){this.ensureStopsLoaded()}},{key:"getStopById",value:function(){var e=o(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureStopsLoaded();case 2:return e.abrupt("return",this.stops[t]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllStops",value:function(){var e=o(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureStopsLoaded();case 2:return e.abrupt("return",Object.values(this.stops));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ensureStopsLoaded",value:function(){var e=o(a.mark((function e(){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadPromise||this.stops||this.loadStops(),!this.loadPromise){e.next=4;break}return e.next=4,this.loadPromise;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadStops",value:function(){var e=this;this.loadPromise=this.getByUrl(this.accessUrl).then((function(t){e.stops=t,e.loadPromise=null})).catch((function(e){console.log(e)}))}},{key:"getByUrl",value:function(){var e=o(a.mark((function e(t){var n,r,o,s,u,c,l,h,f,d,p,g,m,b,_;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.next=3,fetch(t);case 3:return r=e.sent,e.next=6,r.text();case 6:if(o=e.sent,s=this.parseResponseLength(r),u=(new Date).getTime()-n.getTime(),c={},200!==r.status&&y.default.getInstance().emit(v.EventType.Warning,"".concat(t," responded with status code ").concat(r.status)),200===r.status&&o){l=JSON.parse(o),h=i(l["@graph"]);try{for(h.s();!(f=h.n()).done;)d=f.value,p=d["@id"],g=d["http://www.w3.org/2003/01/geo/wgs84_pos#lat"]||d.latitude,m=d["http://www.w3.org/2003/01/geo/wgs84_pos#long"]||d.longitude,b=d.avgStopTimes||0,_={id:d["@id"],latitude:parseFloat(g),longitude:parseFloat(m),name:d.name,avgStopTimes:1e3*parseFloat(b)},c[p]=_}catch(a){h.e(a)}finally{h.f()}}return y.default.getInstance().emit(v.EventType.ResourceFetch,{DataType:v.DataType.Stops,url:t,duration:u,size:s}),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseLength",value:function(e){if(e.headers.get("content-length"))return parseInt(e.headers.get("content-length"),10);try{return e.body._chunkSize}catch(t){}}}]),e}();m=c([d.injectable(),h(0,d.inject(g.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.default&&p.default)?r:Object])],m),t.default=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=0;t.id=function(){return r++}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(n(113));function a(e,t){return Math.floor((1-Math.log(Math.tan(e*Math.PI/180)+1/Math.cos(e*Math.PI/180))/Math.PI)/2*Math.pow(2,t))}function o(e,t){return Math.floor((e+180)/360*Math.pow(2,t))}t.lat_to_tile=a,t.long_to_tile=o,t.toTileCoordinate=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:14;return new i.default(n,o(t,n),a(e,n))}},function(e,t,n){(function(e){var r="undefined"!==typeof e&&e||"undefined"!==typeof self&&self||window,i=Function.prototype.apply;function a(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(328),t.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(40))},function(e,t,n){"use strict";var r,i="object"===typeof Reflect?Reflect:null,a=i&&"function"===typeof i.apply?i.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};r=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!==e};function s(){s.init.call(this)}e.exports=s,s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var u=10;function c(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function l(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,r){var i,a,o,s;if(c(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"===typeof o?o=a[t]=r?[n,o]:[o,n]:r?o.unshift(n):o.push(n),(i=l(e))>0&&o.length>i&&!o.warned){o.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=o.length,s=u,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function p(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"===typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):y(i,i.length)}function v(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function y(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return l(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var u=i[e];if(void 0===u)return!1;if("function"===typeof u)a(u,this,t);else{var c=u.length,l=y(u,c);for(n=0;n<c;++n)a(l[n],this,t)}return!0},s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,d(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,d(this,e,t)),this},s.prototype.removeListener=function(e,t){var n,r,i,a,o;if(c(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(i=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,i=a;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,a=Object.keys(n);for(r=0;r<a.length;++r)"removeListener"!==(i=a[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},s.prototype.listenerCount=v,s.prototype.eventNames=function(){return this._eventsCount>0?r(this._events):[]}},function(e,t,n){"use strict";var r=n(168),i=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=h;var a=Object.create(n(150));a.inherits=n(129);var o=n(237),s=n(183);a.inherits(h,o);for(var u=i(s.prototype),c=0;c<u.length;c++){var l=u[c];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(e){if(!(this instanceof h))return new h(e);o.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",f)}function f(){this.allowHalfOpen||this._writableState.ended||r.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),h.prototype._destroy=function(e,t){this.push(null),this.end(),r.nextTick(t,e)}},function(e,t,n){"use strict";(function(t,r){var i=n(78),a=n(79),o={};e.exports=o;var s="function"===typeof t&&t,u=s?function(e){return s(e)}:function(e){return setTimeout(e,0)};function c(e,t,n){try{return e(t,n)}catch(i){r.nextTick((function(){throw i}))}}"object"===typeof r&&"function"===typeof r.nextTick?o.nextTick=r.nextTick:o.nextTick=u,o.setImmediate=s?u:o.nextTick,o.clone=function(e){if(e&&"object"===typeof e){var t;if(Array.isArray(e)){t=[];for(var n=0;n<e.length;++n)t[n]=o.clone(e[n])}else if(o.isObject(e))for(var r in t={},e)t[r]=o.clone(e[r]);else t=e.toString();return t}return e},o.isObject=function(e){return"[object Object]"===Object.prototype.toString.call(e)},o.isUndefined=function(e){return"undefined"===typeof e},o.callbackify=function(e){return a(i.mark((function t(){var n,r,a,o,s,u=arguments;return i.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(n=u.length,r=new Array(n),a=0;a<n;a++)r[a]=u[a];return"function"===typeof(o=r[r.length-1])&&r.pop(),t.prev=3,t.next=6,e.apply(null,r);case 6:s=t.sent,t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(3),"function"!==typeof o){t.next=13;break}return t.abrupt("return",c(o,t.t0));case 13:throw t.t0;case 14:if("function"!==typeof o){t.next=16;break}return t.abrupt("return",c(o,null,s));case 16:return t.abrupt("return",s);case 17:case"end":return t.stop()}}),t,null,[[3,9]])})))}}).call(this,n(140).setImmediate,n(95))},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(82),o=n(112),s=n(85),u=n(97),c=n(373),l=n(107),h=n(104),f=h.isArray,d=h.isObject,p=h.isString,v=h.isUndefined,y=n(154),g=y.isAbsolute,m=y.isRelative,b=y.prependBase,_=y.parse,w=n(97),x=w.asArray,T=w.compareShortestLeast,S=new Map,k={};function M(e,t,n,r,i,a){if(null===t||!p(t)||k.isKeyword(t))return t;if(r&&r.hasOwnProperty(t)&&!0!==i.get(t)&&k.createTermDefinition(e,r,t,i,a),e.isPropertyTermScoped&&e.previousContext&&(e=e.previousContext),(n=n||{}).vocab){var o=e.mappings.get(t);if(null===o)return null;if(o)return o["@id"]}var s=t.indexOf(":");if(-1!==s){var u=t.substr(0,s),c=t.substr(s+1);return"_"===u||0===c.indexOf("//")?t:(r&&r.hasOwnProperty(u)&&k.createTermDefinition(e,r,u,i,a),e.mappings.has(u)?e.mappings.get(u)["@id"]+c:t)}return n.vocab&&"@vocab"in e?e["@vocab"]+t:n.base?b(e["@base"],t):t}function P(e,t){return I.apply(this,arguments)}function I(){return(I=i(r.mark((function e(t,n){var a,s,c;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=function(){return(c=i(r.mark((function e(t,a,u){var c,h;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a.size>10)){e.next=2;break}throw new l("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"loading remote context failed",max:10});case 2:if(c=new Map,j(t,c,!1,n.base),0!==c.size){e.next=6;break}return e.abrupt("return");case 6:return h=o(c.keys()).filter((function(e){return!1===c.get(e)})),e.abrupt("return",Promise.all(h.map(function(){var e=i(r.mark((function e(i){var o,h,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a.has(i)){e.next=2;break}throw new l("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"recursive context inclusion",url:i});case 2:return(o=new Set(a)).add(i),e.prev=4,e.next=7,u(i);case 7:h=e.sent,v=h.document||null,p(v)&&(v=JSON.parse(v)),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(4),new l("Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context.","jsonld.InvalidUrl",{code:"loading remote context failed",url:i,cause:e.t0});case 15:if(d(v)){e.next=17;break}throw new l("Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object.","jsonld.InvalidUrl",{code:"invalid remote context",url:i});case 17:return v="@context"in v?{"@context":v["@context"]}:{"@context":{}},h.contextUrl&&(f(v["@context"])||(v["@context"]=[v["@context"]]),v["@context"].push(h.contextUrl)),e.next=21,s(v,o,u);case 21:c.set(i,v["@context"]),j(t,c,!0,n.base);case 23:case"end":return e.stop()}}),e,null,[[4,12]])})));return function(t){return e.apply(this,arguments)}}())));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)},s=function(e,t,n){return c.apply(this,arguments)},a=u.normalizeDocumentLoader(n.documentLoader),e.next=5,s(t,new Set,a);case 5:return e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,n,r){if(f(e)){var i,o=a(e);try{for(o.s();!(i=o.n()).done;){j(i.value,t,n,r)}}catch(x){o.e(x)}finally{o.f()}}else if(d(e))for(var s in e)if("@context"===s){var u=e[s];if(f(u))for(var c=u.length,l=0;l<c;++l){var h=u[l];if(p(h)){var v=b(r,h),y=t.get(v);n?f(y)?(Array.prototype.splice.apply(u,[l,1].concat(y)),l+=y.length-1,c=u.length):!1!==y&&(u[l]=y):void 0===y&&t.set(v,!1)}else for(var g in h)d(h[g])&&j(h[g],t,n,r)}else if(p(u)){var m=b(r,u),_=t.get(m);n?!1!==_&&(e[s]=_):void 0===_&&t.set(m,!1)}else for(var w in u)d(u[w])&&j(u[w],t,n,r)}else j(e[s],t,n,r)}function O(e,t){if(!e||"object"!==typeof e||!t||"object"!==typeof t)return e===t;var n=Array.isArray(e);if(n!==Array.isArray(t))return!1;if(n){if(e.length!==t.length)return!1;for(var r=0;r<e.length;++r)if(!O(e[r],t[r]))return!1;return!0}var i=Object.keys(e),a=Object.keys(t);if(i.length!==a.length)return!1;for(var o in e){var s=e[o],u=t[o];if("@container"===o&&Array.isArray(s)&&Array.isArray(u)&&(s=s.slice().sort(),u=u.slice().sort()),!O(s,u))return!1}return!0}e.exports=k,k.cache=new c,k.process=function(e){var t=e.activeCtx,n=e.localCtx,r=e.options,i=e.isPropertyTermScopedContext,a=void 0!==i&&i,o=e.isTypeScopedContext,c=void 0!==o&&o;d(n)&&"@context"in n&&f(n["@context"])&&(n=n["@context"]);var h=x(n);if(0===h.length)return t;var v=t.previousContext||t;if(a&&t.previousContext)return(t=t.clone()).isPropertyTermScoped=!0,t.previousContext=k.process({activeCtx:t.previousContext,localCtx:h,options:r,isPropertyTermScopedContext:a}),t;for(var y=t,w=0;w<h.length;++w){var T=h[w];if(t=y,null!==T){if(k.cache){var S=k.cache.get(t,T);if(S){y=t=S;continue}}if(d(T)&&"@context"in T&&(T=T["@context"]),!d(T))throw new l("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:T});y=y.clone();var M=new Map;if("@version"in T){if(1.1!==T["@version"])throw new l("Unsupported JSON-LD version: "+T["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:T});if(t.processingMode&&"json-ld-1.0"===t.processingMode)throw new l("@version: "+T["@version"]+" not compatible with "+t.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:T});y.processingMode="json-ld-1.1",y["@version"]=T["@version"],M.set("@version",!0)}if(y.processingMode=y.processingMode||t.processingMode||"json-ld-1.0","@base"in T){var P=T["@base"];if(null===P);else if(g(P))P=_(P);else{if(!m(P))throw new l('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:T});P=_(b(t["@base"].href,P))}y["@base"]=P,M.set("@base",!0)}if("@vocab"in T){var I=T["@vocab"];if(null===I)delete y["@vocab"];else{if(!p(I))throw new l('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:T});if(!g(I))throw new l('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:T});y["@vocab"]=I}M.set("@vocab",!0)}if("@language"in T){var j=T["@language"];if(null===j)delete y["@language"];else{if(!p(j))throw new l('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:T});y["@language"]=j.toLowerCase()}M.set("@language",!0)}for(var O in M.set("@protected",T["@protected"]||!1),T)k.createTermDefinition(y,T,O,M,r,a);c&&!y.previousContext&&(y.previousContext=v.clone()),k.cache&&k.cache.set(t,T,y)}else{if(!a&&0!==Object.keys(t.protected).length){var R=r&&r.protectedMode||"error";if("error"===R)throw new l("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});if("warn"===R){console.warn("WARNING: invalid context nullification");var N=t;y=t=k.getInitialContext(r).clone();for(var C=0,A=Object.entries(N.protected);C<A.length;C++){var E=s(A[C],2),D=E[0];E[1]&&(t.mappings[D]=u.clone(N.mappings[D]))}t.protected=u.clone(N.protected),k.cache&&k.cache.set(N,T,y);continue}throw new l("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:n,protectedMode:R})}y=t=k.getInitialContext(r).clone(),c&&(y.previousContext=v.clone())}}return y},k.createTermDefinition=function(e,t,n,r,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(r.has(n)){if(r.get(n))return;throw new l("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:t,term:n})}if(r.set(n,!1),k.isKeyword(n))throw new l("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:t,term:n});if(""===n)throw new l("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var o,s=e.mappings.get(n);if(e.mappings.has(n)&&e.mappings.delete(n),t.hasOwnProperty(n)&&(o=t[n]),null===o||d(o)&&null===o["@id"])return e.mappings.set(n,null),void r.set(n,!0);var u=!1;if(p(o)&&(u=!0,o={"@id":o}),!d(o))throw new l("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:t});var c={};e.mappings.set(n,c),c.reverse=!1;var h=["@container","@id","@language","@reverse","@type"];for(var v in k.processingMode(e,1.1)&&h.push("@context","@nest","@prefix","@protected"),o)if(!h.includes(v))throw new l("Invalid JSON-LD syntax; a term definition must not contain "+v,"jsonld.SyntaxError",{code:"invalid term definition",context:t});var y=n.indexOf(":");if(c._termHasColon=-1!==y,"@reverse"in o){if("@id"in o)throw new l("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});if("@nest"in o)throw new l("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});var m=o["@reverse"];if(!p(m))throw new l("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});var b=M(e,m,{vocab:!0,base:!1},t,r,i);if(!g(b))throw new l("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});c["@id"]=b,c.reverse=!0}else if("@id"in o){var _=o["@id"];if(!p(_))throw new l("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});if(_!==n){if(_=M(e,_,{vocab:!0,base:!1},t,r,i),!g(_)&&!k.isKeyword(_))throw new l("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t});c["@id"]=_,c._prefix=!c._termHasColon&&_.match(/[:\/\?#\[\]@]$/)&&(u||k.processingMode(e,1))}}if(!("@id"in c))if(c._termHasColon){var w=n.substr(0,y);if(t.hasOwnProperty(w)&&k.createTermDefinition(e,t,w,r,i),e.mappings.has(w)){var x=n.substr(y+1);c["@id"]=e.mappings.get(w)["@id"]+x}else c["@id"]=n}else{if(!("@vocab"in e))throw new l("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:t,term:n});c["@id"]=e["@vocab"]+n}if((!0===o["@protected"]||!0===r.get("@protected")&&!1!==o["@protected"])&&(e.protected[n]=!0,c.protected=!0),r.set(n,!0),"@type"in o){var T=o["@type"];if(!p(T))throw new l("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if("@id"!==T&&"@vocab"!==T&&"@json"!==T){if(T=M(e,T,{vocab:!0,base:!1},t,r,i),!g(T))throw new l("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:t});if(0===T.indexOf("_:"))throw new l("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:t})}c["@type"]=T}if("@container"in o){var S=p(o["@container"])?[o["@container"]]:o["@container"]||[],P=["@list","@set","@index","@language"],I=!0,j=S.includes("@set");if(k.processingMode(e,1.1))if(P.push("@graph","@id","@type"),S.includes("@list")){if(1!==S.length)throw new l("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else if(S.includes("@graph")){if(S.some((function(e){return"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e})))throw new l("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:t})}else I&=S.length<=(j?2:1);else I&=!f(o["@container"]),I&=S.length<=1;if(I&=S.every((function(e){return P.includes(e)})),!(I&=!(j&&S.includes("@list"))))throw new l("Invalid JSON-LD syntax; @context @container value must be one of the following: "+P.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:t});if(c.reverse&&!S.every((function(e){return["@index","@set"].includes(e)})))throw new l("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:t});c["@container"]=S}if("@context"in o&&(c["@context"]=o["@context"]),"@language"in o&&!("@type"in o)){var R=o["@language"];if(null!==R&&!p(R))throw new l("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:t});null!==R&&(R=R.toLowerCase()),c["@language"]=R}if("@prefix"in o){if(c._termHasColon)throw new l("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:t});if("boolean"!==typeof o["@prefix"])throw new l("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:t});c._prefix=!0===o["@prefix"]}if("@nest"in o){var N=o["@nest"];if(!p(N)||"@nest"!==N&&0===N.indexOf("@"))throw new l("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:t});c["@nest"]=N}var C=c["@id"];if("@context"===C||"@preserve"===C)throw new l("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:t});if(s&&s.protected&&!a&&(e.protected[n]=!0,c.protected=!0,!O(s,c))){var A=i&&i.protectedMode||"error";if("error"===A)throw new l("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:t,term:n});if("warn"===A)return void console.warn("WARNING: protected term redefinition",{term:n});throw new l("Invalid protectedMode.","jsonld.SyntaxError",{code:"invalid protected mode",context:t,term:n,protectedMode:A})}},k.expandIri=function(e,t,n,r){return M(e,t,n,void 0,void 0,r)},k.getInitialContext=function(e){var t=_(e.base||""),n=JSON.stringify({base:t,processingMode:e.processingMode}),r=S.get(n);if(r)return r;var i={"@base":t,processingMode:e.processingMode,mappings:new Map,inverse:null,getInverse:function(){if(this.inverse)return this.inverse;var e,t=this.inverse={},n=this.fastCurieMap={},r={},i=this["@language"]||"@none",u=this.mappings,l=o(u.keys()).sort(T),h=a(l);try{for(h.s();!(e=h.n()).done;){var f=e.value,d=u.get(f);if(null!==d){var p=d["@container"]||"@none";p=[].concat(p).sort().join("");var v,y=x(d["@id"]),g=a(y);try{for(g.s();!(v=g.n()).done;){var m=v.value,b=t[m],_=k.isKeyword(m);if(b)_||d._termHasColon||r[m].push(f);else if(t[m]=b={},!_&&!d._termHasColon){r[m]=[f];var w={iri:m,terms:r[m]};m[0]in n?n[m[0]].push(w):n[m[0]]=[w]}if(b[p]||(b[p]={"@language":{},"@type":{},"@any":{}}),b=b[p],c(f,b["@any"],"@none"),d.reverse)c(f,b["@type"],"@reverse");else if("@type"in d)c(f,b["@type"],d["@type"]);else if("@language"in d){var S=d["@language"]||"@null";c(f,b["@language"],S)}else c(f,b["@language"],i),c(f,b["@type"],"@none"),c(f,b["@language"],"@none")}}catch(P){g.e(P)}finally{g.f()}}}}catch(P){h.e(P)}finally{h.f()}for(var M in n)s(n,M,1);return t},clone:function(){var e={};e["@base"]=this["@base"],e.mappings=u.clone(this.mappings),e.clone=this.clone,e.inverse=null,e.getInverse=this.getInverse,e.protected=u.clone(this.protected),this.previousContext&&(e.isPropertyTermScoped=this.previousContext.isPropertyTermScoped,e.previousContext=this.previousContext.clone());e.revertTypeScopedContext=this.revertTypeScopedContext,"@language"in this&&(e["@language"]=this["@language"]);"@vocab"in this&&(e["@vocab"]=this["@vocab"]);return e},revertTypeScopedContext:function(){if(!this.previousContext)return this;return this.previousContext.clone()},protected:{}};return 1e4===S.size&&S.clear(),S.set(n,i),i;function s(e,t,n){var r,i,o,u=e[t],c=e[t]={},l=a(u);try{for(l.s();!(o=l.n()).done;){var h=o.value;(i=n>=(r=h.iri).length?"":r[n])in c?c[i].push(h):c[i]=[h]}}catch(d){l.e(d)}finally{l.f()}for(var f in c)""!==f&&s(c,f,n+1)}function c(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},k.getContextValue=function(e,t,n){if(null===t){if("@context"===n)return;return null}if(e.mappings.has(t)){var r=e.mappings.get(t);if(v(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&e.hasOwnProperty(n)?e[n]:"@context"!==n?null:void 0},k.getAllContexts=function(){var e=i(r.mark((function e(t,n){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",P(t,n));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),k.processingMode=function(e,t){return t.toString()>="1.1"?e.processingMode&&e.processingMode>="json-ld-"+t.toString():!e.processingMode||"json-ld-1.0"===e.processingMode},k.isKeyword=function(e){if(!p(e))return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@embed":case"@explicit":case"@graph":case"@id":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1}},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(89),p=n(80),v=f(n(158)),y=f(n(174)),g=f(n(175)),m=f(n(100)),b=f(n(101)),_=f(n(86)),w=f(n(87)),x=n(157),T=f(n(81)),S=f(n(99)),k=f(n(156)),M=f(n(199)),P=f(n(257)),I=function(){function e(t,n,r,i,a){s(this,e),this.connectionsProvider=t,this.locationResolver=n,this.transferReachableStopsFinder=r,this.initialReachableStopsFinder=i,this.finalReachableStopsFinder=a,this.eventBus=_.default.getInstance(),this.journeyExtractor=new P.default(n)}return u(e,[{key:"plan",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u,c,l,h,f,p,v;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.minimumDepartureTime,r=t.maximumArrivalTime,o=new M.default,e.next=4,this.connectionsProvider.createIterator({upperBoundDate:r,lowerBoundDate:n,excludedModes:t.excludedTravelModes,region:null});case 4:return s=e.sent,u=new k.default([s,o],x.forwardsConnectionSelector,!0),c={finalReachableStops:{},profilesByStop:{},enterConnectionByTrip:{},footpathsQueue:o,connectionsQueue:u},e.next=9,Promise.all([this.initInitialReachableStops(c,t),this.initFinalReachableStops(c,t)]);case 9:if(l=e.sent,h=a(l,2),f=h[0],p=h[1],f&&p){e.next=15;break}return e.abrupt("return",Promise.resolve(new d.ArrayIterator([])));case 15:return v=this,e.abrupt("return",new Promise((function(e,n){var r=!1,i=function(){r||(u.close(),v.extractJourneys(c,t).then((function(t){e(t)})),r=!0)};s.on("readable",(function(){return v.processConnections(c,t,i)})),s.on("end",(function(){return i()})),v.processConnections(c,t,i)})));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"updateProfile",value:function(e,t,n){var r=n.tripId,i={departureTime:n.departureTime.getTime(),arrivalTime:n.arrivalTime.getTime(),exitConnection:n,enterConnection:e.enterConnectionByTrip[r]};e.profilesByStop[n.arrivalStop]=i,_.default.getInstance().emit(w.default.ReachableID,n.arrivalStop)}},{key:"extractJourneys",value:function(){var e=o(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.journeyExtractor.extractJourneys(t.profilesByStop,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"processConnections",value:function(){var e=o(i.mark((function e(t,n,r){var a,o,s,u,c,l,h,f,d,p,g;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.from,o=n.to,s=n.minimumDepartureTime,u=a[0].id,c=o[0].id,l=t.connectionsQueue.read();case 4:if(!l||t.connectionsQueue.closed){e.next=28;break}if(!(l.departureTime<s)||t.connectionsQueue.closed){e.next=8;break}return l=t.connectionsQueue.read(),e.abrupt("continue",4);case 8:if(!(this.getProfile(t,c).arrivalTime<=l.departureTime.getTime())){e.next=10;break}return e.abrupt("return",r());case 10:if(h=l.tripId,f=l.departureTime.getTime(),d=t.enterConnectionByTrip[h],p=(l.departureStop===u||this.getProfile(t,l.departureStop).arrivalTime<=f)&&l.pickupType!==y.default.NotAvailable,!d&&!p){e.next=22;break}if(t.enterConnectionByTrip[h]||(t.enterConnectionByTrip[h]=l),g=l.arrivalTime.getTime()<this.getProfile(t,l.arrivalStop).arrivalTime,!(l.dropOffType!==v.default.NotAvailable)||!g){e.next=22;break}return this.updateProfile(t,n,l),e.next=22,this.scheduleExtraConnections(t,n,l);case 22:if(t.connectionsQueue.closed){e.next=25;break}return l=t.connectionsQueue.read(),e.abrupt("continue",4);case 25:l=void 0,e.next=4;break;case 28:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getProfile",value:function(e,t){return e.profilesByStop[t]||(e.profilesByStop[t]={departureTime:1/0,arrivalTime:1/0}),e.profilesByStop[t]}},{key:"scheduleExtraConnections",value:function(){var e=o(i.mark((function e(t,n,a){var o,s,u,c,l,h,f,d,p,m,_;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.locationResolver.resolve(a.arrivalStop);case 3:return o=e.sent,e.next=6,this.transferReachableStopsFinder.findReachableStops(o,g.default.Source,n.maximumTransferDuration,n.minimumWalkingSpeed,n.profileID);case 6:s=e.sent,t.finalReachableStops[o.id]&&s.push(t.finalReachableStops[o.id]),u=r(s);try{for(u.s();!(c=u.n()).done;)l=c.value,h=l.stop,(f=l.duration)&&h.id&&(d=this.getProfile(t,h.id).arrivalTime,p=new Date(a.arrivalTime.getTime()+f),d>p.getTime()&&p<=n.maximumArrivalTime&&(m="TRANSFER_TO:".concat(a.arrivalStop,"@").concat(a.arrivalTime.getTime()),_={id:"".concat(m,"-").concat(h.id),tripId:m,travelMode:b.default.Walking,departureTime:a.arrivalTime,departureStop:a.arrivalStop,arrivalTime:new Date(a.arrivalTime.getTime()+f),arrivalStop:h.id,dropOffType:v.default.Regular,pickupType:y.default.Regular,headsign:h.id},t.footpathsQueue.write(_)))}catch(i){u.e(i)}finally{u.f()}e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.eventBus&&this.eventBus.emit(w.default.Warning,e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"initInitialReachableStops",value:function(){var e=o(i.mark((function e(t,n){var a,o,s,u,c,l,h,f,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.from[0],o=S.default.getId(a),a.id||(n.from[0].id=o,n.from[0].name="Departure location"),e.next=5,this.initialReachableStopsFinder.findReachableStops(a,g.default.Source,n.maximumWalkingDuration,n.minimumWalkingSpeed,n.profileID);case 5:if(0!==(s=e.sent).length){e.next=9;break}return this.eventBus.emit(w.default.AbortQuery,"No reachable stops at departure location"),e.abrupt("return",!1);case 9:this.eventBus&&this.eventBus.emit(w.default.InitialReachableStops,s),u=r(s);try{for(u.s();!(c=u.n()).done;)l=c.value,h=l.stop,(f=l.duration)&&(d={id:"MOVE_TO:".concat(h.id),tripId:"MOVE_TO:".concat(h.id),travelMode:b.default.Walking,departureTime:n.minimumDepartureTime,departureStop:a.id,arrivalTime:new Date(n.minimumDepartureTime.getTime()+f),arrivalStop:h.id,dropOffType:v.default.Regular,pickupType:y.default.Regular,headsign:h.id},t.footpathsQueue.write(d))}catch(i){u.e(i)}finally{u.f()}return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initFinalReachableStops",value:function(){var e=o(i.mark((function e(t,n){var a,o,s,u,c,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.to[0],o=S.default.getId(a),a.id||(n.to[0].id=o,n.to[0].name="Arrival location"),e.next=5,this.finalReachableStopsFinder.findReachableStops(a,g.default.Target,n.maximumWalkingDuration,n.minimumWalkingSpeed,n.profileID);case 5:if(0!==(s=e.sent).length){e.next=9;break}return this.eventBus.emit(w.default.AbortQuery,"No reachable stops at arrival location"),e.abrupt("return",!1);case 9:this.eventBus&&this.eventBus.emit(w.default.FinalReachableStops,s),u=r(s);try{for(u.s();!(c=u.n()).done;)(l=c.value).duration>0&&(t.finalReachableStops[l.stop.id]={stop:a,duration:l.duration})}catch(i){u.e(i)}finally{u.f()}return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();I=c([p.injectable(),h(0,p.inject(T.default.ConnectionsProvider)),h(1,p.inject(T.default.LocationResolver)),h(2,p.inject(T.default.ReachableStopsFinder)),h(2,p.tagged("phase",m.default.Transfer)),h(3,p.inject(T.default.ReachableStopsFinder)),h(3,p.tagged("phase",m.default.Initial)),h(4,p.inject(T.default.ReachableStopsFinder)),h(4,p.tagged("phase",m.default.Final)),l("design:paramtypes",[Object,Object,Object,Object,Object])],I),t.default=I},function(e,t,n){"use strict";var r=n(82),i=n(112),a=n(76),o=n(77),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(101)),c=s(n(159)),l=function(){function e(t,n){a(this,e),this.legs=t,this.context=n||{}}return o(e,[{key:"updateContext",value:function(e){this.context=Object.assign(this.context,e)}},{key:"addToContext",value:function(e,t){this.context[e]=t}},{key:"getContext",value:function(){return this.context}},{key:"getFromContext",value:function(e){return this.context[e]}},{key:"prependLeg",value:function(e){this.legs.unshift(e)}},{key:"appendLeg",value:function(e){this.legs.push(e)}},{key:"addPath",value:function(e){var t;(t=this.legs).push.apply(t,i(e.legs))}},{key:"getStartLocationId",value:function(){return(" "+this.legs[0].getStartLocation().id).slice(1)}},{key:"getDepartureTime",value:function(e){var t,n=0,i=r(this.legs);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(a.getStartTime())return new Date(a.getStartTime().getTime()-n);n+=a.getExpectedDuration()}}catch(o){i.e(o)}finally{i.f()}return e.minimumDepartureTime}},{key:"getArrivalTime",value:function(e){for(var t=0,n=this.legs.length-1;n>=0;n--){var r=this.legs[n];if(r.getStopTime())return new Date(r.getStopTime().getTime()+t);t+=r.getExpectedDuration()}return new Date(e.minimumDepartureTime.getTime()+t)}},{key:"getTravelTime",value:function(e){return this.getArrivalTime(e).getTime()-this.getDepartureTime(e).getTime()}},{key:"getTransferTime",value:function(e){var t,n=this.getTravelTime(e),i=r(this.legs);try{for(i.s();!(t=i.n()).done;){var a=t.value;a.getTravelMode()!==u.default.Train&&a.getTravelMode()!==u.default.Bus||(n-=a.getExpectedDuration())}}catch(o){i.e(o)}finally{i.f()}return n}}],[{key:"create",value:function(){return new e([])}},{key:"compareEquals",value:function(e,t){return e.legs.length===t.legs.length&&e.legs.every((function(e,n){var r=t.legs[n];return c.default.compareEquals(e,r)}))}}]),e}();t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96);function i(e){return"function"===typeof e?e.name:"symbol"===typeof e?e.toString():e}function a(e){if(e.name)return e.name;var t=e.toString(),n=t.match(/^function\s*([^\s(]+)/);return n?n[1]:"Anonymous function: "+t}t.getServiceIdentifierAsString=i,t.listRegisteredBindingsForServiceIdentifier=function(e,t,n){var r="",i=n(e,t);return 0!==i.length&&(r="\nRegistered bindings:",i.forEach((function(e){var t="Object";null!==e.implementationType&&(t=a(e.implementationType)),r=r+"\n "+t,e.constraint.metaData&&(r=r+" - "+e.constraint.metaData)}))),r},t.circularDependencyToException=function e(t){t.childRequests.forEach((function(t){if(function e(t,n){return null!==t.parentRequest&&(t.parentRequest.serviceIdentifier===n||e(t.parentRequest,n))}(t,t.serviceIdentifier)){var n=function(e){return function e(t,n){void 0===n&&(n=[]);var r=i(t.serviceIdentifier);return n.push(r),null!==t.parentRequest?e(t.parentRequest,n):n}(e).reverse().join(" --\x3e ")}(t);throw new Error(r.CIRCULAR_DEPENDENCY+" "+n)}e(t)}))},t.listMetadataForTarget=function(e,t){if(t.isTagged()||t.isNamed()){var n="",r=t.getNamedTag(),i=t.getCustomTags();return null!==r&&(n+=r.toString()+"\n"),null!==i&&i.forEach((function(e){n+=e.toString()+"\n"}))," "+e+"\n "+e+" - "+n}return" "+e},t.getFunctionName=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.nodes=new Map,this.labels=[],this.adjacencyList=[],this.reverseAdjacencyList=[],this.id=t,this.breakPoints={}}return i(e,[{key:"addEdge",value:function(e,t,n,r,i,a){var o=this.getNodeIndex(e),s=this.getNodeIndex(t);this.adjacencyList[o].push({node:s,through:n,distance:r,cost:a,duration:i}),this.reverseAdjacencyList[s].push({node:o,through:n,distance:r,cost:a,duration:i})}},{key:"getNodeMap",value:function(){return this.nodes}},{key:"getLabel",value:function(e){return this.labels[e]}},{key:"getAdjacencyList",value:function(){return this.adjacencyList}},{key:"getReverseAdjacencyList",value:function(){return this.reverseAdjacencyList}},{key:"getNodeIndex",value:function(e){if(!this.nodes.has(e)){var t=this.adjacencyList.length;this.nodes.set(e,t),this.labels.push(e),this.adjacencyList.push([]),this.reverseAdjacencyList.push([])}return this.nodes.get(e)}},{key:"setBreakPoint",value:function(e,t){var n=this.getNodeIndex(e);this.breakPoints[n]=t}},{key:"getBreakPoint",value:function(e){return this.breakPoints[e]}},{key:"removeBreakPoint",value:function(e){var t=this.getNodeIndex(e);delete this.breakPoints[t]}}]),e}();t.default=a},function(e,t,n){(t=e.exports=n(237)).Stream=t,t.Readable=t,t.Writable=n(183),t.Duplex=n(142),t.Transform=n(241),t.PassThrough=n(338)},function(e,t,n){(function(e){function n(e){return Object.prototype.toString.call(e)}t.isArray=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===n(e)},t.isBoolean=function(e){return"boolean"===typeof e},t.isNull=function(e){return null===e},t.isNullOrUndefined=function(e){return null==e},t.isNumber=function(e){return"number"===typeof e},t.isString=function(e){return"string"===typeof e},t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=function(e){return void 0===e},t.isRegExp=function(e){return"[object RegExp]"===n(e)},t.isObject=function(e){return"object"===typeof e&&null!==e},t.isDate=function(e){return"[object Date]"===n(e)},t.isError=function(e){return"[object Error]"===n(e)||e instanceof Error},t.isFunction=function(e){return"function"===typeof e},t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=e.isBuffer}).call(this,n(115).Buffer)},function(e,t,n){"use strict";var r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#",a="http://www.w3.org/2000/10/swap/";t.a={xsd:{decimal:i+"decimal",boolean:i+"boolean",double:i+"double",integer:i+"integer",string:i+"string"},rdf:{type:r+"type",nil:r+"nil",first:r+"first",rest:r+"rest",langString:r+"langString"},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:a+"reify#forSome",forAll:a+"reify#forAll"},log:{implies:a+"log#implies"}}},function(e,t){e.exports={options:{usePureJavaScript:!1}}},function(e,t,n){"use strict";var r="http://www.w3.org/1999/02/22-rdf-syntax-ns#",i="http://www.w3.org/2001/XMLSchema#";e.exports={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",RDF:r,RDF_LIST:r+"List",RDF_FIRST:r+"first",RDF_REST:r+"rest",RDF_NIL:r+"nil",RDF_TYPE:r+"type",RDF_PLAIN_LITERAL:r+"PlainLiteral",RDF_XML_LITERAL:r+"XMLLiteral",RDF_JSON_LITERAL:r+"JSON",RDF_OBJECT:r+"object",RDF_LANGSTRING:r+"langString",XSD:i,XSD_BOOLEAN:i+"boolean",XSD_DOUBLE:i+"double",XSD_INTEGER:i+"integer",XSD_STRING:i+"string"}},function(e,t,n){"use strict";var r=n(104),i={};e.exports=i,i.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},i.parse=function(e,t){for(var n={},r=i.parsers[t||"full"],a=r.regex.exec(e),o=r.keys.length;o--;)n[r.keys[o]]=void 0===a[o]?null:a[o];return("https"===n.scheme&&"443"===n.port||"http"===n.scheme&&"80"===n.port)&&(n.href=n.href.replace(":"+n.port,""),n.authority=n.authority.replace(":"+n.port,""),n.port=null),n.normalizedPath=i.removeDotSegments(n.path),n},i.prependBase=function(e,t){if(null===e)return t;if(-1!==t.indexOf(":"))return t;r.isString(e)&&(e=i.parse(e||""));var n=i.parse(t),a={protocol:e.protocol||""};if(null!==n.authority)a.authority=n.authority,a.path=n.path,a.query=n.query;else if(a.authority=e.authority,""===n.path)a.path=e.path,null!==n.query?a.query=n.query:a.query=e.query;else{if(0===n.path.indexOf("/"))a.path=n.path;else{var o=e.path;(o=o.substr(0,o.lastIndexOf("/")+1)).length>0&&"/"!==o.substr(-1)&&(o+="/"),o+=n.path,a.path=o}a.query=n.query}""!==n.path&&(a.path=i.removeDotSegments(a.path));var s=a.protocol;return null!==a.authority&&(s+="//"+a.authority),s+=a.path,null!==a.query&&(s+="?"+a.query),null!==n.fragment&&(s+="#"+n.fragment),""===s&&(s="./"),s},i.removeBase=function(e,t){if(null===e)return t;r.isString(e)&&(e=i.parse(e||""));var n="";if(""!==e.href?n+=(e.protocol||"")+"//"+(e.authority||""):t.indexOf("//")&&(n+="//"),0!==t.indexOf(n))return t;for(var a=i.parse(t.substr(n.length)),o=e.normalizedPath.split("/"),s=a.normalizedPath.split("/"),u=a.fragment||a.query?0:1;o.length>0&&s.length>u&&o[0]===s[0];)o.shift(),s.shift();var c="";if(o.length>0){o.pop();for(var l=0;l<o.length;++l)c+="../"}return c+=s.join("/"),null!==a.query&&(c+="?"+a.query),null!==a.fragment&&(c+="#"+a.fragment),""===c&&(c="./"),c},i.removeDotSegments=function(e){if(0===e.length)return"";for(var t=e.split("/"),n=[];t.length>0;){var r=t.shift(),i=0===t.length;"."!==r?".."!==r?n.push(r):(n.pop(),i&&n.push("")):i&&n.push("")}return n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};var a=/^([A-Za-z][A-Za-z0-9+-.]*|_):/;i.isAbsolute=function(e){return r.isString(e)&&a.test(e)},i.isRelative=function(e){return r.isString(e)}},function(e,t,n){"use strict";var r=n(85),i=n(82),a=n(76),o=n(77),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(108),c=s(n(105)),l=n(398),h=function(){function e(t){a(this,e),this.entityType=t,this.filters=[],this.mappings={},this.nestedViews={},this.showId=!0,this.resultObject=this.createResultObject()}return o(e,[{key:"addEntity",value:function(e){this.resultObject.addEntity(e)}},{key:"getContents",value:function(){return this.resultObject.getContents()}},{key:"hideId",value:function(){this.showId=!1}},{key:"addFilter",value:function(e){this.filters.push(e)}},{key:"addMapping",value:function(e,t,n){this.mappings[e]=t,this.nestedViews[e]=n}},{key:"process",value:function(e){if(this._filter(e))return this._map(e)}},{key:"createResultObject",value:function(){return new l.SingleThingViewResult}},{key:"_filter",value:function(e){var t,n=!0,r=i(this.filters);try{for(r.s();!(t=r.n()).done;){if(!(0,t.value)(e)){n=!1;break}}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"_makeList",value:function(e){for(var t=e,n=[t[c.default.inNS(u.RDF,"first")]],r=t[c.default.inNS(u.RDF,"rest")];r&&r!==c.default.inNS(u.RDF,"nil");)t=r,n.push(t[c.default.inNS(u.RDF,"first")]),r=t[c.default.inNS(u.RDF,"rest")];return n}},{key:"_flattenLists",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var a=n[t],o=r(a,2),s=o[0],l=o[1];if(Array.isArray(l)){var h,f=i(l.entries());try{for(f.s();!(h=f.n()).done;){var d=h.value,p=r(d,2),v=p[0],y=p[1];if(y[c.default.inNS(u.RDF,"first")]){var g=this._makeList(y);l[v]=g}}}catch(m){f.e(m)}finally{f.f()}}l[c.default.inNS(u.RDF,"first")]&&(e[s]=this._makeList(l))}}},{key:"_map",value:function(e){var t,n=this;this._flattenLists(e),t=this.showId?this.entityType(e.id):this.entityType();for(var r=function(){var e=a[i],r=e[0],o=e[1],s=n.nestedViews[r];s&&(o=Array.isArray(o)?o.map((function(e){return s.process(e)})):s.process(o));var u=n.mappings[r];u&&(t[u]=o)},i=0,a=Object.entries(e);i<a.length;i++)r();return t}}]),e}();t.ThingView=h},function(e,t,n){"use strict";var r=n(82),i=n(76),a=n(77),o=n(103),s=n(132),u=n(83),c=n(84);Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){c(n,e);var t=u(n);function n(e,r){var a,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return i(this,n),(a=t.call(this)).sourceIterators=e,a.selector=r,a.setMaxListeners(1e3),a.values=Array(a.sourceIterators.length).fill(void 0),a.waitingForFill=Array(a.sourceIterators.length).fill(!1),a.readable=!0,a.condensed=o,a.addListeners(),a}return a(n,[{key:"read",value:function(){var e;if(!this.fillValues())return this.readable=!1,null;if(this.condensed){var t=this.getCondensedValues(),n=t.values;e=t.indexMap[this.selector(n)]}else e=this.selector(this.values);var r=this.values[e];return this.values[e]=void 0,this.readable=!1,r}},{key:"close",value:function(){var e,t=r(this.sourceIterators);try{for(t.s();!(e=t.n()).done;){e.value.close()}}catch(i){t.e(i)}finally{t.f()}s(o(n.prototype),"close",this).call(this)}},{key:"fillValues",value:function(){var e=this;if(this.waitingForFill.every((function(e){return e})))return!1;if(this.values.every((function(e){return void 0!==e})))return!0;if(this.sourceIterators.every((function(e){return e.ended})))return!1;for(var t=0,n=function(){++t===e.sourceIterators.length&&(e.readable=!0)},r=0;r<this.sourceIterators.length;r++)this.sourceIterators[r].ended||void 0!==this.values[r]&&null!==this.values[r]?n():this.fillValue(r,n);return t===this.sourceIterators.length}},{key:"fillValue",value:function(e,t){var n=this.sourceIterators[e],r=n.read();r||!n.closed&&n.readable?(this.values[e]=r,t()):!this.waitingForFill[e]&&(this.waitingForFill[e]=!0,this.waitForValue(e,t))}},{key:"waitForValue",value:function(e,t){var n=this,r=this.sourceIterators[e];r.ended?t():r.once("readable",(function(){var i=r.read();null===i?n.waitForValue(e,t):(n.values[e]=i,n.waitingForFill[e]=!1,t())}))}},{key:"getCondensedValues",value:function(){var e=[],t=[];return this.values.forEach((function(n,r){void 0!==n&&null!==n&&(e.push(n),t.push(r))}),{}),{values:e,indexMap:t}}},{key:"addListeners",value:function(){var e,t=this,n=r(this.sourceIterators);try{for(n.s();!(e=n.n()).done;){e.value.on("end",(function(){t.sourceIterators.every((function(e){return e.ended}))&&t.close()}))}}catch(i){n.e(i)}finally{n.f()}}}]),n}(n(89).AsyncIterator);t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forwardsConnectionSelector=function(e){if(1===e.length)return 0;for(var t=0,n=e[t],r=1;r<e.length;r++){var i=e[r];(i.departureTime<n.departureTime||i.departureTime===n.departureTime&&i.arrivalTime<n.arrivalTime)&&(t=r,n=i)}return t},t.backwardsConnectionsSelector=function(e){if(1===e.length)return 0;for(var t=0,n=e[t],r=1;r<e.length;r++){var i=e[r];i.departureTime>n.departureTime&&(t=r,n=i)}return t}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Regular="http://vocab.gtfs.org/terms#Regular",e.NotAvailable="http://vocab.gtfs.org/terms#NotAvailable",e.MustPhone="http://vocab.gtfs.org/terms#MustPhone",e.MustCoordinateWithDriver="http://vocab.gtfs.org/terms#MustCoordinateWithDriver"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(200)),s=function(){function e(t,n){r(this,e),this.travelMode=t,this.steps=n}return i(e,[{key:"getExpectedDuration",value:function(){return this.getAverageDuration()||this.getMinimumDuration()||this.getMaximumDuration()}},{key:"getMinimumDuration",value:function(){return this.steps.reduce((function(e,t){return e+t.duration.minimum}),0)}},{key:"getAverageDuration",value:function(){return this.steps.reduce((function(e,t){return e+t.duration.average}),0)}},{key:"getMaximumDuration",value:function(){return this.steps.reduce((function(e,t){return e+t.duration.maximum}),0)}},{key:"getDistance",value:function(){return this.steps.reduce((function(e,t){return e+t.distance}),0)}},{key:"getTravelMode",value:function(){return this.travelMode}},{key:"getSteps",value:function(){return this.steps}},{key:"getStartTime",value:function(){if(this.steps.length>0)return this.steps[0].startTime}},{key:"getStopTime",value:function(){if(this.steps.length>0)return this.steps[this.steps.length-1].stopTime}},{key:"getStartLocation",value:function(){if(this.steps.length>0)return this.steps[0].startLocation}},{key:"getStopLocation",value:function(){if(this.steps.length>0)return this.steps[this.steps.length-1].stopLocation}}],[{key:"compareEquals",value:function(e,t){return e.getSteps().length===t.getSteps().length&&(t.getTravelMode()===e.getTravelMode()&&e.getSteps().every((function(e,n){var r=t.getSteps()[n];return o.default.compareEquals(e,r)})))}}]),e}();t.default=s},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(260),d=n(80),p=h(n(261)),v=h(n(262)),y=h(n(86)),g=h(n(87)),m=h(n(146)),b=h(n(81)),_=h(n(422)),w=h(n(423)),x=h(n(135)),T=h(n(424)),S=function(){function e(t,n,r){a(this,e),this.eventBus=y.default.getInstance(),this.locationResolver=t,this.publicTransportPlannerFactory=n,this.roadPlanner=r}return o(e,[{key:"run",value:function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveBaseQuery(t);case 2:if(!(n=e.sent).roadNetworkOnly){e.next=7;break}return e.abrupt("return",this.roadPlanner.plan(n));case 7:return i=new T.default(n,9e5),a=new w.default(i,this.runSubquery.bind(this)),e.abrupt("return",new _.default(a,m.default.compareEquals));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"runSubquery",value:function(e){this.eventBus.emit(g.default.SubQuery,e);var t=this.publicTransportPlannerFactory();return new f.PromiseProxyIterator((function(){return t.plan(e)}))}},{key:"resolveEndpoint",value:function(){var e=i(r.mark((function e(t){var n,i=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=7;break}return n=t.map((function(e){return i.locationResolver.resolve(e)})),e.next=4,Promise.all(n);case 4:return e.abrupt("return",e.sent);case 7:return e.next=9,this.locationResolver.resolve(t);case 9:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveBaseQuery",value:function(){var e=i(r.mark((function e(t){var n,i,a,o,s,u,c,h,f,d,y,g,m,b,_;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.minimumWalkingSpeed,i=t.maximumWalkingSpeed,a=t.walkingSpeed,o=t.maximumWalkingDuration,s=t.maximumWalkingDistance,u=t.minimumTransferDuration,c=t.maximumTransferDuration,h=t.maximumTransferDistance,f=t.maximumTransfers,d=t.minimumDepartureTime,y=t.excludedTravelModes,g=l(t,["minimumWalkingSpeed","maximumWalkingSpeed","walkingSpeed","maximumWalkingDuration","maximumWalkingDistance","minimumTransferDuration","maximumTransferDuration","maximumTransferDistance","maximumTransfers","minimumDepartureTime","excludedTravelModes"]),m=g.from,b=g.to,m=JSON.parse(JSON.stringify(m)),b=JSON.parse(JSON.stringify(b)),_=Object.assign({},g),y&&(_.excludedTravelModes=new Set(y)),_.minimumDepartureTime=d||new Date,e.prev=7,e.next=10,this.resolveEndpoint(m);case 10:return _.from=e.sent,e.next=13,this.resolveEndpoint(b);case 13:_.to=e.sent,e.next=19;break;case 16:return e.prev=16,e.t0=e.catch(7),e.abrupt("return",Promise.reject(new v.default(e.t0)));case 19:return _.minimumWalkingSpeed=n||a||p.default.defaultMinimumWalkingSpeed,_.maximumWalkingSpeed=i||a||p.default.defaultMaximumWalkingSpeed,_.maximumWalkingDuration=o||x.default.toDuration(s,_.minimumWalkingSpeed)||p.default.defaultWalkingDuration,_.minimumTransferDuration=u||p.default.defaultMinimumTransferDuration,_.maximumTransferDuration=c||x.default.toDuration(h,_.minimumWalkingSpeed)||p.default.defaultMaximumTransferDuration,_.maximumTransfers=f||p.default.defaultMaximumTransfers,e.abrupt("return",_);case 26:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();S=s([d.injectable(),c(0,d.inject(b.default.LocationResolver)),c(1,d.inject(b.default.PublicTransportPlannerFactory)),c(2,d.inject(b.default.RoadPlanner)),u("design:paramtypes",[Object,Function,Object])],S),t.default=S},function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function i(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}n.d(t,"a",(function(){return o}));var a=n(282);function o(e){return function(){var t,n=r(e);if(i()){var o=r(this).constructor;t=Reflect.construct(n,arguments,o)}else t=n.apply(this,arguments);return Object(a.a)(this,t)}}},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}n.d(t,"a",(function(){return i}))},,,function(e,t,n){"use strict";function r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,"a",(function(){return r}))},function(e,t,n){(function(e,t){var n;!function(n){!function(r){var i="object"===typeof t?t:"object"===typeof self?self:"object"===typeof this?this:Function("return this;")(),a=o(n);function o(e,t){return function(n,r){"function"!==typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}"undefined"===typeof i.Reflect?i.Reflect=n:a=o(i.Reflect,a),function(t){var n=Object.prototype.hasOwnProperty,r="function"===typeof Symbol,i=r&&"undefined"!==typeof Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",a=r&&"undefined"!==typeof Symbol.iterator?Symbol.iterator:"@@iterator",o="function"===typeof Object.create,s={__proto__:[]}instanceof Array,u=!o&&!s,c={create:o?function(){return C(Object.create(null))}:s?function(){return C({__proto__:null})}:function(){return C({})},has:u?function(e,t){return n.call(e,t)}:function(e,t){return t in e},get:u?function(e,t){return n.call(e,t)?e[t]:void 0}:function(e,t){return e[t]}},l=Object.getPrototypeOf(Function),h="object"===typeof e&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})&&"true"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).REFLECT_METADATA_USE_MAP_POLYFILL,f=h||"function"!==typeof Map||"function"!==typeof Map.prototype.entries?function(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[a]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,i)},t.prototype.entries=function(){return new n(this._keys,this._values,o)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[a]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}();function r(e,t){return e}function i(e,t){return t}function o(e,t){return[e,t]}}():Map,d=h||"function"!==typeof Set||"function"!==typeof Set.prototype.entries?function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[a]=function(){return this.keys()},e}():Set,p=new(h||"function"!==typeof WeakMap?function(){var e=c.create(),t=r();return function(){function e(){this._key=r()}return e.prototype.has=function(e){var t=i(e,!1);return void 0!==t&&c.has(t,this._key)},e.prototype.get=function(e){var t=i(e,!1);return void 0!==t?c.get(t,this._key):void 0},e.prototype.set=function(e,t){return i(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=i(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=r()},e}();function r(){var t;do{t="@@WeakMap@@"+o()}while(c.has(e,t));return e[t]=!0,t}function i(e,r){if(!n.call(e,t)){if(!r)return;Object.defineProperty(e,t,{value:c.create()})}return e[t]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function o(){var e,t=(e=16,"function"===typeof Uint8Array?"undefined"!==typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!==typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e));t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<16;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}}():WeakMap);function v(e,t,n){var r=p.get(e);if(w(r)){if(!n)return;r=new f,p.set(e,r)}var i=r.get(t);if(w(i)){if(!n)return;i=new f,r.set(t,i)}return i}function y(e,t,n){var r=v(t,n,!1);return!w(r)&&!!r.has(e)}function g(e,t,n){var r=v(t,n,!1);if(!w(r))return r.get(e)}function m(e,t,n,r){v(n,r,!0).set(e,t)}function b(e,t){var n=[],r=v(e,t,!1);if(w(r))return n;for(var i=function(e){var t=j(e,a);if(!P(t))throw new TypeError;var n=t.call(e);if(!T(n))throw new TypeError;return n}(r.keys()),o=0;;){var s=O(i);if(!s)return n.length=o,n;var u=s.value;try{n[o]=u}catch(c){try{R(i)}finally{throw c}}o++}}function _(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function w(e){return void 0===e}function x(e){return null===e}function T(e){return"object"===typeof e?null!==e:"function"===typeof e}function S(e,t){switch(_(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",r=j(e,i);if(void 0!==r){var a=r.call(e,n);if(T(a))throw new TypeError;return a}return function(e,t){if("string"===t){var n=e.toString;if(P(n))if(!T(i=n.call(e)))return i;if(P(r=e.valueOf))if(!T(i=r.call(e)))return i}else{var r;if(P(r=e.valueOf))if(!T(i=r.call(e)))return i;var i,a=e.toString;if(P(a))if(!T(i=a.call(e)))return i}throw new TypeError}(e,"default"===n?"number":n)}function k(e){var t=S(e,3);return"symbol"===typeof t?t:function(e){return""+e}(t)}function M(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function P(e){return"function"===typeof e}function I(e){return"function"===typeof e}function j(e,t){var n=e[t];if(void 0!==n&&null!==n){if(!P(n))throw new TypeError;return n}}function O(e){var t=e.next();return!t.done&&t}function R(e){var t=e.return;t&&t.call(e)}function N(e){var t=Object.getPrototypeOf(e);if("function"!==typeof e||e===l)return t;if(t!==l)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!==typeof i||i===e?t:i}function C(e){return e.__=void 0,delete e.__,e}t("decorate",(function(e,t,n,r){if(w(n)){if(!M(e))throw new TypeError;if(!I(t))throw new TypeError;return function(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!w(r)&&!x(r)){if(!I(r))throw new TypeError;t=r}}return t}(e,t)}if(!M(e))throw new TypeError;if(!T(t))throw new TypeError;if(!T(r)&&!w(r)&&!x(r))throw new TypeError;return x(r)&&(r=void 0),function(e,t,n,r){for(var i=e.length-1;i>=0;--i){var a=(0,e[i])(t,n,r);if(!w(a)&&!x(a)){if(!T(a))throw new TypeError;r=a}}return r}(e,t,n=k(n),r)})),t("metadata",(function(e,t){return function(n,r){if(!T(n))throw new TypeError;if(!w(r)&&!function(e){switch(_(e)){case 3:case 4:return!0;default:return!1}}(r))throw new TypeError;m(e,t,n,r)}})),t("defineMetadata",(function(e,t,n,r){if(!T(n))throw new TypeError;return w(r)||(r=k(r)),m(e,t,n,r)})),t("hasMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return w(n)||(n=k(n)),function e(t,n,r){if(y(t,n,r))return!0;var i=N(n);return!x(i)&&e(t,i,r)}(e,t,n)})),t("hasOwnMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return w(n)||(n=k(n)),y(e,t,n)})),t("getMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return w(n)||(n=k(n)),function e(t,n,r){if(y(t,n,r))return g(t,n,r);var i=N(n);return x(i)?void 0:e(t,i,r)}(e,t,n)})),t("getOwnMetadata",(function(e,t,n){if(!T(t))throw new TypeError;return w(n)||(n=k(n)),g(e,t,n)})),t("getMetadataKeys",(function(e,t){if(!T(e))throw new TypeError;return w(t)||(t=k(t)),function e(t,n){var r=b(t,n),i=N(t);if(null===i)return r;var a=e(i,n);if(a.length<=0)return r;if(r.length<=0)return a;for(var o=new d,s=[],u=0,c=r;u<c.length;u++){var l=c[u];o.has(l)||(o.add(l),s.push(l))}for(var h=0,f=a;h<f.length;h++){l=f[h];o.has(l)||(o.add(l),s.push(l))}return s}(e,t)})),t("getOwnMetadataKeys",(function(e,t){if(!T(e))throw new TypeError;return w(t)||(t=k(t)),b(e,t)})),t("deleteMetadata",(function(e,t,n){if(!T(t))throw new TypeError;w(n)||(n=k(n));var r=v(t,n,!1);if(w(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=p.get(t);return i.delete(n),i.size>0||p.delete(t),!0}))}(a)}()}(n||(n={}))}).call(this,n(95),n(40))},function(e,t,n){var r=n(224);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t,n){"use strict";(function(t){"undefined"===typeof t||!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports={nextTick:function(e,n,r,i){if("function"!==typeof e)throw new TypeError('"callback" argument must be a function');var a,o,s=arguments.length;switch(s){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick((function(){e.call(null,n)}));case 3:return t.nextTick((function(){e.call(null,n,r)}));case 4:return t.nextTick((function(){e.call(null,n,r,i)}));default:for(a=new Array(s-1),o=0;o<a.length;)a[o++]=arguments[o];return t.nextTick((function(){e.apply(null,a)}))}}}:e.exports=t}).call(this,n(95))},function(e,t,n){var r=n(103),i=n(181),a=n(367),o=n(368);function s(t){var n="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!a(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return o(e,arguments,r(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},s(t)}e.exports=s},function(e,t,n){"use strict";var r=n(82),i=n(144).isKeyword,a=n(116),o=n(104),s=n(97),u=n(107),c={};e.exports=c,c.createMergedNodeMap=function(e,t){var n=(t=t||{}).issuer||new s.IdentifierIssuer("_:b"),r={"@default":{}};return c.createNodeMap(e,r,"@default",n),c.mergeNodeMaps(r)},c.createNodeMap=function(e,t,n,l,h,f){if(o.isArray(e)){var d,p=r(e);try{for(p.s();!(d=p.n()).done;){var v=d.value;c.createNodeMap(v,t,n,l,void 0,f)}}catch(G){p.e(G)}finally{p.f()}}else if(o.isObject(e))if(a.isValue(e)){if("@type"in e){var y=e["@type"];0===y.indexOf("_:")&&(e["@type"]=y=l.getId(y))}f&&f.push(e)}else{if(f&&a.isList(e)){var g=[];return c.createNodeMap(e["@list"],t,n,l,h,g),void f.push({"@list":g})}if("@type"in e){var m,b=e["@type"],_=r(b);try{for(_.s();!(m=_.n()).done;){var w=m.value;0===w.indexOf("_:")&&l.getId(w)}}catch(G){_.e(G)}finally{_.f()}}o.isUndefined(h)&&(h=a.isBlankNode(e)?l.getId(e["@id"]):e["@id"]),f&&f.push({"@id":h});var x=t[n],T=x[h]=x[h]||{};T["@id"]=h;var S,k=Object.keys(e).sort(),M=r(k);try{for(M.s();!(S=M.n()).done;){var P=S.value;if("@id"!==P)if("@reverse"!==P)if("@graph"!==P)if("@type"!==P&&i(P)){if("@index"===P&&P in T&&(e[P]!==T[P]||e[P]["@id"]!==T[P]["@id"]))throw new u("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:T});T[P]=e[P]}else{var I=e[P];if(0===P.indexOf("_:")&&(P=l.getId(P)),0!==I.length){var j,O=r(I);try{for(O.s();!(j=O.n()).done;){var R=j.value;if("@type"===P&&(R=0===R.indexOf("_:")?l.getId(R):R),a.isSubject(R)||a.isSubjectReference(R)){var N=a.isBlankNode(R)?l.getId(R["@id"]):R["@id"];s.addValue(T,P,{"@id":N},{propertyIsArray:!0,allowDuplicate:!1}),c.createNodeMap(R,t,n,l,N)}else if(a.isValue(R))s.addValue(T,P,R,{propertyIsArray:!0,allowDuplicate:!1});else if(a.isList(R)){var C=[];c.createNodeMap(R["@list"],t,n,l,h,C),R={"@list":C},s.addValue(T,P,R,{propertyIsArray:!0,allowDuplicate:!1})}else c.createNodeMap(R,t,n,l,h),s.addValue(T,P,R,{propertyIsArray:!0,allowDuplicate:!1})}}catch(G){O.e(G)}finally{O.f()}}else s.addValue(T,P,[],{propertyIsArray:!0})}else h in t||(t[h]={}),c.createNodeMap(e[P],t,h,l);else{var A={"@id":h},E=e["@reverse"];for(var D in E){var L,B=E[D],F=r(B);try{for(F.s();!(L=F.n()).done;){var U=L.value,q=U["@id"];a.isBlankNode(U)&&(q=l.getId(q)),c.createNodeMap(U,t,n,l,q),s.addValue(x[q],D,A,{propertyIsArray:!0,allowDuplicate:!1})}}catch(G){F.e(G)}finally{F.f()}}}}}catch(G){M.e(G)}finally{M.f()}}else f&&f.push(e)},c.mergeNodeMapGraphs=function(e){var t,n={},a=r(Object.keys(e).sort());try{for(a.s();!(t=a.n()).done;){var o,u=t.value,c=r(Object.keys(e[u]).sort());try{for(c.s();!(o=c.n()).done;){var l=o.value,h=e[u][l];l in n||(n[l]={"@id":l});var f,d=n[l],p=r(Object.keys(h).sort());try{for(p.s();!(f=p.n()).done;){var v=f.value;if(i(v))d[v]=s.clone(h[v]);else{var y,g=r(h[v]);try{for(g.s();!(y=g.n()).done;){var m=y.value;s.addValue(d,v,s.clone(m),{propertyIsArray:!0,allowDuplicate:!1})}}catch(b){g.e(b)}finally{g.f()}}}}catch(b){p.e(b)}finally{p.f()}}}catch(b){c.e(b)}finally{c.f()}}}catch(b){a.e(b)}finally{a.f()}return n},c.mergeNodeMaps=function(e){var t,n=e["@default"],i=Object.keys(e).sort(),o=r(i);try{for(o.s();!(t=o.n()).done;){var s=t.value;if("@default"!==s){var u=e[s],c=n[s];c?"@graph"in c||(c["@graph"]=[]):n[s]=c={"@id":s,"@graph":[]};var l,h=c["@graph"],f=r(Object.keys(u).sort());try{for(f.s();!(l=f.n()).done;){var d=u[l.value];a.isSubjectReference(d)||h.push(d)}}catch(p){f.e(p)}finally{f.f()}}}}catch(p){o.e(p)}finally{o.f()}return n}},function(e,t){function n(e,t){var n=Math.pow(2,t);return Math.floor((e+180)/360*n)}function r(e,t){var n=e*Math.PI/180,r=Math.pow(2,t);return Math.floor((1-Math.log(Math.tan(n)+1/Math.cos(n))/Math.PI)/2*r)}t.tilesInBbox=function(e,t){for(var i=[],a=n(e.left,t),o=n(e.right,t),s=r(e.top,t),u=r(e.bottom,t),c=a;c<=o;){for(var l=s;l<=u;)i.push({x:c,y:l,z:t}),l++;c++}return i}},function(e,t,n){"use strict";var r,i=n(85),a=n(78),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(128)),v=n(254),y=f(n(113)),g=n(94),m=n(404),b=f(n(81)),_=n(108),w=f(n(105)),x=n(139),T=function(){function e(t){s(this,e),this.ldFetch=t,this.ldLoader=new g.LDLoader,this.paths={}}return u(e,[{key:"get",value:function(){var e=o(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForLocation(12,t),this.paths[n]||(this.paths[n]=this.getByUrl(n)),e.abrupt("return",this.paths[n]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdForLocation",value:function(e,t){var n=x.lat_to_tile(t.latitude,e),r=x.long_to_tile(t.longitude,e),i=new y.default(e,r,n);return this.getIdForTileCoords(i)}},{key:"getIdForTileCoords",value:function(e){return"https://hdelva.be/stops/distances/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}},{key:"getByLocation",value:function(e,t){var n=x.lat_to_tile(t.latitude,e),r=x.long_to_tile(t.longitude,e),i=new y.default(e,r,n);return this.getByTileCoords(i)}},{key:"getByTileCoords",value:function(){var e=o(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForTileCoords(t),e.next=3,this.getByUrl(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getByUrl",value:function(){var e=o(a.mark((function e(t){var n,r,o,s,u;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ldFetch.get(t);case 2:return n=e.sent,r=n.triples,o=this.ldLoader.process(r,[this.getPathsView()]),s=i(o,1),u=s[0],e.abrupt("return",u);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPathsView",value:function(){var e=new m.IndexThingView(v.Footpath.create);return e.addMapping(w.default.inNS(_.PLANNER,"source"),"from"),e.addMapping(w.default.inNS(_.PLANNER,"destination"),"to"),e.addMapping(w.default.inNS(_.PLANNER,"distance"),"distance"),e}}]),e}();T=c([d.injectable(),h(0,d.inject(b.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.default&&p.default)?r:Object])],T),t.default=T},function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return a}));var r=n(91),i=n(92),a=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;if(Object(r.a)(this,e),this.data=t,this.length=this.data.length,this.compare=n,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)}return Object(i.a)(e,[{key:"push",value:function(e){this.data.push(e),this.length++,this._up(this.length-1)}},{key:"pop",value:function(){if(0!==this.length){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}}},{key:"peek",value:function(){return this.data[0]}},{key:"_up",value:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var i=e-1>>1,a=t[i];if(n(r,a)>=0)break;t[e]=a,e=i}t[e]=r}},{key:"_down",value:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,i=t[e];e<r;){var a=1+(e<<1),o=t[a],s=a+1;if(s<this.length&&n(t[s],o)<0&&(a=s,o=t[s]),n(o,i)>=0)break;t[e]=o,e=a}t[e]=i}}]),e}();function o(e,t){return e<t?-1:e>t?1:0}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Regular="http://vocab.gtfs.org/terms#Regular",e.NotAvailable="http://vocab.gtfs.org/terms#NotAvailable",e.MustPhone="http://vocab.gtfs.org/terms#MustPhone",e.MustCoordinateWithDriver="http://vocab.gtfs.org/terms#MustCoordinateWithDriver"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Source="source",e.Target="target"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),s=n(439),u=function(){function e(){r(this,e)}return i(e,[{key:"createInstance",value:function(e,t){return new s.MixedDijkstraInstance(e,t)}}]),e}();u=a([o.injectable()],u),t.default=u},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__rest||function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(80),d=h(n(261)),p=h(n(262)),v=h(n(81)),y=h(n(135)),g=function(){function e(t,n,r){a(this,e),this.locationResolver=t,this.publicTransportPlanner=n,this.roadPlanner=r}return o(e,[{key:"run",value:function(){var e=i(r.mark((function e(t){var n;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.resolveQuery(t);case 2:if(!(n=e.sent).roadNetworkOnly){e.next=7;break}return e.abrupt("return",this.roadPlanner.plan(n));case 7:return e.abrupt("return",this.publicTransportPlanner.plan(n));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveEndpoint",value:function(){var e=i(r.mark((function e(t){var n,i=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=7;break}return n=t.map((function(e){return i.locationResolver.resolve(e)})),e.next=4,Promise.all(n);case 4:return e.abrupt("return",e.sent);case 7:return e.next=9,this.locationResolver.resolve(t);case 9:return e.t0=e.sent,e.abrupt("return",[e.t0]);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveQuery",value:function(){var e=i(r.mark((function e(t){var n,i,a,o,s,u,c,h,f,v,g,m,b,_,w,x,T;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.minimumWalkingSpeed,i=t.maximumWalkingSpeed,a=t.walkingSpeed,o=t.maximumWalkingDuration,s=t.maximumWalkingDistance,u=t.minimumTransferDuration,c=t.maximumTransferDuration,h=t.maximumTransferDistance,f=t.maximumTransfers,v=t.minimumDepartureTime,g=t.maximumArrivalTime,m=t.excludedTravelModes,b=l(t,["minimumWalkingSpeed","maximumWalkingSpeed","walkingSpeed","maximumWalkingDuration","maximumWalkingDistance","minimumTransferDuration","maximumTransferDuration","maximumTransferDistance","maximumTransfers","minimumDepartureTime","maximumArrivalTime","excludedTravelModes"]),_=b.from,w=b.to,_=JSON.parse(JSON.stringify(_)),w=JSON.parse(JSON.stringify(w)),x=Object.assign({},b),m&&(x.excludedTravelModes=new Set(m)),x.minimumDepartureTime=v||new Date,g?x.maximumArrivalTime=g:(T=x.minimumDepartureTime,x.maximumArrivalTime=new Date(T.getTime()+432e5)),e.prev=8,e.next=11,this.resolveEndpoint(_);case 11:return x.from=e.sent,e.next=14,this.resolveEndpoint(w);case 14:x.to=e.sent,e.next=20;break;case 17:return e.prev=17,e.t0=e.catch(8),e.abrupt("return",Promise.reject(new p.default(e.t0)));case 20:return x.minimumWalkingSpeed=n||a||d.default.defaultMinimumWalkingSpeed,x.maximumWalkingSpeed=i||a||d.default.defaultMaximumWalkingSpeed,x.maximumWalkingDuration=o||y.default.toDuration(s,x.minimumWalkingSpeed)||d.default.defaultWalkingDuration,x.minimumTransferDuration=u||d.default.defaultMinimumTransferDuration,x.maximumTransferDuration=c||y.default.toDuration(h,x.minimumWalkingSpeed)||d.default.defaultMaximumTransferDuration,x.maximumTransfers=f||d.default.defaultMaximumTransfers,e.abrupt("return",x);case 27:case"end":return e.stop()}}),e,this,[[8,17]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();g=s([f.injectable(),c(0,f.inject(v.default.LocationResolver)),c(1,f.inject(v.default.PublicTransportPlanner)),c(2,f.inject(v.default.RoadPlanner)),u("design:paramtypes",[Object,Object,Object])],g),t.default=g},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});var u=n(80),c=function(){function e(){a(this,e)}return o(e,[{key:"findReachableStops",value:function(){var e=i(r.mark((function e(t,n,i,a){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[{stop:t,duration:0}]);case 1:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}()}]),e}();c=s([u.injectable()],c),t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(180),i=function(){function e(e){this._binding=e}return e.prototype.onActivation=function(e){return this._binding.onActivation=e,new r.BindingWhenSyntax(this._binding)},e}();t.BindingOnSyntax=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(179),i=n(223),a=function(){function e(e){this._binding=e}return e.prototype.when=function(e){return this._binding.constraint=e,new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetNamed=function(e){return this._binding.constraint=i.namedConstraint(e),new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetIsDefault=function(){return this._binding.constraint=function(e){return null!==e.target&&!e.target.isNamed()&&!e.target.isTagged()},new r.BindingOnSyntax(this._binding)},e.prototype.whenTargetTagged=function(e,t){return this._binding.constraint=i.taggedConstraint(e)(t),new r.BindingOnSyntax(this._binding)},e.prototype.whenInjectedInto=function(e){return this._binding.constraint=function(t){return i.typeConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentNamed=function(e){return this._binding.constraint=function(t){return i.namedConstraint(e)(t.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenParentTagged=function(e,t){return this._binding.constraint=function(n){return i.taggedConstraint(e)(t)(n.parentRequest)},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorIs=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorIs=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.typeConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorNamed=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorNamed=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,i.namedConstraint(e))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._binding.constraint=function(n){return i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorTagged=function(e,t){return this._binding.constraint=function(n){return!i.traverseAncerstors(n,i.taggedConstraint(e)(t))},new r.BindingOnSyntax(this._binding)},e.prototype.whenAnyAncestorMatches=function(e){return this._binding.constraint=function(t){return i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e.prototype.whenNoAncestorMatches=function(e){return this._binding.constraint=function(t){return!i.traverseAncerstors(t,e)},new r.BindingOnSyntax(this._binding)},e}();t.BindingWhenSyntax=a},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(115),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),a(i,o),o.from=function(e,t,n){if("number"===typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!==typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"===typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";(function(t,r,i){var a=n(168);function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=m;var s,u=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?r:a.nextTick;m.WritableState=g;var c=Object.create(n(150));c.inherits=n(129);var l={deprecate:n(336)},h=n(238),f=n(182).Buffer,d=i.Uint8Array||function(){};var p,v=n(239);function y(){}function g(e,t){s=s||n(142),e=e||{};var r=t instanceof s;this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var i=e.highWaterMark,c=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var h=!1===e.decodeStrings;this.decodeStrings=!h,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,i=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,i){--t.pendingcb,n?(a.nextTick(i,r),a.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",r)):(i(r),e._writableState.errorEmitted=!0,e.emit("error",r),S(e,t))}(e,n,r,t,i);else{var o=x(n);o||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),r?u(_,e,n,o,i):_(e,n,o,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function m(e){if(s=s||n(142),!p.call(m,this)&&!(this instanceof s))return new m(e);this._writableState=new g(e,this),this.writable=!0,e&&("function"===typeof e.write&&(this._write=e.write),"function"===typeof e.writev&&(this._writev=e.writev),"function"===typeof e.destroy&&(this._destroy=e.destroy),"function"===typeof e.final&&(this._final=e.final)),h.call(this)}function b(e,t,n,r,i,a,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,a,t.onwrite),t.sync=!1}function _(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),S(e,t)}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,b(e,t,!0,t.length,i,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new o(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,h=n.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,l,h),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function x(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function T(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),S(e,t)}))}function S(e,t){var n=x(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"===typeof e._final?(t.pendingcb++,t.finalCalled=!0,a.nextTick(T,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}c.inherits(m,h),g.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(g.prototype,"buffer",{get:l.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(p=Function.prototype[Symbol.hasInstance],Object.defineProperty(m,Symbol.hasInstance,{value:function(e){return!!p.call(this,e)||this===m&&(e&&e._writableState instanceof g)}})):p=function(e){return e instanceof this},m.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},m.prototype.write=function(e,t,n){var r,i=this._writableState,o=!1,s=!i.objectMode&&(r=e,f.isBuffer(r)||r instanceof d);return s&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"===typeof t&&(n=t,t=null),s?t="buffer":t||(t=i.defaultEncoding),"function"!==typeof n&&(n=y),i.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),a.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var i=!0,o=!1;return null===n?o=new TypeError("May not write null values to stream"):"string"===typeof n||void 0===n||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),a.nextTick(r,o),i=!1),i}(this,i,e,n))&&(i.pendingcb++,o=function(e,t,n,r,i,a){if(!n){var o=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!==typeof t||(t=f.from(t,n));return t}(t,r,i);r!==o&&(n=!0,i="buffer",r=o)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:a,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,s,r,i,a);return u}(this,i,s,e,t,n)),o},m.prototype.cork=function(){this._writableState.corked++},m.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},m.prototype.setDefaultEncoding=function(e){if("string"===typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(m.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),m.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},m.prototype._writev=null,m.prototype.end=function(e,t,n){var r=this._writableState;"function"===typeof e?(n=e,e=null,t=null):"function"===typeof t&&(n=t,t=null),null!==e&&void 0!==e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||function(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?a.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n)},Object.defineProperty(m.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),m.prototype.destroy=v.destroy,m.prototype._undestroy=v.undestroy,m.prototype._destroy=function(e,t){this.end(),t(e)}}).call(this,n(95),n(140).setImmediate,n(40))},function(e,t,n){"use strict";var r=n(342),i=n(344);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=b(e));return e instanceof a?e.format():a.prototype.format.call(e)},t.Url=a;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(c),h=["%","/","?",";","#"].concat(l),f=["/","?","#"],d=/^[+a-z0-9A-Z_-]{0,63}$/,p=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},m=n(345);function b(e,t,n){if(e&&i.isObject(e)&&e instanceof a)return e;var r=new a;return r.parse(e,t,n),r}a.prototype.parse=function(e,t,n){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),s=-1!==a&&a<e.indexOf("#")?"?":"#",c=e.split(s);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(s);if(b=b.trim(),!n&&1===e.split("#").length){var _=u.exec(b);if(_)return this.path=b,this.href=b,this.pathname=_[1],_[2]?(this.search=_[2],this.query=t?m.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var w=o.exec(b);if(w){var x=(w=w[0]).toLowerCase();this.protocol=x,b=b.substr(w.length)}if(n||w||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var T="//"===b.substr(0,2);!T||w&&y[w]||(b=b.substr(2),this.slashes=!0)}if(!y[w]&&(T||w&&!g[w])){for(var S,k,M=-1,P=0;P<f.length;P++){-1!==(I=b.indexOf(f[P]))&&(-1===M||I<M)&&(M=I)}-1!==(k=-1===M?b.lastIndexOf("@"):b.lastIndexOf("@",M))&&(S=b.slice(0,k),b=b.slice(k+1),this.auth=decodeURIComponent(S)),M=-1;for(P=0;P<h.length;P++){var I;-1!==(I=b.indexOf(h[P]))&&(-1===M||I<M)&&(M=I)}-1===M&&(M=b.length),this.host=b.slice(0,M),b=b.slice(M),this.parseHost(),this.hostname=this.hostname||"";var j="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!j)for(var O=this.hostname.split(/\./),R=(P=0,O.length);P<R;P++){var N=O[P];if(N&&!N.match(d)){for(var C="",A=0,E=N.length;A<E;A++)N.charCodeAt(A)>127?C+="x":C+=N[A];if(!C.match(d)){var D=O.slice(0,P),L=O.slice(P+1),B=N.match(p);B&&(D.push(B[1]),L.unshift(B[2])),L.length&&(b="/"+L.join(".")+b),this.hostname=D.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),j||(this.hostname=r.toASCII(this.hostname));var F=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+F,this.href+=this.host,j&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!v[x])for(P=0,R=l.length;P<R;P++){var q=l[P];if(-1!==b.indexOf(q)){var G=encodeURIComponent(q);G===q&&(G=escape(q)),b=b.split(q).join(G)}}var z=b.indexOf("#");-1!==z&&(this.hash=b.substr(z),b=b.slice(0,z));var W=b.indexOf("?");if(-1!==W?(this.search=b.substr(W),this.query=b.substr(W+1),t&&(this.query=m.parse(this.query)),b=b.slice(0,W)):t&&(this.search="",this.query={}),b&&(this.pathname=b),g[x]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){F=this.pathname||"";var V=this.search||"";this.path=F+V}return this.href=this.format(),this},a.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",r=this.hash||"",a=!1,o="";this.host?a=e+this.host:this.hostname&&(a=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(o=m.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==a?(a="//"+(a||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):a||(a=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),t+a+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(s=s.replace("#","%23"))+r},a.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},a.prototype.resolveObject=function(e){if(i.isString(e)){var t=new a;t.parse(e,!1,!0),e=t}for(var n=new a,r=Object.keys(this),o=0;o<r.length;o++){var s=r[o];n[s]=this[s]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),c=0;c<u.length;c++){var l=u[c];"protocol"!==l&&(n[l]=e[l])}return g[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!g[e.protocol]){for(var h=Object.keys(e),f=0;f<h.length;f++){var d=h[f];n[d]=e[d]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||y[e.protocol])n.pathname=e.pathname;else{for(var p=(e.pathname||"").split("/");p.length&&!(e.host=p.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==p[0]&&p.unshift(""),p.length<2&&p.unshift(""),n.pathname=p.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var v=n.pathname||"",m=n.search||"";n.path=v+m}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var b=n.pathname&&"/"===n.pathname.charAt(0),_=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=_||b||n.host&&e.pathname,x=w,T=n.pathname&&n.pathname.split("/")||[],S=(p=e.pathname&&e.pathname.split("/")||[],n.protocol&&!g[n.protocol]);if(S&&(n.hostname="",n.port=null,n.host&&(""===T[0]?T[0]=n.host:T.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===p[0]?p[0]=e.host:p.unshift(e.host)),e.host=null),w=w&&(""===p[0]||""===T[0])),_)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,T=p;else if(p.length)T||(T=[]),T.pop(),T=T.concat(p),n.search=e.search,n.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(S)n.hostname=n.host=T.shift(),(j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=j.shift(),n.host=n.hostname=j.shift());return n.search=e.search,n.query=e.query,i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!T.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=T.slice(-1)[0],M=(n.host||e.host||T.length>1)&&("."===k||".."===k)||""===k,P=0,I=T.length;I>=0;I--)"."===(k=T[I])?T.splice(I,1):".."===k?(T.splice(I,1),P++):P&&(T.splice(I,1),P--);if(!w&&!x)for(;P--;P)T.unshift("..");!w||""===T[0]||T[0]&&"/"===T[0].charAt(0)||T.unshift(""),M&&"/"!==T.join("/").substr(-1)&&T.push("");var j,O=""===T[0]||T[0]&&"/"===T[0].charAt(0);S&&(n.hostname=n.host=O?"":T.length?T.shift():"",(j=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=j.shift(),n.host=n.hostname=j.shift()));return(w=w||n.host&&T.length)&&!O&&T.unshift(""),T.length?n.pathname=T.join("/"):(n.pathname=null,n.path=null),i.isNull(n.pathname)&&i.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},a.prototype.parseHost=function(){var e=this.host,t=s.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return d}));var i=n(91),a=n(92),o=n(151).a.xsd,s=String.fromCharCode,u=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\[uU]|\\(.)/g,c={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},l=/[\x00-\x20<>\\"\{\}\|\^\`]/,h={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},f=/$0^/,d=function(){function t(e){if(Object(i.a)(this,t),this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<]))/,this._number=/^[\-+]?(?:\d+\.?\d*([eE](?:[\-\+])?\d+)|\d*\.?\d+)(?=\.?[,;:\s#()\[\]\{\}"'<])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s()\[\]\{\}"'<])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._lineMode=!!e.lineMode)for(var n in this._n3Mode=!1,this)!(n in h)&&this[n]instanceof RegExp&&(this[n]=f);else this._n3Mode=!1!==e.n3;this._comments=!!e.comments,this._literalClosingPos=0}return Object(a.a)(t,[{key:"_tokenizeToEnd",value:function(e,t){for(var n=this._input,r=this._comments;;){for(var i,a;i=this._newline.exec(n);)r&&(a=this._comment.exec(i[0]))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),n=n.substr(i[0].length,n.length),this._line++;if(!i&&(i=this._whitespace.exec(n))&&(n=n.substr(i[0].length,n.length)),this._endOfFile.test(n))return t&&(r&&(a=this._comment.exec(n))&&e(null,{line:this._line,type:"comment",value:a[1],prefix:""}),e(n=null,{line:this._line,type:"eof",value:"",prefix:""})),this._input=n;var s=this._line,u="",c="",h="",f=n[0],d=null,p=0,v=!1;switch(f){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(p=1,u="^");break}if(this._previousMarker="^^","<"!==(n=n.substr(2))[0]){v=!0;break}case"<":if(d=this._unescapedIri.exec(n))u="IRI",c=d[1];else if(d=this._iri.exec(n)){if(null===(c=this._unescape(d[1]))||l.test(c))return b(this);u="IRI"}else this._n3Mode&&n.length>1&&"="===n[1]&&(u="inverse",p=2,c=">");break;case"_":((d=this._blank.exec(n))||t&&(d=this._blank.exec(n+" ")))&&(u="blank",h="_",c=d[1]);break;case'"':if(d=this._simpleQuotedString.exec(n))c=d[1];else{var y=this._parseLiteral(n);if(c=y.value,p=y.matchLength,null===c)return b(this)}null===d&&0===p||(u="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(d=this._simpleApostropheString.exec(n))c=d[1];else{var g=this._parseLiteral(n);if(c=g.value,p=g.matchLength,null===c)return b(this)}null===d&&0===p||(u="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(d=this._variable.exec(n))&&(u="var",c=d[0]);break;case"@":"literal"===this._previousMarker&&(d=this._langcode.exec(n))?(u="langcode",c=d[1]):(d=this._keyword.exec(n))&&(u=d[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){u=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(d=this._number.exec(n)||t&&(d=this._number.exec(n+" ")))&&(u="literal",c=d[0],h=d[1]?o.double:/^[+\-]?\d+$/.test(d[0])?o.integer:o.decimal);break;case"B":case"b":case"p":case"P":case"G":case"g":(d=this._sparqlKeyword.exec(n))?u=d[0].toUpperCase():v=!0;break;case"f":case"t":(d=this._boolean.exec(n))?(u="literal",c=d[0],h=o.boolean):v=!0;break;case"a":(d=this._shortPredicates.exec(n))?(u="abbreviation",c="a"):v=!0;break;case"=":this._n3Mode&&n.length>1&&(u="abbreviation",">"!==n[1]?(p=1,c="="):(p=2,c=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"{":case"}":this._lineMode||(p=1,u=f);break;default:v=!0}if(v&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(d=this._prefix.exec(n))?((d=this._prefixed.exec(n))||t&&(d=this._prefixed.exec(n+" ")))&&(u="prefixed",h=d[1]||"",c=this._unescape(d[2])):(u="prefix",c=d[1]||"")),"^^"===this._previousMarker)switch(u){case"prefixed":u="type";break;case"IRI":u="typeIRI";break;default:u=""}if(!u)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?b(this):this._input=n;var m={line:s,type:u,value:c,prefix:h};e(null,m),this.previousToken=m,this._previousMarker=u,n=n.substr(p||d[0].length,n.length)}function b(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}}},{key:"_unescape",value:function(e){try{return e.replace(u,(function(e,t,n,r){var i;if(t){if(i=parseInt(t,16),isNaN(i))throw new Error;return s(i)}if(n){if(i=parseInt(n,16),isNaN(i))throw new Error;return i<=65535?s(i):s(55296+(i-=65536)/1024,56320+(1023&i))}var a=c[r];if(!a)throw new Error;return a}))}catch(t){return null}}},{key:"_parseLiteral",value:function(e){if(e.length>=3){for(var t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length,r=Math.max(this._literalClosingPos,n);(r=e.indexOf(t,r))>0;){for(var i=0;"\\"===e[r-i-1];)i++;if(i%2===0){var a=e.substring(n,r),o=a.split(/\r\n|\r|\n/).length-1,s=r+n;if(1===n&&0!==o||3===n&&this._lineMode)break;return this._line+=o,{value:this._unescape(a),matchLength:s}}r++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}},{key:"_syntaxError",value:function(e){this._input=null;var t=new Error('Unexpected "'+e+'" on line '+this._line+".");return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}},{key:"tokenize",value:function(t,n){var i=this;if(this._line=1,"string"===typeof t){if(this._input=t,"function"!==typeof n){var a,o=[];if(this._tokenizeToEnd((function(e,t){e?a=e:o.push(t)}),!0),a)throw a;return o}e((function(){i._tokenizeToEnd(n,!0)}))}else this._input="",this._pendingBuffer=null,"function"===typeof t.setEncoding&&t.setEncoding("utf8"),t.on("data",(function(e){null!==i._input&&0!==e.length&&(i._pendingBuffer&&(e=r.concat([i._pendingBuffer,e]),i._pendingBuffer=null),128&e[e.length-1]?i._pendingBuffer=e:(i._input+=e,i._tokenizeToEnd(n,!1)))})),t.on("end",(function(){null!==i._input&&i._tokenizeToEnd(n,!0)})),t.on("error",n)}}]),t}()}).call(this,n(140).setImmediate,n(115).Buffer)},function(e,t,n){e.exports=i;var r=n(141).EventEmitter;function i(){r.call(this)}n(129)(i,r),i.Readable=n(149),i.Writable=n(349),i.Duplex=n(350),i.Transform=n(351),i.PassThrough=n(352),i.Stream=i,i.prototype.pipe=function(e,t){var n=this;function i(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",i),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",s),n.on("close",u));var o=!1;function s(){o||(o=!0,e.end())}function u(){o||(o=!0,"function"===typeof e.destroy&&e.destroy())}function c(e){if(l(),0===r.listenerCount(this,"error"))throw e}function l(){n.removeListener("data",i),e.removeListener("drain",a),n.removeListener("end",s),n.removeListener("close",u),n.removeListener("error",c),e.removeListener("error",c),n.removeListener("end",l),n.removeListener("close",l),e.removeListener("close",l)}return n.on("error",c),e.on("error",c),n.on("end",l),n.on("close",l),e.on("close",l),e.emit("pipe",n),e}},function(e,t,n){(function(t,r){var i=n(358),a=n(78),o=n(79),s=n(188),u=n(97),c=u.IdentifierIssuer,l=n(107),h=n(369),f=n(370),d=n(372).expand,p=n(374).flatten,v=n(375).fromRDF,y=n(376).toRDF,g=n(378).frameMergedOrDefault,m=n(104),b=m.isArray,_=m.isObject,w=m.isString,x=n(116).isSubjectReference,T=n(144),S=T.getInitialContext,k=T.process,M=T.getAllContexts,P=n(379),I=P.compact,j=P.compactIri,O=P.removePreserve,R=n(170),N=R.createNodeMap,C=R.createMergedNodeMap,A=R.mergeNodeMaps,E="undefined"!==typeof t&&t.versions&&t.versions.node,D=!E&&("undefined"!==typeof window||"undefined"!==typeof self),L=function(e){var t={};function m(t,n){var r=n.documentLoader,a=void 0===r?e.documentLoader:r,o=i(n,["documentLoader"]);return Object.assign({},{documentLoader:a},o,t)}return e.compact=u.callbackify(function(){var t=o(a.mark((function t(n,r,i){var o,s,h,f,d,p,v,y,g,x,T,k=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(k.length<2)){t.next=2;break}throw new TypeError("Could not compact, too few arguments.");case 2:if(null!==r){t.next=4;break}throw new l("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});case 4:if(null!==n){t.next=6;break}return t.abrupt("return",null);case 6:if((i=m(i,{base:w(n)?n:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new c("_:b")})).link&&(i.skipExpansion=!0),i.compactToRelative||delete i.base,!i.skipExpansion){t.next=13;break}o=n,t.next=16;break;case 13:return t.next=15,e.expand(n,i);case 15:o=t.sent;case 16:return t.next=18,e.processContext(S(i),r,i);case 18:s=t.sent,h=I({activeCtx:s,element:o,options:i,compactionMap:i.compactionMap}),i.compactArrays&&!i.graph&&b(h)?1===h.length?h=h[0]:0===h.length&&(h={}):i.graph&&_(h)&&(h=[h]),_(r)&&"@context"in r&&(r=r["@context"]),r=u.clone(r),b(r)||(r=[r]),f=r,r=[];for(d=0;d<f.length;++d)(!_(f[d])||Object.keys(f[d]).length>0)&&r.push(f[d]);if(p=r.length>0,1===r.length&&(r=r[0]),b(h))v=j({activeCtx:s,iri:"@graph",relativeTo:{vocab:!0}}),y=h,h={},p&&(h["@context"]=r),h[v]=y;else if(_(h)&&p)for(x in g=h,h={"@context":r},g)h[x]=g[x];return i.framing&&(T=j({activeCtx:s,iri:"@graph",relativeTo:{vocab:!0}}),i.link={},h[T]=O(s,h[T],i)),t.abrupt("return",h);case 32:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),e.expand=u.callbackify(function(){var t=o(a.mark((function t(n,r){var i,o,s,c,l,h,f,p=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(p.length<1)){t.next=2;break}throw new TypeError("Could not expand, too few arguments.");case 2:if(!1===(r=m(r,{keepFreeFloatingNodes:!1})).expansionMap&&(r.expansionMap=void 0),i={},o=[],"expandContext"in r&&(s=u.clone(r.expandContext),_(s)&&"@context"in s?i.expandContext=s:i.expandContext={"@context":s},o.push(i.expandContext)),w(n)){t.next=11;break}i.input=u.clone(n),t.next=17;break;case 11:return t.next=13,e.get(n,r);case 13:l=t.sent,c=l.documentUrl,i.input=l.document,l.contextUrl&&(i.remoteContext={"@context":l.contextUrl},o.push(i.remoteContext));case 17:return"base"in r||(r.base=c||""),t.next=20,M(i,r);case 20:return h=S(r),o.forEach((function(e){h=k({activeCtx:h,localCtx:e,options:r})})),f=d({activeCtx:h,element:i.input,options:r,expansionMap:r.expansionMap}),_(f)&&"@graph"in f&&1===Object.keys(f).length?f=f["@graph"]:null===f&&(f=[]),b(f)||(f=[f]),t.abrupt("return",f);case 26:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),e.flatten=u.callbackify(function(){var t=o(a.mark((function t(n,r,i){var o,s,u,c=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(c.length<1)){t.next=2;break}return t.abrupt("return",new TypeError("Could not flatten, too few arguments."));case 2:return r="function"===typeof r?null:r||null,i=m(i,{base:w(n)?n:""}),t.next=6,e.expand(n,i);case 6:if(o=t.sent,s=p(o),null!==r){t.next=10;break}return t.abrupt("return",s);case 10:return i.graph=!0,i.skipExpansion=!0,t.next=14,e.compact(s,r,i);case 14:return u=t.sent,t.abrupt("return",u);case 16:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),e.frame=u.callbackify(function(){var t=o(a.mark((function t(n,r,i){var o,s,c,l,h,f,d,p,v=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(v.length<2)){t.next=2;break}throw new TypeError("Could not frame, too few arguments.");case 2:if(i=m(i,{base:w(n)?n:"",embed:"@last",explicit:!1,requireAll:!0,omitDefault:!1,pruneBlankNodeIdentifiers:!0,bnodesToClear:[]}),!w(r)){t.next=9;break}return t.next=6,e.get(r,i);case 6:o=t.sent,r=o.document,o.contextUrl&&((s=r["@context"])?b(s)?s.push(o.contextUrl):s=[s,o.contextUrl]:s=o.contextUrl,r["@context"]=s);case 9:return c=r&&r["@context"]||{},t.next=12,e.expand(n,i);case 12:return l=t.sent,(h=u.clone(i)).isFrame=!0,h.keepFreeFloatingNodes=!0,t.next=18,e.expand(r,h);case 18:return f=t.sent,h.merged=!("@graph"in r),d=g(l,f,h),h.graph=!0,h.skipExpansion=!0,h.link={},h.framing=!0,t.next=27,e.compact(d,c,h);case 27:return p=t.sent,t.abrupt("return",p);case 29:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),e.link=u.callbackify(function(){var t=o(a.mark((function t(n,r,i){var o;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={},r&&(o["@context"]=r),o["@embed"]="@link",t.abrupt("return",e.frame(n,o,i));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),e.normalize=e.canonize=u.callbackify(function(){var t=o(a.mark((function t(n,r){var i,o,c,f=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(f.length<1)){t.next=2;break}throw new TypeError("Could not canonize, too few arguments.");case 2:if(!("inputFormat"in(r=m(r,{base:w(n)?n:"",algorithm:"URDNA2015",skipExpansion:!1})))){t.next=8;break}if("application/n-quads"===r.inputFormat||"application/nquads"===r.inputFormat){t.next=6;break}throw new l("Unknown canonicalization input format.","jsonld.CanonizeError");case 6:return i=h.parse(n),t.abrupt("return",s.canonize(i,r));case 8:return delete(o=u.clone(r)).format,o.produceGeneralizedRdf=!1,t.next=13,e.toRDF(n,o);case 13:return c=t.sent,t.abrupt("return",s.canonize(c,r));case 15:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),e.fromRDF=u.callbackify(function(){var e=o(a.mark((function e(n,r){var i,o,s,u=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(u.length<1)){e.next=2;break}throw new TypeError("Could not convert from RDF, too few arguments.");case 2:if(r=m(r,{format:w(n)?"application/n-quads":void 0}),i=r.format,o=r.rdfParser,!i){e.next=11;break}if(o=o||t[i]){e.next=9;break}throw new l("Unknown input format.","jsonld.UnknownFormat",{format:i});case 9:e.next=12;break;case 11:o=function(){return n};case 12:return s=o.length>1?new Promise((function(e,t){o(n,(function(n,r){n?t(n):e(r)}))})):Promise.resolve(o(n)),e.next=15,s;case 15:return s=e.sent,Array.isArray(s)||(s=h.legacyDatasetToQuads(s)),e.abrupt("return",v(s,r));case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),e.toRDF=u.callbackify(function(){var t=o(a.mark((function t(n,r){var i,o,s=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(s.length<1)){t.next=2;break}throw new TypeError("Could not convert to RDF, too few arguments.");case 2:if(!(r=m(r,{base:w(n)?n:"",skipExpansion:!1})).skipExpansion){t.next=7;break}i=n,t.next=10;break;case 7:return t.next=9,e.expand(n,r);case 9:i=t.sent;case 10:if(o=y(i,r),!r.format){t.next=17;break}if("application/n-quads"!==r.format&&"application/nquads"!==r.format){t.next=16;break}return t.next=15,h.serialize(o);case 15:return t.abrupt("return",t.sent);case 16:throw new l("Unknown output format.","jsonld.UnknownFormat",{format:r.format});case 17:return t.abrupt("return",o);case 18:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),e.createNodeMap=u.callbackify(function(){var t=o(a.mark((function t(n,r){var i,o=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(o.length<1)){t.next=2;break}throw new TypeError("Could not create node map, too few arguments.");case 2:return r=m(r,{base:w(n)?n:""}),t.next=5,e.expand(n,r);case 5:return i=t.sent,t.abrupt("return",C(i,r));case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),e.merge=u.callbackify(function(){var t=o(a.mark((function t(n,r,i){var o,s,l,h,f,d,p,v,y,g,_,w,T,S,k,M,P,I=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(I.length<1)){t.next=2;break}throw new TypeError("Could not merge, too few arguments.");case 2:if(b(n)){t.next=4;break}throw new TypeError('Could not merge, "docs" must be an array.');case 4:return r="function"===typeof r?null:r||null,i=m(i,{}),t.next=8,Promise.all(n.map((function(t){var n=Object.assign({},i);return e.expand(t,n)})));case 8:o=t.sent,s=!0,"mergeNodes"in i&&(s=i.mergeNodes),l=i.issuer||new c("_:b"),h={"@default":{}},f=0;case 14:if(!(f<o.length)){t.next=33;break}if(d=u.relabelBlankNodes(o[f],{issuer:new c("_:b"+f+"-")}),N(d,p=s||0===f?h:{"@default":{}},"@default",l),p===h){t.next=30;break}t.t0=a.keys(p);case 20:if((t.t1=t.t0()).done){t.next=30;break}if(v=t.t1.value,y=p[v],v in h){t.next=26;break}return h[v]=y,t.abrupt("continue",20);case 26:for(_ in g=h[v],y)_ in g||(g[_]=y[_]);t.next=20;break;case 30:++f,t.next=14;break;case 33:for(w=A(h),T=[],S=Object.keys(w).sort(),k=0;k<S.length;++k)M=w[S[k]],x(M)||T.push(M);if(null!==r){t.next=39;break}return t.abrupt("return",T);case 39:return i.graph=!0,i.skipExpansion=!0,t.next=43,e.compact(T,r,i);case 43:return P=t.sent,t.abrupt("return",P);case 45:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()),Object.defineProperty(e,"documentLoader",{get:function(){return e._documentLoader},set:function(t){return e._documentLoader=u.normalizeDocumentLoader(t)}}),e.documentLoader=function(){var e=o(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new l("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:t});case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.loadDocument=u.callbackify(o(a.mark((function t(){var n=arguments;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e.documentLoader.apply(null,n));case 1:case"end":return t.stop()}}),t)})))),e.get=u.callbackify(function(){var t=o(a.mark((function t(n,r){var i,o;return a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i="function"===typeof r.documentLoader?u.normalizeDocumentLoader(r.documentLoader):e.documentLoader,t.next=3,i(n);case 3:if(o=t.sent,t.prev=4,o.document){t.next=7;break}throw new l("No remote document found at the given URL.","jsonld.NullRemoteDocument");case 7:w(o.document)&&(o.document=JSON.parse(o.document)),t.next=13;break;case 10:throw t.prev=10,t.t0=t.catch(4),new l("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:t.t0,remoteDoc:o});case 13:return t.abrupt("return",o);case 14:case"end":return t.stop()}}),t,null,[[4,10]])})));return function(e,n){return t.apply(this,arguments)}}()),e.processContext=u.callbackify(function(){var e=o(a.mark((function e(t,n,r){var i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=m(r,{base:""}),null!==n){e.next=3;break}return e.abrupt("return",S(r));case 3:return n=u.clone(n),_(n)&&"@context"in n||(n={"@context":n}),e.next=7,M(n,r);case 7:return i=e.sent,e.abrupt("return",k({activeCtx:t,localCtx:i,options:r}));case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()),e.getContextValue=n(144).getContextValue,e.documentLoaders={},e.documentLoaders.node=n(380),e.documentLoaders.xhr=n(383),e.useDocumentLoader=function(t){if(!(t in e.documentLoaders))throw new l('Unknown document loader type: "'+t+'"',"jsonld.UnknownDocumentLoader",{type:t});e.documentLoader=e.documentLoaders[t].apply(e,Array.prototype.slice.call(arguments,1))},e.registerRDFParser=function(e,n){t[e]=n},e.unregisterRDFParser=function(e){delete t[e]},e.registerRDFParser("application/n-quads",h.parse),e.registerRDFParser("application/nquads",h.parse),e.registerRDFParser("rdfa-api",f.parse),e.url=n(154),e.util=u,Object.assign(e,u),e.promises=e,e.RequestQueue=n(194),e.JsonLdProcessor=n(384)(e),D&&"undefined"===typeof r.JsonLdProcessor&&Object.defineProperty(r,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor}),E?e.useDocumentLoader("node"):"undefined"!==typeof XMLHttpRequest&&e.useDocumentLoader("xhr"),e},B=function e(){return L((function(){return e()}))};L(B),e.exports=B}).call(this,n(95),n(40))},function(e,t,n){"use strict";var r,i=n(78),a=n(79),o=n(143),s=n(245),u=n(364),c=n(249),l=n(365);try{r=n(366)}catch(f){}var h={};e.exports=h,h.NQuads=n(191),h.IdentifierIssuer=n(189),h._rdfCanonizeNative=function(e){return e&&(r=e),r},h.canonize=o.callbackify(function(){var e=a(i.mark((function e(t,n){var a,o;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=new Promise((function(e,t){a=function(n,r){if(n)return t(n);e(r)}})),Array.isArray(t)||(t=h.NQuads.legacyDatasetToQuads(t)),!n.useNative){e.next=10;break}if(!r){e.next=7;break}r.canonize(t,n,a),e.next=8;break;case 7:throw new Error("rdf-canonize-native not available");case 8:e.next=23;break;case 10:if("URDNA2015"!==n.algorithm){e.next=14;break}new s(n).main(t,a),e.next=23;break;case 14:if("URGNA2012"!==n.algorithm){e.next=18;break}new u(n).main(t,a),e.next=23;break;case 18:if("algorithm"in n){e.next=22;break}throw new Error("No RDF Dataset Canonicalization algorithm specified.");case 22:throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+n.algorithm);case 23:return e.abrupt("return",o);case 24:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),h.canonizeSync=function(e,t){if(Array.isArray(e)||(e=h.NQuads.legacyDatasetToQuads(e)),t.useNative){if(r)return r.canonizeSync(e,t);throw new Error("rdf-canonize-native not available")}if("URDNA2015"===t.algorithm)return new c(t).main(e);if("URGNA2012"===t.algorithm)return new l(t).main(e);if(!("algorithm"in t))throw new Error("No RDF Dataset Canonicalization algorithm specified.");throw new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm)}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(143);e.exports=function(){function e(t){r(this,e),this.prefix=t,this.counter=0,this.existing={}}return i(e,[{key:"clone",value:function(){var t=new e(this.prefix);return t.counter=this.counter,t.existing=a.clone(this.existing),t}},{key:"getId",value:function(e){if(e&&e in this.existing)return this.existing[e];var t=this.prefix+this.counter;return this.counter+=1,e&&(this.existing[e]=t),t}},{key:"hasId",value:function(e){return e in this.existing}}]),e}()},function(e,t,n){var r=n(152);e.exports=r.md=r.md||{},r.md.algorithms=r.md.algorithms||{}},function(e,t,n){"use strict";var r=n(82),i=n(76),a=n(77),o="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",s="http://www.w3.org/2001/XMLSchema#string",u={};function c(e,t){for(var n in e)if(e[n].termType!==t[n].termType||e[n].value!==t[n].value)return!1;return"Literal"!==e.object.termType||e.object.datatype.termType===t.object.datatype.termType&&e.object.datatype.value===t.object.datatype.value&&e.object.language===t.object.language}u.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,u.empty=new RegExp("^[ \\t]*$"),u.quad=new RegExp('^[ \\t]*(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]+(?:<([^:]+:[^>]*)>)[ \\t]+(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?)|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^(?:<([^:]+:[^>]*)>))|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))[ \\t]*(?:\\.|(?:(?:(?:<([^:]+:[^>]*)>)|(_:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9])(?:(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040.])*(?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd_0-9-\xb7\u0300-\u036f\u203f-\u2040]))?))[ \\t]*\\.))[ \\t]*$'),e.exports=function(){function e(){i(this,e)}return a(e,null,[{key:"parse",value:function(e){var t,n=[],i={},a=e.split(u.eoln),l=0,f=r(a);try{for(f.s();!(t=f.n()).done;){var d=t.value;if(l++,!u.empty.test(d)){var p=d.match(u.quad);if(null===p)throw new Error("N-Quads parse error on line "+l+".");var v={};if(void 0!==p[1]?v.subject={termType:"NamedNode",value:p[1]}:v.subject={termType:"BlankNode",value:p[2]},v.predicate={termType:"NamedNode",value:p[3]},void 0!==p[4]?v.object={termType:"NamedNode",value:p[4]}:void 0!==p[5]?v.object={termType:"BlankNode",value:p[5]}:(v.object={termType:"Literal",value:void 0,datatype:{termType:"NamedNode"}},void 0!==p[7]?v.object.datatype.value=p[7]:void 0!==p[8]?(v.object.datatype.value=o,v.object.language=p[8]):v.object.datatype.value=s,v.object.value=p[6].replace(h,(function(e,t,n,r){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")}))),void 0!==p[9]?v.graph={termType:"NamedNode",value:p[9]}:void 0!==p[10]?v.graph={termType:"BlankNode",value:p[10]}:v.graph={termType:"DefaultGraph",value:""},v.graph.value in i){var y,g=!0,m=i[v.graph.value],b=r(m);try{for(b.s();!(y=b.n()).done;){if(c(y.value,v)){g=!1;break}}}catch(_){b.e(_)}finally{b.f()}g&&(m.push(v),n.push(v))}else i[v.graph.value]=[v],n.push(v)}}}catch(_){f.e(_)}finally{f.f()}return n}},{key:"serialize",value:function(t){Array.isArray(t)||(t=e.legacyDatasetToQuads(t));var n,i=[],a=r(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;i.push(e.serializeQuad(o))}}catch(s){a.e(s)}finally{a.f()}return i.sort().join("")}},{key:"serializeQuad",value:function(e){var t=e.subject,n=e.predicate,r=e.object,i=e.graph,a="";return[t,n].forEach((function(e){"NamedNode"===e.termType?a+="<"+e.value+">":a+=e.value,a+=" "})),"NamedNode"===r.termType?a+="<"+r.value+">":"BlankNode"===r.termType?a+=r.value:(a+='"'+function(e){return e.replace(l,(function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}}))}(r.value)+'"',r.datatype.value===o?r.language&&(a+="@"+r.language):r.datatype.value!==s&&(a+="^^<"+r.datatype.value+">")),"NamedNode"===i.termType?a+=" <"+i.value+">":"BlankNode"===i.termType&&(a+=" "+i.value),a+=" .\n"}},{key:"legacyDatasetToQuads",value:function(e){var t=[],n={"blank node":"BlankNode",IRI:"NamedNode",literal:"Literal"},r=function(r){e[r].forEach((function(e){var i={};for(var a in e){var u=e[a],c={termType:n[u.type],value:u.value};"Literal"===c.termType&&(c.datatype={termType:"NamedNode"},"datatype"in u&&(c.datatype.value=u.datatype),"language"in u?("datatype"in u||(c.datatype.value=o),c.language=u.language):"datatype"in u||(c.datatype.value=s)),i[a]=c}i.graph="@default"===r?{termType:"DefaultGraph",value:""}:{termType:r.startsWith("_:")?"BlankNode":"NamedNode",value:r},t.push(i)}))};for(var i in e)r(i);return t}}]),e}();var l=/["\\\n\r]/g;var h=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var r=n(228),i=n(225),a=n(167),o=n(229);e.exports=function(e){return r(e)||i(e)||a(e)||o()}},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(97),u=s.callbackify,c=s.normalizeDocumentLoader;e.exports=function(){function e(){a(this,e),this._requests={},this.add=u(this.add.bind(this))}return o(e,[{key:"wrapLoader",value:function(e){var t=this;return t._loader=c(e),function(){return t.add.apply(t,arguments)}}},{key:"add",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=(n=this)._requests[t])){e.next=4;break}return e.abrupt("return",Promise.resolve(i));case 4:return i=n._requests[t]=n._loader(t),e.prev=5,e.next=8,i;case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,delete n._requests[t],e.finish(9);case 12:case"end":return e.stop()}}),e,this,[[5,,9,12]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()},function(e,t,n){var r=n(385);e.exports=r},function(e,t){var n=function(e){function t(){this.fetch=!1,this.DOMException=e.DOMException}return t.prototype=e,new t}("undefined"!==typeof self?self:this);!function(e){!function(t){var n="URLSearchParams"in e,r="Symbol"in e&&"iterator"in Symbol,i="FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),a="FormData"in e,o="ArrayBuffer"in e;if(o)var s=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],u=ArrayBuffer.isView||function(e){return e&&s.indexOf(Object.prototype.toString.call(e))>-1};function c(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function l(e){return"string"!==typeof e&&(e=String(e)),e}function h(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return r&&(t[Symbol.iterator]=function(){return t}),t}function f(e){this.map={},e instanceof f?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function d(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function v(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function y(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:a&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:n&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():o&&i&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=y(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o&&(ArrayBuffer.prototype.isPrototypeOf(e)||u(e))?this._bodyArrayBuffer=y(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):n&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?d(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var e=d(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=p(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},a&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}f.prototype.append=function(e,t){e=c(e),t=l(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},f.prototype.delete=function(e){delete this.map[c(e)]},f.prototype.get=function(e){return e=c(e),this.has(e)?this.map[e]:null},f.prototype.has=function(e){return this.map.hasOwnProperty(c(e))},f.prototype.set=function(e,t){this.map[c(e)]=l(t)},f.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},f.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),h(e)},f.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),h(e)},f.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),h(e)},r&&(f.prototype[Symbol.iterator]=f.prototype.entries);var m=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function b(e,t){var n=(t=t||{}).body;if(e instanceof b){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new f(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new f(t.headers)),this.method=function(e){var t=e.toUpperCase();return m.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function _(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function w(e){var t=new f;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function x(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new f(t.headers),this.url=t.url||"",this._initBody(e)}b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},g.call(b.prototype),g.call(x.prototype),x.prototype.clone=function(){return new x(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},x.error=function(){var e=new x(null,{status:0,statusText:""});return e.type="error",e};var T=[301,302,303,307,308];x.redirect=function(e,t){if(-1===T.indexOf(t))throw new RangeError("Invalid status code");return new x(null,{status:t,headers:{location:e}})},t.DOMException=e.DOMException;try{new t.DOMException}catch(k){t.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},t.DOMException.prototype=Object.create(Error.prototype),t.DOMException.prototype.constructor=t.DOMException}function S(e,n){return new Promise((function(r,a){var o=new b(e,n);if(o.signal&&o.signal.aborted)return a(new t.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function u(){s.abort()}s.onload=function(){var e={status:s.status,statusText:s.statusText,headers:w(s.getAllResponseHeaders()||"")};e.url="responseURL"in s?s.responseURL:e.headers.get("X-Request-URL");var t="response"in s?s.response:s.responseText;r(new x(t,e))},s.onerror=function(){a(new TypeError("Network request failed"))},s.ontimeout=function(){a(new TypeError("Network request failed"))},s.onabort=function(){a(new t.DOMException("Aborted","AbortError"))},s.open(o.method,o.url,!0),"include"===o.credentials?s.withCredentials=!0:"omit"===o.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),o.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),o.signal&&(o.signal.addEventListener("abort",u),s.onreadystatechange=function(){4===s.readyState&&o.signal.removeEventListener("abort",u)}),s.send("undefined"===typeof o._bodyInit?null:o._bodyInit)}))}S.polyfill=!0,e.fetch||(e.fetch=S,e.Headers=f,e.Request=b,e.Response=x),t.Headers=f,t.Request=b,t.Response=x,t.fetch=S}({})}(n),delete n.fetch.polyfill,(t=n.fetch).default=n.fetch,t.fetch=n.fetch,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,e.exports=t},function(e,t,n){n(399),e.exports=self.fetch.bind(self)},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(172)),d=r(n(119)),p=r(n(109)),v=r(n(120)),y=r(n(106)),g=r(n(415)),m=r(n(121)),b=r(n(122)),_=r(n(98)),w=r(n(419)),x=n(94),T=r(n(123)),S=n(255),k=r(n(90)),M=r(n(145)),P=r(n(124)),I=r(n(133)),j=r(n(134)),O=r(n(201)),R=r(n(160)),N=r(n(125)),C=r(n(81)),A=new i.Container;A.bind(C.default.Context).to(a.default).inSingletonScope(),A.bind(C.default.QueryRunner).to(R.default),A.bind(C.default.LocationResolver).to(N.default),A.bind(C.default.HydraTemplateFetcher).to(d.default).inSingletonScope(),A.bind(C.default.PublicTransportPlanner).to(M.default),A.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),A.bind(C.default.RoadPlanner).to(I.default),A.bind(C.default.ShortestPathTreeAlgorithm).to(T.default).inSingletonScope(),A.bind(C.default.ShortestPathAlgorithm).to(S.Dijkstra).inSingletonScope(),A.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),A.bind(C.default.ProfileFetcher).to(v.default).inSingletonScope(),A.bind(C.default.ProfileProvider).to(y.default).inSingletonScope(),A.bind(C.default.JourneyExtractor).to(P.default),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Initial),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Transfer),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Final),A.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),A.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),A.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),A.bind(C.default.ConnectionsFetcher).to(l.default),A.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),A.bind(C.default.StopsProvider).to(m.default).inSingletonScope(),A.bind(C.default.StopsFetcher).to(g.default),A.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),A.bind(C.default.RoutableTileFetcher).to(b.default).inSingletonScope(),A.bind(C.default.RoutableTileProvider).to(_.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),A.bind(C.default.RoutableTileProvider).to(w.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),A.bind(C.default.FootpathsProvider).to(f.default).inSingletonScope(),A.bind(C.default.LDFetch).to(p.default).inSingletonScope(),A.bind(C.default.LDLoader).to(x.LDLoader),t.default=A},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(89),c=s(n(173)),l=function(e){o(n,e);var t=a(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return r(this,n),(e=t.call(this)).buffer=i?new c.default([],(function(e,t){return t.departureTime-e.departureTime})):new c.default([],(function(e,t){return e.departureTime-t.departureTime})),e.readable=!0,e.shouldClose=!1,e.setMaxListeners(100),e}return i(n,[{key:"read",value:function(){var e;return e=this.buffer.length?this.buffer.pop():null,this.shouldClose&&this.close(),e}},{key:"write",value:function(e){this.shouldClose||(this.buffer.push(e),this.readable=!0)}},{key:"closeAfterFlush",value:function(){this.shouldClose=!0}}]),n}(u.AsyncIterator);t.default=l},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(99)),s=function(){function e(t,n,i,a,o,s,u,c){r(this,e),this.distance=s,this.duration=i,this.startLocation=t,this.startTime=a,this.stopLocation=n,this.stopTime=o,this.enterConnectionId=u,this.exitConnectionId=c}return i(e,null,[{key:"create",value:function(t,n,r,i,a,o,s){return new e(t,n,r,a,o,s,i)}},{key:"createFromConnections",value:function(t,n){return new e({id:t.departureStop},{id:n.arrivalStop},{minimum:n.arrivalTime.getTime()-t.departureTime.getTime()},t.departureTime,n.arrivalTime,void 0,t.id,n.id)}},{key:"compareEquals",value:function(t,n){return e.compareLocations(n.startLocation,t.startLocation)&&e.compareLocations(n.stopLocation,t.stopLocation)}},{key:"compareLocations",value:function(e,t){return o.default.getId(e)===o.default.getId(t)&&e.longitude===t.longitude&&e.latitude===t.latitude}}]),e}();t.default=s},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(81)),d=l(n(135)),p=function(){function e(t,n){a(this,e),this.stopsProvider=t,this.footpathsProvider=n}return o(e,[{key:"findReachableStops",value:function(){var e=i(r.mark((function e(t,n,i,a){var o,s,u,c,l,h,f;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[{stop:t,duration:0}],e.next=3,this.footpathsProvider.get(t);case 3:s=e.sent,u=0,c=Object.values(s);case 5:if(!(u<c.length)){e.next=22;break}if(l=c[u],h=void 0,t.id!==l.from){e.next=14;break}return e.next=11,this.stopsProvider.getStopById(l.to);case 11:h=e.sent,e.next=18;break;case 14:if(t.id!==l.to){e.next=18;break}return e.next=17,this.stopsProvider.getStopById(l.from);case 17:h=e.sent;case 18:h&&(f=d.default.toDuration(l.distance,a),o.push({stop:h,duration:f,id:l.id}));case 19:u++,e.next=5;break;case 22:return e.abrupt("return",o);case 23:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()}]),e}();p=s([h.injectable(),c(0,h.inject(f.default.StopsProvider)),c(1,h.inject(f.default.FootpathsProvider)),u("design:paramtypes",[Object,Object])],p),t.default=p},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(103),u=n(132),c=n(83),l=n(84),h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=h(n(230)),d=function(e){l(n,e);var t=c(n);function n(){return a(this,n),t.call(this,f.default)}return o(n,[{key:"query",value:function(e){return e.roadNetworkOnly=!0,u(s(n.prototype),"query",this).call(this,e)}},{key:"completePath",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h(n(136)).default);t.default=d},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={Connections:Symbol("Connection"),Stops:Symbol("Stop"),RoutableTile:Symbol("RoutableTile"),ZoiTile:Symbol("ZoiTile"),ReducedRoutableTile:Symbol("ReducedRoutableTile"),Profile:Symbol("Profile"),Footpath:Symbol("Footpath"),Unknown:Symbol("?")};t.default=r},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=n(131),d=n(254),p=l(n(113)),v=l(n(86)),y=l(n(87)),g=n(139),m=function(){function e(){o(this,e),this.paths={}}return s(e,[{key:"get",value:function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForLocation(12,t),this.paths[n]||(this.paths[n]=this.getByUrl(n)),e.abrupt("return",this.paths[n]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdForLocation",value:function(e,t){var n=g.lat_to_tile(t.latitude,e),r=g.long_to_tile(t.longitude,e),i=new p.default(e,r,n);return this.getIdForTileCoords(i)}},{key:"getIdForTileCoords",value:function(e){return"https://hdelva.be/stops/distances/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}},{key:"getByLocation",value:function(e,t){var n=g.lat_to_tile(t.latitude,e),r=g.long_to_tile(t.longitude,e),i=new p.default(e,r,n);return this.getByTileCoords(i)}},{key:"getByTileCoords",value:function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForTileCoords(t),e.next=3,this.getByUrl(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getByUrl",value:function(){var e=a(i.mark((function e(t){var n,a,o,s,u,c,l,h,p,g,m,b;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.next=3,fetch(t);case 3:return a=e.sent,o=this.parseResponseLength(a),s=(new Date).getTime()-n.getTime(),e.next=8,a.text();case 8:if(u=e.sent,c={},200!==a.status&&v.default.getInstance().emit(y.default.Warning,"".concat(t," responded with status code ").concat(a.status)),200===a.status&&u){l=JSON.parse(u),h=r(l["@graph"]);try{for(h.s();!(p=h.n()).done;)g=p.value,m=g["@id"],(b=new d.Footpath(m)).to=g["planner:destination"],b.from=g["planner:source"],b.distance=g["planner:distance"],c[m]=b}catch(i){h.e(i)}finally{h.f()}}return v.default.getInstance().emit(y.default.ResourceFetch,{datatype:f.DataType.Footpath,url:t,duration:s,size:o}),e.abrupt("return",c);case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseLength",value:function(e){if(e.headers.get("content-length"))return parseInt(e.headers.get("content-length"),10);try{return e.body._chunkSize}catch(t){}}}]),e}();m=u([h.injectable(),c("design:paramtypes",[])],m),t.default=m},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(90)),d=l(n(81)),p=function(e){o(n,e);var t=a(n);function n(e,i){return r(this,n),t.call(this,e,i)}return i(n,[{key:"getIdForTileCoords",value:function(e){return"https://hdelva.be/tiles/reduced/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}}]),n}(l(n(98)).default);p=s([h.injectable(),c(0,h.inject(d.default.PathfinderProvider)),c(1,h.inject(d.default.RoutableTileFetcher)),u("design:paramtypes",[f.default,Object])],p),t.default=p},function(e,t,n){"use strict";var r,i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(128)),v=n(94),y=n(155),g=f(n(81)),m=n(108),b=f(n(105)),_=f(n(273)),w=f(n(441)),x=f(n(442)),T=function(){function e(t){s(this,e),this.ldFetch=t,this.ldLoader=new v.LDLoader,this.ldLoader.defineCollection(b.default.inNS(m.TREE,"relation"))}return u(e,[{key:"get",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ldFetch.get(t);case 2:return n=e.sent,r=n.triples,o=this.ldLoader.process(r,[this.getView()]),s=a(o,1),(u=s[0]).id=t,e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getView",value:function(){var e=new y.ThingView(x.default.create);return e.addFilter((function(e){return void 0!==e[b.default.inNS(m.TREE,"relation")]})),e.addMapping(b.default.inNS(m.TREE,"relation"),"relations",this.getRelationView()),e}},{key:"getRelationView",value:function(){var e=new y.ThingView(w.default.create);return e.addFilter((function(e){return e[b.default.inNS(m.RDF,"type")]===b.default.inNS(m.TREE,"GeospatiallyContainsRelation")})),e.addMapping(b.default.inNS(m.TREE,"node"),"node"),e.addMapping(b.default.inNS(m.TREE,"value"),"geoValue",this.getFragmentView()),e}},{key:"getFragmentView",value:function(){var e=new y.ThingView(_.default.create);return e.addFilter((function(e){return e[b.default.inNS(m.RDF,"type")]===b.default.inNS(m.GEOSPARQL,"Geometry")})),e.addMapping(b.default.inNS(m.GEOSPARQL,"asWKT"),"area"),e}}]),e}();T=c([d.injectable(),h(0,d.inject(g.default.LDFetch)),l("design:paramtypes",["function"===typeof(r="undefined"!==typeof p.default&&p.default)?r:Object])],T),t.default=T},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(81)),d=function(){function e(t){a(this,e),this.accessUrls=[],this.treeFetcher=t}return o(e,[{key:"addTreeSource",value:function(e){this.allTrees=null,this.accessUrls.push(e)}},{key:"getAllTrees",value:function(){var e=i(r.mark((function e(){var t=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.allTrees||(this.allTrees=Promise.all(this.accessUrls.map((function(e){return t.treeFetcher.get(e)})))),e.abrupt("return",this.allTrees);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();d=s([h.injectable(),c(0,h.inject(f.default.HypermediaTreeFetcher)),u("design:paramtypes",[Object])],d),t.default=d},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),s=n(271),u=function(){function e(){r(this,e)}return i(e,[{key:"createInstance",value:function(e){return new s.BidirDijkstraInstance(e)}}]),e}();u=a([o.injectable()],u),t.BidirDijkstra=u},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(81)),d=l(n(447)),p=function(){function e(t){a(this,e),this.reachableStopsFinder=new d.default(t),this.reachableStopsCache={}}return o(e,[{key:"findReachableStops",value:function(){var e=i(r.mark((function e(t,n,i,a){var o,s,u;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o="".concat(t.id," ").concat(i," ").concat(a),!(s=this.reachableStopsCache[o])){e.next=4;break}return e.abrupt("return",s);case 4:return e.next=6,this.reachableStopsFinder.findReachableStops(t,n,i,a);case 6:return u=e.sent,this.reachableStopsCache[o]=u,e.abrupt("return",u);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()}]),e}();p=s([h.injectable(),c(0,h.inject(f.default.StopsProvider)),u("design:paramtypes",[Object])],p),t.default=p},function(e,t,n){"use strict";n.r(t),n.d(t,"DataFactory",(function(){return T})),n.d(t,"Lexer",(function(){return k.a})),n.d(t,"Parser",(function(){return I})),n.d(t,"Writer",(function(){return B})),n.d(t,"Store",(function(){return H})),n.d(t,"StreamParser",(function(){return Q})),n.d(t,"StreamWriter",(function(){return Y})),n.d(t,"Util",(function(){return r}));var r={};n.r(r),n.d(r,"isNamedNode",(function(){return J})),n.d(r,"isBlankNode",(function(){return K})),n.d(r,"isLiteral",(function(){return Z})),n.d(r,"isVariable",(function(){return $})),n.d(r,"isDefaultGraph",(function(){return ee})),n.d(r,"inDefaultGraph",(function(){return te})),n.d(r,"prefix",(function(){return ne})),n.d(r,"prefixes",(function(){return re}));var i,a,o=n(282),s=n(165),u=n(161),c=n(162),l=n(91),h=n(92),f=n(151),d=f.a.rdf,p=f.a.xsd,v=0,y=function(){function e(t){Object(l.a)(this,e),this.id=t}return Object(h.a)(e,[{key:"equals",value:function(t){return t instanceof e?this.id===t.id:!!t&&this.termType===t.termType&&this.value===t.value}},{key:"toJSON",value:function(){return{termType:this.termType,value:this.value}}},{key:"value",get:function(){return this.id}}]),e}(),g=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"termType",get:function(){return"NamedNode"}}]),n}(y),m=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"equals",value:function(e){return e instanceof n?this.id===e.id:!!e&&!!e.datatype&&this.termType===e.termType&&this.value===e.value&&this.language===e.language&&this.datatype.value===e.datatype.value}},{key:"toJSON",value:function(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}},{key:"termType",get:function(){return"Literal"}},{key:"value",get:function(){return this.id.substring(1,this.id.lastIndexOf('"'))}},{key:"language",get:function(){var e=this.id,t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}},{key:"datatype",get:function(){return new g(this.datatypeString)}},{key:"datatypeString",get:function(){var e,t=this.id,n=t.lastIndexOf('"')+1;return n<t.length&&"^"===(e=t[n])?t.substr(n+2):"@"!==e?p.string:d.langString}}]),n}(y),b=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,"_:"+e)}return Object(h.a)(n,[{key:"termType",get:function(){return"BlankNode"}},{key:"value",get:function(){return this.id.substr(2)}}]),n}(y),_=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){return Object(l.a)(this,n),t.call(this,"?"+e)}return Object(h.a)(n,[{key:"termType",get:function(){return"Variable"}},{key:"value",get:function(){return this.id.substr(1)}}]),n}(y),w=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(l.a)(this,n),e=t.call(this,""),Object(o.a)(e,a||Object(s.a)(e))}return Object(h.a)(n,[{key:"equals",value:function(e){return this===e||!!e&&this.termType===e.termType}},{key:"termType",get:function(){return"DefaultGraph"}}]),n}(y);a=new w;var x=function(){function e(t,n,r,i){Object(l.a)(this,e),this.subject=t,this.predicate=n,this.object=r,this.graph=i||a}return Object(h.a)(e,[{key:"toJSON",value:function(){return{subject:this.subject.toJSON(),predicate:this.predicate.toJSON(),object:this.object.toJSON(),graph:this.graph.toJSON()}}},{key:"equals",value:function(e){return!!e&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}]),e}(),T=i={namedNode:function(e){return new g(e)},blankNode:function(e){e||(e="n3-"+v++);return new b(e)},variable:function(e){return new _(e)},literal:function(e,t){if("string"===typeof t)return new m('"'+e+'"@'+t.toLowerCase());var n=t?t.value:"";""===n&&("boolean"===typeof e?n=p.boolean:"number"===typeof e&&(Number.isFinite(e)?n=Number.isInteger(e)?p.integer:p.double:(n=p.double,Number.isNaN(e)||(e=e>0?"INF":"-INF"))));return""===n||n===p.string?new m('"'+e+'"'):new m('"'+e+'"^^'+n)},defaultGraph:function(){return a},quad:S,triple:S,internal:{Term:y,NamedNode:g,BlankNode:b,Variable:_,Literal:m,DefaultGraph:w,Quad:x,Triple:x,fromId:function(e,t){if(t=t||i,!e)return t.defaultGraph();switch(e[0]){case"_":return t.blankNode(e.substr(2));case"?":return t.variable(e.substr(1));case'"':if(t===i)return new m(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));var n=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,n-1),"@"===e[n+1]?e.substr(n+2):t.namedNode(e.substr(n+3)));default:return t.namedNode(e)}},toId:function(e){if("string"===typeof e)return e;if(e instanceof y)return e.id;if(!e)return a.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return"_:"+e.value;case"Variable":return"?"+e.value;case"DefaultGraph":return"";case"Literal":return'"'+e.value+'"'+(e.language?"@"+e.language:e.datatype&&e.datatype.value!==p.string?"^^"+e.datatype.value:"");default:throw new Error("Unexpected termType: "+e.termType)}}}};function S(e,t,n,r){return new x(e,t,n,r)}var k=n(185),M=0,P=0,I=function(){function e(t){Object(l.a)(this,e),this._contextStack=[],this._graph=null,t=t||{},this._setBase(t.baseIRI),t.factory&&O(this,t.factory);var n="string"===typeof t.format?t.format.match(/\w*$/)[0].toLowerCase():"",r="turtle"===n,i="trig"===n,a=/triple/.test(n),o=/quad/.test(n),s=this._n3Mode=/n3/.test(n),u=a||o;(this._supportsNamedGraphs=!(r||s))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(r||i||a||s),u&&(this._resolveRelativeIRI=function(e){return null}),this._blankNodePrefix="string"!==typeof t.blankNodePrefix?"":t.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=t.lexer||new k.a({lineMode:u,n3:s}),this._explicitQuantifiers=!!t.explicitQuantifiers}return Object(h.a)(e,[{key:"_blank",value:function(){return this._blankNode("b"+P++)}},{key:"_setBase",value:function(e){if(e){var t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}},{key:"_saveContext",value:function(e,t,n,r,i){var a=this._n3Mode;this._contextStack.push({subject:n,predicate:r,object:i,graph:t,type:e,inverse:!!a&&this._inversePredicate,blankPrefix:a?this._prefixes._:"",quantified:a?this._quantified:null}),a&&(this._inversePredicate=!1,this._prefixes._=this._graph?this._graph.id.substr(2)+".":".",this._quantified=Object.create(this._quantified))}},{key:"_restoreContext",value:function(){var e=this._contextStack.pop(),t=this._n3Mode;this._subject=e.subject,this._predicate=e.predicate,this._object=e.object,this._graph=e.graph,t&&(this._inversePredicate=e.inverse,this._prefixes._=e.blankPrefix,this._quantified=e.quantified)}},{key:"_readInTopContext",value:function(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}},{key:"_readEntity",value:function(e,t){var n;switch(e.type){case"IRI":case"typeIRI":var r=this._resolveIRI(e.value);if(null===r)return this._error("Invalid IRI",e);n=this._namedNode(r);break;case"type":case"prefixed":var i=this._prefixes[e.prefix];if(void 0===i)return this._error('Undefined prefix "'+e.prefix+':"',e);n=this._namedNode(i+e.value);break;case"blank":n=this._blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._variable(e.value.substr(1));break;default:return this._error("Expected entity but got "+e.type,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}},{key:"_readSubject",value:function(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._blank(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._blank(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier=this._blankNode,this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier=this._variable,this._readQuantifierList):this._error('Unexpected "@forAll"',e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}},{key:"_readPredicate",value:function(e){var t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error("Unexpected "+t,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}},{key:"_readObject",value:function(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._literal(e.value,this._namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._blank()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._blank()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}},{key:"_readPredicateOrNamedGraph",value:function(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}},{key:"_readGraph",value:function(e){return"{"!==e.type?this._error("Expected graph but got "+e.type,e):(this._graph=this._subject,this._subject=null,this._readSubject)}},{key:"_readBlankNodeHead",value:function(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}},{key:"_readBlankNodeTail",value:function(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);var t=null===this._predicate;return this._restoreContext(),null===this._object?t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank:this._getContextEndReader()}},{key:"_readPredicateAfterBlank",value:function(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}},{key:"_readListItem",value:function(e){var t=null,n=null,r=this._subject,i=this._contextStack,a=i[i.length-1],o=this._readListItem;switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._blank(),this.RDF_FIRST,this._subject=t=this._blank()),o=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._blank(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext(),0!==i.length&&"list"===i[i.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(o=this._readPredicate,this._subject===this.RDF_NIL)return o}else if(o=this._getContextEndReader(),this._object===this.RDF_NIL)return o;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,o=this._readListItemDataTypeOrLang):(t=this._literal(e.value,this._namedNode(e.prefix)),o=this._getContextEndReader());break;default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._blank()),null===r?null===a.predicate?a.subject=n:a.object=n:this._emit(r,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return o}},{key:"_readDataTypeOrLang",value:function(e){return this._completeLiteral(e,!1)}},{key:"_readListItemDataTypeOrLang",value:function(e){return this._completeLiteral(e,!0)}},{key:"_completeLiteral",value:function(e,t){switch(e.type){case"type":case"typeIRI":var n=this._readEntity(e);if(void 0===n)return;this._object=this._literal(this._literalValue,n),e=null;break;case"langcode":this._object=this._literal(this._literalValue,e.value),e=null;break;default:this._object=this._literal(this._literalValue)}return t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===e?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(e))}},{key:"_readFormulaTail",value:function(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext(),null===this._object?this._readPredicate:this._getContextEndReader())}},{key:"_readPunctuation",value:function(e){var t,n=this._subject,r=this._graph,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(r=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error('Expected punctuation to follow "'+this._object.id+'"',e)}if(null!==n){var a=this._predicate,o=this._object;i?this._emit(o,a,n,r):this._emit(n,a,o,r)}return t}},{key:"_readBlankNodePunctuation",value:function(e){var t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error('Expected punctuation to follow "'+this._object.id+'"',e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}},{key:"_readQuadPunctuation",value:function(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}},{key:"_readPrefix",value:function(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}},{key:"_readPrefixIRI",value:function(e){if("IRI"!==e.type)return this._error('Expected IRI to follow prefix "'+this._prefix+':"',e);var t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}},{key:"_readBaseIRI",value:function(e){var t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}},{key:"_readNamedGraphLabel",value:function(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}},{key:"_readNamedGraphBlankLabel",value:function(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._blank(),this._readGraph)}},{key:"_readDeclarationPunctuation",value:function(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}},{key:"_readQuantifierList",value:function(e){var t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error("Unexpected "+e.type,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._blank(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._blank(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._quantifier("b"+P++),this._readQuantifierPunctuation}},{key:"_readQuantifierPunctuation",value:function(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}},{key:"_getPathReader",value:function(e){return this._afterPath=e,this._readPath}},{key:"_readPath",value:function(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:var t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){var r=this._subject;this._restoreContext(),this._emit(this._subject,this.RDF_FIRST,r,this._graph)}return this._afterPath(e)}}},{key:"_readForwardPath",value:function(e){var t,n,r=this._blank();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=r):(t=this._object,this._object=r),this._emit(t,n,r,this._graph),this._readPath}},{key:"_readBackwardPath",value:function(e){var t,n,r=this._blank();if(void 0!==(t=this._readEntity(e)))return null===this._predicate?(n=this._subject,this._subject=r):(n=this._object,this._object=r),this._emit(r,t,n,this._graph),this._readPath}},{key:"_getContextEndReader",value:function(){var e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail}}},{key:"_emit",value:function(e,t,n,r){this._callback(null,this._quad(e,t,n,r||this.DEFAULTGRAPH))}},{key:"_error",value:function(e,t){var n=new Error(e+" on line "+t.line+".");n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=j}},{key:"_resolveIRI",value:function(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}},{key:"_resolveRelativeIRI",value:function(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}},{key:"_removeDotSegments",value:function(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;for(var t="",n=e.length,r=-1,i=-1,a=0,o="/";r<n;){switch(o){case":":if(i<0&&"/"===e[++r]&&"/"===e[++r])for(;(i=r+1)<n&&"/"!==e[i];)r=i;break;case"?":case"#":r=n;break;case"/":if("."===e[r+1])switch(o=e[1+ ++r]){case"/":t+=e.substring(a,r-1),a=r+1;break;case void 0:case"?":case"#":return t+e.substring(a,r)+e.substr(r+1);case".":if(void 0===(o=e[1+ ++r])||"/"===o||"?"===o||"#"===o){if((a=(t+=e.substring(a,r-2)).lastIndexOf("/"))>=i&&(t=t.substr(0,a)),"/"!==o)return t+"/"+e.substr(r+1);a=r+1}}}o=e[++r]}return t+e.substring(a)}},{key:"parse",value:function(e,t,n){var r=this;if(this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):"b"+M+++"_",this._prefixCallback=n||j,this._inversePredicate=!1,this._quantified=Object.create(null),!t){var i,a=[];if(this._callback=function(e,t){e?i=e:t&&a.push(t)},this._lexer.tokenize(e).every((function(e){return r._readCallback=r._readCallback(e)})),i)throw i;return a}this._callback=t,this._lexer.tokenize(e,(function(e,t){null!==e?(r._callback(e),r._callback=j):r._readCallback&&(r._readCallback=r._readCallback(t))}))}}],[{key:"_resetBlankNodeIds",value:function(){M=P=0}}]),e}();function j(){}function O(e,t){var n=t.namedNode;e._namedNode=n,e._blankNode=t.blankNode,e._literal=t.literal,e._variable=t.variable,e._quad=t.quad,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=n(f.a.rdf.first),e.RDF_REST=n(f.a.rdf.rest),e.RDF_NIL=n(f.a.rdf.nil),e.N3_FORALL=n(f.a.r.forAll),e.N3_FORSOME=n(f.a.r.forSome),e.ABBREVIATIONS={a:n(f.a.rdf.type),"=":n(f.a.owl.sameAs),">":n(f.a.log.implies)},e.QUANTIFIERS_GRAPH=n("urn:n3:quantifiers")}O(I.prototype,T);var R=T.defaultGraph(),N=f.a.rdf,C=f.a.xsd,A=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,E=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,D={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"},L=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"equals",value:function(){return!1}}]),n}(T.internal.Term),B=function(){function e(t,n){if(Object(l.a)(this,e),this._prefixRegex=/$0^/,t&&"function"!==typeof t.write&&(n=t,t=null),n=n||{},this._lists=n.lists,t)this._outputStream=t,this._endStream=void 0===n.end||!!n.end;else{var r="";this._outputStream={write:function(e,t,n){r+=e,n&&n()},end:function(e){e&&e(null,r)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(n.format)?this._writeQuad=this._writeQuadLine:(this._graph=R,this._prefixIRIs=Object.create(null),n.prefixes&&this.addPrefixes(n.prefixes))}return Object(h.a)(e,[{key:"_write",value:function(e,t){this._outputStream.write(e,"utf8",t)}},{key:"_writeQuad",value:function(e,t,n,r,i){try{r.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(R.equals(r)?"":this._encodeIriOrBlank(r)+" {\n")),this._graph=r,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(", "+this._encodeObject(n),i):this._write(";\n    "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(n),i):this._write((null===this._subject?"":".\n")+this._encodeIriOrBlank(this._subject=e)+" "+this._encodePredicate(this._predicate=t)+" "+this._encodeObject(n),i)}catch(a){i&&i(a)}}},{key:"_writeQuadLine",value:function(e,t,n,r,i){delete this._prefixMatch,this._write(this.quadToString(e,t,n,r),i)}},{key:"quadToString",value:function(e,t,n,r){return this._encodeIriOrBlank(e)+" "+this._encodeIriOrBlank(t)+" "+this._encodeObject(n)+(r&&r.value?" "+this._encodeIriOrBlank(r)+" .\n":" .\n")}},{key:"quadsToString",value:function(e){return e.map((function(e){return this.quadToString(e.subject,e.predicate,e.object,e.graph)}),this).join("")}},{key:"_encodeIriOrBlank",value:function(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:"_:"+e.value;var t=e.value;A.test(t)&&(t=t.replace(E,F));var n=this._prefixRegex.exec(t);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:t:"<"+t+">"}},{key:"_encodeLiteral",value:function(e){var t=e.value;return A.test(t)&&(t=t.replace(E,F)),e.language?'"'+t+'"@'+e.language:e.datatype.value!==C.string?'"'+t+'"^^'+this._encodeIriOrBlank(e.datatype):'"'+t+'"'}},{key:"_encodePredicate",value:function(e){return e.value===N.type?"a":this._encodeIriOrBlank(e)}},{key:"_encodeObject",value:function(e){return"Literal"===e.termType?this._encodeLiteral(e):this._encodeIriOrBlank(e)}},{key:"_blockedWrite",value:function(){throw new Error("Cannot write because the writer has been closed.")}},{key:"addQuad",value:function(e,t,n,r,i){void 0===n?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"===typeof r?this._writeQuad(e,t,n,R,r):this._writeQuad(e,t,n,r||R,i)}},{key:"addQuads",value:function(e){for(var t=0;t<e.length;t++)this.addQuad(e[t])}},{key:"addPrefix",value:function(e,t,n){var r={};r[e]=t,this.addPrefixes(r,n)}},{key:"addPrefixes",value:function(e,t){var n=this._prefixIRIs,r=!1;for(var i in e){var a=e[i];"string"!==typeof a&&(a=a.value),r=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),n[a]=i+=":",this._write("@prefix "+i+" <"+a+">.\n")}if(r){var o="",s="";for(var u in n)o+=o?"|"+u:u,s+=(s?"|":"")+n[u];o=o.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&"),this._prefixRegex=new RegExp("^(?:"+s+")[^/]*$|^("+o+")([a-zA-Z][\\-_a-zA-Z0-9]*)$")}this._write(r?"\n":"",t)}},{key:"blank",value:function(e,t){var n,r,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),r=i.length){case 0:return new L("[]");case 1:if(!((n=i[0]).object instanceof L))return new L("[ "+this._encodePredicate(n.predicate)+" "+this._encodeObject(n.object)+" ]");default:for(var a="[",o=0;o<r;o++)(n=i[o]).predicate.equals(e)?a+=", "+this._encodeObject(n.object):(a+=(o?";\n  ":"\n  ")+this._encodePredicate(n.predicate)+" "+this._encodeObject(n.object),e=n.predicate);return new L(a+"\n]")}}},{key:"list",value:function(e){for(var t=e&&e.length||0,n=new Array(t),r=0;r<t;r++)n[r]=this._encodeObject(e[r]);return new L("("+n.join(" ")+")")}},{key:"end",value:function(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;var t=e&&function(n,r){t=null,e(n,r)};if(this._endStream)try{return this._outputStream.end(t)}catch(n){}t&&t()}},{key:"_inDefaultGraph",get:function(){return R.equals(this._graph)}}]),e}();function F(e){var t=D[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var U=n(211),q=n(242),G=n(186),z=T.internal,W=z.toId,V=z.fromId,H=function(){function e(t,n){Object(l.a)(this,e),this._size=0,this._graphs=Object.create(null),this._id=0,this._ids=Object.create(null),this._ids["><"]=0,this._entities=Object.create(null),this._blankNodeIndex=0,n||!t||t[0]||(n=t,t=null),n=n||{},this._factory=n.factory||T,t&&this.addQuads(t)}return Object(h.a)(e,[{key:"_addToIndex",value:function(e,t,n,r){var i=e[t]||(e[t]={}),a=i[n]||(i[n]={}),o=r in a;return o||(a[r]=null),!o}},{key:"_removeFromIndex",value:function(e,t,n,r){var i,a=e[t],o=a[n];for(i in delete o[r],o)return;for(i in delete a[n],a)return;delete e[t]}},{key:"_findInIndex",value:function(e,t,n,r,i,a,o,s,u,c){var l,h,f,d=!t+!n+!r>1?Object.keys(this._ids):this._entities;for(var p in t&&((l=e,e={})[t]=l[t]),e){var v=d[p];if(h=e[p])for(var y in n&&((l=h,h={})[n]=l[n]),h){var g=d[y];if(f=h[y])for(var m=(r?r in f?[r]:[]:Object.keys(f)),b=0;b<m.length;b++){var _={subject:null,predicate:null,object:null};_[i]=V(v,this._factory),_[a]=V(g,this._factory),_[o]=V(d[m[b]],this._factory);var w=this._factory.quad(_.subject,_.predicate,_.object,V(s,this._factory));if(c)c.push(w);else if(u(w))return!0}}}return c}},{key:"_loop",value:function(e,t){for(var n in e)t(n)}},{key:"_loopByKey0",value:function(e,t,n){var r,i;if(r=e[t])for(i in r)n(i)}},{key:"_loopByKey1",value:function(e,t,n){var r;for(r in e)e[r][t]&&n(r)}},{key:"_loopBy2Keys",value:function(e,t,n,r){var i,a,o;if((i=e[t])&&(a=i[n]))for(o in a)r(o)}},{key:"_countInIndex",value:function(e,t,n,r){var i,a,o,s=0;for(var u in t&&((i=e,e={})[t]=i[t]),e)if(a=e[u])for(var c in n&&((i=a,a={})[n]=i[n]),a)(o=a[c])&&(r?r in o&&s++:s+=Object.keys(o).length);return s}},{key:"_getGraphs",value:function(e){if(!X(e))return this._graphs;var t={};return t[e]=this._graphs[e],t}},{key:"_uniqueEntities",value:function(e){var t=Object.create(null),n=this._entities;return function(r){r in t||(t[r]=!0,e(V(n[r])))}}},{key:"addQuad",value:function(e,t,n,r){t||(r=e.graph,n=e.object,t=e.predicate,e=e.subject),e=W(e),t=W(t),n=W(n),r=W(r);var i=this._graphs[r];i||(i=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(i));var a=this._ids,o=this._entities;e=a[e]||(a[o[++this._id]=e]=this._id),t=a[t]||(a[o[++this._id]=t]=this._id),n=a[n]||(a[o[++this._id]=n]=this._id);var s=this._addToIndex(i.subjects,e,t,n);return this._addToIndex(i.predicates,t,n,e),this._addToIndex(i.objects,n,e,t),this._size=null,s}},{key:"addQuads",value:function(e){for(var t=0;t<e.length;t++)this.addQuad(e[t])}},{key:"import",value:function(e){var t=this;return e.on("data",(function(e){t.addQuad(e)})),e}},{key:"removeQuad",value:function(e,t,n,r){t||(r=e.graph,n=e.object,t=e.predicate,e=e.subject),e=W(e),t=W(t),n=W(n),r=W(r);var i,a,o,s=this._ids,u=this._graphs;if(!(e=s[e])||!(t=s[t])||!(n=s[n])||!(i=u[r])||!(a=i.subjects[e])||!(o=a[t])||!(n in o))return!1;for(e in this._removeFromIndex(i.subjects,e,t,n),this._removeFromIndex(i.predicates,t,n,e),this._removeFromIndex(i.objects,n,e,t),null!==this._size&&this._size--,i.subjects)return!0;return delete u[r],!0}},{key:"removeQuads",value:function(e){for(var t=0;t<e.length;t++)this.removeQuad(e[t])}},{key:"remove",value:function(e){var t=this;return e.on("data",(function(e){t.removeQuad(e)})),e}},{key:"removeMatches",value:function(e,t,n,r){return this.remove(this.match(e,t,n,r))}},{key:"deleteGraph",value:function(e){return this.removeMatches(null,null,null,e)}},{key:"getQuads",value:function(e,t,n,r){e=e&&W(e),t=t&&W(t),n=n&&W(n),r=r&&W(r);var i,a,o,s,u=[],c=this._getGraphs(r),l=this._ids;if(X(e)&&!(a=l[e])||X(t)&&!(o=l[t])||X(n)&&!(s=l[n]))return u;for(var h in c)(i=c[h])&&(a?s?this._findInIndex(i.objects,s,a,o,"object","subject","predicate",h,null,u):this._findInIndex(i.subjects,a,o,null,"subject","predicate","object",h,null,u):o?this._findInIndex(i.predicates,o,s,null,"predicate","object","subject",h,null,u):s?this._findInIndex(i.objects,s,null,null,"object","subject","predicate",h,null,u):this._findInIndex(i.subjects,null,null,null,"subject","predicate","object",h,null,u));return u}},{key:"match",value:function(e,t,n,r){var i=this,a=new G.Readable({objectMode:!0});return a._read=function(){var o,s=Object(q.a)(i.getQuads(e,t,n,r));try{for(s.s();!(o=s.n()).done;){var u=o.value;a.push(u)}}catch(c){s.e(c)}finally{s.f()}a.push(null)},a}},{key:"countQuads",value:function(e,t,n,r){e=e&&W(e),t=t&&W(t),n=n&&W(n),r=r&&W(r);var i,a,o,s,u=0,c=this._getGraphs(r),l=this._ids;if(X(e)&&!(a=l[e])||X(t)&&!(o=l[t])||X(n)&&!(s=l[n]))return 0;for(var h in c)(i=c[h])&&(u+=e?n?this._countInIndex(i.objects,s,a,o):this._countInIndex(i.subjects,a,o,s):t?this._countInIndex(i.predicates,o,s,a):this._countInIndex(i.objects,s,a,o));return u}},{key:"forEach",value:function(e,t,n,r,i){this.some((function(t){return e(t),!1}),t,n,r,i)}},{key:"every",value:function(e,t,n,r,i){var a=!1,o=!this.some((function(t){return a=!0,!e(t)}),t,n,r,i);return a&&o}},{key:"some",value:function(e,t,n,r,i){t=t&&W(t),n=n&&W(n),r=r&&W(r),i=i&&W(i);var a,o,s,u,c=this._getGraphs(i),l=this._ids;if(X(t)&&!(o=l[t])||X(n)&&!(s=l[n])||X(r)&&!(u=l[r]))return!1;for(var h in c)if(a=c[h])if(o){if(u){if(this._findInIndex(a.objects,u,o,s,"object","subject","predicate",h,e,null))return!0}else if(this._findInIndex(a.subjects,o,s,null,"subject","predicate","object",h,e,null))return!0}else if(s){if(this._findInIndex(a.predicates,s,u,null,"predicate","object","subject",h,e,null))return!0}else if(u){if(this._findInIndex(a.objects,u,null,null,"object","subject","predicate",h,e,null))return!0}else if(this._findInIndex(a.subjects,null,null,null,"subject","predicate","object",h,e,null))return!0;return!1}},{key:"getSubjects",value:function(e,t,n){var r=[];return this.forSubjects((function(e){r.push(e)}),e,t,n),r}},{key:"forSubjects",value:function(e,t,n,r){t=t&&W(t),n=n&&W(n),r=r&&W(r);var i,a,o,s=this._ids,u=this._getGraphs(r);if(e=this._uniqueEntities(e),!(X(t)&&!(a=s[t])||X(n)&&!(o=s[n])))for(r in u)(i=u[r])&&(a?o?this._loopBy2Keys(i.predicates,a,o,e):this._loopByKey1(i.subjects,a,e):o?this._loopByKey0(i.objects,o,e):this._loop(i.subjects,e))}},{key:"getPredicates",value:function(e,t,n){var r=[];return this.forPredicates((function(e){r.push(e)}),e,t,n),r}},{key:"forPredicates",value:function(e,t,n,r){t=t&&W(t),n=n&&W(n),r=r&&W(r);var i,a,o,s=this._ids,u=this._getGraphs(r);if(e=this._uniqueEntities(e),!(X(t)&&!(a=s[t])||X(n)&&!(o=s[n])))for(r in u)(i=u[r])&&(a?o?this._loopBy2Keys(i.objects,o,a,e):this._loopByKey0(i.subjects,a,e):o?this._loopByKey1(i.predicates,o,e):this._loop(i.predicates,e))}},{key:"getObjects",value:function(e,t,n){var r=[];return this.forObjects((function(e){r.push(e)}),e,t,n),r}},{key:"forObjects",value:function(e,t,n,r){t=t&&W(t),n=n&&W(n),r=r&&W(r);var i,a,o,s=this._ids,u=this._getGraphs(r);if(e=this._uniqueEntities(e),!(X(t)&&!(a=s[t])||X(n)&&!(o=s[n])))for(r in u)(i=u[r])&&(a?o?this._loopBy2Keys(i.subjects,a,o,e):this._loopByKey1(i.objects,a,e):o?this._loopByKey0(i.predicates,o,e):this._loop(i.objects,e))}},{key:"getGraphs",value:function(e,t,n){var r=[];return this.forGraphs((function(e){r.push(e)}),e,t,n),r}},{key:"forGraphs",value:function(e,t,n,r){for(var i in this._graphs)this.some((function(t){return e(t.graph),!0}),t,n,r,i)}},{key:"createBlankNode",value:function(e){var t,n;if(e)for(t=e="_:"+e,n=1;this._ids[t];)t=e+n++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}},{key:"extractLists",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.remove,r=void 0!==n&&n,i=t.ignoreErrors,a=void 0!==i&&i,o={},s=a?function(){return!0}:function(e,t){throw new Error("".concat(e.value," ").concat(t))},u=this.getQuads(null,f.a.rdf.rest,f.a.rdf.nil,null),c=r?Object(U.a)(u):[];return u.forEach((function(t){for(var n,i,a=[],u=!1,l=t.graph,h=t.subject;h&&!u;){var d,p,v=e.getQuads(null,null,h,null),y=e.getQuads(h,null,null,null),g=null,m=null,b=null;for(d=0;d<y.length&&!u;d++)(p=y[d]).graph.equals(l)?n?u=s(h,"has non-list arcs out"):p.predicate.value===f.a.rdf.first?g?u=s(h,"has multiple rdf:first arcs"):c.push(g=p):p.predicate.value===f.a.rdf.rest?m?u=s(h,"has multiple rdf:rest arcs"):c.push(m=p):v.length?u=s(h,"can't be subject and object"):(n=p,i="subject"):u=s(h,"not confined to single graph");for(d=0;d<v.length&&!u;++d)p=v[d],n?u=s(h,"can't have coreferences"):p.predicate.value===f.a.rdf.rest?b?u=s(h,"has incoming rdf:rest arcs"):b=p:(n=p,i="object");g?a.unshift(g.object):u=s(h,"has no list head"),h=b&&b.subject}u?r=!1:n&&(o[n[i].value]=a)})),r&&this.removeQuads(c),o}},{key:"size",get:function(){var e=this._size;if(null!==e)return e;e=0;var t,n,r=this._graphs;for(var i in r)for(var a in t=r[i].subjects)for(var o in n=t[a])e+=Object.keys(n[o]).length;return this._size=e}}]),e}();function X(e){return"string"===typeof e||e instanceof String}var Q=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(l.a)(this,n),(r=t.call(this,{decodeStrings:!0}))._readableState.objectMode=!0;var i,a,o=Object(s.a)(r);return new I(e).parse({on:function(e,t){switch(e){case"data":i=t;break;case"end":a=t}}},(function(e,t){e&&o.emit("error",e)||t&&o.push(t)}),(function(e,t){o.emit("prefix",e,t)})),r._transform=function(e,t,n){i(e),n()},r._flush=function(e){a(),e()},r}return Object(h.a)(n,[{key:"import",value:function(e){var t=this;return e.on("data",(function(e){t.write(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.emit("error",e)})),this}}]),n}(G.Transform),Y=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var r;Object(l.a)(this,n),(r=t.call(this,{encoding:"utf8"}))._writableState.objectMode=!0;var i=Object(s.a)(r),a=r._writer=new B({write:function(e,t,n){i.push(e),n&&n()},end:function(e){i.push(null),e&&e()}},e);return r._transform=function(e,t,n){a.addQuad(e,n)},r._flush=function(e){a.end(e)},r}return Object(h.a)(n,[{key:"import",value:function(e){var t=this;return e.on("data",(function(e){t.write(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.emit("error",e)})),e.on("prefix",(function(e,n){t._writer.addPrefix(e,n)})),this}}]),n}(G.Transform);function J(e){return!!e&&"NamedNode"===e.termType}function K(e){return!!e&&"BlankNode"===e.termType}function Z(e){return!!e&&"Literal"===e.termType}function $(e){return!!e&&"Variable"===e.termType}function ee(e){return!!e&&"DefaultGraph"===e.termType}function te(e){return ee(e.graph)}function ne(e,t){return re({"":e},t)("")}function re(e,t){var n=Object.create(null);for(var r in e)i(r,e[r]);function i(e,r){if("string"===typeof r){var i=Object.create(null);n[e]=function(e){return i[e]||(i[e]=t.namedNode(r+e))}}else if(!(e in n))throw new Error("Unknown prefix: "+e);return n[e]}return t=t||T,i}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=function(){function e(){}return e.prototype.getConstructorMetadata=function(e){return{compilerGeneratedMetadata:Reflect.getMetadata(r.PARAM_TYPES,e),userGeneratedMetadata:Reflect.getMetadata(r.TAGGED,e)||{}}},e.prototype.getPropertiesMetadata=function(e){return Reflect.getMetadata(r.TAGGED_PROP,e)||[]},e}();t.MetadataReader=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96);t.isStackOverflowExeption=function(e){return e instanceof RangeError||e.message===r.STACK_OVERFLOW}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(88),a=n(102),o=n(126),s=function(){function e(e){this._cb=e}return e.prototype.unwrap=function(){return this._cb()},e}();t.LazyServiceIdentifer=s,t.inject=function(e){return function(t,n,s){if(void 0===e)throw new Error(r.UNDEFINED_INJECT_ANNOTATION(t.name));var u=new a.Metadata(i.INJECT_TAG,e);"number"===typeof s?o.tagParameter(t,n,s,u):o.tagProperty(t,n,u)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(138),a=n(102),o=n(299),s=function(){function e(e,t,n,s){this.id=i.id(),this.type=e,this.serviceIdentifier=n,this.name=new o.QueryableString(t||""),this.metadata=new Array;var u=null;"string"===typeof s?u=new a.Metadata(r.NAMED_TAG,s):s instanceof a.Metadata&&(u=s),null!==u&&this.metadata.push(u)}return e.prototype.hasTag=function(e){for(var t=0,n=this.metadata;t<n.length;t++){if(n[t].key===e)return!0}return!1},e.prototype.isArray=function(){return this.hasTag(r.MULTI_INJECT_TAG)},e.prototype.matchesArray=function(e){return this.matchesTag(r.MULTI_INJECT_TAG)(e)},e.prototype.isNamed=function(){return this.hasTag(r.NAMED_TAG)},e.prototype.isTagged=function(){return this.metadata.some((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG}))},e.prototype.isOptional=function(){return this.matchesTag(r.OPTIONAL_TAG)(!0)},e.prototype.getNamedTag=function(){return this.isNamed()?this.metadata.filter((function(e){return e.key===r.NAMED_TAG}))[0]:null},e.prototype.getCustomTags=function(){return this.isTagged()?this.metadata.filter((function(e){return e.key!==r.INJECT_TAG&&e.key!==r.MULTI_INJECT_TAG&&e.key!==r.NAME_TAG&&e.key!==r.UNMANAGED_TAG&&e.key!==r.NAMED_TAG})):null},e.prototype.matchesNamedTag=function(e){return this.matchesTag(r.NAMED_TAG)(e)},e.prototype.matchesTag=function(e){var t=this;return function(n){for(var r=0,i=t.metadata;r<i.length;r++){var a=i[r];if(a.key===e&&a.value===n)return!0}return!1}},e}();t.Target=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(179),i=n(180),a=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new i.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new r.BindingOnSyntax(this._binding)}return e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingWhenOnSyntax=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102);t.traverseAncerstors=function e(t,n){var r=t.parentRequest;return null!==r&&(!!n(r)||e(r,n))};var a=function(e){return function(t){var n=function(n){return null!==n&&null!==n.target&&n.target.matchesTag(e)(t)};return n.metaData=new i.Metadata(e,t),n}};t.taggedConstraint=a;var o=a(r.NAMED_TAG);t.namedConstraint=o;t.typeConstraint=function(e){return function(t){var n=null;if(null!==t){if(n=t.bindings[0],"string"===typeof e)return n.serviceIdentifier===e;var r=t.bindings[0].implementationType;return e===r}return!1}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(113));function s(e){var t=Math.PI-2*Math.PI*e.y/Math.pow(2,e.zoom);return 180/Math.PI*Math.atan(.5*(Math.exp(t)-Math.exp(-t)))}function u(e){return e.x/Math.pow(2,e.zoom)*360-180}var c=function(){function e(t,n,i){r(this,e),this.id=t,this.nodes=n,this.ways=i}return i(e,[{key:"getWays",value:function(){return this.ways}},{key:"getNodes",value:function(){return this.nodes}},{key:"contains",value:function(e){var t=s(this.coordinate),n=u(this.coordinate),r=new o.default(this.coordinate.zoom,this.coordinate.x+1,this.coordinate.y+1),i=s(r),a=u(r);return!(e.latitude>t||e.latitude<i)&&!(e.longitude<n||e.longitude>a)}}]),e}();t.RoutableTile=c},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(172)),d=r(n(119)),p=r(n(109)),v=r(n(120)),y=r(n(106)),g=r(n(137)),m=r(n(121)),b=r(n(122)),_=r(n(98)),w=n(94),x=r(n(123)),T=r(n(176)),S=r(n(90)),k=r(n(145)),M=r(n(124)),P=r(n(133)),I=r(n(134)),j=r(n(178)),O=r(n(160)),R=r(n(125)),N=r(n(81)),C=new i.Container;C.bind(N.default.Context).to(a.default).inSingletonScope(),C.bind(N.default.QueryRunner).to(O.default),C.bind(N.default.LocationResolver).to(R.default),C.bind(N.default.HydraTemplateFetcher).to(d.default).inSingletonScope(),C.bind(N.default.JourneyExtractor).to(M.default),C.bind(N.default.PublicTransportPlanner).to(k.default),C.bind(N.default.PublicTransportPlannerFactory).toAutoFactory(N.default.PublicTransportPlanner),C.bind(N.default.RoadPlanner).to(P.default),C.bind(N.default.ShortestPathTreeAlgorithm).to(x.default).inSingletonScope(),C.bind(N.default.ShortestPathAlgorithm).to(T.default).inSingletonScope(),C.bind(N.default.PathfinderProvider).to(S.default).inSingletonScope(),C.bind(N.default.ProfileFetcher).to(v.default).inSingletonScope(),C.bind(N.default.ProfileProvider).to(y.default).inSingletonScope(),C.bind(N.default.FootpathsProvider).to(f.default).inSingletonScope(),C.bind(N.default.ReachableStopsFinder).to(I.default).whenTargetTagged("phase",o.default.Initial),C.bind(N.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Transfer),C.bind(N.default.ReachableStopsFinder).to(I.default).whenTargetTagged("phase",o.default.Final),C.bind(N.default.CatalogFetcher).to(u.default).inSingletonScope(),C.bind(N.default.CatalogProvider).to(c.default).inSingletonScope(),C.bind(N.default.ConnectionsProvider).to(h.default).inSingletonScope(),C.bind(N.default.ConnectionsFetcher).to(l.default),C.bind(N.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(N.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),C.bind(N.default.StopsProvider).to(m.default).inSingletonScope(),C.bind(N.default.StopsFetcher).to(g.default),C.bind(N.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(N.default.StopsFetcher);return n.setAccessUrl(t),n}})),C.bind(N.default.RoutableTileFetcher).to(b.default).inSingletonScope(),C.bind(N.default.RoutableTileProvider).to(_.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),C.bind(N.default.RoutableTileProvider).to(_.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),C.bind(N.default.LDFetch).to(p.default).inSingletonScope(),C.bind(N.default.LDLoader).to(w.LDLoader),t.default=C},function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,a=r.length,o=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return e}})),u=r[n];n<a;u=r[++n])v(u)||!_(u)?o+=" "+u:o+=" "+s(u);return o},t.deprecate=function(n,r){if("undefined"!==typeof e&&!0===e.noDeprecation)return n;if("undefined"===typeof e)return function(){return t.deprecate(n,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),i=!0}return n.apply(this,arguments)}};var a,o={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),p(n)?r.showHidden=n:n&&t._extend(r,n),m(r.showHidden)&&(r.showHidden=!1),m(r.depth)&&(r.depth=2),m(r.colors)&&(r.colors=!1),m(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=s.styles[t];return n?"\x1b["+s.colors[n][0]+"m"+e+"\x1b["+s.colors[n][1]+"m":e}function c(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,e);return g(i)||(i=l(e,i,r)),i}var a=function(e,t){if(m(t))return e.stylize("undefined","undefined");if(g(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(y(t))return e.stylize(""+t,"number");if(p(t))return e.stylize(""+t,"boolean");if(v(t))return e.stylize("null","null")}(e,n);if(a)return a;var o=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(n)),x(n)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return h(n);if(0===o.length){if(T(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(x(n))return h(n)}var c,_="",S=!1,k=["{","}"];(d(n)&&(S=!0,k=["[","]"]),T(n))&&(_=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(_=" "+RegExp.prototype.toString.call(n)),w(n)&&(_=" "+Date.prototype.toUTCString.call(n)),x(n)&&(_=" "+h(n)),0!==o.length||S&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=S?function(e,t,n,r,i){for(var a=[],o=0,s=t.length;o<s;++o)I(t,String(o))?a.push(f(e,t,n,r,String(o),!0)):a.push("");return i.forEach((function(i){i.match(/^\d+$/)||a.push(f(e,t,n,r,i,!0))})),a}(e,n,r,s,o):o.map((function(t){return f(e,n,r,s,t,S)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,_,k)):k[0]+_+k[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,n,r,i,a){var o,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),I(r,i)||(o="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=v(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(s=a?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),m(o)){if(a&&i.match(/^\d+$/))return s;(o=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=e.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=e.stylize(o,"string"))}return o+": "+s}function d(e){return Array.isArray(e)}function p(e){return"boolean"===typeof e}function v(e){return null===e}function y(e){return"number"===typeof e}function g(e){return"string"===typeof e}function m(e){return void 0===e}function b(e){return _(e)&&"[object RegExp]"===S(e)}function _(e){return"object"===typeof e&&null!==e}function w(e){return _(e)&&"[object Date]"===S(e)}function x(e){return _(e)&&("[object Error]"===S(e)||e instanceof Error)}function T(e){return"function"===typeof e}function S(e){return Object.prototype.toString.call(e)}function k(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(m(a)&&(a=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(new RegExp("\\b"+n+"\\b","i").test(a)){var r=e.pid;o[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else o[n]=function(){};return o[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=p,t.isNull=v,t.isNullOrUndefined=function(e){return null==e},t.isNumber=y,t.isString=g,t.isSymbol=function(e){return"symbol"===typeof e},t.isUndefined=m,t.isRegExp=b,t.isObject=_,t.isDate=w,t.isError=x,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e},t.isBuffer=n(326);var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function P(){var e=new Date,t=[k(e.getHours()),k(e.getMinutes()),k(e.getSeconds())].join(":");return[e.getDate(),M[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",P(),t.format.apply(t,arguments))},t.inherits=n(327),t._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var j="undefined"!==typeof Symbol?Symbol("util.promisify.custom"):void 0;function O(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!==typeof e)throw new TypeError('The "original" argument must be of type Function');if(j&&e[j]){var t;if("function"!==typeof(t=e[j]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,j,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],a=0;a<arguments.length;a++)i.push(arguments[a]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(o){n(o)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),j&&Object.defineProperty(t,j,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=j,t.callbackify=function(t){if("function"!==typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var i=n.pop();if("function"!==typeof i)throw new TypeError("The last argument must be of type Function");var a=this,o=function(){return i.apply(a,arguments)};t.apply(this,n).then((function(t){e.nextTick(o,null,t)}),(function(t){e.nextTick(O,t,o)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n(95))},function(e,t,n){(function(t,n){!function(t){"use strict";"function"===typeof bootstrap?bootstrap("promise",t):e.exports=t()}((function(){"use strict";var e=!1;try{throw new Error}catch(J){e=!!J.stack}var r,i=T(),a=function(){},o=function(){var e={task:void 0,next:null},r=e,i=!1,a=void 0,s=!1,u=[];function c(){for(var t,n;e.next;)t=(e=e.next).task,e.task=void 0,(n=e.domain)&&(e.domain=void 0,n.enter()),l(t,n);for(;u.length;)l(t=u.pop());i=!1}function l(e,t){try{e()}catch(J){if(s)throw t&&t.exit(),setTimeout(c,0),t&&t.enter(),J;setTimeout((function(){throw J}),0)}t&&t.exit()}if(o=function(e){r=r.next={task:e,domain:s&&t.domain,next:null},i||(i=!0,a())},"object"===typeof t&&"[object process]"===t.toString()&&t.nextTick)s=!0,a=function(){t.nextTick(c)};else if("function"===typeof n)a="undefined"!==typeof window?n.bind(window,c):function(){n(c)};else if("undefined"!==typeof MessageChannel){var h=new MessageChannel;h.port1.onmessage=function(){a=f,h.port1.onmessage=c,c()};var f=function(){h.port2.postMessage(0)};a=function(){setTimeout(c,0),f()}}else a=function(){setTimeout(c,0)};return o.runAfter=function(e){u.push(e),i||(i=!0,a())},o}(),s=Function.call;function u(e){return function(){return s.apply(e,arguments)}}var c,l=u(Array.prototype.slice),h=u(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;n<r;n++)n in this&&(t=e(t,this[n],n));return t}),f=u(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),d=u(Array.prototype.map||function(e,t){var n=this,r=[];return h(n,(function(i,a,o){r.push(e.call(t,a,o,n))}),void 0),r}),p=Object.create||function(e){function t(){}return t.prototype=e,new t},v=Object.defineProperty||function(e,t,n){return e[t]=n.value,e},y=u(Object.prototype.hasOwnProperty),g=Object.keys||function(e){var t=[];for(var n in e)y(e,n)&&t.push(n);return t},m=u(Object.prototype.toString);function b(e){return"[object StopIteration]"===m(e)||e instanceof c}c="undefined"!==typeof ReturnValue?ReturnValue:function(e){this.value=e};function _(t,n){if(e&&n.stack&&"object"===typeof t&&null!==t&&t.stack){for(var r=[],i=n;i;i=i.source)i.stack&&(!t.__minimumStackCounter__||t.__minimumStackCounter__>i.stackCounter)&&(v(t,"__minimumStackCounter__",{value:i.stackCounter,configurable:!0}),r.unshift(i.stack));r.unshift(t.stack);var a=function(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var i=t[r];!x(i)&&(-1===(a=i).indexOf("(module.js:")&&-1===a.indexOf("(node.js:"))&&i&&n.push(i)}var a;return n.join("\n")}(r.join("\nFrom previous event:\n"));v(t,"stack",{value:a,configurable:!0})}}function w(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function x(e){var t=w(e);if(!t)return!1;var n=t[0],a=t[1];return n===r&&a>=i&&a<=Y}function T(){if(e)try{throw new Error}catch(J){var t=J.stack.split("\n"),n=w(t[0].indexOf("@")>0?t[1]:t[2]);if(!n)return;return r=n[0],n[1]}}function S(e){return e instanceof j?e:C(e)?function(e){var t=M();return S.nextTick((function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}})),t.promise}(e):z(e)}S.resolve=S,S.nextTick=o,S.longStackSupport=!1;var k=1;function M(){var t,n=[],r=[],i=p(M.prototype),a=p(j.prototype);if(a.promiseDispatch=function(e,i,a){var o=l(arguments);n?(n.push(o),"when"===i&&a[1]&&r.push(a[1])):S.nextTick((function(){t.promiseDispatch.apply(t,o)}))},a.valueOf=function(){if(n)return a;var e=R(t);return N(e)&&(t=e),e},a.inspect=function(){return t?t.inspect():{state:"pending"}},S.longStackSupport&&e)try{throw new Error}catch(J){a.stack=J.stack.substring(J.stack.indexOf("\n")+1),a.stackCounter=k++}function o(i){t=i,S.longStackSupport&&e&&(a.source=i),h(n,(function(e,t){S.nextTick((function(){i.promiseDispatch.apply(i,t)}))}),void 0),n=void 0,r=void 0}return i.promise=a,i.resolve=function(e){t||o(S(e))},i.fulfill=function(e){t||o(z(e))},i.reject=function(e){t||o(G(e))},i.notify=function(e){t||h(r,(function(t,n){S.nextTick((function(){n(e)}))}),void 0)},i}function P(e){if("function"!==typeof e)throw new TypeError("resolver must be a function.");var t=M();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function I(e){return P((function(t,n){for(var r=0,i=e.length;r<i;r++)S(e[r]).then(t,n)}))}function j(e,t,n){void 0===t&&(t=function(e){return G(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=p(j.prototype);if(r.promiseDispatch=function(n,i,a){var o;try{o=e[i]?e[i].apply(r,a):t.call(r,i,a)}catch(s){o=G(s)}n&&n(o)},r.inspect=n,n){var i=n();"rejected"===i.state&&(r.exception=i.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function O(e,t,n,r){return S(e).then(t,n,r)}function R(e){if(N(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function N(e){return e instanceof j}function C(e){return(t=e)===Object(t)&&"function"===typeof e.then;var t}"object"===typeof t&&t&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).Q_DEBUG&&(S.longStackSupport=!0),S.defer=M,M.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(l(arguments,1)):e.resolve(n)}},S.Promise=P,S.promise=P,P.race=I,P.all=H,P.reject=G,P.resolve=S,S.passByCopy=function(e){return e},j.prototype.passByCopy=function(){return this},S.join=function(e,t){return S(e).join(t)},j.prototype.join=function(e){return S([this,e]).spread((function(e,t){if(e===t)return e;throw new Error("Q can't join: not the same: "+e+" "+t)}))},S.race=I,j.prototype.race=function(){return this.then(S.race)},S.makePromise=j,j.prototype.toString=function(){return"[object Promise]"},j.prototype.then=function(e,t,n){var r=this,i=M(),a=!1;return S.nextTick((function(){r.promiseDispatch((function(t){a||(a=!0,i.resolve(function(t){try{return"function"===typeof e?e(t):t}catch(n){return G(n)}}(t)))}),"when",[function(e){a||(a=!0,i.resolve(function(e){if("function"===typeof t){_(e,r);try{return t(e)}catch(n){return G(n)}}return G(e)}(e)))}])})),r.promiseDispatch(void 0,"when",[void 0,function(e){var t,r=!1;try{t=function(e){return"function"===typeof n?n(e):e}(e)}catch(J){if(r=!0,!S.onerror)throw J;S.onerror(J)}r||i.notify(t)}]),i.promise},S.tap=function(e,t){return S(e).tap(t)},j.prototype.tap=function(e){return e=S(e),this.then((function(t){return e.fcall(t).thenResolve(t)}))},S.when=O,j.prototype.thenResolve=function(e){return this.then((function(){return e}))},S.thenResolve=function(e,t){return S(e).thenResolve(t)},j.prototype.thenReject=function(e){return this.then((function(){throw e}))},S.thenReject=function(e,t){return S(e).thenReject(t)},S.nearer=R,S.isPromise=N,S.isPromiseAlike=C,S.isPending=function(e){return N(e)&&"pending"===e.inspect().state},j.prototype.isPending=function(){return"pending"===this.inspect().state},S.isFulfilled=function(e){return!N(e)||"fulfilled"===e.inspect().state},j.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},S.isRejected=function(e){return N(e)&&"rejected"===e.inspect().state},j.prototype.isRejected=function(){return"rejected"===this.inspect().state};var A,E,D,L=[],B=[],F=[],U=!0;function q(){L.length=0,B.length=0,U||(U=!0)}function G(e){var n=j({when:function(n){return n&&function(e){if(U){var n=f(B,e);-1!==n&&("object"===typeof t&&"function"===typeof t.emit&&S.nextTick.runAfter((function(){var r=f(F,e);-1!==r&&(t.emit("rejectionHandled",L[n],e),F.splice(r,1))})),B.splice(n,1),L.splice(n,1))}}(this),n?n(e):this}},(function(){return this}),(function(){return{state:"rejected",reason:e}}));return function(e,n){U&&("object"===typeof t&&"function"===typeof t.emit&&S.nextTick.runAfter((function(){-1!==f(B,e)&&(t.emit("unhandledRejection",n,e),F.push(e))})),B.push(e),n&&"undefined"!==typeof n.stack?L.push(n.stack):L.push("(no stack) "+n))}(n,e),n}function z(e){return j({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},delete:function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return g(e)}},void 0,(function(){return{state:"fulfilled",value:e}}))}function W(e,t,n){return S(e).spread(t,n)}function V(e,t,n){return S(e).dispatch(t,n)}function H(e){return O(e,(function(e){var t=0,n=M();return h(e,(function(r,i,a){var o;N(i)&&"fulfilled"===(o=i.inspect()).state?e[a]=o.value:(++t,O(i,(function(r){e[a]=r,0===--t&&n.resolve(e)}),n.reject,(function(e){n.notify({index:a,value:e})})))}),void 0),0===t&&n.resolve(e),n.promise}))}function X(e){if(0===e.length)return S.resolve();var t=S.defer(),n=0;return h(e,(function(r,i,a){var o=e[a];n++,O(o,(function(e){t.resolve(e)}),(function(e){if(0===--n){var r=e||new Error(""+e);r.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+r.message,t.reject(r)}}),(function(e){t.notify({index:a,value:e})}))}),void 0),t.promise}function Q(e){return O(e,(function(e){return e=d(e,S),O(H(d(e,(function(e){return O(e,a,a)}))),(function(){return e}))}))}S.resetUnhandledRejections=q,S.getUnhandledReasons=function(){return L.slice()},S.stopUnhandledRejectionTracking=function(){q(),U=!1},q(),S.reject=G,S.fulfill=z,S.master=function(e){return j({isDef:function(){}},(function(t,n){return V(e,t,n)}),(function(){return S(e).inspect()}))},S.spread=W,j.prototype.spread=function(e,t){return this.all().then((function(t){return e.apply(void 0,t)}),t)},S.async=function(e){return function(){function t(e,t){var a;if("undefined"===typeof StopIteration){try{a=n[e](t)}catch(o){return G(o)}return a.done?S(a.value):O(a.value,r,i)}try{a=n[e](t)}catch(o){return b(o)?S(o.value):G(o)}return O(a,r,i)}var n=e.apply(this,arguments),r=t.bind(t,"next"),i=t.bind(t,"throw");return r()}},S.spawn=function(e){S.done(S.async(e)())},S.return=function(e){throw new c(e)},S.promised=function(e){return function(){return W([this,H(arguments)],(function(t,n){return e.apply(t,n)}))}},S.dispatch=V,j.prototype.dispatch=function(e,t){var n=this,r=M();return S.nextTick((function(){n.promiseDispatch(r.resolve,e,t)})),r.promise},S.get=function(e,t){return S(e).dispatch("get",[t])},j.prototype.get=function(e){return this.dispatch("get",[e])},S.set=function(e,t,n){return S(e).dispatch("set",[t,n])},j.prototype.set=function(e,t){return this.dispatch("set",[e,t])},S.del=S.delete=function(e,t){return S(e).dispatch("delete",[t])},j.prototype.del=j.prototype.delete=function(e){return this.dispatch("delete",[e])},S.mapply=S.post=function(e,t,n){return S(e).dispatch("post",[t,n])},j.prototype.mapply=j.prototype.post=function(e,t){return this.dispatch("post",[e,t])},S.send=S.mcall=S.invoke=function(e,t){return S(e).dispatch("post",[t,l(arguments,2)])},j.prototype.send=j.prototype.mcall=j.prototype.invoke=function(e){return this.dispatch("post",[e,l(arguments,1)])},S.fapply=function(e,t){return S(e).dispatch("apply",[void 0,t])},j.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},S.try=S.fcall=function(e){return S(e).dispatch("apply",[void 0,l(arguments,1)])},j.prototype.fcall=function(){return this.dispatch("apply",[void 0,l(arguments)])},S.fbind=function(e){var t=S(e),n=l(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(l(arguments))])}},j.prototype.fbind=function(){var e=this,t=l(arguments);return function(){return e.dispatch("apply",[this,t.concat(l(arguments))])}},S.keys=function(e){return S(e).dispatch("keys",[])},j.prototype.keys=function(){return this.dispatch("keys",[])},S.all=H,j.prototype.all=function(){return H(this)},S.any=X,j.prototype.any=function(){return X(this)},S.allResolved=(A=Q,E="allResolved",D="allSettled",function(){return"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(E+" is deprecated, use "+D+" instead.",new Error("").stack),A.apply(A,arguments)}),j.prototype.allResolved=function(){return Q(this)},S.allSettled=function(e){return S(e).allSettled()},j.prototype.allSettled=function(){return this.then((function(e){return H(d(e,(function(e){function t(){return e.inspect()}return(e=S(e)).then(t,t)})))}))},S.fail=S.catch=function(e,t){return S(e).then(void 0,t)},j.prototype.fail=j.prototype.catch=function(e){return this.then(void 0,e)},S.progress=function(e,t){return S(e).then(void 0,void 0,t)},j.prototype.progress=function(e){return this.then(void 0,void 0,e)},S.fin=S.finally=function(e,t){return S(e).finally(t)},j.prototype.fin=j.prototype.finally=function(e){if(!e||"function"!==typeof e.apply)throw new Error("Q can't apply finally callback");return e=S(e),this.then((function(t){return e.fcall().then((function(){return t}))}),(function(t){return e.fcall().then((function(){throw t}))}))},S.done=function(e,t,n,r){return S(e).done(t,n,r)},j.prototype.done=function(e,n,r){var i=function(e){S.nextTick((function(){if(_(e,a),!S.onerror)throw e;S.onerror(e)}))},a=e||n||r?this.then(e,n,r):this;"object"===typeof t&&t&&t.domain&&(i=t.domain.bind(i)),a.then(void 0,i)},S.timeout=function(e,t,n){return S(e).timeout(t,n)},j.prototype.timeout=function(e,t){var n=M(),r=setTimeout((function(){t&&"string"!==typeof t||((t=new Error(t||"Timed out after "+e+" ms")).code="ETIMEDOUT"),n.reject(t)}),e);return this.then((function(e){clearTimeout(r),n.resolve(e)}),(function(e){clearTimeout(r),n.reject(e)}),n.notify),n.promise},S.delay=function(e,t){return void 0===t&&(t=e,e=void 0),S(e).delay(t)},j.prototype.delay=function(e){return this.then((function(t){var n=M();return setTimeout((function(){n.resolve(t)}),e),n.promise}))},S.nfapply=function(e,t){return S(e).nfapply(t)},j.prototype.nfapply=function(e){var t=M(),n=l(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},S.nfcall=function(e){var t=l(arguments,1);return S(e).nfapply(t)},j.prototype.nfcall=function(){var e=l(arguments),t=M();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},S.nfbind=S.denodeify=function(e){if(void 0===e)throw new Error("Q can't wrap an undefined function");var t=l(arguments,1);return function(){var n=t.concat(l(arguments)),r=M();return n.push(r.makeNodeResolver()),S(e).fapply(n).fail(r.reject),r.promise}},j.prototype.nfbind=j.prototype.denodeify=function(){var e=l(arguments);return e.unshift(this),S.denodeify.apply(void 0,e)},S.nbind=function(e,t){var n=l(arguments,2);return function(){var r=n.concat(l(arguments)),i=M();function a(){return e.apply(t,arguments)}return r.push(i.makeNodeResolver()),S(a).fapply(r).fail(i.reject),i.promise}},j.prototype.nbind=function(){var e=l(arguments,0);return e.unshift(this),S.nbind.apply(void 0,e)},S.nmapply=S.npost=function(e,t,n){return S(e).npost(t,n)},j.prototype.nmapply=j.prototype.npost=function(e,t){var n=l(t||[]),r=M();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},S.nsend=S.nmcall=S.ninvoke=function(e,t){var n=l(arguments,2),r=M();return n.push(r.makeNodeResolver()),S(e).dispatch("post",[t,n]).fail(r.reject),r.promise},j.prototype.nsend=j.prototype.nmcall=j.prototype.ninvoke=function(e){var t=l(arguments,1),n=M();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},S.nodeify=function(e,t){return S(e).nodeify(t)},j.prototype.nodeify=function(e){if(!e)return this;this.then((function(t){S.nextTick((function(){e(null,t)}))}),(function(t){S.nextTick((function(){e(t)}))}))},S.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var Y=T();return S}))}).call(this,n(95),n(140).setImmediate)},function(e,t,n){(function(e){var r=n(330),i=n(236),a=n(340),o=n(341),s=n(184),u=t;u.request=function(t,n){t="string"===typeof t?s.parse(t):a(t);var i=-1===e.location.protocol.search(/^https?:$/)?"http:":"",o=t.protocol||i,u=t.hostname||t.host,c=t.port,l=t.path||"/";u&&-1!==u.indexOf(":")&&(u="["+u+"]"),t.url=(u?o+"//"+u:"")+(c?":"+c:"")+l,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var h=new r(t);return n&&h.on("response",n),h},u.get=function(e,t){var n=u.request(e,t);return n.end(),n},u.ClientRequest=r,u.IncomingMessage=i.IncomingMessage,u.Agent=function(){},u.Agent.defaultMaxSockets=4,u.globalAgent=new u.Agent,u.STATUS_CODES=o,u.METHODS=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"]}).call(this,n(40))},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(e){t.fetch=s(e.fetch)&&s(e.ReadableStream),t.writableStream=s(e.WritableStream),t.abortController=s(e.AbortController),t.blobConstructor=!1;try{new Blob([new ArrayBuffer(1)]),t.blobConstructor=!0}catch(u){}var n;function r(){if(void 0!==n)return n;if(e.XMLHttpRequest){n=new e.XMLHttpRequest;try{n.open("GET",e.XDomainRequest?"/":"https://example.com")}catch(u){n=null}}else n=null;return n}function i(e){var t=r();if(!t)return!1;try{return t.responseType=e,t.responseType===e}catch(u){}return!1}var a="undefined"!==typeof e.ArrayBuffer,o=a&&s(e.ArrayBuffer.prototype.slice);function s(e){return"function"===typeof e}t.arraybuffer=t.fetch||a&&i("arraybuffer"),t.msstream=!t.fetch&&o&&i("ms-stream"),t.mozchunkedarraybuffer=!t.fetch&&a&&i("moz-chunked-arraybuffer"),t.overrideMimeType=t.fetch||!!r()&&s(r().overrideMimeType),t.vbArray=s(e.VBArray),n=null}).call(this,n(40))},function(e,t,n){(function(e,r,i){var a=n(235),o=n(129),s=n(149),u=t.readyStates={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},c=t.IncomingMessage=function(t,n,o,u){var c=this;if(s.Readable.call(c),c._mode=o,c.headers={},c.rawHeaders=[],c.trailers={},c.rawTrailers=[],c.on("end",(function(){e.nextTick((function(){c.emit("close")}))})),"fetch"===o){if(c._fetchResponse=n,c.url=n.url,c.statusCode=n.status,c.statusMessage=n.statusText,n.headers.forEach((function(e,t){c.headers[t.toLowerCase()]=e,c.rawHeaders.push(t,e)})),a.writableStream){var l=new WritableStream({write:function(e){return new Promise((function(t,n){c._destroyed?n():c.push(new r(e))?t():c._resumeFetch=t}))},close:function(){i.clearTimeout(u),c._destroyed||c.push(null)},abort:function(e){c._destroyed||c.emit("error",e)}});try{return void n.body.pipeTo(l).catch((function(e){i.clearTimeout(u),c._destroyed||c.emit("error",e)}))}catch(p){}}var h=n.body.getReader();!function e(){h.read().then((function(t){if(!c._destroyed){if(t.done)return i.clearTimeout(u),void c.push(null);c.push(new r(t.value)),e()}})).catch((function(e){i.clearTimeout(u),c._destroyed||c.emit("error",e)}))}()}else{if(c._xhr=t,c._pos=0,c.url=t.responseURL,c.statusCode=t.status,c.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach((function(e){var t=e.match(/^([^:]+):\s*(.*)/);if(t){var n=t[1].toLowerCase();"set-cookie"===n?(void 0===c.headers[n]&&(c.headers[n]=[]),c.headers[n].push(t[2])):void 0!==c.headers[n]?c.headers[n]+=", "+t[2]:c.headers[n]=t[2],c.rawHeaders.push(t[1],t[2])}})),c._charset="x-user-defined",!a.overrideMimeType){var f=c.rawHeaders["mime-type"];if(f){var d=f.match(/;\s*charset=([^;])(;|$)/);d&&(c._charset=d[1].toLowerCase())}c._charset||(c._charset="utf-8")}}};o(c,s.Readable),c.prototype._read=function(){var e=this._resumeFetch;e&&(this._resumeFetch=null,e())},c.prototype._onXHRProgress=function(){var e=this,t=e._xhr,n=null;switch(e._mode){case"text:vbarray":if(t.readyState!==u.DONE)break;try{n=new i.VBArray(t.responseBody).toArray()}catch(l){}if(null!==n){e.push(new r(n));break}case"text":try{n=t.responseText}catch(l){e._mode="text:vbarray";break}if(n.length>e._pos){var a=n.substr(e._pos);if("x-user-defined"===e._charset){for(var o=new r(a.length),s=0;s<a.length;s++)o[s]=255&a.charCodeAt(s);e.push(o)}else e.push(a,e._charset);e._pos=n.length}break;case"arraybuffer":if(t.readyState!==u.DONE||!t.response)break;n=t.response,e.push(new r(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=t.response,t.readyState!==u.LOADING||!n)break;e.push(new r(new Uint8Array(n)));break;case"ms-stream":if(n=t.response,t.readyState!==u.LOADING)break;var c=new i.MSStreamReader;c.onprogress=function(){c.result.byteLength>e._pos&&(e.push(new r(new Uint8Array(c.result.slice(e._pos)))),e._pos=c.result.byteLength)},c.onload=function(){e.push(null)},c.readAsArrayBuffer(n)}e._xhr.readyState===u.DONE&&"ms-stream"!==e._mode&&e.push(null)}}).call(this,n(95),n(115).Buffer,n(40))},function(e,t,n){"use strict";(function(t,r){var i=n(168);e.exports=b;var a,o=n(234);b.ReadableState=m;n(141).EventEmitter;var s=function(e,t){return e.listeners(t).length},u=n(238),c=n(182).Buffer,l=t.Uint8Array||function(){};var h=Object.create(n(150));h.inherits=n(129);var f=n(333),d=void 0;d=f&&f.debuglog?f.debuglog("stream"):function(){};var p,v=n(334),y=n(239);h.inherits(b,u);var g=["error","close","destroy","pause","resume"];function m(e,t){e=e||{};var r=t instanceof(a=a||n(142));this.objectMode=!!e.objectMode,r&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var i=e.highWaterMark,o=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=i||0===i?i:r&&(o||0===o)?o:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new v,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(p||(p=n(240).StringDecoder),this.decoder=new p(e.encoding),this.encoding=e.encoding)}function b(e){if(a=a||n(142),!(this instanceof b))return new b(e);this._readableState=new m(e,this),this.readable=!0,e&&("function"===typeof e.read&&(this._read=e.read),"function"===typeof e.destroy&&(this._destroy=e.destroy)),u.call(this)}function _(e,t,n,r,i){var a,o=e._readableState;null===t?(o.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,T(e)}(e,o)):(i||(a=function(e,t){var n;r=t,c.isBuffer(r)||r instanceof l||"string"===typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(o,t)),a?e.emit("error",a):o.objectMode||t&&t.length>0?("string"===typeof t||o.objectMode||Object.getPrototypeOf(t)===c.prototype||(t=function(e){return c.from(e)}(t)),r?o.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):w(e,o,t,!0):o.ended?e.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!n?(t=o.decoder.write(t),o.objectMode||0!==t.length?w(e,o,t,!1):k(e,o)):w(e,o,t,!1))):r||(o.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(o)}function w(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&T(e)),k(e,t)}Object.defineProperty(b.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),b.prototype.destroy=y.destroy,b.prototype._undestroy=y.undestroy,b.prototype._destroy=function(e,t){this.push(null),t(e)},b.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"===typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=c.from(e,t),t=""),n=!0),_(this,e,t,!1,n)},b.prototype.unshift=function(e){return _(this,e,null,!0,!1)},b.prototype.isPaused=function(){return!1===this._readableState.flowing},b.prototype.setEncoding=function(e){return p||(p=n(240).StringDecoder),this._readableState.decoder=new p(e),this._readableState.encoding=e,this};function x(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=8388608?e=8388608:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(d("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(S,e):S(e))}function S(e){d("emit readable"),e.emit("readable"),j(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(M,e,t))}function M(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(d("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function P(e){d("readable nexttick read 0"),e.read(0)}function I(e,t){t.reading||(d("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),j(e),t.flowing&&!t.reading&&e.read(0)}function j(e){var t=e._readableState;for(d("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var a=n.data,o=e>a.length?a.length:e;if(o===a.length?i+=a:i+=a.slice(0,e),0===(e-=o)){o===a.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=a.slice(o));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=c.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var a=r.data,o=e>a.length?a.length:e;if(a.copy(n,n.length-e,0,o),0===(e-=o)){o===a.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=a.slice(o));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function R(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(N,t,e))}function N(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function C(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}b.prototype.read=function(e){d("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return d("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?R(this):T(this),null;if(0===(e=x(e,t))&&t.ended)return 0===t.length&&R(this),null;var r,i=t.needReadable;return d("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&d("length less than watermark",i=!0),t.ended||t.reading?d("reading or ended",i=!1):i&&(d("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=x(n,t))),null===(r=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&R(this)),null!==r&&this.emit("data",r),r},b.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},b.prototype.pipe=function(e,t){var n=this,a=this._readableState;switch(a.pipesCount){case 0:a.pipes=e;break;case 1:a.pipes=[a.pipes,e];break;default:a.pipes.push(e)}a.pipesCount+=1,d("pipe count=%d opts=%j",a.pipesCount,t);var u=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:b;function c(t,r){d("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,d("cleanup"),e.removeListener("close",g),e.removeListener("finish",m),e.removeListener("drain",h),e.removeListener("error",y),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",b),n.removeListener("data",v),f=!0,!a.awaitDrain||e._writableState&&!e._writableState.needDrain||h())}function l(){d("onend"),e.end()}a.endEmitted?i.nextTick(u):n.once("end",u),e.on("unpipe",c);var h=function(e){return function(){var t=e._readableState;d("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&s(e,"data")&&(t.flowing=!0,j(e))}}(n);e.on("drain",h);var f=!1;var p=!1;function v(t){d("ondata"),p=!1,!1!==e.write(t)||p||((1===a.pipesCount&&a.pipes===e||a.pipesCount>1&&-1!==C(a.pipes,e))&&!f&&(d("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,p=!0),n.pause())}function y(t){d("onerror",t),b(),e.removeListener("error",y),0===s(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",m),b()}function m(){d("onfinish"),e.removeListener("close",g),b()}function b(){d("unpipe"),n.unpipe(e)}return n.on("data",v),function(e,t,n){if("function"===typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?o(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",y),e.once("close",g),e.once("finish",m),e.emit("pipe",n),a.flowing||(d("pipe resume"),n.resume()),e},b.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<i;a++)r[a].emit("unpipe",this,n);return this}var o=C(t.pipes,e);return-1===o||(t.pipes.splice(o,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},b.prototype.on=function(e,t){var n=u.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&T(this):i.nextTick(P,this))}return n},b.prototype.addListener=b.prototype.on,b.prototype.resume=function(){var e=this._readableState;return e.flowing||(d("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(I,e,t))}(this,e)),this},b.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this},b.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(d("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(d("wrapped data"),n.decoder&&(i=n.decoder.write(i)),!n.objectMode||null!==i&&void 0!==i)&&((n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause())))})),e)void 0===this[i]&&"function"===typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var a=0;a<g.length;a++)e.on(g[a],this.emit.bind(this,g[a]));return this._read=function(t){d("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(b.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),b._fromList=O}).call(this,n(40),n(95))},function(e,t,n){e.exports=n(141).EventEmitter},function(e,t,n){"use strict";var r=n(168);function i(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var n=this,a=this._readableState&&this._readableState.destroyed,o=this._writableState&&this._writableState.destroyed;return a||o?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||r.nextTick(i,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(r.nextTick(i,n,e),n._writableState&&(n._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},function(e,t,n){"use strict";var r=n(337).Buffer,i=r.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!==typeof t&&(r.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=u,this.end=c,t=4;break;case"utf8":this.fillLast=s,t=4;break;case"base64":this.text=l,this.end=h,t=3;break;default:return this.write=f,void(this.end=d)}this.lastNeed=0,this.lastTotal=0,this.lastChar=r.allocUnsafe(t)}function o(e){return e<=127?0:e>>5===6?2:e>>4===14?3:e>>3===30?4:e>>6===2?-1:-2}function s(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!==(192&t[0]))return e.lastNeed=0,"\ufffd";if(e.lastNeed>1&&t.length>1){if(128!==(192&t[1]))return e.lastNeed=1,"\ufffd";if(e.lastNeed>2&&t.length>2&&128!==(192&t[2]))return e.lastNeed=2,"\ufffd"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function u(e,t){if((e.length-t)%2===0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function c(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function l(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function h(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function f(e){return e.toString(this.encoding)}function d(e){return e&&e.length?this.write(e):""}t.StringDecoder=a,a.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},a.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"\ufffd":t},a.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=o(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=o(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},a.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,n){"use strict";e.exports=o;var r=n(142),i=Object.create(n(150));function a(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);r.call(this,e),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"===typeof e.transform&&(this._transform=e.transform),"function"===typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"===typeof this._flush?this._flush((function(t,n){u(e,t,n)})):u(this,null,null)}function u(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}i.inherits=n(129),i.inherits(o,r),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,r.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var n=this;r.prototype._destroy.call(this,e,(function(e){t(e),n.emit("close")}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(163);function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(r.a)(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a,o=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==i.return||i.return()}finally{if(s)throw a}}}}},function(e,t){e.exports=function(e,t){var n,r,i,a,o,s=t.indexOf("#");if(s>0&&(t=t.slice(0,s)),0===e.length)return t;if(0===e.indexOf("#"))return t+e;if(e.indexOf(":")>=0)return e;if(n=t.indexOf(":"),0===t.length)return e;if(n<0)return alert("Invalid base: "+t+" in join with given: "+e),e;if(r=t.slice(0,+n+1||9e9),0===e.indexOf("//"))return r+e;if(t.indexOf("//",n)===n+1){if((i=t.indexOf("/",n+3))<0)return t.length-n-3>0?t+"/"+e:r+e}else if((i=t.indexOf("/",n+1))<0)return t.length-n-1>0?t+"/"+e:r+e;if(0===e.indexOf("/"))return t.slice(0,i)+e;if((a=(o=t.slice(i)).lastIndexOf("/"))<0)return r+e;for(a>=0&&a<o.length-1&&(o=o.slice(0,+a+1||9e9)),o+=e;o.match(/[^\/]*\/\.\.\//);)o=o.replace(/[^\/]*\/\.\.\//,"");return o=(o=o.replace(/\.\//g,"")).replace(/\/\.$/,"/"),t.slice(0,i)+o}},function(e,t){function n(e,t){for(var n in e)t[n]=e[n]}function r(e,t){var r=e.prototype;if(Object.create){var i=Object.create(t.prototype);r.__proto__=i}if(!(r instanceof t)){function a(){}a.prototype=t.prototype,n(r,a=new a),e.prototype=r=a}r.constructor!=e&&("function"!=typeof e&&console.error("unknow Class:"+e),r.constructor=e)}var i={},a=i.ELEMENT_NODE=1,o=i.ATTRIBUTE_NODE=2,s=i.TEXT_NODE=3,u=i.CDATA_SECTION_NODE=4,c=i.ENTITY_REFERENCE_NODE=5,l=i.ENTITY_NODE=6,h=i.PROCESSING_INSTRUCTION_NODE=7,f=i.COMMENT_NODE=8,d=i.DOCUMENT_NODE=9,p=i.DOCUMENT_TYPE_NODE=10,v=i.DOCUMENT_FRAGMENT_NODE=11,y=i.NOTATION_NODE=12,g={},m={},b=(g.INDEX_SIZE_ERR=(m[1]="Index size error",1),g.DOMSTRING_SIZE_ERR=(m[2]="DOMString size error",2),g.HIERARCHY_REQUEST_ERR=(m[3]="Hierarchy request error",3)),_=(g.WRONG_DOCUMENT_ERR=(m[4]="Wrong document",4),g.INVALID_CHARACTER_ERR=(m[5]="Invalid character",5),g.NO_DATA_ALLOWED_ERR=(m[6]="No data allowed",6),g.NO_MODIFICATION_ALLOWED_ERR=(m[7]="No modification allowed",7),g.NOT_FOUND_ERR=(m[8]="Not found",8)),w=(g.NOT_SUPPORTED_ERR=(m[9]="Not supported",9),g.INUSE_ATTRIBUTE_ERR=(m[10]="Attribute in use",10));g.INVALID_STATE_ERR=(m[11]="Invalid state",11),g.SYNTAX_ERR=(m[12]="Syntax error",12),g.INVALID_MODIFICATION_ERR=(m[13]="Invalid modification",13),g.NAMESPACE_ERR=(m[14]="Invalid namespace",14),g.INVALID_ACCESS_ERR=(m[15]="Invalid access",15);function x(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,m[e]),this.message=m[e],Error.captureStackTrace&&Error.captureStackTrace(this,x);return n.code=e,t&&(this.message=this.message+": "+t),n}function T(){}function S(e,t){this._node=e,this._refresh=t,k(this)}function k(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var r=e._refresh(e._node);te(e,"length",r.length),n(r,e),e._inc=t}}function M(){}function P(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function I(e,t,n,r){if(r?t[P(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&E(i,e,r),function(e,t,n){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&(t._nsMap[n.prefix?n.localName:""]=n.value)}(i,e,n))}}function j(e,t,n){var r=P(t,n);if(!(r>=0))throw x(_,new Error(e.tagName+"@"+n));for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(E(a,e,n),n.ownerElement=null)}}function O(e){if(this._features={},e)for(var t in e)this._features=e[t]}function R(){}function N(e){return("<"==e?"&lt;":">"==e&&"&gt;")||"&"==e&&"&amp;"||'"'==e&&"&quot;"||"&#"+e.charCodeAt()+";"}function C(e,t){if(t(e))return!0;if(e=e.firstChild)do{if(C(e,t))return!0}while(e=e.nextSibling)}function A(){}function E(e,t,n,r){e&&e._inc++,"http://www.w3.org/2000/xmlns/"==n.namespaceURI&&delete t._nsMap[n.prefix?n.localName:""]}function D(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,a=0;i;)r[a++]=i,i=i.nextSibling;r.length=a}}}function L(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,D(e.ownerDocument,e),t}function B(e,t,n){var r=t.parentNode;if(r&&r.removeChild(t),t.nodeType===v){var i=t.firstChild;if(null==i)return t;var a=t.lastChild}else i=a=t;var o=n?n.previousSibling:e.lastChild;i.previousSibling=o,a.nextSibling=n,o?o.nextSibling=i:e.firstChild=i,null==n?e.lastChild=a:n.previousSibling=a;do{i.parentNode=e}while(i!==a&&(i=i.nextSibling));return D(e.ownerDocument||e,e),t.nodeType==v&&(t.firstChild=t.lastChild=null),t}function F(){this._nsMap={}}function U(){}function q(){}function G(){}function z(){}function W(){}function V(){}function H(){}function X(){}function Q(){}function Y(){}function J(){}function K(){}function Z(e,t){var n=[],r=9==this.nodeType?this.documentElement:this,i=r.prefix,a=r.namespaceURI;if(a&&null==i&&null==(i=r.lookupPrefix(a)))var o=[{namespace:a,prefix:null}];return ee(this,n,e,t,o),n.join("")}function $(e,t,n){var r=e.prefix||"",i=e.namespaceURI;if(!r&&!i)return!1;if("xml"===r&&"http://www.w3.org/XML/1998/namespace"===i||"http://www.w3.org/2000/xmlns/"==i)return!1;for(var a=n.length;a--;){var o=n[a];if(o.prefix==r)return o.namespace!=i}return!0}function ee(e,t,n,r,i){if(r){if(!(e=r(e)))return;if("string"==typeof e)return void t.push(e)}switch(e.nodeType){case a:i||(i=[]);i.length;var l=e.attributes,y=l.length,g=e.firstChild,m=e.tagName;n="http://www.w3.org/1999/xhtml"===e.namespaceURI||n,t.push("<",m);for(var b=0;b<y;b++){"xmlns"==(_=l.item(b)).prefix?i.push({prefix:_.localName,namespace:_.value}):"xmlns"==_.nodeName&&i.push({prefix:"",namespace:_.value})}for(b=0;b<y;b++){var _;if($(_=l.item(b),0,i)){var w=_.prefix||"",x=_.namespaceURI,T=w?" xmlns:"+w:" xmlns";t.push(T,'="',x,'"'),i.push({prefix:w,namespace:x})}ee(_,t,n,r,i)}if($(e,0,i)){w=e.prefix||"",x=e.namespaceURI,T=w?" xmlns:"+w:" xmlns";t.push(T,'="',x,'"'),i.push({prefix:w,namespace:x})}if(g||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(m)){if(t.push(">"),n&&/^script$/i.test(m))for(;g;)g.data?t.push(g.data):ee(g,t,n,r,i),g=g.nextSibling;else for(;g;)ee(g,t,n,r,i),g=g.nextSibling;t.push("</",m,">")}else t.push("/>");return;case d:case v:for(g=e.firstChild;g;)ee(g,t,n,r,i),g=g.nextSibling;return;case o:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,N),'"');case s:return t.push(e.data.replace(/[<&]/g,N));case u:return t.push("<![CDATA[",e.data,"]]>");case f:return t.push("\x3c!--",e.data,"--\x3e");case p:var S=e.publicId,k=e.systemId;if(t.push("<!DOCTYPE ",e.name),S)t.push(' PUBLIC "',S),k&&"."!=k&&t.push('" "',k),t.push('">');else if(k&&"."!=k)t.push(' SYSTEM "',k,'">');else{var M=e.internalSubset;M&&t.push(" [",M,"]"),t.push(">")}return;case h:return t.push("<?",e.target," ",e.data,"?>");case c:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function te(e,t,n){e[t]=n}x.prototype=Error.prototype,n(g,x),T.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)ee(this[r],n,e,t);return n.join("")}},S.prototype.item=function(e){return k(this),this[e]},r(S,T),M.prototype={length:0,item:T.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new x(w);var n=this.getNamedItem(e.nodeName);return I(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t,n=e.ownerElement;if(n&&n!=this._ownerElement)throw new x(w);return t=this.getNamedItemNS(e.namespaceURI,e.localName),I(this._ownerElement,this,e,t),t},removeNamedItem:function(e){var t=this.getNamedItem(e);return j(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return j(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}},O.prototype={hasFeature:function(e,t){var n=this._features[e.toLowerCase()];return!(!n||t&&!(t in n))},createDocument:function(e,t,n){var r=new A;if(r.implementation=this,r.childNodes=new T,r.doctype=n,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new V;return r.name=e,r.nodeName=e,r.publicId=t,r.systemId=n,r}},R.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return B(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t),t&&this.removeChild(t)},removeChild:function(e){return L(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(e){return function e(t,n,r){var i=new n.constructor;for(var s in n){var u=n[s];"object"!=typeof u&&u!=i[s]&&(i[s]=u)}n.childNodes&&(i.childNodes=new T);switch(i.ownerDocument=t,i.nodeType){case a:var c=n.attributes,l=i.attributes=new M,h=c.length;l._ownerElement=i;for(var f=0;f<h;f++)i.setAttributeNode(e(t,c.item(f),!0));break;case o:r=!0}if(r)for(var d=n.firstChild;d;)i.appendChild(e(t,d,r)),d=d.nextSibling;return i}(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==s&&e.nodeType==s?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n)for(var r in n)if(n[r]==e)return r;t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n)return n[e];t=t.nodeType==o?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return null==this.lookupPrefix(e)}},n(i,R),n(i,R.prototype),A.prototype={nodeName:"#document",nodeType:d,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==v){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return null==this.documentElement&&e.nodeType==a&&(this.documentElement=e),B(this,e,t),e.ownerDocument=this,e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),L(this,e)},importNode:function(e,t){return function e(t,n,r){var i;switch(n.nodeType){case a:(i=n.cloneNode(!1)).ownerDocument=t;case v:break;case o:r=!0}i||(i=n.cloneNode(!1));if(i.ownerDocument=t,i.parentNode=null,r)for(var s=n.firstChild;s;)i.appendChild(e(t,s,r)),s=s.nextSibling;return i}(this,e,t)},getElementById:function(e){var t=null;return C(this.documentElement,(function(n){if(n.nodeType==a&&n.getAttribute("id")==e)return t=n,!0})),t},createElement:function(e){var t=new F;return t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.childNodes=new T,(t.attributes=new M)._ownerElement=t,t},createDocumentFragment:function(){var e=new Y;return e.ownerDocument=this,e.childNodes=new T,e},createTextNode:function(e){var t=new G;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new z;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new W;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new J;return n.ownerDocument=this,n.tagName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new U;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new Q;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new F,r=t.split(":"),i=n.attributes=new M;return n.childNodes=new T,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new U,r=t.split(":");return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,2==r.length?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},r(A,R),F.prototype={nodeType:a,hasAttribute:function(e){return null!=this.getAttributeNode(e)},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=""+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===v?this.insertBefore(e,null):function(e,t){var n=t.parentNode;if(n){var r=e.lastChild;n.removeChild(t);r=e.lastChild}return r=e.lastChild,t.parentNode=e,t.previousSibling=r,t.nextSibling=null,r?r.nextSibling=t:e.firstChild=t,e.lastChild=t,D(e.ownerDocument,e,t),t}(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return null!=this.getAttributeNodeNS(e,t)},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||""},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=""+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new S(this,(function(t){var n=[];return C(t,(function(r){r===t||r.nodeType!=a||"*"!==e&&r.tagName!=e||n.push(r)})),n}))},getElementsByTagNameNS:function(e,t){return new S(this,(function(n){var r=[];return C(n,(function(i){i===n||i.nodeType!==a||"*"!==e&&i.namespaceURI!==e||"*"!==t&&i.localName!=t||r.push(i)})),r}))}},A.prototype.getElementsByTagName=F.prototype.getElementsByTagName,A.prototype.getElementsByTagNameNS=F.prototype.getElementsByTagNameNS,r(F,R),U.prototype.nodeType=o,r(U,R),q.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(m[b])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,n){n=this.data.substring(0,e)+n+this.data.substring(e+t),this.nodeValue=this.data=n,this.length=n.length}},r(q,R),G.prototype={nodeName:"#text",nodeType:s,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},r(G,q),z.prototype={nodeName:"#comment",nodeType:f},r(z,q),W.prototype={nodeName:"#cdata-section",nodeType:u},r(W,q),V.prototype.nodeType=p,r(V,R),H.prototype.nodeType=y,r(H,R),X.prototype.nodeType=l,r(X,R),Q.prototype.nodeType=c,r(Q,R),Y.prototype.nodeName="#document-fragment",Y.prototype.nodeType=v,r(Y,R),J.prototype.nodeType=h,r(J,R),K.prototype.serializeToString=function(e,t,n){return Z.call(e,t,n)},R.prototype.toString=Z;try{if(Object.defineProperty){Object.defineProperty(S.prototype,"length",{get:function(){return k(this),this.$$length}}),Object.defineProperty(R.prototype,"textContent",{get:function(){return function e(t){switch(t.nodeType){case a:case v:var n=[];for(t=t.firstChild;t;)7!==t.nodeType&&8!==t.nodeType&&n.push(e(t)),t=t.nextSibling;return n.join("");default:return t.nodeValue}}(this)},set:function(e){switch(this.nodeType){case a:case v:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}}),te=function(e,t,n){e["$$"+t]=n}}}catch(ne){}t.DOMImplementation=O,t.XMLSerializer=K},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=n(360),u=n(189),c=n(246),l=n(248),h=n(191),f=n(143),d={subject:"s",object:"o",graph:"g"};e.exports=function(e){o(n,e);var t=a(n);function n(e){var i;return r(this,n),e=e||{},(i=t.call(this,e)).name="URDNA2015",i.options=Object.assign({},e),i.blankNodeInfo={},i.hashToBlankNodes={},i.canonicalIssuer=new u("_:c14n"),i.hashAlgorithm="sha256",i.quads,i}return i(n,[{key:"main",value:function(e,t){var n,r=this;r.schedule.start=Date.now(),r.quads=e;var i={};r.waterfall([function(t){r.forEach(e,(function(e,t,n){r.forEachComponent(e,(function(t){if("BlankNode"===t.termType){var n=t.value;n in r.blankNodeInfo?r.blankNodeInfo[n].quads.push(e):(i[n]=!0,r.blankNodeInfo[n]={quads:[e]})}})),n()}),t)},function(e){var t=!0;r.whilst((function(){return t}),(function(e){t=!1,r.hashToBlankNodes={},r.waterfall([function(e){r.forEach(i,(function(e,t,n){r.hashFirstDegreeQuads(t,(function(e,i){if(e)return n(e);i in r.hashToBlankNodes?r.hashToBlankNodes[i].push(t):r.hashToBlankNodes[i]=[t],n()}))}),e)},function(e){var n=Object.keys(r.hashToBlankNodes).sort();r.forEach(n,(function(e,n,a){var o=r.hashToBlankNodes[e];if(o.length>1)return a();var s=o[0];r.canonicalIssuer.getId(s),delete i[s],delete r.hashToBlankNodes[e],t=!0,a()}),e)}],e)}),e)},function(e){var t=Object.keys(r.hashToBlankNodes).sort();r.forEach(t,(function(e,t,n){var i=[],a=r.hashToBlankNodes[e];r.waterfall([function(e){r.forEach(a,(function(e,t,n){if(r.canonicalIssuer.hasId(e))return n();var a=new u("_:b");a.getId(e),r.hashNDegreeQuads(e,a,(function(e,t){if(e)return n(e);i.push(t),n()}))}),e)},function(e){i.sort((function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0})),r.forEach(i,(function(e,t,n){for(var i in e.issuer.existing)r.canonicalIssuer.getId(i);n()}),e)}],n)}),e)},function(e){var t=[];r.waterfall([function(e){r.forEach(r.quads,(function(e,n,i){r.forEachComponent(e,(function(e){"BlankNode"!==e.termType||e.value.startsWith(r.canonicalIssuer.prefix)||(e.value=r.canonicalIssuer.getId(e.value))})),t.push(h.serializeQuad(e)),i()}),e)},function(e){return t.sort(),n=t.join(""),e()}],e)}],(function(e){return t(e,n)}))}},{key:"hashFirstDegreeQuads",value:function(e,t){var n=this,r=n.blankNodeInfo[e];if("hash"in r)return t(null,r.hash);var i=[],a=r.quads;n.forEach(a,(function(t,r,a){var o={predicate:t.predicate};n.forEachComponent(t,(function(t,r){o[r]=n.modifyFirstDegreeComponent(e,t,r)})),i.push(h.serializeQuad(o)),a()}),(function(e){if(e)return t(e);i.sort();for(var a=new c(n.hashAlgorithm),o=0;o<i.length;++o)a.update(i[o]);r.hash=a.digest(),t(null,r.hash)}))}},{key:"hashRelatedBlankNode",value:function(e,t,n,r,i){var a,o=this;o.waterfall([function(t){return o.canonicalIssuer.hasId(e)?(a=o.canonicalIssuer.getId(e),t()):n.hasId(e)?(a=n.getId(e),t()):void o.hashFirstDegreeQuads(e,(function(e,n){if(e)return t(e);a=n,t()}))}],(function(e){if(e)return i(e);var n=new c(o.hashAlgorithm);return n.update(r),"g"!==r&&n.update(o.getRelatedPredicate(t)),n.update(a),i(null,n.digest())}))}},{key:"hashNDegreeQuads",value:function(e,t,n){var r,i=this,a=new c(i.hashAlgorithm);i.waterfall([function(n){return i.createHashToRelated(e,t,(function(e,t){if(e)return n(e);r=t,n()}))},function(e){var n=Object.keys(r).sort();i.forEach(n,(function(e,n,o){a.update(e);var s,u="",c=new l(r[e]);i.whilst((function(){return c.hasNext()}),(function(e){var n=c.next(),r=t.clone(),a="",o=[];i.waterfall([function(t){i.forEach(n,(function(t,n,s){if(i.canonicalIssuer.hasId(t)?a+=i.canonicalIssuer.getId(t):(r.hasId(t)||o.push(t),a+=r.getId(t)),0!==u.length&&a>u)return e();s()}),t)},function(t){i.forEach(o,(function(t,n,o){i.hashNDegreeQuads(t,r,(function(n,i){return n?o(n):(a+=r.getId(t),a+="<"+i.hash+">",r=i.issuer,0!==u.length&&a>u?e():void o())}))}),t)},function(e){(0===u.length||a<u)&&(u=a,s=r),e()}],e)}),(function(e){if(e)return o(e);a.update(u),t=s,o()}))}),e)}],(function(e){n(e,{hash:a.digest(),issuer:t})}))}},{key:"modifyFirstDegreeComponent",value:function(e,t){return"BlankNode"!==t.termType||((t=f.clone(t)).value=t.value===e?"_:a":"_:z"),t}},{key:"getRelatedPredicate",value:function(e){return"<"+e.predicate.value+">"}},{key:"createHashToRelated",value:function(e,t,n){var r=this,i={},a=r.blankNodeInfo[e].quads;r.forEach(a,(function(n,a,o){r.forEach(n,(function(a,o,s){if("predicate"===o||"BlankNode"!==a.termType||a.value===e)return s();var u=a.value,c=d[o];r.hashRelatedBlankNode(u,n,t,c,(function(e,t){if(e)return s(e);t in i?i[t].push(u):i[t]=[u],s()}))}),o)}),(function(e){return n(e,i)}))}},{key:"forEachComponent",value:function(e,t){for(var n in e)"predicate"!==n&&t(e[n],n,e)}}]),n}(s)},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(152);n(190),n(361),n(363),e.exports=function(){function e(t){r(this,e),this.md=a.md[t].create()}return i(e,[{key:"update",value:function(e){this.md.update(e,"utf8")}},{key:"digest",value:function(){return this.md.digest().toHex()}}]),e}()},function(e,t,n){(function(t,r,i,a){var o=n(152),s=n(362),u=e.exports=o.util=o.util||{};function c(e){if(8!==e&&16!==e&&24!==e&&32!==e)throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}function l(e){if(this.data="",this.read=0,"string"===typeof e)this.data=e;else if(u.isArrayBuffer(e)||u.isArrayBufferView(e))if("undefined"!==typeof a&&e instanceof a)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch(r){for(var n=0;n<t.length;++n)this.putByte(t[n])}}else(e instanceof l||"object"===typeof e&&"string"===typeof e.data&&"number"===typeof e.read)&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}!function(){if("undefined"!==typeof t&&t.nextTick&&!t.browser)return u.nextTick=t.nextTick,void(u.setImmediate="function"===typeof r?r:u.nextTick);if("function"===typeof r)return u.setImmediate=function(){return r.apply(void 0,arguments)},void(u.nextTick=function(e){return r(e)});if(u.setImmediate=function(e){setTimeout(e,0)},"undefined"!==typeof window&&"function"===typeof window.postMessage){var e="forge.setImmediate",n=[];u.setImmediate=function(t){n.push(t),1===n.length&&window.postMessage(e,"*")},window.addEventListener("message",(function(t){if(t.source===window&&t.data===e){t.stopPropagation();var r=n.slice();n.length=0,r.forEach((function(e){e()}))}}),!0)}if("undefined"!==typeof MutationObserver){var i=Date.now(),a=!0,o=document.createElement("div");n=[];new MutationObserver((function(){var e=n.slice();n.length=0,e.forEach((function(e){e()}))})).observe(o,{attributes:!0});var s=u.setImmediate;u.setImmediate=function(e){Date.now()-i>15?(i=Date.now(),s(e)):(n.push(e),1===n.length&&o.setAttribute("a",a=!a))}}u.nextTick=u.setImmediate}(),u.isNodejs="undefined"!==typeof t&&t.versions&&t.versions.node,u.globalScope=u.isNodejs?i:"undefined"===typeof self?window:self,u.isArray=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},u.isArrayBuffer=function(e){return"undefined"!==typeof ArrayBuffer&&e instanceof ArrayBuffer},u.isArrayBufferView=function(e){return e&&u.isArrayBuffer(e.buffer)&&void 0!==e.byteLength},u.ByteBuffer=l,u.ByteStringBuffer=l;u.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>4096&&(this.data.substr(0,1),this._constructedStringLength=0)},u.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read},u.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0},u.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))},u.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var n=this.data;t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return this.data=n,this._optimizeConstructedString(t),this},u.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this},u.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(u.encodeUtf8(e))},u.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e))},u.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255))},u.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))},u.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(255&e)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))},u.ByteStringBuffer.prototype.putInt=function(e,t){c(t);var n="";do{t-=8,n+=String.fromCharCode(e>>t&255)}while(t>0);return this.putBytes(n)},u.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)},u.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())},u.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)},u.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e},u.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e},u.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e},u.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e},u.ByteStringBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.charCodeAt(this.read++),e-=8}while(e>0);return t},u.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},u.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.ByteStringBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)},u.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this},u.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)},u.ByteStringBuffer.prototype.copy=function(){var e=u.createBuffer(this.data);return e.read=this.read,e},u.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this},u.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this},u.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this},u.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var n=this.data.charCodeAt(t);n<16&&(e+="0"),e+=n.toString(16)}return e},u.ByteStringBuffer.prototype.toString=function(){return u.decodeUtf8(this.bytes())},u.DataBuffer=function(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var n=u.isArrayBuffer(e),r=u.isArrayBufferView(e);if(n||r)return this.data=n?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength),void(this.write="writeOffset"in t?t.writeOffset:this.data.byteLength);this.data=new DataView(new ArrayBuffer(0)),this.write=0,null!==e&&void 0!==e&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)},u.DataBuffer.prototype.length=function(){return this.write-this.read},u.DataBuffer.prototype.isEmpty=function(){return this.length()<=0},u.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var n=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),r=new Uint8Array(this.length()+t);return r.set(n),this.data=new DataView(r.buffer),this},u.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this},u.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var n=0;n<t;++n)this.data.setUint8(e);return this},u.DataBuffer.prototype.putBytes=function(e,t){if(u.isArrayBufferView(e)){var n=(r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)).byteLength-r.byteOffset;return this.accommodate(n),new Uint8Array(this.data.buffer,this.write).set(r),this.write+=n,this}if(u.isArrayBuffer(e)){var r=new Uint8Array(e);return this.accommodate(r.byteLength),new Uint8Array(this.data.buffer).set(r,this.write),this.write+=r.byteLength,this}if(e instanceof u.DataBuffer||"object"===typeof e&&"number"===typeof e.read&&"number"===typeof e.write&&u.isArrayBufferView(e.data)){r=new Uint8Array(e.data.byteLength,e.read,e.length());return this.accommodate(r.byteLength),new Uint8Array(e.data.byteLength,this.write).set(r),this.write+=r.byteLength,this}if(e instanceof u.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary","string"===typeof e){var i;if("hex"===t)return this.accommodate(Math.ceil(e.length/2)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.hex.decode(e,i,this.write),this;if("base64"===t)return this.accommodate(3*Math.ceil(e.length/4)),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.base64.decode(e,i,this.write),this;if("utf8"===t&&(e=u.encodeUtf8(e),t="binary"),"binary"===t||"raw"===t)return this.accommodate(e.length),i=new Uint8Array(this.data.buffer,this.write),this.write+=u.binary.raw.decode(i),this;if("utf16"===t)return this.accommodate(2*e.length),i=new Uint16Array(this.data.buffer,this.write),this.write+=u.text.utf16.encode(i),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)},u.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this},u.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")},u.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this},u.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this},u.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this},u.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this},u.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this},u.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this},u.DataBuffer.prototype.putInt=function(e,t){c(t),this.accommodate(t/8);do{t-=8,this.data.setInt8(this.write++,e>>t&255)}while(t>0);return this},u.DataBuffer.prototype.putSignedInt=function(e,t){return c(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)},u.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)},u.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e},u.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e},u.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e},u.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e},u.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e},u.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e},u.DataBuffer.prototype.getInt=function(e){c(e);var t=0;do{t=(t<<8)+this.data.getInt8(this.read++),e-=8}while(e>0);return t},u.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),n=2<<e-2;return t>=n&&(t-=n<<1),t},u.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):0===e?t="":(t=0===this.read?this.data:this.data.slice(this.read),this.clear()),t},u.DataBuffer.prototype.bytes=function(e){return"undefined"===typeof e?this.data.slice(this.read):this.data.slice(this.read,this.read+e)},u.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)},u.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this},u.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)},u.DataBuffer.prototype.copy=function(){return new u.DataBuffer(this)},u.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this},u.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this},u.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this},u.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var n=this.data.getUint8(t);n<16&&(e+="0"),e+=n.toString(16)}return e},u.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if("binary"===(e=e||"utf8")||"raw"===e)return u.binary.raw.encode(t);if("hex"===e)return u.binary.hex.encode(t);if("base64"===e)return u.binary.base64.encode(t);if("utf8"===e)return u.text.utf8.decode(t);if("utf16"===e)return u.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)},u.createBuffer=function(e,t){return t=t||"raw",void 0!==e&&"utf8"===t&&(e=u.encodeUtf8(e)),new u.ByteBuffer(e)},u.fillString=function(e,t){for(var n="";t>0;)1&t&&(n+=e),(t>>>=1)>0&&(e+=e);return n},u.xorBytes=function(e,t,n){for(var r="",i="",a="",o=0,s=0;n>0;--n,++o)i=e.charCodeAt(o)^t.charCodeAt(o),s>=10&&(r+=a,a="",s=0),a+=String.fromCharCode(i),++s;return r+=a},u.hexToBytes=function(e){var t="",n=0;for(!0&e.length&&(n=1,t+=String.fromCharCode(parseInt(e[0],16)));n<e.length;n+=2)t+=String.fromCharCode(parseInt(e.substr(n,2),16));return t},u.bytesToHex=function(e){return u.createBuffer(e).toHex()},u.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(255&e)};var h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],d="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";u.encode64=function(e,t){for(var n,r,i,a="",o="",s=0;s<e.length;)n=e.charCodeAt(s++),r=e.charCodeAt(s++),i=e.charCodeAt(s++),a+=h.charAt(n>>2),a+=h.charAt((3&n)<<4|r>>4),isNaN(r)?a+="==":(a+=h.charAt((15&r)<<2|i>>6),a+=isNaN(i)?"=":h.charAt(63&i)),t&&a.length>t&&(o+=a.substr(0,t)+"\r\n",a=a.substr(t));return o+=a},u.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t,n,r,i,a="",o=0;o<e.length;)t=f[e.charCodeAt(o++)-43],n=f[e.charCodeAt(o++)-43],r=f[e.charCodeAt(o++)-43],i=f[e.charCodeAt(o++)-43],a+=String.fromCharCode(t<<2|n>>4),64!==r&&(a+=String.fromCharCode((15&n)<<4|r>>2),64!==i&&(a+=String.fromCharCode((3&r)<<6|i)));return a},u.encodeUtf8=function(e){return unescape(encodeURIComponent(e))},u.decodeUtf8=function(e){return decodeURIComponent(escape(e))},u.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:s.encode,decode:s.decode}},u.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)},u.binary.raw.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(e.length));for(var i=n=n||0,a=0;a<e.length;++a)r[i++]=e.charCodeAt(a);return t?i-n:r},u.binary.hex.encode=u.bytesToHex,u.binary.hex.decode=function(e,t,n){var r=t;r||(r=new Uint8Array(Math.ceil(e.length/2)));var i=0,a=n=n||0;for(1&e.length&&(i=1,r[a++]=parseInt(e[0],16));i<e.length;i+=2)r[a++]=parseInt(e.substr(i,2),16);return t?a-n:r},u.binary.base64.encode=function(e,t){for(var n,r,i,a="",o="",s=0;s<e.byteLength;)n=e[s++],r=e[s++],i=e[s++],a+=h.charAt(n>>2),a+=h.charAt((3&n)<<4|r>>4),isNaN(r)?a+="==":(a+=h.charAt((15&r)<<2|i>>6),a+=isNaN(i)?"=":h.charAt(63&i)),t&&a.length>t&&(o+=a.substr(0,t)+"\r\n",a=a.substr(t));return o+=a},u.binary.base64.decode=function(e,t,n){var r,i,a,o,s=t;s||(s=new Uint8Array(3*Math.ceil(e.length/4))),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var u=0,c=n=n||0;u<e.length;)r=f[e.charCodeAt(u++)-43],i=f[e.charCodeAt(u++)-43],a=f[e.charCodeAt(u++)-43],o=f[e.charCodeAt(u++)-43],s[c++]=r<<2|i>>4,64!==a&&(s[c++]=(15&i)<<4|a>>2,64!==o&&(s[c++]=(3&a)<<6|o));return t?c-n:s.subarray(0,c)},u.binary.base58.encode=function(e,t){return u.binary.baseN.encode(e,d,t)},u.binary.base58.decode=function(e,t){return u.binary.baseN.decode(e,d,t)},u.text={utf8:{},utf16:{}},u.text.utf8.encode=function(e,t,n){e=u.encodeUtf8(e);var r=t;r||(r=new Uint8Array(e.length));for(var i=n=n||0,a=0;a<e.length;++a)r[i++]=e.charCodeAt(a);return t?i-n:r},u.text.utf8.decode=function(e){return u.decodeUtf8(String.fromCharCode.apply(null,e))},u.text.utf16.encode=function(e,t,n){var r=t;r||(r=new Uint8Array(2*e.length));for(var i=new Uint16Array(r.buffer),a=n=n||0,o=n,s=0;s<e.length;++s)i[o++]=e.charCodeAt(s),a+=2;return t?a-n:r},u.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))},u.deflate=function(e,t,n){if(t=u.decode64(e.deflate(u.encode64(t)).rval),n){var r=2;32&t.charCodeAt(1)&&(r=6),t=t.substring(r,t.length-4)}return t},u.inflate=function(e,t,n){var r=e.inflate(u.encode64(t)).rval;return null===r?null:u.decode64(r)};var p=function(e,t,n){if(!e)throw new Error("WebStorage not available.");var r;if(null===n?r=e.removeItem(t):(n=u.encode64(JSON.stringify(n)),r=e.setItem(t,n)),"undefined"!==typeof r&&!0!==r.rval){var i=new Error(r.error.message);throw i.id=r.error.id,i.name=r.error.name,i}},v=function(e,t){if(!e)throw new Error("WebStorage not available.");var n=e.getItem(t);if(e.init)if(null===n.rval){if(n.error){var r=new Error(n.error.message);throw r.id=n.error.id,r.name=n.error.name,r}n=null}else n=n.rval;return null!==n&&(n=JSON.parse(u.decode64(n))),n},y=function(e,t,n,r){var i=v(e,t);null===i&&(i={}),i[n]=r,p(e,t,i)},g=function(e,t,n){var r=v(e,t);return null!==r&&(r=n in r?r[n]:null),r},m=function(e,t,n){var r=v(e,t);if(null!==r&&n in r){delete r[n];var i=!0;for(var a in r){i=!1;break}i&&(r=null),p(e,t,r)}},b=function(e,t){p(e,t,null)},_=function(e,t,n){var r,i=null;"undefined"===typeof n&&(n=["web","flash"]);var a=!1,o=null;for(var s in n){r=n[s];try{if("flash"===r||"both"===r){if(null===t[0])throw new Error("Flash local storage not available.");i=e.apply(this,t),a="flash"===r}"web"!==r&&"both"!==r||(t[0]=localStorage,i=e.apply(this,t),a=!0)}catch(u){o=u}if(a)break}if(!a)throw o;return i};u.setItem=function(e,t,n,r,i){_(y,arguments,i)},u.getItem=function(e,t,n,r){return _(g,arguments,r)},u.removeItem=function(e,t,n,r){_(m,arguments,r)},u.clearItems=function(e,t,n){_(b,arguments,n)},u.parseUrl=function(e){var t=/^(https?):\/\/([^:&^\/]*):?(\d*)(.*)$/g;t.lastIndex=0;var n=t.exec(e),r=null===n?null:{full:e,scheme:n[1],host:n[2],port:n[3],path:n[4]};return r&&(r.fullHost=r.host,r.port?(80!==r.port&&"http"===r.scheme||443!==r.port&&"https"===r.scheme)&&(r.fullHost+=":"+r.port):"http"===r.scheme?r.port=80:"https"===r.scheme&&(r.port=443),r.full=r.scheme+"://"+r.fullHost),r};var w=null;u.getQueryVariables=function(e){var t,n=function(e){for(var t={},n=e.split("&"),r=0;r<n.length;r++){var i,a,o=n[r].indexOf("=");o>0?(i=n[r].substring(0,o),a=n[r].substring(o+1)):(i=n[r],a=null),i in t||(t[i]=[]),i in Object.prototype||null===a||t[i].push(unescape(a))}return t};return"undefined"===typeof e?(null===w&&(w="undefined"!==typeof window&&window.location&&window.location.search?n(window.location.search.substring(1)):{}),t=w):t=n(e),t},u.parseFragment=function(e){var t=e,n="",r=e.indexOf("?");r>0&&(t=e.substring(0,r),n=e.substring(r+1));var i=t.split("/");return i.length>0&&""===i[0]&&i.shift(),{pathString:t,queryString:n,path:i,query:""===n?{}:u.getQueryVariables(n)}},u.makeRequest=function(e){var t=u.parseFragment(e),n={path:t.pathString,query:t.queryString,getPath:function(e){return"undefined"===typeof e?t.path:t.path[e]},getQuery:function(e,n){var r;return"undefined"===typeof e?r=t.query:(r=t.query[e])&&"undefined"!==typeof n&&(r=r[n]),r},getQueryLast:function(e,t){var r=n.getQuery(e);return r?r[r.length-1]:t}};return n},u.makeLink=function(e,t,n){e=jQuery.isArray(e)?e.join("/"):e;var r=jQuery.param(t||{});return n=n||"",e+(r.length>0?"?"+r:"")+(n.length>0?"#"+n:"")},u.setPath=function(e,t,n){if("object"===typeof e&&null!==e)for(var r=0,i=t.length;r<i;){var a=t[r++];if(r==i)e[a]=n;else{var o=a in e;(!o||o&&"object"!==typeof e[a]||o&&null===e[a])&&(e[a]={}),e=e[a]}}},u.getPath=function(e,t,n){for(var r=0,i=t.length,a=!0;a&&r<i&&"object"===typeof e&&null!==e;){var o=t[r++];(a=o in e)&&(e=e[o])}return a?e:n},u.deletePath=function(e,t){if("object"===typeof e&&null!==e)for(var n=0,r=t.length;n<r;){var i=t[n++];if(n==r)delete e[i];else{if(!(i in e)||"object"!==typeof e[i]||null===e[i])break;e=e[i]}}},u.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},u.format=function(e){for(var t,n,r=/%./g,i=0,a=[],o=0;t=r.exec(e);){(n=e.substring(o,r.lastIndex-2)).length>0&&a.push(n),o=r.lastIndex;var s=t[0][1];switch(s){case"s":case"o":i<arguments.length?a.push(arguments[1+i++]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+s+"?>")}}return a.push(e.substring(o)),a.join("")},u.formatNumber=function(e,t,n,r){var i=e,a=isNaN(t=Math.abs(t))?2:t,o=void 0===n?",":n,s=void 0===r?".":r,u=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",l=c.length>3?c.length%3:0;return u+(l?c.substr(0,l)+s:"")+c.substr(l).replace(/(\d{3})(?=\d)/g,"$1"+s)+(a?o+Math.abs(i-c).toFixed(a).slice(2):"")},u.formatSize=function(e){return e=e>=1073741824?u.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?u.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?u.formatNumber(e/1024,0)+" KiB":u.formatNumber(e,0)+" bytes"},u.bytesFromIP=function(e){return-1!==e.indexOf(".")?u.bytesFromIPv4(e):-1!==e.indexOf(":")?u.bytesFromIPv6(e):null},u.bytesFromIPv4=function(e){if(4!==(e=e.split(".")).length)return null;for(var t=u.createBuffer(),n=0;n<e.length;++n){var r=parseInt(e[n],10);if(isNaN(r))return null;t.putByte(r)}return t.getBytes()},u.bytesFromIPv6=function(e){for(var t=0,n=2*(8-(e=e.split(":").filter((function(e){return 0===e.length&&++t,!0}))).length+t),r=u.createBuffer(),i=0;i<8;++i)if(e[i]&&0!==e[i].length){var a=u.hexToBytes(e[i]);a.length<2&&r.putByte(0),r.putBytes(a)}else r.fillWithByte(0,n),n=0;return r.getBytes()},u.bytesToIP=function(e){return 4===e.length?u.bytesToIPv4(e):16===e.length?u.bytesToIPv6(e):null},u.bytesToIPv4=function(e){if(4!==e.length)return null;for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t.join(".")},u.bytesToIPv6=function(e){if(16!==e.length)return null;for(var t=[],n=[],r=0,i=0;i<e.length;i+=2){for(var a=u.bytesToHex(e[i]+e[i+1]);"0"===a[0]&&"0"!==a;)a=a.substr(1);if("0"===a){var o=n[n.length-1],s=t.length;o&&s===o.end+1?(o.end=s,o.end-o.start>n[r].end-n[r].start&&(r=n.length-1)):n.push({start:s,end:s})}t.push(a)}if(n.length>0){var c=n[r];c.end-c.start>0&&(t.splice(c.start,c.end-c.start+1,""),0===c.start&&t.unshift(""),7===c.end&&t.push(""))}return t.join(":")},u.estimateCores=function(e,t){if("function"===typeof e&&(t=e,e={}),e=e||{},"cores"in u&&!e.update)return t(null,u.cores);if("undefined"!==typeof navigator&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return u.cores=navigator.hardwareConcurrency,t(null,u.cores);if("undefined"===typeof Worker)return u.cores=1,t(null,u.cores);if("undefined"===typeof Blob)return u.cores=2,t(null,u.cores);var n=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",(function(e){for(var t=Date.now(),n=t+4;Date.now()<n;);self.postMessage({st:t,et:n})}))}.toString(),")()"],{type:"application/javascript"}));!function e(r,i,a){if(0===i){var o=Math.floor(r.reduce((function(e,t){return e+t}),0)/r.length);return u.cores=Math.max(1,o),URL.revokeObjectURL(n),t(null,u.cores)}!function(e,t){for(var r=[],i=[],a=0;a<e;++a){var o=new Worker(n);o.addEventListener("message",(function(n){if(i.push(n.data),i.length===e){for(var a=0;a<e;++a)r[a].terminate();t(null,i)}})),r.push(o)}for(a=0;a<e;++a)r[a].postMessage(a)}(a,(function(t,n){r.push(function(e,t){for(var n=[],r=0;r<e;++r)for(var i=t[r],a=n[r]=[],o=0;o<e;++o)if(r!==o){var s=t[o];(i.st>s.st&&i.st<s.et||s.st>i.st&&s.st<i.et)&&a.push(o)}return n.reduce((function(e,t){return Math.max(e,t.length)}),0)}(a,n)),e(r,i-1,a)}))}([],5,16)}}).call(this,n(95),n(140).setImmediate,n(40),n(115).Buffer)},function(e,t,n){"use strict";var r=n(76),i=n(77);e.exports=function(){function e(t){r(this,e),this.list=t.sort(),this.done=!1,this.left={};for(var n=0;n<t.length;++n)this.left[t[n]]=!0}return i(e,[{key:"hasNext",value:function(){return!this.done}},{key:"next",value:function(){for(var e=this.list.slice(),t=null,n=0,r=this.list.length,i=0;i<r;++i){var a=this.list[i],o=this.left[a];(null===t||a>t)&&(o&&i>0&&a>this.list[i-1]||!o&&i<r-1&&a>this.list[i+1])&&(t=a,n=i)}if(null===t)this.done=!0;else{var s=this.left[t]?n-1:n+1;this.list[n]=this.list[s],this.list[s]=t;for(var u=0;u<r;++u)this.list[u]>t&&(this.left[this.list[u]]=!this.left[this.list[u]])}return e}}]),e}()},function(e,t,n){"use strict";var r=n(82),i=n(76),a=n(77),o=n(189),s=n(246),u=n(248),c=n(191),l=n(143),h={subject:"s",object:"o",graph:"g"};e.exports=function(){function e(){i(this,e),this.name="URDNA2015",this.blankNodeInfo={},this.hashToBlankNodes={},this.canonicalIssuer=new o("_:c14n"),this.hashAlgorithm="sha256",this.quads}return a(e,[{key:"main",value:function(e){var t=this;t.quads=e;var n,i={},a=r(e);try{var s=function(){var e=n.value;t.forEachComponent(e,(function(n){if("BlankNode"===n.termType){var r=n.value;r in t.blankNodeInfo?t.blankNodeInfo[r].quads.push(e):(i[r]=!0,t.blankNodeInfo[r]={quads:[e]})}}))};for(a.s();!(n=a.n()).done;)s()}catch(N){a.e(N)}finally{a.f()}for(var u=!0;u;){for(var l in u=!1,t.hashToBlankNodes={},i){var h=t.hashFirstDegreeQuads(l);h in t.hashToBlankNodes?t.hashToBlankNodes[h].push(l):t.hashToBlankNodes[h]=[l]}for(var f=Object.keys(t.hashToBlankNodes).sort(),d=0;d<f.length;++d){var p=f[d],v=t.hashToBlankNodes[p];if(!(v.length>1)){var y=v[0];t.canonicalIssuer.getId(y),delete i[y],delete t.hashToBlankNodes[p],u=!0}}}for(var g=Object.keys(t.hashToBlankNodes).sort(),m=0;m<g.length;++m){for(var b=[],_=g[m],w=t.hashToBlankNodes[_],x=0;x<w.length;++x){var T=w[x];if(!t.canonicalIssuer.hasId(T)){var S=new o("_:b");S.getId(T);var k=t.hashNDegreeQuads(T,S);b.push(k)}}b.sort((function(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}));for(var M=0;M<b.length;++M){var P=b[M];for(var I in P.issuer.existing)t.canonicalIssuer.getId(I)}}for(var j=[],O=0;O<t.quads.length;++O){var R=t.quads[O];t.forEachComponent(R,(function(e){"BlankNode"!==e.termType||e.value.startsWith(t.canonicalIssuer.prefix)||(e.value=t.canonicalIssuer.getId(e.value))})),j.push(c.serializeQuad(R))}return j.sort(),j.join("")}},{key:"hashFirstDegreeQuads",value:function(e){var t=this,n=t.blankNodeInfo[e];if("hash"in n)return n.hash;for(var r=[],i=n.quads,a=function(n){var a=i[n],o={predicate:a.predicate};t.forEachComponent(a,(function(n,r){o[r]=t.modifyFirstDegreeComponent(e,n,r)})),r.push(c.serializeQuad(o))},o=0;o<i.length;++o)a(o);r.sort();for(var u=new s(t.hashAlgorithm),l=0;l<r.length;++l)u.update(r[l]);return n.hash=u.digest(),n.hash}},{key:"hashRelatedBlankNode",value:function(e,t,n,r){var i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.hashFirstDegreeQuads(e);var a=new s(this.hashAlgorithm);return a.update(r),"g"!==r&&a.update(this.getRelatedPredicate(t)),a.update(i),a.digest()}},{key:"hashNDegreeQuads",value:function(e,t){for(var n=new s(this.hashAlgorithm),r=this.createHashToRelated(e,t),i=Object.keys(r).sort(),a=0;a<i.length;++a){var o=i[a];n.update(o);for(var c="",l=void 0,h=new u(r[o]);h.hasNext();){for(var f=h.next(),d=t.clone(),p="",v=[],y=!1,g=0;g<f.length;++g){var m=f[g];if(this.canonicalIssuer.hasId(m)?p+=this.canonicalIssuer.getId(m):(d.hasId(m)||v.push(m),p+=d.getId(m)),0!==c.length&&p>c){y=!0;break}}if(!y){for(var b=0;b<v.length;++b){var _=v[b],w=this.hashNDegreeQuads(_,d);if(p+=d.getId(_),p+="<"+w.hash+">",d=w.issuer,0!==c.length&&p>c){y=!0;break}}y||(0===c.length||p<c)&&(c=p,l=d)}}n.update(c),t=l}return{hash:n.digest(),issuer:t}}},{key:"modifyFirstDegreeComponent",value:function(e,t){return"BlankNode"!==t.termType||((t=l.clone(t)).value=t.value===e?"_:a":"_:z"),t}},{key:"getRelatedPredicate",value:function(e){return"<"+e.predicate.value+">"}},{key:"createHashToRelated",value:function(e,t){for(var n={},r=this.blankNodeInfo[e].quads,i=0;i<r.length;++i){var a=r[i];for(var o in a){var s=a[o];if("predicate"!==o&&"BlankNode"===s.termType&&s.value!==e){var u=s.value,c=h[o],l=this.hashRelatedBlankNode(u,a,t,c);l in n?n[l].push(u):n[l]=[u]}}}return n}},{key:"forEachComponent",value:function(e,t){for(var n in e)"predicate"!==n&&t(e[n],n,e)}}]),e}()},function(e,t){function n(){this.value=""}n.prototype.equals=function(e){return!!e&&e.termType===this.termType},n.prototype.termType="DefaultGraph",e.exports=n},function(e,t){function n(e){this.value=e}n.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},n.prototype.termType="NamedNode",e.exports=n},function(e,t){e.exports=i,e.exports.parse=i,e.exports.stringify=function e(t){"Feature"===t.type&&(t=t.geometry);function n(e){return e.join(" ")}function r(e){return e.map(n).join(", ")}function i(e){return e.map(r).map(a).join(", ")}function a(e){return"("+e+")"}switch(t.type){case"Point":return"POINT ("+n(t.coordinates)+")";case"LineString":return"LINESTRING ("+r(t.coordinates)+")";case"Polygon":return"POLYGON ("+i(t.coordinates)+")";case"MultiPoint":return"MULTIPOINT ("+r(t.coordinates)+")";case"MultiPolygon":return"MULTIPOLYGON ("+(t.coordinates.map(i).map(a).join(", ")+")");case"MultiLineString":return"MULTILINESTRING ("+i(t.coordinates)+")";case"GeometryCollection":return"GEOMETRYCOLLECTION ("+t.geometries.map(e).join(", ")+")";default:throw new Error("stringify requires a valid GeoJSON Feature or geometry object as input")}};var n=/[-+]?([0-9]*\.[0-9]+|[0-9]+)([eE][-+]?[0-9]+)?/,r=new RegExp("^"+n.source+"(\\s"+n.source+"){1,}");function i(e){var t,n=e.split(";"),i=n.pop(),a=(n.shift()||"").split("=").pop(),o=0;function s(e){var t=i.substring(o).match(e);return t?(o+=t[0].length,t[0]):null}function u(){s(/^\s*/)}function c(){u();for(var e,t=0,n=[],i=[n],a=n;e=s(/^(\()/)||s(/^(\))/)||s(/^(,)/)||s(r);){if("("===e)i.push(a),a=[],i[i.length-1].push(a),t++;else if(")"===e){if(0===a.length)return null;if(!(a=i.pop()))return null;if(0===--t)break}else if(","===e)a=[],i[i.length-1].push(a);else{if(e.split(/\s/g).some(isNaN))return null;Array.prototype.push.apply(a,e.split(/\s/g).map(parseFloat))}u()}return 0!==t?null:n}function l(){for(var e,t,n=[];t=s(r)||s(/^(,)/);)","===t?(n.push(e),e=[]):t.split(/\s/g).some(isNaN)||(e||(e=[]),Array.prototype.push.apply(e,t.split(/\s/g).map(parseFloat))),u();return e?(n.push(e),n.length?n:null):null}function h(){return function(){if(!s(/^(point(\sz)?)/i))return null;if(u(),!s(/^(\()/))return null;var e=l();return e?(u(),s(/^(\))/)?{type:"Point",coordinates:e[0]}:null):null}()||function(){if(!s(/^(linestring(\sz)?)/i))return null;if(u(),!s(/^(\()/))return null;var e=l();return e&&s(/^(\))/)?{type:"LineString",coordinates:e}:null}()||function(){if(!s(/^(polygon(\sz)?)/i))return null;u();var e=c();return e?{type:"Polygon",coordinates:e}:null}()||function(){if(!s(/^(multipoint)/i))return null;u();var e=i.substring(i.indexOf("(")+1,i.length-1).replace(/\(/g,"").replace(/\)/g,"");i="MULTIPOINT ("+e+")";var t=c();return t?(u(),{type:"MultiPoint",coordinates:t}):null}()||function(){if(!s(/^(multilinestring)/i))return null;u();var e=c();return e?(u(),{type:"MultiLineString",coordinates:e}):null}()||function(){if(!s(/^(multipolygon)/i))return null;u();var e=c();return e?{type:"MultiPolygon",coordinates:e}:null}()||function(){var e,t=[];if(!s(/^(geometrycollection)/i))return null;if(u(),!s(/^(\()/))return null;for(;e=h();)t.push(e),u(),s(/^(,)/),u();return s(/^(\))/)?{type:"GeometryCollection",geometries:t}:null}()}return(t=h())&&a.match(/\d+/)&&(t.crs={type:"name",properties:{name:"urn:ogc:def:crs:EPSG::"+a}}),t}},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(79),o=n(76),s=n(77),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(197),n(166);var c=u(n(171)),l=u(n(198)),h=u(n(111)),f=u(n(113)),d=u(n(93)),p=u(n(86)),v=u(n(87)),y=u(n(81)),g=u(n(99)),m=n(139),b=n(426),_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l.default;o(this,e),this.tileProvider=n.getTagged(y.default.RoutableTileProvider,"phase",d.default.Base),this.pathfinderProvider=n.get(y.default.PathfinderProvider),this.registry=h.default.getInstance(),this.profileProvider=n.get(y.default.ProfileProvider),this.eventBus=p.default.getInstance(),this.reachedTiles=new Set,this.startPoint=t,this.showIncremental=!1,this.showDebugLogs=!1,this.embedded=!1,this.setProfileID("http://hdelva.be/profile/car")}return s(e,[{key:"enableIncrementalResults",value:function(){this.showIncremental=!0}},{key:"enableDebugLogs",value:function(){this.showDebugLogs=!0}},{key:"setDevelopmentProfile",value:function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.profileProvider.parseDevelopmentProfile(t);case 2:n=e.sent,this.setProfileID(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setProfileID",value:function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.activeProfile=this.profileProvider.getProfile(t),this.embedded=!1;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIsochrone",value:function(){var e=a(i.mark((function e(t){var n,r,a,o,s,u=arguments;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(u.length>1&&void 0!==u[1])||u[1],this.showDebugLogs&&(console.time(g.default.getId(this.startPoint)),console.log("Generating the ".concat(t/1e3,"s isochrone ")+"from ".concat(this.startPoint.latitude,", ").concat(this.startPoint.longitude))),this.embedded){e.next=6;break}return e.next=5,this.embedBeginPoint(this.startPoint);case 5:this.embedded=!0;case 6:return e.next=8,this.loaded;case 8:return e.next=10,this.activeProfile;case 10:return r=e.sent,this.showDebugLogs&&console.log("Using the ".concat(r.getID()," profile")),a=this.pathfinderProvider.getShortestPathTreeAlgorithm(r),e.next=15,this.tileProvider.wait();case 15:if(a.setUseWeightedCost(!1),!n){e.next=22;break}return e.next=19,a.start(g.default.getId(this.startPoint),t);case 19:o=e.sent,e.next=25;break;case 22:return e.next=24,a.continue(t);case 24:o=e.sent;case 25:return this.showDebugLogs&&(console.log("Path tree computed using ".concat(this.reachedTiles.size," tiles.")),console.timeEnd(g.default.getId(this.startPoint)),console.time(g.default.getId(this.startPoint))),e.next=28,b.visualizeConcaveIsochrone(o,t,this.registry);case 28:return s=e.sent,this.showDebugLogs&&console.timeEnd(g.default.getId(this.startPoint)),e.abrupt("return",s);case 31:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=a(i.mark((function e(t){var n,o=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.tileProvider.getIdForTileCoords(t),this.reachedTiles.has(n)){e.next=3;break}return e.delegateYield(i.mark((function e(){var s,u,c,l,h,f,d,p,y,g,b,_;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o.eventBus.emit(v.default.ReachableTile,t),e.next=3,o.activeProfile;case 3:return s=e.sent,u=o.pathfinderProvider.getShortestPathTreeAlgorithm(s),e.next=7,o.tileProvider.getByTileCoords(t);case 7:c=e.sent,o.reachedTiles.add(n),l=new Set,h=r(c.getNodes());try{for(h.s();!(f=h.n()).done;)d=f.value,u.removeBreakPoint(d),p=o.registry.getNode(d),c.contains(p)||l.add(d),o.showIncremental&&u.setBreakPoint(d,function(){var e=a(i.mark((function e(t){var n;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=y.registry.getNode(t))&&y.eventBus.emit(v.default.ReachableLocation,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(w){h.e(w)}finally{h.f()}y=o,g=r(l);try{for(_=function(){var e=b.value,t=y.registry.getNode(e),n=m.toTileCoordinate(t.latitude,t.longitude);u.setBreakPoint(e,function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchTile(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},g.s();!(b=g.n()).done;)_()}catch(w){g.e(w)}finally{g.f()}case 15:case"end":return e.stop()}}),e)}))(),"t0",3);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"embedBeginPoint",value:function(){var e=a(i.mark((function e(t){var n,r,a,o=this;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 14,.005,n={top:t.latitude+.005,bottom:t.latitude-.005,left:t.longitude-.005,right:t.longitude+.005},r=c.default.tilesInBbox(n,14).map((function(e){var t=new f.default(14,e.x,e.y);return o.fetchTile(t),t})),e.next=6,this.tileProvider.getMultipleByTileCoords(r);case 6:return a=e.sent,e.next=9,this.pathfinderProvider.embedLocation(t,a);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=_},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.Footpath=a},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(t,"__esModule",{value:!0});var o=n(80),s=n(256),u=function(){function e(){r(this,e)}return i(e,[{key:"createInstance",value:function(e){return new s.DijkstraInstance(e)}}]),e}();u=a([o.injectable()],u),t.Dijkstra=u},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(80),d=h(n(173)),p=h(n(148)),v=function(){function e(t){s(this,e),this.useWeightedCost=!0,this.graph=t,this.costs=new Float32Array,this.previousNodes=new Float32Array}return u(e,[{key:"setUseWeightedCost",value:function(e){this.useWeightedCost=e}},{key:"setBreakPoint",value:function(e,t){this.graph.setBreakPoint(e,t)}},{key:"removeBreakPoint",value:function(e){this.graph.removeBreakPoint(e)}},{key:"queryPath",value:function(){var e=o(r.mark((function e(t,n){var o,s,u,c,l,h,f,p,v,y,g,m,b,_,w,x,T,S,k,M,P,I,j,O=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=O.length>2&&void 0!==O[2]?O[2]:1/0,s=this.useWeightedCost?new d.default([],(function(e,t){return e[3]-t[3]})):new d.default([],(function(e,t){return e[2]-t[2]})),this.costs=this.costs.fill(1/0),this.previousNodes=this.previousNodes.fill(void 0),u=this.graph.getNodeIndex(t),this.setCost(u,0),(c=new Float32Array(4))[3]=0,c[0]=u,c[1]=0,c[2]=0,s.push(c),l=this.graph.getNodeIndex(n);case 13:if(!s.length){e.next=28;break}if(h=s.pop(),f=a(h,4),p=f[0],v=f[1],y=f[2],g=f[3],!(v>o)){e.next=17;break}return e.abrupt("break",28);case 17:if(p!==l){e.next=19;break}return e.abrupt("break",28);case 19:if(!(g>this.getCost(p))){e.next=21;break}return e.abrupt("continue",13);case 21:if(!this.graph.getBreakPoint(p)){e.next=24;break}return e.next=24,this.graph.getBreakPoint(p)(this.graph.getLabel(p));case 24:m=i(this.graph.getAdjacencyList()[p]);try{for(m.s();!(b=m.n()).done;)_=b.value,(w=new Float32Array(4))[3]=g+_.cost,w[0]=_.node,w[1]=v+_.distance,w[2]=y+_.duration,w[3]<this.getCost(w[0])&&(this.setCost(w[0],w[3]),this.previousNodes[w[0]]=p,s.push(w))}catch(r){m.e(r)}finally{m.f()}e.next=13;break;case 28:x=l,T=[];case 30:if(isNaN(this.previousNodes[x])){e.next=42;break}S=void 0,k=1/0,M=void 0,P=i(this.graph.getReverseAdjacencyList()[x]);try{for(P.s();!(I=P.n()).done;)j=I.value,this.getCost(j.node)<k&&(k=this.getCost(j.node),S=j,M=j.through)}catch(r){P.e(r)}finally{P.f()}if(S){e.next=38;break}return e.abrupt("break",42);case 38:T.push({from:this.graph.getLabel(S.node),to:this.graph.getLabel(x),distance:S.distance,duration:S.duration,through:M}),x=S.node,e.next=30;break;case 42:return e.abrupt("return",T.reverse());case 43:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setCost",value:function(e,t){if(e>=this.costs.length){var n=new Float32Array(this.graph.getAdjacencyList().length).fill(1/0,this.costs.length);n.set(this.costs),this.costs=n;var r=new Float32Array(this.graph.getAdjacencyList().length).fill(void 0,this.previousNodes.length);r.set(this.previousNodes),this.previousNodes=r}this.costs[e]=t}},{key:"getCost",value:function(e){if(e>=this.costs.length){var t=new Float32Array(this.graph.getAdjacencyList().length).fill(1/0,this.costs.length);t.set(this.costs),this.costs=t;var n=new Float32Array(this.graph.getAdjacencyList().length).fill(void 0,this.previousNodes.length);n.set(this.previousNodes),this.previousNodes=n}return this.costs[e]}}]),e}();v=c([f.injectable(),l("design:paramtypes",[p.default])],v),t.DijkstraInstance=v},function(e,t,n){"use strict";var r=n(78),i=n(85),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(89),d=n(80),p=h(n(81)),v=h(n(159)),y=h(n(146)),g=h(n(200)),m=function(){function e(t){o(this,e),this.locationResolver=t}return s(e,[{key:"extractJourneys",value:function(){var e=a(r.mark((function e(t,n){var a,o,s,u,c,l,h,d,p,m,b,_,w,x,T,S;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=y.default.create(),o=n.from[0].id,s=n.to[0].id;case 3:if(s===o||!t[s]||!t[s].exitConnection){e.next=22;break}return u=t[s],c=u.enterConnection,l=u.exitConnection,h=[this.locationResolver.resolve(c.departureStop),this.locationResolver.resolve(l.arrivalStop)],e.next=9,Promise.all(h);case 9:d=e.sent,p=i(d,2),m=p[0],b=p[1],_=l.arrivalTime,w=c.departureTime,x=_.getTime()-w.getTime(),T=new g.default(m,b,{average:x},w,_,void 0,c.id,l.id),S=new v.default(l.travelMode,[T]),a.prependLeg(S),s=c.departureStop,e.next=3;break;case 22:if(a.legs.length){e.next=24;break}return e.abrupt("return",new f.EmptyIterator);case 24:return e.abrupt("return",new f.SingletonIterator(a));case 25:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();m=u([d.injectable(),l(0,d.inject(p.default.LocationResolver)),c("design:paramtypes",[Object])],m),t.default=m},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(158)),s=function(){function e(){r(this,e)}return i(e,null,[{key:"filterInfinity",value:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n].filter((function(e){return e.departureTime!==1/0})),0===t[n].length&&delete t[n]);return t}},{key:"getTransferTimes",value:function(e,t,n,r,i){var a=t.arrivalStop,s=t.arrivalTime,u=t.tripId;if(t.dropOffType!==o.default.NotAvailable)for(var c=e[a].length-1;c>=0;){var l=e[a][c].departureTime-s.getTime();if(l>=r&&l<=i)return e[a][c].getArrivalTimeByTransfers(u).slice();c--}return Array(n+1).fill({arrivalTime:1/0,tripId:u})}}]),e}();t.default=s},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,null,[{key:"toArray",value:function(e){var t=[];return e.each((function(e){return t.push(e)})),new Promise((function(n){e.on("end",(function(){return n(t)}))}))}},{key:"getFirst",value:function(e){return new Promise((function(t){e.on("readable",(function(){t(e.read())}))}))}},{key:"find",value:function(e,t){return new Promise((function(n,r){e.on("readable",(function(){for(var r=e.read();r&&!t(r);)r=e.read();r&&n(r)})),e.on("end",(function(){return n(null)}))}))}}]),e}();t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(n(421))},function(e,t,n){"use strict";var r=n(76),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(135)),o=function e(){r(this,e)};t.default=o,o.defaultMinimumWalkingSpeed=3,o.defaultMaximumWalkingSpeed=6,o.defaultWalkingDuration=a.default.fromMinutes(10),o.defaultMinimumTransferDuration=a.default.fromMinutes(1),o.defaultMaximumTransferDuration=a.default.fromMinutes(25),o.defaultMaximumTransfers=4},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=n(169),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(87)),c=function(e){a(n,e);var t=i(n);function n(){var e;return r(this,n),(e=t.apply(this,arguments)).eventType=u.default.InvalidQuery,e}return n}(o(Error));t.default=c},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=n(169);Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){a(n,e);var t=i(n);function n(){return r(this,n),t.apply(this,arguments)}return n}(o(Error));t.default=s},function(e,t,n){"use strict";var r=n(265),i=n(431),a=n(432),o=n(434);function s(e,t){for(var n=new Array(e.length-1),r=1;r<e.length;++r)for(var i=n[r-1]=new Array(e.length-1),a=0,o=0;a<e.length;++a)a!==t&&(i[o++]=e[r][a]);return n}function u(e){if(1===e.length)return e[0];if(2===e.length)return["sum(",e[0],",",e[1],")"].join("");var t=e.length>>1;return["sum(",u(e.slice(0,t)),",",u(e.slice(t)),")"].join("")}function c(e){if(2===e.length)return[["sum(prod(",e[0][0],",",e[1][1],"),prod(-",e[0][1],",",e[1][0],"))"].join("")];for(var t=[],n=0;n<e.length;++n)t.push(["scale(",u(c(s(e,n))),",",(r=n,1&r?"-":""),e[0][n],")"].join(""));return t;var r}function l(e){for(var t=[],n=[],l=function(e){for(var t=new Array(e),n=0;n<e;++n){t[n]=new Array(e);for(var r=0;r<e;++r)t[n][r]=["m",r,"[",e-n-1,"]"].join("")}return t}(e),h=[],f=0;f<e;++f)0===(1&f)?t.push.apply(t,c(s(l,f))):n.push.apply(n,c(s(l,f))),h.push("m"+f);var d=u(t),p=u(n),v="orientation"+e+"Exact",y=["function ",v,"(",h.join(),"){var p=",d,",n=",p,",d=sub(p,n);return d[d.length-1];};return ",v].join("");return new Function("sum","prod","scale","sub",y)(i,r,a,o)}var h=l(3),f=l(4),d=[function(){return 0},function(){return 0},function(e,t){return t[0]-e[0]},function(e,t,n){var r,i=(e[1]-n[1])*(t[0]-n[0]),a=(e[0]-n[0])*(t[1]-n[1]),o=i-a;if(i>0){if(a<=0)return o;r=i+a}else{if(!(i<0))return o;if(a>=0)return o;r=-(i+a)}var s=33306690738754716e-32*r;return o>=s||o<=-s?o:h(e,t,n)},function(e,t,n,r){var i=e[0]-r[0],a=t[0]-r[0],o=n[0]-r[0],s=e[1]-r[1],u=t[1]-r[1],c=n[1]-r[1],l=e[2]-r[2],h=t[2]-r[2],d=n[2]-r[2],p=a*c,v=o*u,y=o*s,g=i*c,m=i*u,b=a*s,_=l*(p-v)+h*(y-g)+d*(m-b),w=7771561172376103e-31*((Math.abs(p)+Math.abs(v))*Math.abs(l)+(Math.abs(y)+Math.abs(g))*Math.abs(h)+(Math.abs(m)+Math.abs(b))*Math.abs(d));return _>w||-_>w?_:f(e,t,n,r)}];function p(e){var t=d[e.length];return t||(t=d[e.length]=l(e.length)),t.apply(void 0,e)}!function(){for(;d.length<=5;)d.push(l(d.length));for(var t=[],n=["slow"],r=0;r<=5;++r)t.push("a"+r),n.push("o"+r);var i=["function getOrientation(",t.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(r=2;r<=5;++r)i.push("case ",r,":return o",r,"(",t.slice(0,r).join(),");");i.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),n.push(i.join(""));var a=Function.apply(void 0,n);for(e.exports=a.apply(void 0,[p].concat(d)),r=0;r<=5;++r)e.exports[r]=d[r]}()},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=e*t,a=r*e,o=a-(a-e),s=e-o,u=r*t,c=u-(u-t),l=t-c,h=s*l-(i-o*c-s*c-o*l);if(n)return n[0]=h,n[1]=i,n;return[h,i]};var r=+(Math.pow(2,27)+1)},function(e,t,n){"use strict";var r=n(82),i=n(85),a=n(78),o=n(79),s=n(76),u=n(77),c=this&&this.__await||function(e){return this instanceof c?(this.v=e,this):new c(e)},l=this&&this.__asyncGenerator||function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof c?Promise.resolve(n.value.v).then(u,l):h(a[0][2],n)}catch(r){h(a[0][3],r)}var n}function u(e){s("next",e)}function l(e){s("throw",e)}function h(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(197),n(166);var f=h(n(171)),d=h(n(198)),p=h(n(111)),v=h(n(113)),y=h(n(93)),g=h(n(86)),m=h(n(87)),b=h(n(81)),_=h(n(99)),w=n(139),x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d.default;s(this,e),this.baseTileProvider=n.getTagged(b.default.RoutableTileProvider,"phase",y.default.Base),this.transitTileProvider=n.getTagged(b.default.RoutableTileProvider,"phase",y.default.Transit),this.pathfinderProvider=n.get(b.default.PathfinderProvider),this.registry=p.default.getInstance(),this.profileProvider=n.get(b.default.ProfileProvider),this.eventBus=g.default.getInstance(),this.reachedTiles=new Set,this.startPoint=t,this.showIncremental=!1,this.embedded=!1,this.setProfileID("http://hdelva.be/profile/car")}return u(e,[{key:"enableIncrementalResults",value:function(){this.showIncremental=!0}},{key:"setDevelopmentProfile",value:function(){var e=o(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.profileProvider.parseDevelopmentProfile(t);case 2:n=e.sent,this.setProfileID(n);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setProfileID",value:function(){var e=o(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.activeProfile=this.profileProvider.getProfile(t),this.embedded=!1;case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startSimulation",value:function(e,t){return l(this,arguments,a.mark((function n(){var r,i,o,s,u,l;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=Array.from(e),n.next=3,c(this.activeProfile);case 3:i=n.sent,console.log("Using the ".concat(i.getID()," profile")),o=this.pathfinderProvider.getShortestPathAlgorithm(i);case 6:if(s=r[Math.floor(Math.random()*r.length)],u=r[Math.floor(Math.random()*r.length)],s===u){n.next=17;break}return n.next=12,c(o.queryPath(s,u,1500*t));case 12:return l=n.sent,n.next=15,c(l);case 15:return n.next=17,n.sent;case 17:n.next=6;break;case 19:case"end":return n.stop()}}),n,this)})))}},{key:"getAreaTree",value:function(e,t){return l(this,arguments,a.mark((function n(){var r,i,o,s;return a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(this.embedded){n.next=4;break}return n.next=3,c(this.embedBeginPoint(this.startPoint));case 3:this.embedded=!0;case 4:return n.next=6,c(this.loaded);case 6:return n.next=8,c(this.activeProfile);case 8:return r=n.sent,console.log("Using the ".concat(r.getID()," profile")),i=this.pathfinderProvider.getShortestPathTreeAlgorithm(r),n.next=13,c(i.start(_.default.getId(this.startPoint),e/t));case 13:return o=n.sent,n.next=16,c(this.pruneTree(o));case 16:return n.next=18,n.sent;case 18:s=1;case 19:if(!(s<=t)){n.next=31;break}return console.log(e/t*s),n.next=23,c(i.continue(e/t*s));case 23:return o=n.sent,n.next=26,c(this.pruneTree(o));case 26:return n.next=28,n.sent;case 28:s++,n.next=19;break;case 31:case"end":return n.stop()}}),n,this)})))}},{key:"pruneTree",value:function(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var a=i(r[n],2),o=a[0],s=a[1];s.previousNode&&(t[o]=s)}return t}},{key:"embedBeginPoint",value:function(){var e=o(a.mark((function e(t){var n,r,i,o=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 14,.005,n={top:t.latitude+.005,bottom:t.latitude-.005,left:t.longitude-.005,right:t.longitude+.005},r=f.default.tilesInBbox(n,14).map((function(e){var t=new v.default(14,e.x,e.y);return o.fetchTile(t,!0),t})),e.next=6,this.baseTileProvider.getMultipleByTileCoords(r);case 6:return i=e.sent,e.next=9,this.pathfinderProvider.embedLocation(t,i);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fetchTile",value:function(){var e=o(a.mark((function e(t,n){var i,s=this;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n?this.baseTileProvider.getIdForTileCoords(t):this.transitTileProvider.getIdForTileCoords(t),this.reachedTiles.has(i)){e.next=3;break}return e.delegateYield(a.mark((function e(){var u,c,l,h,f,d,p,v,y,g,b,_;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.eventBus.emit(m.default.ReachableTile,t),e.next=3,s.activeProfile;case 3:if(u=e.sent,c=s.pathfinderProvider.getShortestPathTreeAlgorithm(u),!n){e.next=11;break}return e.next=8,s.baseTileProvider.getByTileCoords(t);case 8:l=e.sent,e.next=14;break;case 11:return e.next=13,s.transitTileProvider.getByTileCoords(t);case 13:l=e.sent;case 14:s.reachedTiles.add(i),h=new Set,f=r(l.getNodes());try{for(f.s();!(d=f.n()).done;)p=d.value,c.removeBreakPoint(p),v=s.registry.getNode(p),l.contains(v)||h.add(p),s.showIncremental&&c.setBreakPoint(p,function(){var e=o(a.mark((function e(t){var n;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=y.registry.getNode(t))&&y.eventBus.emit(m.default.ReachableLocation,n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(x){f.e(x)}finally{f.f()}y=s,g=r(h);try{for(_=function(){var e=b.value,t=y.registry.getNode(e),n=w.toTileCoordinate(t.latitude,t.longitude);c.setBreakPoint(e,function(){var e=o(a.mark((function e(t){return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.fetchTile(n,!1);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},g.s();!(b=g.n()).done;)_()}catch(x){g.e(x)}finally{g.f()}case 21:case"end":return e.stop()}}),e)}))(),"t0",3);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();t.default=x},function(e,t,n){"use strict";var r=n(82),i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(131),o=i(n(202));t.default=function(e,t){var n,i,s=[],u=[],c=[],l=[],h=r(e);try{for(h.s();!(n=h.n()).done;){var f=n.value;f.datatype===a.DataType.Connections?s.push(f):f.datatype===a.DataType.Stops?u.push(f):f.datatype===a.DataType.ReducedRoutableTile?c.push(f):f.datatype===a.DataType.Footpath&&l.push(f)}}catch(b){h.e(b)}finally{h.f()}if(t===a.QueryMode.Dijkstra)i=c.length>0?new a.ReducedCarPlanner:new o.default;else{i=t===a.QueryMode.CSAEarliestArrival?l.length>0?new a.TriangleTransitPlanner:new a.FlexibleTransitPlanner:new a.FlexibleProfileTransitPlanner;var d,p=r(s);try{for(p.s();!(d=p.n()).done;){var v=d.value;i.addConnectionSource(v.accessUrl)}}catch(b){p.e(b)}finally{p.f()}var y,g=r(u);try{for(g.s();!(y=g.n()).done;){var m=y.value;i.addStopSource(m.accessUrl)}}catch(b){g.e(b)}finally{g.f()}}return i}},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(109)),u=n(108),c=o(n(105)),l=o(n(203));function h(){return(h=a(r.mark((function e(t){var n,a,o,h,f,d,p,v,y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.indexOf("tiles")>=0)){e.next=4;break}n=t.indexOf("hdelva.be/")>=0?l.default.ReducedRoutableTile:l.default.RoutableTile,e.next=17;break;case 4:if(!(t.indexOf("hdelva.be/stops/distances/")>=0)){e.next=8;break}n=l.default.Footpath,e.next=17;break;case 8:return a=new s.default,e.next=11,a.get(t);case 11:o=e.sent,h=o.triples,f=new Set,d=i(h);try{for(d.s();!(p=d.n()).done;)v=p.value,y=v.predicate,f.add(y.value)}catch(r){d.e(r)}finally{d.f()}n=f.has(c.default.inNS(u.LC,"departureStop"))?l.default.Connections:f.has(c.default.inNS(u.GEO,"lat"))?l.default.Stops:f.has(c.default.inNS(u.PROFILE,"hasAccessRules"))?l.default.Profile:l.default.Unknown;case 17:return e.abrupt("return",{accessUrl:t,datatype:n});case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.default=function(e){return h.apply(this,arguments)}},function(e,t,n){"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.CSAEarliestArrival=0]="CSAEarliestArrival",e[e.CSAProfile=1]="CSAProfile",e[e.Dijkstra=2]="Dijkstra"}(r||(r={})),t.default=r},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(438)),u=o(n(101)),c=function(e){a(n,e);var t=i(n);function n(){var e;return r(this,n),(e=t.call(this,s.default)).addConnectionSource("https://graph.irail.be/sncb/connections",u.default.Train),e.addConnectionSource("https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/connections",u.default.Bus),e.addConnectionSource("https://openplanner.ilabt.imec.be/mivb/connections",u.default.Bus),e.addStopSource("https://irail.be/stations/NMBS"),e.addStopSource("https://openplanner.ilabt.imec.be/delijn/Oost-Vlaanderen/stops"),e.addStopSource("https://openplanner.ilabt.imec.be/mivb/stops"),e}return n}(o(n(136)).default);t.default=c},function(e,t,n){"use strict";var r=n(112),i=n(82),a=n(78),o=n(85),s=n(79),u=n(76),c=n(77),l=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},h=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d,p=n(80),v=f(n(173)),y=f(n(148));!function(e){e[e.Continue=0]="Continue",e[e.Break=1]="Break",e[e.NodeHandled=2]="NodeHandled"}(d||(d={}));var g=function(){function e(t){u(this,e),this.useWeightedCost=!0,this.graph=t,this.forwardCosts=[],this.forwardParents=[],this.backwardCosts=[],this.backwardParents=[]}return c(e,[{key:"setUseWeightedCost",value:function(e){this.useWeightedCost=e}},{key:"setBreakPoint",value:function(e,t){this.graph.setBreakPoint(e,t)}},{key:"removeBreakPoint",value:function(e){this.graph.removeBreakPoint(e)}},{key:"queryPath",value:function(){var e=s(a.mark((function e(t,n){var r,i,s,u,c,l,h,f,p,y=arguments;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=y.length>2&&void 0!==y[2]?y[2]:1/0,this.useWeightedCost?(i=new v.default([],(function(e,t){return e.cost-t.cost})),s=new v.default([],(function(e,t){return e.cost-t.cost}))):(i=new v.default([],(function(e,t){return e.duration-t.duration})),s=new v.default([],(function(e,t){return e.duration-t.duration}))),this.forwardCosts=this.forwardCosts.fill(1/0),this.forwardParents=this.forwardParents.fill(void 0),this.backwardCosts=this.backwardCosts.fill(1/0),this.backwardParents=this.backwardParents.fill(void 0),u=this.graph.getNodeIndex(t),c=this.graph.getNodeIndex(n),this.setForwardCost(u,0),this.setBackwardCost(c,0),i.push({distance:0,duration:0,cost:0,position:u}),s.push({distance:0,duration:0,cost:0,position:c});case 12:if(!i.length||!s.length){e.next=29;break}return e.next=15,Promise.all([this.forwardStep(i,c,r),this.backwardStep(s,u,r)]);case 15:if(l=e.sent,h=o(l,2),f=h[0],p=h[1],f.kind!==d.Break&&p.kind!==d.Break){e.next=21;break}return e.abrupt("return",[]);case 21:if(f.kind!==d.NodeHandled){e.next=24;break}if(!(this.backwardCosts[f.nodeId]<1/0)){e.next=24;break}return e.abrupt("return",this.constructPath(f.nodeId));case 24:if(p.kind!==d.NodeHandled){e.next=27;break}if(!(this.forwardCosts[p.nodeId]<1/0)){e.next=27;break}return e.abrupt("return",this.constructPath(p.nodeId));case 27:e.next=12;break;case 29:return e.abrupt("return",[]);case 30:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"constructPath",value:function(e){for(var t=e,n=[],r=[];void 0!==this.backwardParents[t];){var a,o=void 0,s=1/0,u=void 0,c=i(this.graph.getAdjacencyList()[t]);try{for(c.s();!(a=c.n()).done;){var l=a.value;this.getBackwardCost(l.node)<s&&(s=this.getBackwardCost(l.node),o=l,u=l.through)}}catch(g){c.e(g)}finally{c.f()}if(!o)break;r.push({from:this.graph.getLabel(t),to:this.graph.getLabel(o.node),through:u,distance:o.distance,duration:o.duration}),t=o.node}for(t=e;void 0!==this.forwardParents[t];){var h,f=void 0,d=1/0,p=void 0,v=i(this.graph.getReverseAdjacencyList()[t]);try{for(v.s();!(h=v.n()).done;){var y=h.value;this.getForwardCost(y.node)<d&&(d=this.getForwardCost(y.node),f=y,p=y.through)}}catch(g){v.e(g)}finally{v.f()}if(!f)break;n.push({from:this.graph.getLabel(f.node),to:this.graph.getLabel(t),through:p,distance:f.distance,duration:f.duration}),t=f.node}return n.reverse().concat(r)}},{key:"forwardStep",value:function(){var e=s(a.mark((function e(t,n,r){var o,s,u,c,l,h,f,p,v;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return",{kind:d.Break});case 2:if(o=t.pop(),s=o.duration,u=o.distance,c=o.cost,l=o.position,!(u>r)){e.next=5;break}return e.abrupt("return",{kind:d.Break});case 5:if(l!==n){e.next=7;break}return e.abrupt("return",{kind:d.Break});case 7:if(!(c>this.getForwardCost(l))){e.next=9;break}return e.abrupt("return",{kind:d.Continue});case 9:if(!this.graph.getBreakPoint(l)){e.next=12;break}return e.next=12,this.graph.getBreakPoint(l)(this.graph.getLabel(l));case 12:h=i(this.graph.getAdjacencyList()[l]);try{for(h.s();!(f=h.n()).done;)p=f.value,(v={distance:u+p.distance,duration:s+p.duration,cost:c+p.cost,position:p.node}).cost<this.getForwardCost(v.position)&&(this.setForwardCost(v.position,v.cost),this.forwardParents[v.position]=l,t.push(v))}catch(a){h.e(a)}finally{h.f()}return e.abrupt("return",{kind:d.NodeHandled,nodeId:l});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"backwardStep",value:function(){var e=s(a.mark((function e(t,n,r){var o,s,u,c,l,h,f,p,v;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.length){e.next=2;break}return e.abrupt("return",{kind:d.Break});case 2:if(o=t.pop(),s=o.duration,u=o.distance,c=o.cost,l=o.position,!(u>r)){e.next=5;break}return e.abrupt("return",{kind:d.Break});case 5:if(l!==n){e.next=7;break}return e.abrupt("return",{kind:d.Break});case 7:if(!(c>this.getBackwardCost(l))){e.next=9;break}return e.abrupt("return",{kind:d.Continue});case 9:if(!this.graph.getBreakPoint(l)){e.next=12;break}return e.next=12,this.graph.getBreakPoint(l)(this.graph.getLabel(l));case 12:h=i(this.graph.getReverseAdjacencyList()[l]);try{for(h.s();!(f=h.n()).done;)p=f.value,(v={distance:u+p.distance,duration:s+p.duration,cost:c+p.cost,position:p.node}).cost<this.getBackwardCost(v.position)&&(this.setBackwardCost(v.position,v.cost),this.backwardParents[v.position]=l,t.push(v))}catch(a){h.e(a)}finally{h.f()}return e.abrupt("return",{kind:d.NodeHandled,nodeId:l});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"setForwardCost",value:function(e,t){if(e>=this.forwardCosts.length){var n=this.graph.getAdjacencyList().length-this.forwardCosts.length;this.forwardCosts=this.forwardCosts.concat(r(Array(n)).fill(1/0)),this.forwardParents=this.forwardParents.concat(r(Array(n)).fill(void 0))}this.forwardCosts[e]=t}},{key:"getForwardCost",value:function(e){if(e>=this.forwardCosts.length){var t=this.graph.getAdjacencyList().length-this.forwardCosts.length;this.forwardCosts=this.forwardCosts.concat(r(Array(t)).fill(1/0)),this.forwardParents=this.forwardParents.concat(r(Array(t)).fill(void 0))}return this.forwardCosts[e]}},{key:"setBackwardCost",value:function(e,t){if(e>=this.backwardCosts.length){var n=this.graph.getAdjacencyList().length-this.backwardCosts.length;this.backwardCosts=this.backwardCosts.concat(r(Array(n)).fill(1/0)),this.backwardParents=this.backwardParents.concat(r(Array(n)).fill(void 0))}this.backwardCosts[e]=t}},{key:"getBackwardCost",value:function(e){if(e>=this.backwardCosts.length){var t=this.graph.getAdjacencyList().length-this.backwardCosts.length;this.backwardCosts=this.backwardCosts.concat(r(Array(t)).fill(1/0)),this.backwardParents=this.backwardParents.concat(r(Array(t)).fill(void 0))}return this.backwardCosts[e]}}]),e}();g=l([p.injectable(),h("design:paramtypes",[y.default])],g),t.BidirDijkstraInstance=g},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(440)),u=function(e){a(n,e);var t=i(n);function n(){return r(this,n),t.call(this,s.default)}return n}(o(n(136)).default);t.default=u},function(e,t,n){"use strict";var r=n(76),i=n(77),a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=a(n(164)),s=function(){function e(t){r(this,e),this.id=t}return i(e,[{key:"contains",value:function(e){var t=o.point([e.longitude,e.latitude]);return o.booleanPointInPolygon(t,this.area)}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=s},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(448)),u=function(e){a(n,e);var t=i(n);function n(){return r(this,n),t.call(this,s.default)}return n}(o(n(136)).default);t.default=u},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(103),o=n(132),s=n(83),u=n(84),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=c(n(449)),h=c(n(101)),f=c(n(81)),d=function(e){u(n,e);var t=s(n);function n(){var e;return r(this,n),(e=t.call(this,l.default)).treeProvider=l.default.get(f.default.HypermediaTreeProvider),e}return i(n,[{key:"addConnectionSource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.default.Train;o(a(n.prototype),"addConnectionSource",this).call(this,e,t),this.treeProvider.addTreeSource(e)}}]),n}(c(n(136)).default);t.default=d},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(103),u=n(132),c=n(83),l=n(84),h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=h(n(451)),d=function(e){l(n,e);var t=c(n);function n(){var e;return a(this,n),(e=t.call(this,f.default)).setProfileID("http://hdelva.be/profile/car"),e}return o(n,[{key:"query",value:function(e){return e.roadNetworkOnly=!0,u(s(n.prototype),"query",this).call(this,e)}},{key:"completePath",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h(n(136)).default);t.default=d},function(e,t,n){"use strict";var r=n(76),i=n(83),a=n(84),o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(n(453)),u=function(e){a(n,e);var t=i(n);function n(){return r(this,n),t.call(this,s.default)}return n}(o(n(136)).default);t.default=u},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(103),u=n(132),c=n(83),l=n(84),h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=h(n(455)),d=function(e){l(n,e);var t=c(n);function n(){return a(this,n),t.call(this,f.default)}return o(n,[{key:"query",value:function(e){return e.roadNetworkOnly=!0,u(s(n.prototype),"query",this).call(this,e)}},{key:"completePath",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),n}(h(n(136)).default);t.default=d},function(e,t,n){"use strict";var r=n(82),i=n(85),a=n(76),o=n(77),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=s(n(105)),c=function(){function e(t){a(this,e),this.rawData={},this.aliases={},Array.isArray(t)?this.processArray(t):(this.rawData=t,this.processObject(t))}return o(e,[{key:"resolveIdentifier",value:function(e){return e.indexOf("://")>0?e:this.aliases[e]?this.aliases[e]:e.indexOf(":")>0?(this.aliases[e]=this.expandURI(e),this.aliases[e]):e}},{key:"processObject",value:function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=i(n[t],2),a=r[0],o=r[1];if(a.indexOf(":")>=0&&(this.aliases[a]=this.expandURI(a)),"object"===typeof o){if(o["@id"]){var s=o["@id"];this.aliases[a]=this.expandURI(s)}}else"string"===typeof o&&(this.aliases[a]=this.expandURI(o))}}},{key:"expandURI",value:function(e){if(e.indexOf("://")>0)return e;if(e.indexOf(":")<0)return e;var t=e.split(":"),n=i(t,2),r=n[0],a=n[1],o=this.rawData[r];return o?u.default.inNS(o,a):e}},{key:"processArray",value:function(e){var t,n=r(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.rawData=Object.assign(this.rawData,i),this.processObject(i)}}catch(a){n.e(a)}finally{n.f()}}}]),e}();t.default=c},function(e,t,n){"use strict";n.r(t),n.d(t,"Delaunay",(function(){return P})),n.d(t,"Voronoi",(function(){return x}));var r=n(242),i=n(78),a=n.n(i),o=n(91),s=n(92),u=Math.pow(2,-52),c=function(){function e(t){Object(o.a)(this,e);var n=1/0,r=1/0,i=-1/0,a=-1/0,s=t.length>>1,c=this.ids=new Uint32Array(s);if(s>0&&"number"!==typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;for(var g=0;g<s;g++){var m=t[2*g],b=t[2*g+1];m<n&&(n=m),b<r&&(r=b),m>i&&(i=m),b>a&&(a=b),c[g]=g}for(var _,w,x,T=(n+i)/2,S=(r+a)/2,k=1/0,M=0;M<s;M++){var P=l(T,S,t[2*M],t[2*M+1]);P<k&&(_=M,k=P)}var I=t[2*_],j=t[2*_+1];k=1/0;for(var O=0;O<s;O++)if(O!==_){var R=l(I,j,t[2*O],t[2*O+1]);R<k&&R>0&&(w=O,k=R)}for(var N=t[2*w],C=t[2*w+1],A=1/0,E=0;E<s;E++)if(E!==_&&E!==w){var D=f(I,j,N,C,t[2*E],t[2*E+1]);D<A&&(x=E,A=D)}var L=t[2*x],B=t[2*x+1];if(A===1/0)throw new Error("No Delaunay triangulation exists for this input.");if(h(I,j,N,C,L,B)){var F=w,U=N,q=C;w=x,N=L,C=B,x=F,L=U,B=q}var G=function(e,t,n,r,i,a){var o=n-e,s=r-t,u=i-e,c=a-t,l=o*o+s*s,h=u*u+c*c,f=o*c-s*u;return{x:e+.5*(c*l-s*h)/f,y:t+.5*(o*h-u*l)/f}}(I,j,N,C,L,B);this._cx=G.x,this._cy=G.y,function e(t,n,r,i,a,o){var s,u,c;if(i-r<=20)for(s=r+1;s<=i;s++){for(c=t[s],u=s-1;u>=r&&v(n,t[u],c,a,o)>0;)t[u+1]=t[u--];t[u+1]=c}else{for(u=i,y(t,r+i>>1,s=r+1),v(n,t[r],t[i],a,o)>0&&y(t,r,i),v(n,t[s],t[i],a,o)>0&&y(t,s,i),v(n,t[r],t[s],a,o)>0&&y(t,r,s),c=t[s];;){do{s++}while(v(n,t[s],c,a,o)<0);do{u--}while(v(n,t[u],c,a,o)>0);if(u<s)break;y(t,s,u)}t[r+1]=t[u],t[u]=c,i-s+1>=u-r?(e(t,n,s,i,a,o),e(t,n,r,u-1,a,o)):(e(t,n,r,u-1,a,o),e(t,n,s,i,a,o))}}(c,t,0,c.length-1,G.x,G.y),this._hashSize=Math.ceil(Math.sqrt(s)),this._hash=new Array(this._hashSize);var z=this.hull=d(t,_);this._hashEdge(z),z.t=0,z=d(t,w,z),this._hashEdge(z),z.t=1,z=d(t,x,z),this._hashEdge(z),z.t=2;var W=2*s-5,V=this.triangles=new Uint32Array(3*W),H=this.halfedges=new Int32Array(3*W);this.trianglesLen=0,this._addTriangle(_,w,x,-1,-1,-1);for(var X,Q,Y=0;Y<c.length;Y++){var J=c[Y],K=t[2*J],Z=t[2*J+1];if(!(Y>0&&Math.abs(K-X)<=u&&Math.abs(Z-Q)<=u)&&(X=K,Q=Z,J!==_&&J!==w&&J!==x)){var $=this._hashKey(K,Z),ee=$,te=void 0;do{te=this._hash[ee],ee=(ee+1)%this._hashSize}while((!te||te.removed)&&ee!==$);for(z=te=te.prev;!h(K,Z,z.x,z.y,z.next.x,z.next.y);)if((z=z.next)===te){z=null;break}if(z){var ne=z===te,re=this._addTriangle(z.i,J,z.next.i,-1,-1,z.t);z.t=re,(z=d(t,J,z)).t=this._legalize(re+2);for(var ie=z.next;h(K,Z,ie.x,ie.y,ie.next.x,ie.next.y);)re=this._addTriangle(ie.i,J,ie.next.i,ie.prev.t,-1,ie.t),ie.prev.t=this._legalize(re+2),this.hull=p(ie),ie=ie.next;if(ne)for(ie=z.prev;h(K,Z,ie.prev.x,ie.prev.y,ie.x,ie.y);)re=this._addTriangle(ie.prev.i,J,ie.i,-1,ie.t,ie.prev.t),this._legalize(re+2),ie.prev.t=re,this.hull=p(ie),ie=ie.prev;this._hashEdge(z),this._hashEdge(z.prev)}}}this.triangles=V.subarray(0,this.trianglesLen),this.halfedges=H.subarray(0,this.trianglesLen)}return Object(s.a)(e,null,[{key:"from",value:function(t,n,r){n||(n=g),r||(r=m);for(var i=t.length,a=new Float64Array(2*i),o=0;o<i;o++){var s=t[o];a[2*o]=n(s),a[2*o+1]=r(s)}return new e(a)}}]),Object(s.a)(e,[{key:"_hashEdge",value:function(e){this._hash[this._hashKey(e.x,e.y)]=e}},{key:"_hashKey",value:function(e,t){return Math.floor(function(e,t){var n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}(e-this._cx,t-this._cy)*this._hashSize)%this._hashSize}},{key:"_legalize",value:function(e){var t=this.triangles,n=this.coords,r=this.halfedges,i=r[e],a=e-e%3,o=i-i%3,s=a+(e+1)%3,u=a+(e+2)%3,c=o+(i+2)%3;if(-1===i)return u;var l=t[u],h=t[e],f=t[s],d=t[c];if(function(e,t,n,r,i,a,o,s){var u=e-o,c=t-s,l=n-o,h=r-s,f=i-o,d=a-s,p=l*l+h*h,v=f*f+d*d;return u*(h*v-p*d)-c*(l*v-p*f)+(u*u+c*c)*(l*d-h*f)<0}(n[2*l],n[2*l+1],n[2*h],n[2*h+1],n[2*f],n[2*f+1],n[2*d],n[2*d+1])){t[e]=d,t[i]=l;var p=r[c];if(-1===p){var v=this.hull;do{if(v.t===c){v.t=e;break}v=v.next}while(v!==this.hull)}this._link(e,p),this._link(i,r[u]),this._link(u,c);var y=o+(i+1)%3;return this._legalize(e),this._legalize(y)}return u}},{key:"_link",value:function(e,t){this.halfedges[e]=t,-1!==t&&(this.halfedges[t]=e)}},{key:"_addTriangle",value:function(e,t,n,r,i,a){var o=this.trianglesLen;return this.triangles[o]=e,this.triangles[o+1]=t,this.triangles[o+2]=n,this._link(o,r),this._link(o+1,i),this._link(o+2,a),this.trianglesLen+=3,o}}]),e}();function l(e,t,n,r){var i=e-n,a=t-r;return i*i+a*a}function h(e,t,n,r,i,a){return(r-t)*(i-n)-(n-e)*(a-r)<0}function f(e,t,n,r,i,a){var o=n-e,s=r-t,u=i-e,c=a-t,l=o*o+s*s,h=u*u+c*c,f=o*c-s*u,d=.5*(c*l-s*h)/f,p=.5*(o*h-u*l)/f;return l&&h&&f&&d*d+p*p||1/0}function d(e,t,n){var r={i:t,x:e[2*t],y:e[2*t+1],t:0,prev:null,next:null,removed:!1};return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function p(e){return e.prev.next=e.next,e.next.prev=e.prev,e.removed=!0,e.prev}function v(e,t,n,r,i){return l(e[2*t],e[2*t+1],r,i)-l(e[2*n],e[2*n+1],r,i)||e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]}function y(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e){return e[0]}function m(e){return e[1]}var b=function(){function e(){Object(o.a)(this,e),this._x0=this._y0=this._x1=this._y1=null,this._=""}return Object(s.a)(e,[{key:"moveTo",value:function(e,t){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t)}},{key:"closePath",value:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}},{key:"lineTo",value:function(e,t){this._+="L".concat(this._x1=+e,",").concat(this._y1=+t)}},{key:"arc",value:function(e,t,n){var r=(e=+e)+(n=+n),i=t=+t;if(n<0)throw new Error("negative radius");null===this._x1?this._+="M".concat(r,",").concat(i):(Math.abs(this._x1-r)>1e-6||Math.abs(this._y1-i)>1e-6)&&(this._+="L"+r+","+i),n&&(this._+="A".concat(n,",").concat(n,",0,1,1,").concat(e-n,",").concat(t,"A").concat(n,",").concat(n,",0,1,1,").concat(this._x1=r,",").concat(this._y1=i))}},{key:"rect",value:function(e,t,n,r){this._+="M".concat(this._x0=this._x1=+e,",").concat(this._y0=this._y1=+t,"h").concat(+n,"v").concat(+r,"h").concat(-n,"Z")}},{key:"value",value:function(){return this._||null}}]),e}(),_=function(){function e(){Object(o.a)(this,e),this._=[]}return Object(s.a)(e,[{key:"moveTo",value:function(e,t){this._.push([e,t])}},{key:"closePath",value:function(){this._.push(this._[0].slice())}},{key:"lineTo",value:function(e,t){this._.push([e,t])}},{key:"value",value:function(){return this._.length?this._:null}}]),e}(),w=n(212),x=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],r=Object(w.a)(n,4),i=r[0],a=r[1],s=r[2],u=r[3];if(Object(o.a)(this,e),!((s=+s)>=(i=+i))||!((u=+u)>=(a=+a)))throw new Error("invalid bounds");var c=this.delaunay=t,l=c.points,h=c.hull,f=c.triangles,d=this.circumcenters=new Float64Array(f.length/3*2),p=this.vectors=new Float64Array(2*l.length);this.xmax=s,this.xmin=i,this.ymax=u,this.ymin=a;for(var v=0,y=0,g=f.length;v<g;v+=3,y+=2){var m=2*f[v],b=2*f[v+1],_=2*f[v+2],x=l[m],T=l[m+1],S=l[b],k=l[b+1],M=l[_],P=l[_+1],I=x-S,j=x-M,O=T-k,R=T-P,N=x*x+T*T,C=N-S*S-k*k,A=N-M*M-P*P,E=2*(j*O-I*R);d[y]=(O*A-R*C)/E,d[y+1]=(j*C-I*A)/E}var D,L,B,F=h,U=4*F.i,q=F.x,G=F.y;do{D=U,L=q,B=G,U=4*(F=F.next).i,q=F.x,G=F.y,p[D+2]=p[U]=B-G,p[D+3]=p[U+1]=q-L}while(F!==h)}return Object(s.a)(e,[{key:"render",value:function(e){for(var t=null==e?e=new b:void 0,n=this.delaunay,r=n.halfedges,i=n.hull,a=this.circumcenters,o=this.vectors,s=0,u=r.length;s<u;++s){var c=r[s];if(!(c<s)){var l=2*Math.floor(s/3),h=2*Math.floor(c/3),f=a[l],d=a[l+1],p=a[h],v=a[h+1];this._renderSegment(f,d,p,v,e)}}var y=i;do{y=y.next;var g=2*Math.floor(y.t/3),m=a[g],_=a[g+1],w=4*y.i,x=this._project(m,_,o[w+2],o[w+3]);x&&this._renderSegment(m,_,x[0],x[1],e)}while(y!==i);return t&&t.value()}},{key:"renderBounds",value:function(e){var t=null==e?e=new b:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),t&&t.value()}},{key:"renderCell",value:function(e,t){var n=null==t?t=new b:void 0,r=this._clip(e);if(null!==r){t.moveTo(r[0],r[1]);for(var i=2,a=r.length;i<a;i+=2)t.lineTo(r[i],r[i+1]);return t.closePath(),n&&n.value()}}},{key:"cellPolygons",value:a.a.mark((function e(){var t,n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.delaunay.points,n=0,r=t.length/2;case 2:if(!(n<r)){e.next=10;break}if(!(i=this.cellPolygon(n))){e.next=7;break}return e.next=7,i;case 7:++n,e.next=2;break;case 10:case"end":return e.stop()}}),e,this)}))},{key:"cellPolygon",value:function(e){var t=new _;return this.renderCell(e,t),t.value()}},{key:"_renderSegment",value:function(e,t,n,r,i){var a,o=this._regioncode(e,t),s=this._regioncode(n,r);0===o&&0===s?(i.moveTo(e,t),i.lineTo(n,r)):(a=this._clipSegment(e,t,n,r,o,s))&&(i.moveTo(a[0],a[1]),i.lineTo(a[2],a[3]))}},{key:"contains",value:function(e,t,n){return(t=+t)===t&&(n=+n)===n&&this.delaunay._step(e,t,n)===e}},{key:"_cell",value:function(e){var t=this.circumcenters,n=this.delaunay,r=n.inedges,i=n.halfedges,a=n.triangles,o=r[e];if(-1===o)return null;var s=[],u=o;do{var c=Math.floor(u/3);if(s.push(t[2*c],t[2*c+1]),a[u=u%3===2?u-2:u+1]!==e)break;u=i[u]}while(u!==o&&-1!==u);return s}},{key:"_clip",value:function(e){var t=this._cell(e);if(null===t)return null;var n=this.vectors,r=4*e;return n[r]||n[r+1]?this._clipInfinite(e,t,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(e,t)}},{key:"_clipFinite",value:function(e,t){for(var n,r,i,a,o,s=t.length,u=null,c=t[s-2],l=t[s-1],h=this._regioncode(c,l),f=0;f<s;f+=2)if(n=c,r=l,c=t[f],l=t[f+1],i=h,h=this._regioncode(c,l),0===i&&0===h)a=o,o=0,u?u.push(c,l):u=[c,l];else{var d=void 0,p=void 0,v=void 0,y=void 0,g=void 0;if(0===i){if(null===(d=this._clipSegment(n,r,c,l,i,h)))continue;var m=d,b=Object(w.a)(m,4);p=b[0],v=b[1],y=b[2],g=b[3]}else{if(null===(d=this._clipSegment(c,l,n,r,h,i)))continue;var _=d,x=Object(w.a)(_,4);y=x[0],g=x[1],p=x[2],v=x[3],a=o,o=this._edgecode(p,v),a&&o&&this._edge(e,a,o,u,u.length),u?u.push(p,v):u=[p,v]}a=o,o=this._edgecode(y,g),a&&o&&this._edge(e,a,o,u,u.length),u?u.push(y,g):u=[y,g]}if(u)a=o,o=this._edgecode(u[0],u[1]),a&&o&&this._edge(e,a,o,u,u.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return u}},{key:"_clipSegment",value:function(e,t,n,r,i,a){for(;;){if(0===i&&0===a)return[e,t,n,r];if(i&a)return null;var o=void 0,s=void 0,u=i||a;8&u?(o=e+(n-e)*(this.ymax-t)/(r-t),s=this.ymax):4&u?(o=e+(n-e)*(this.ymin-t)/(r-t),s=this.ymin):2&u?(s=t+(r-t)*(this.xmax-e)/(n-e),o=this.xmax):(s=t+(r-t)*(this.xmin-e)/(n-e),o=this.xmin),i?(e=o,t=s,i=this._regioncode(e,t)):(n=o,r=s,a=this._regioncode(n,r))}}},{key:"_clipInfinite",value:function(e,t,n,r,i,a){var o,s=Array.from(t);if((o=this._project(s[0],s[1],n,r))&&s.unshift(o[0],o[1]),(o=this._project(s[s.length-2],s[s.length-1],i,a))&&s.push(o[0],o[1]),s=this._clipFinite(e,s))for(var u,c=0,l=s.length,h=this._edgecode(s[l-2],s[l-1]);c<l;c+=2)u=h,h=this._edgecode(s[c],s[c+1]),u&&h&&(c=this._edge(e,u,h,s,c),l=s.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}},{key:"_edge",value:function(e,t,n,r,i){for(;t!==n;){var a=void 0,o=void 0;switch(t){case 5:t=4;continue;case 4:t=6,a=this.xmax,o=this.ymin;break;case 6:t=2;continue;case 2:t=10,a=this.xmax,o=this.ymax;break;case 10:t=8;continue;case 8:t=9,a=this.xmin,o=this.ymax;break;case 9:t=1;continue;case 1:t=5,a=this.xmin,o=this.ymin}r[i]===a&&r[i+1]===o||!this.contains(e,a,o)||(r.splice(i,0,a,o),i+=2)}return i}},{key:"_project",value:function(e,t,n,r){var i,a,o,s=1/0;if(r<0){if(t<=this.ymin)return null;(i=(this.ymin-t)/r)<s&&(o=this.ymin,a=e+(s=i)*n)}else if(r>0){if(t>=this.ymax)return null;(i=(this.ymax-t)/r)<s&&(o=this.ymax,a=e+(s=i)*n)}if(n>0){if(e>=this.xmax)return null;(i=(this.xmax-e)/n)<s&&(a=this.xmax,o=t+(s=i)*r)}else if(n<0){if(e<=this.xmin)return null;(i=(this.xmin-e)/n)<s&&(a=this.xmin,o=t+(s=i)*r)}return[a,o]}},{key:"_edgecode",value:function(e,t){return(e===this.xmin?1:e===this.xmax?2:0)|(t===this.ymin?4:t===this.ymax?8:0)}},{key:"_regioncode",value:function(e,t){return(e<this.xmin?1:e>this.xmax?2:0)|(t<this.ymin?4:t>this.ymax?8:0)}}]),e}(),T=a.a.mark(j),S=2*Math.PI;function k(e){return e[0]}function M(e){return e[1]}var P=function(){function e(t){Object(o.a)(this,e);var n=new c(t),r=n.halfedges,i=n.hull,a=n.triangles;this.points=t,this.halfedges=r,this.hull=i,this.triangles=a;for(var s=this.inedges=new Int32Array(t.length/2).fill(-1),u=this.outedges=new Int32Array(t.length/2).fill(-1),l=0,h=r.length;l<h;++l)s[a[l%3===2?l-2:l+1]]=l;var f,d=i;do{f=d,s[(d=d.next).i]=f.t,u[f.i]=d.t}while(d!==i)}return Object(s.a)(e,[{key:"voronoi",value:function(e){return new x(this,e)}},{key:"neighbors",value:a.a.mark((function e(t){var n,r,i,o,s,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.inedges,r=this.outedges,i=this.halfedges,o=this.triangles,-1!==(s=n[t])){e.next=4;break}return e.abrupt("return");case 4:u=s;case 5:return e.next=7,o[u];case 7:if(o[u=u%3===2?u-2:u+1]===t){e.next=10;break}return e.abrupt("return");case 10:if(-1!==(u=i[u])){e.next=15;break}return e.next=14,o[r[t]];case 14:return e.abrupt("return",e.sent);case 15:if(u!==s){e.next=5;break}case 16:case"end":return e.stop()}}),e,this)}))},{key:"find",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if((e=+e)!==e||(t=+t)!==t)return-1;for(;(n=this._step(r,e,t))>=0&&n!==r;)r=n;return n}},{key:"_step",value:function(e,t,n){var i=this.inedges,a=this.points;if(-1===i[e])return-1;var o,s=e,u=Math.pow(t-a[2*e],2)+Math.pow(n-a[2*e+1],2),c=Object(r.a)(this.neighbors(e));try{for(c.s();!(o=c.n()).done;){var l=o.value,h=Math.pow(t-a[2*l],2)+Math.pow(n-a[2*l+1],2);h<u&&(u=h,s=l)}}catch(f){c.e(f)}finally{c.f()}return s}},{key:"render",value:function(e){for(var t=null==e?e=new b:void 0,n=this.points,r=this.halfedges,i=this.triangles,a=0,o=r.length;a<o;++a){var s=r[a];if(!(s<a)){var u=2*i[a],c=2*i[s];e.moveTo(n[u],n[u+1]),e.lineTo(n[c],n[c+1])}}return this.renderHull(e),t&&t.value()}},{key:"renderPoints",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=null==e?e=new b:void 0,r=this.points,i=0,a=r.length;i<a;i+=2){var o=r[i],s=r[i+1];e.moveTo(o+t,s),e.arc(o,s,t,0,S)}return n&&n.value()}},{key:"renderHull",value:function(e){var t=null==e?e=new b:void 0,n=this.hull,r=n;for(e.moveTo(r.x,r.y);(r=r.next)!==n;)e.lineTo(r.x,r.y);return e.closePath(),t&&t.value()}},{key:"hullPolygon",value:function(){var e=new _;return this.renderHull(e),e.value()}},{key:"renderTriangle",value:function(e,t){var n=null==t?t=new b:void 0,r=this.points,i=this.triangles,a=2*i[e*=3],o=2*i[e+1],s=2*i[e+2];return t.moveTo(r[a],r[a+1]),t.lineTo(r[o],r[o+1]),t.lineTo(r[s],r[s+1]),t.closePath(),n&&n.value()}},{key:"trianglePolygons",value:a.a.mark((function e(){var t,n,r;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.triangles,n=0,r=t.length/3;case 2:if(!(n<r)){e.next=8;break}return e.next=5,this.trianglePolygon(n);case 5:++n,e.next=2;break;case 8:case"end":return e.stop()}}),e,this)}))},{key:"trianglePolygon",value:function(e){var t=new _;return this.renderTriangle(e,t),t.value()}}]),e}();function I(e,t,n,r){for(var i=e.length,a=new Float64Array(2*i),o=0;o<i;++o){var s=e[o];a[2*o]=t.call(r,s,o,e),a[2*o+1]=n.call(r,s,o,e)}return a}function j(e,t,n,i){var o,s,u,c;return a.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:o=0,s=Object(r.a)(e),a.prev=2,s.s();case 4:if((u=s.n()).done){a.next=13;break}return c=u.value,a.next=8,t.call(i,c,o,e);case 8:return a.next=10,n.call(i,c,o,e);case 10:++o;case 11:a.next=4;break;case 13:a.next=18;break;case 15:a.prev=15,a.t0=a.catch(2),s.e(a.t0);case 18:return a.prev=18,s.f(),a.finish(18);case 21:case"end":return a.stop()}}),T,null,[[2,15,18,21]])}P.from=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:k,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:M,r=arguments.length>3?arguments[3]:void 0;return new P("length"in e?I(e,t,n,r):Float64Array.from(j(e,t,n,r)))}},,function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return a}));var i=n(165);function a(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?Object(i.a)(e):t}},,,,,,,,,,function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{u(r.next(e))}catch(t){a(t)}}function s(e){try{u(r.throw(e))}catch(t){a(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,a,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=r[2&a[0]?"return":a[0]?"throw":"next"])&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[0,i.value]),a[0]){case 0:case 1:i=a;break;case 4:return o.label++,{value:a[1],done:!1};case 5:o.label++,r=a[1],a=[0];continue;case 7:a=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){o.label=a[1];break}if(6===a[0]&&o.label<i[1]){o.label=i[1],i=a;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(a);break}i[2]&&o.ops.pop(),o.trys.pop();continue}a=t.call(e,o)}catch(s){a=[6,s],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var a=n(293),o=n(96),s=n(110),u=n(88),c=n(218),l=n(294),h=n(301),f=n(303),d=n(138),p=n(147),v=n(306),y=n(307),g=function(){function e(e){var t=e||{};if("object"!==typeof t)throw new Error(""+o.CONTAINER_OPTIONS_MUST_BE_AN_OBJECT);if(void 0===t.defaultScope)t.defaultScope=s.BindingScopeEnum.Transient;else if(t.defaultScope!==s.BindingScopeEnum.Singleton&&t.defaultScope!==s.BindingScopeEnum.Transient&&t.defaultScope!==s.BindingScopeEnum.Request)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_DEFAULT_SCOPE);if(void 0===t.autoBindInjectable)t.autoBindInjectable=!1;else if("boolean"!==typeof t.autoBindInjectable)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_AUTO_BIND_INJECTABLE);if(void 0===t.skipBaseClassChecks)t.skipBaseClassChecks=!1;else if("boolean"!==typeof t.skipBaseClassChecks)throw new Error(""+o.CONTAINER_OPTIONS_INVALID_SKIP_BASE_CHECK);this.options={autoBindInjectable:t.autoBindInjectable,defaultScope:t.defaultScope,skipBaseClassChecks:t.skipBaseClassChecks},this.id=d.id(),this._bindingDictionary=new y.Lookup,this._snapshots=[],this._middleware=null,this.parent=null,this._metadataReader=new c.MetadataReader}return e.merge=function(t,n){var r=new e,i=l.getBindingDictionary(r),a=l.getBindingDictionary(t),o=l.getBindingDictionary(n);function s(e,t){e.traverse((function(e,n){n.forEach((function(e){t.add(e.serviceIdentifier,e.clone())}))}))}return s(a,i),s(o,i),r},e.prototype.load=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=this._getContainerModuleHelpersFactory(),r=0,i=e;r<i.length;r++){var a=i[r],o=n(a.id);a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)}},e.prototype.loadAsync=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r(this,void 0,void 0,(function(){var t,n,r,a,o;return i(this,(function(i){switch(i.label){case 0:t=this._getContainerModuleHelpersFactory(),n=0,r=e,i.label=1;case 1:return n<r.length?(a=r[n],o=t(a.id),[4,a.registry(o.bindFunction,o.unbindFunction,o.isboundFunction,o.rebindFunction)]):[3,4];case 2:i.sent(),i.label=3;case 3:return n++,[3,1];case 4:return[2]}}))}))},e.prototype.unload=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(e){return function(t){return t.moduleId===e}};t.forEach((function(t){var n=r(t.id);e._bindingDictionary.removeByCondition(n)}))},e.prototype.bind=function(e){var t=this.options.defaultScope||s.BindingScopeEnum.Transient,n=new a.Binding(e,t);return this._bindingDictionary.add(e,n),new f.BindingToSyntax(n)},e.prototype.rebind=function(e){return this.unbind(e),this.bind(e)},e.prototype.unbind=function(e){try{this._bindingDictionary.remove(e)}catch(t){throw new Error(o.CANNOT_UNBIND+" "+p.getServiceIdentifierAsString(e))}},e.prototype.unbindAll=function(){this._bindingDictionary=new y.Lookup},e.prototype.isBound=function(e){var t=this._bindingDictionary.hasKey(e);return!t&&this.parent&&(t=this.parent.isBound(e)),t},e.prototype.isBoundNamed=function(e,t){return this.isBoundTagged(e,u.NAMED_TAG,t)},e.prototype.isBoundTagged=function(e,t,n){var r=!1;if(this._bindingDictionary.hasKey(e)){var i=this._bindingDictionary.get(e),a=l.createMockRequest(this,e,t,n);r=i.some((function(e){return e.constraint(a)}))}return!r&&this.parent&&(r=this.parent.isBoundTagged(e,t,n)),r},e.prototype.snapshot=function(){this._snapshots.push(v.ContainerSnapshot.of(this._bindingDictionary.clone(),this._middleware))},e.prototype.restore=function(){var e=this._snapshots.pop();if(void 0===e)throw new Error(o.NO_MORE_SNAPSHOTS_AVAILABLE);this._bindingDictionary=e.bindings,this._middleware=e.middleware},e.prototype.createChild=function(t){var n=new e(t||this.options);return n.parent=this,n},e.prototype.applyMiddleware=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((function(e,t){return t(e)}),n)},e.prototype.applyCustomMetadataReader=function(e){this._metadataReader=e},e.prototype.get=function(e){return this._get(!1,!1,s.TargetTypeEnum.Variable,e)},e.prototype.getTagged=function(e,t,n){return this._get(!1,!1,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getNamed=function(e,t){return this.getTagged(e,u.NAMED_TAG,t)},e.prototype.getAll=function(e){return this._get(!0,!0,s.TargetTypeEnum.Variable,e)},e.prototype.getAllTagged=function(e,t,n){return this._get(!1,!0,s.TargetTypeEnum.Variable,e,t,n)},e.prototype.getAllNamed=function(e,t){return this.getAllTagged(e,u.NAMED_TAG,t)},e.prototype.resolve=function(e){var t=this.createChild();return t.bind(e).toSelf(),t.get(e)},e.prototype._getContainerModuleHelpersFactory=function(){var e=this,t=function(e,t){e._binding.moduleId=t},n=function(n){return function(r){var i=e.rebind.bind(e)(r);return t(i,n),i}};return function(r){return{bindFunction:(i=r,function(n){var r=e.bind.bind(e)(n);return t(r,i),r}),isboundFunction:function(t){return e.isBound.bind(e)(t)},rebindFunction:n(r),unbindFunction:function(t){e.unbind.bind(e)(t)}};var i}},e.prototype._get=function(e,t,n,r,i,a){var s=null,u={avoidConstraints:e,contextInterceptor:function(e){return e},isMultiInject:t,key:i,serviceIdentifier:r,targetType:n,value:a};if(this._middleware){if(void 0===(s=this._middleware(u))||null===s)throw new Error(o.INVALID_MIDDLEWARE_RETURN)}else s=this._planAndResolve()(u);return s},e.prototype._planAndResolve=function(){var e=this;return function(t){var n=l.plan(e._metadataReader,e,t.isMultiInject,t.targetType,t.serviceIdentifier,t.key,t.value,t.avoidConstraints);return n=t.contextInterceptor(n),h.resolve(n)}},e}();t.Container=g},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(138),a=function(){function e(e,t){this.id=i.id(),this.activated=!1,this.serviceIdentifier=e,this.scope=t,this.type=r.BindingTypeEnum.Invalid,this.constraint=function(e){return!0},this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.dynamicValue=null}return e.prototype.clone=function(){var t=new e(this.serviceIdentifier,this.scope);return t.activated=!1,t.implementationType=this.implementationType,t.dynamicValue=this.dynamicValue,t.scope=this.scope,t.type=this.type,t.factory=this.factory,t.provider=this.provider,t.constraint=this.constraint,t.onActivation=this.onActivation,t.cache=this.cache,t},e}();t.Binding=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(295),i=n(96),a=n(110),o=n(88),s=n(219),u=n(147),c=n(296),l=n(102),h=n(297),f=n(298),d=n(300),p=n(221);function v(e){return e._bindingDictionary}function y(e,t,n,a,o){var s=g(n.container,o.serviceIdentifier),c=[];return s.length===r.BindingCount.NoBindingsAvailable&&n.container.options.autoBindInjectable&&"function"===typeof o.serviceIdentifier&&e.getConstructorMetadata(o.serviceIdentifier).compilerGeneratedMetadata&&(n.container.bind(o.serviceIdentifier).toSelf(),s=g(n.container,o.serviceIdentifier)),c=t?s:s.filter((function(e){var t=new d.Request(e.serviceIdentifier,n,a,e,o);return e.constraint(t)})),function(e,t,n,a){switch(t.length){case r.BindingCount.NoBindingsAvailable:if(n.isOptional())return t;var o=u.getServiceIdentifierAsString(e),s=i.NOT_REGISTERED;throw s+=u.listMetadataForTarget(o,n),s+=u.listRegisteredBindingsForServiceIdentifier(a,o,g),new Error(s);case r.BindingCount.OnlyOneBindingAvailable:if(!n.isArray())return t;case r.BindingCount.MultipleBindingsAvailable:default:if(n.isArray())return t;o=u.getServiceIdentifierAsString(e),s=i.AMBIGUOUS_MATCH+" "+o;throw s+=u.listRegisteredBindingsForServiceIdentifier(a,o,g),new Error(s)}}(o.serviceIdentifier,c,o,n.container),c}function g(e,t){var n=[],r=v(e);return r.hasKey(t)?n=r.get(t):null!==e.parent&&(n=g(e.parent,t)),n}t.getBindingDictionary=v,t.plan=function(e,t,n,r,v,g,m,b){void 0===b&&(b=!1);var _=new c.Context(t),w=function(e,t,n,r,i,a){var s=e?o.MULTI_INJECT_TAG:o.INJECT_TAG,u=new l.Metadata(s,n),c=new p.Target(t,r,n,u);if(void 0!==i){var h=new l.Metadata(i,a);c.metadata.push(h)}return c}(n,r,v,"",g,m);try{return function e(t,n,r,o,s,u){var c,l;if(null===s){c=y(t,n,o,null,u),l=new d.Request(r,o,null,c,u);var p=new h.Plan(o,l);o.addPlan(p)}else c=y(t,n,o,s,u),l=s.addChildRequest(u.serviceIdentifier,c,u);c.forEach((function(n){var r=null;if(u.isArray())r=l.addChildRequest(n.serviceIdentifier,n,u);else{if(n.cache)return;r=l}if(n.type===a.BindingTypeEnum.Instance&&null!==n.implementationType){var s=f.getDependencies(t,n.implementationType);if(!o.container.options.skipBaseClassChecks){var c=f.getBaseClassDependencyCount(t,n.implementationType);if(s.length<c){var h=i.ARGUMENTS_LENGTH_MISMATCH(f.getFunctionName(n.implementationType));throw new Error(h)}}s.forEach((function(n){e(t,!1,n.serviceIdentifier,o,r,n)}))}}))}(e,b,v,_,null,w),_}catch(x){throw s.isStackOverflowExeption(x)&&_.plan&&u.circularDependencyToException(_.plan.rootRequest),x}},t.createMockRequest=function(e,t,n,r){var i=new p.Target(a.TargetTypeEnum.Variable,"",t,new l.Metadata(n,r)),o=new c.Context(e);return new d.Request(t,o,null,[],i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.BindingCount={MultipleBindingsAvailable:2,NoBindingsAvailable:0,OnlyOneBindingAvailable:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(138),i=function(){function e(e){this.id=r.id(),this.container=e}return e.prototype.addPlan=function(e){this.plan=e},e.prototype.setCurrentRequest=function(e){this.currentRequest=e},e}();t.Context=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){this.parentContext=e,this.rootRequest=t};t.Plan=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(220),i=n(96),a=n(110),o=n(88),s=n(147);t.getFunctionName=s.getFunctionName;var u=n(221);function c(e,t,n,r){var o=e.getConstructorMetadata(n),s=o.compilerGeneratedMetadata;if(void 0===s){var c=i.MISSING_INJECTABLE_ANNOTATION+" "+t+".";throw new Error(c)}var f=o.userGeneratedMetadata,d=Object.keys(f),p=function(e,t,n,r,i){for(var a=[],o=0;o<i;o++){var s=l(o,e,t,n,r);null!==s&&a.push(s)}return a}(r,t,s,f,0===n.length&&d.length>0?d.length:n.length),v=function e(t,n){for(var r=t.getPropertiesMetadata(n),i=[],o=Object.keys(r),s=0,c=o;s<c.length;s++){var l=c[s],f=r[l],d=h(r[l]),p=d.targetName||l,v=d.inject||d.multiInject,y=new u.Target(a.TargetTypeEnum.ClassProperty,p,v);y.metadata=f,i.push(y)}var g=Object.getPrototypeOf(n.prototype).constructor;if(g!==Object){var m=e(t,g);i=i.concat(m)}return i}(e,n);return p.concat(v)}function l(e,t,n,o,s){var c=s[e.toString()]||[],l=h(c),f=!0!==l.unmanaged,d=o[e],p=l.inject||l.multiInject;if((d=p||d)instanceof r.LazyServiceIdentifer&&(d=d.unwrap()),f){if(!t&&(d===Object||d===Function||void 0===d)){var v=i.MISSING_INJECT_ANNOTATION+" argument "+e+" in class "+n+".";throw new Error(v)}var y=new u.Target(a.TargetTypeEnum.ConstructorArgument,l.targetName,d);return y.metadata=c,y}return null}function h(e){var t={};return e.forEach((function(e){t[e.key.toString()]=e.value})),{inject:t[o.INJECT_TAG],multiInject:t[o.MULTI_INJECT_TAG],targetName:t[o.NAME_TAG],unmanaged:t[o.UNMANAGED_TAG]}}t.getDependencies=function(e,t){return c(e,s.getFunctionName(t),t,!1)},t.getBaseClassDependencyCount=function e(t,n){var r=Object.getPrototypeOf(n.prototype).constructor;if(r!==Object){var i=c(t,s.getFunctionName(r),r,!0),a=i.map((function(e){return e.metadata.filter((function(e){return e.key===o.UNMANAGED_TAG}))})),u=[].concat.apply([],a).length,l=i.length-u;return l>0?l:e(t,r)}return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){this.str=e}return e.prototype.startsWith=function(e){return 0===this.str.indexOf(e)},e.prototype.endsWith=function(e){var t,n=e.split("").reverse().join("");return t=this.str.split("").reverse().join(""),this.startsWith.call({str:t},n)},e.prototype.contains=function(e){return-1!==this.str.indexOf(e)},e.prototype.equals=function(e){return this.str===e},e.prototype.value=function(){return this.str},e}();t.QueryableString=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(138),i=function(){function e(e,t,n,i,a){this.id=r.id(),this.serviceIdentifier=e,this.parentContext=t,this.parentRequest=n,this.target=a,this.childRequests=[],this.bindings=Array.isArray(i)?i:[i],this.requestScope=null===n?new Map:null}return e.prototype.addChildRequest=function(t,n,r){var i=new e(t,this.parentContext,this,n,r);return this.childRequests.push(i),i},e}();t.Request=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(110),a=n(219),o=n(147),s=n(302),u=function(e,t,n){try{return n()}catch(i){throw a.isStackOverflowExeption(i)?new Error(r.CIRCULAR_DEPENDENCY_IN_FACTORY(e,t.toString())):i}};t.resolve=function(e){return function e(t){return function(n){n.parentContext.setCurrentRequest(n);var a=n.bindings,c=n.childRequests,l=n.target&&n.target.isArray(),h=!n.parentRequest||!n.parentRequest.target||!n.target||!n.parentRequest.target.matchesArray(n.target.serviceIdentifier);if(l&&h)return c.map((function(n){return e(t)(n)}));var f=null;if(!n.target.isOptional()||0!==a.length){var d=a[0],p=d.scope===i.BindingScopeEnum.Singleton,v=d.scope===i.BindingScopeEnum.Request;if(p&&d.activated)return d.cache;if(v&&null!==t&&t.has(d.id))return t.get(d.id);if(d.type===i.BindingTypeEnum.ConstantValue)f=d.cache;else if(d.type===i.BindingTypeEnum.Function)f=d.cache;else if(d.type===i.BindingTypeEnum.Constructor)f=d.implementationType;else if(d.type===i.BindingTypeEnum.DynamicValue&&null!==d.dynamicValue)f=u("toDynamicValue",d.serviceIdentifier,(function(){return d.dynamicValue(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Factory&&null!==d.factory)f=u("toFactory",d.serviceIdentifier,(function(){return d.factory(n.parentContext)}));else if(d.type===i.BindingTypeEnum.Provider&&null!==d.provider)f=u("toProvider",d.serviceIdentifier,(function(){return d.provider(n.parentContext)}));else{if(d.type!==i.BindingTypeEnum.Instance||null===d.implementationType){var y=o.getServiceIdentifierAsString(n.serviceIdentifier);throw new Error(r.INVALID_BINDING_TYPE+" "+y)}f=s.resolveInstance(d.implementationType,c,e(t))}return"function"===typeof d.onActivation&&(f=d.onActivation(n.parentContext,f)),p&&(d.cache=f,d.activated=!0),v&&null!==t&&!t.has(d.id)&&t.set(d.id,f),f}}}(e.plan.rootRequest.requestScope)(e.plan.rootRequest)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(110),a=n(88);t.resolveInstance=function(e,t,n){var o,s,u=null;if(t.length>0){var c=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ConstructorArgument})).map(n);s=c,u=function(e,t,n){var r=t.filter((function(e){return null!==e.target&&e.target.type===i.TargetTypeEnum.ClassProperty})),a=r.map(n);return r.forEach((function(t,n){var r;r=t.target.name.value();var i=a[n];e[r]=i})),e}(u=new((o=e).bind.apply(o,[void 0].concat(s))),t,n)}else u=new e;return function(e,t){if(Reflect.hasMetadata(a.POST_CONSTRUCT,e)){var n=Reflect.getMetadata(a.POST_CONSTRUCT,e);try{t[n.value]()}catch(i){throw new Error(r.POST_CONSTRUCT_ERROR(e.name,i.message))}}}(e,u),u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(110),a=n(304),o=n(222),s=function(){function e(e){this._binding=e}return e.prototype.to=function(e){return this._binding.type=i.BindingTypeEnum.Instance,this._binding.implementationType=e,new a.BindingInWhenOnSyntax(this._binding)},e.prototype.toSelf=function(){if("function"!==typeof this._binding.serviceIdentifier)throw new Error(""+r.INVALID_TO_SELF_VALUE);var e=this._binding.serviceIdentifier;return this.to(e)},e.prototype.toConstantValue=function(e){return this._binding.type=i.BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toDynamicValue=function(e){return this._binding.type=i.BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new a.BindingInWhenOnSyntax(this._binding)},e.prototype.toConstructor=function(e){return this._binding.type=i.BindingTypeEnum.Constructor,this._binding.implementationType=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toFunction=function(e){if("function"!==typeof e)throw new Error(r.INVALID_FUNCTION_BINDING);var t=this.toConstantValue(e);return this._binding.type=i.BindingTypeEnum.Function,t},e.prototype.toAutoFactory=function(e){return this._binding.type=i.BindingTypeEnum.Factory,this._binding.factory=function(t){return function(){return t.container.get(e)}},new o.BindingWhenOnSyntax(this._binding)},e.prototype.toProvider=function(e){return this._binding.type=i.BindingTypeEnum.Provider,this._binding.provider=e,new o.BindingWhenOnSyntax(this._binding)},e.prototype.toService=function(e){this.toDynamicValue((function(t){return t.container.get(e)}))},e}();t.BindingToSyntax=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(305),i=n(179),a=n(180),o=function(){function e(e){this._binding=e,this._bindingWhenSyntax=new a.BindingWhenSyntax(this._binding),this._bindingOnSyntax=new i.BindingOnSyntax(this._binding),this._bindingInSyntax=new r.BindingInSyntax(e)}return e.prototype.inRequestScope=function(){return this._bindingInSyntax.inRequestScope()},e.prototype.inSingletonScope=function(){return this._bindingInSyntax.inSingletonScope()},e.prototype.inTransientScope=function(){return this._bindingInSyntax.inTransientScope()},e.prototype.when=function(e){return this._bindingWhenSyntax.when(e)},e.prototype.whenTargetNamed=function(e){return this._bindingWhenSyntax.whenTargetNamed(e)},e.prototype.whenTargetIsDefault=function(){return this._bindingWhenSyntax.whenTargetIsDefault()},e.prototype.whenTargetTagged=function(e,t){return this._bindingWhenSyntax.whenTargetTagged(e,t)},e.prototype.whenInjectedInto=function(e){return this._bindingWhenSyntax.whenInjectedInto(e)},e.prototype.whenParentNamed=function(e){return this._bindingWhenSyntax.whenParentNamed(e)},e.prototype.whenParentTagged=function(e,t){return this._bindingWhenSyntax.whenParentTagged(e,t)},e.prototype.whenAnyAncestorIs=function(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)},e.prototype.whenNoAncestorIs=function(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)},e.prototype.whenAnyAncestorNamed=function(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)},e.prototype.whenAnyAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,t)},e.prototype.whenNoAncestorNamed=function(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)},e.prototype.whenNoAncestorTagged=function(e,t){return this._bindingWhenSyntax.whenNoAncestorTagged(e,t)},e.prototype.whenAnyAncestorMatches=function(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)},e.prototype.whenNoAncestorMatches=function(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)},e.prototype.onActivation=function(e){return this._bindingOnSyntax.onActivation(e)},e}();t.BindingInWhenOnSyntax=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(110),i=n(222),a=function(){function e(e){this._binding=e}return e.prototype.inRequestScope=function(){return this._binding.scope=r.BindingScopeEnum.Request,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inSingletonScope=function(){return this._binding.scope=r.BindingScopeEnum.Singleton,new i.BindingWhenOnSyntax(this._binding)},e.prototype.inTransientScope=function(){return this._binding.scope=r.BindingScopeEnum.Transient,new i.BindingWhenOnSyntax(this._binding)},e}();t.BindingInSyntax=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.of=function(t,n){var r=new e;return r.bindings=t,r.middleware=n,r},e}();t.ContainerSnapshot=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=function(){function e(){this._map=new Map}return e.prototype.getMap=function(){return this._map},e.prototype.add=function(e,t){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);if(null===t||void 0===t)throw new Error(r.NULL_ARGUMENT);var n=this._map.get(e);void 0!==n?(n.push(t),this._map.set(e,n)):this._map.set(e,[t])},e.prototype.get=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);var t=this._map.get(e);if(void 0!==t)return t;throw new Error(r.KEY_NOT_FOUND)},e.prototype.remove=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);if(!this._map.delete(e))throw new Error(r.KEY_NOT_FOUND)},e.prototype.removeByCondition=function(e){var t=this;this._map.forEach((function(n,r){var i=n.filter((function(t){return!e(t)}));i.length>0?t._map.set(r,i):t._map.delete(r)}))},e.prototype.hasKey=function(e){if(null===e||void 0===e)throw new Error(r.NULL_ARGUMENT);return this._map.has(e)},e.prototype.clone=function(){var t=new e;return this._map.forEach((function(e,n){e.forEach((function(e){return t.add(n,e.clone())}))})),t},e.prototype.traverse=function(e){this._map.forEach((function(t,n){e(n,t)}))},e}();t.Lookup=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(138),i=function(e){this.id=r.id(),this.registry=e};t.ContainerModule=i;var a=function(e){this.id=r.id(),this.registry=e};t.AsyncContainerModule=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(88);t.injectable=function(){return function(e){if(Reflect.hasOwnMetadata(i.PARAM_TYPES,e))throw new Error(r.DUPLICATED_INJECTABLE_DECORATOR);var t=Reflect.getMetadata(i.DESIGN_PARAM_TYPES,e)||[];return Reflect.defineMetadata(i.PARAM_TYPES,t,e),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(102),i=n(126);t.tagged=function(e,t){return function(n,a,o){var s=new r.Metadata(e,t);"number"===typeof o?i.tagParameter(n,a,o,s):i.tagProperty(n,a,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102),a=n(126);t.named=function(e){return function(t,n,o){var s=new i.Metadata(r.NAMED_TAG,e);"number"===typeof o?a.tagParameter(t,n,o,s):a.tagProperty(t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102),a=n(126);t.optional=function(){return function(e,t,n){var o=new i.Metadata(r.OPTIONAL_TAG,!0);"number"===typeof n?a.tagParameter(e,t,n,o):a.tagProperty(e,t,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102),a=n(126);t.unmanaged=function(){return function(e,t,n){var o=new i.Metadata(r.UNMANAGED_TAG,!0);a.tagParameter(e,t,n,o)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102),a=n(126);t.multiInject=function(e){return function(t,n,o){var s=new i.Metadata(r.MULTI_INJECT_TAG,e);"number"===typeof o?a.tagParameter(t,n,o,s):a.tagProperty(t,n,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(88),i=n(102),a=n(126);t.targetName=function(e){return function(t,n,o){var s=new i.Metadata(r.NAME_TAG,e);a.tagParameter(t,n,o,s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(96),i=n(88),a=n(102);t.postConstruct=function(){return function(e,t,n){var o=new a.Metadata(i.POST_CONSTRUCT,t);if(Reflect.hasOwnMetadata(i.POST_CONSTRUCT,e.constructor))throw new Error(r.MULTIPLE_POST_CONSTRUCT_METHODS);Reflect.defineMetadata(i.POST_CONSTRUCT,o,e.constructor)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.multiBindToService=function(e){return function(t){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return n.forEach((function(n){return e.bind(n).toService(t)}))}}}},function(e,t,n){"use strict";var r=n(112),i=n(82),a=n(76),o=n(83),s=n(84);Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){s(n,e);var t=o(n);function n(e,o){var s;a(this,n);var u,c=new Array,l=new Array,h=i(e);try{for(h.s();!(u=h.n()).done;){var f,d,p=u.value;c=(f=c).concat.apply(f,r(p.getNodes())),l=(d=l).concat.apply(d,r(p.getWays()))}}catch(v){h.e(v)}finally{h.f()}return(s=t.call(this,o,new Set(c),new Set(l))).tiles=e,s}return n}(n(227).RoutableTile);t.RoutableTileSet=u},function(e,t,n){var r=n(224);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var r=n(322),i=n(323);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?i(e):t}},function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(u){i=!0,a=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}}},function(e,t,n){var r=function(){var e={km:6371,mile:3960,meter:6371e3,nmi:3440},t=function(e){return e*Math.PI/180},n=function(e,t){switch(e){case"[lat,lon]":return{latitude:t[0],longitude:t[1]};case"[lon,lat]":return{latitude:t[1],longitude:t[0]};case"{lon,lat}":return{latitude:t.lat,longitude:t.lon};case"{lat,lng}":return{latitude:t.lat,longitude:t.lng};case"geojson":return{latitude:t.geometry.coordinates[1],longitude:t.geometry.coordinates[0]};default:return t}};return function(r,i,a){var o=(a=a||{}).unit in e?e[a.unit]:e.km,s=n(a.format,r),u=n(a.format,i),c=t(u.latitude-s.latitude),l=t(u.longitude-s.longitude),h=t(s.latitude),f=t(u.latitude),d=Math.sin(c/2)*Math.sin(c/2)+Math.sin(l/2)*Math.sin(l/2)*Math.cos(h)*Math.cos(f),p=2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d));return a.threshold?a.threshold>o*p:o*p}}();e.exports&&(e.exports=r)},function(e,t){e.exports=function(e){return e&&"object"===typeof e&&"function"===typeof e.copy&&"function"===typeof e.fill&&"function"===typeof e.readUInt8}},function(e,t){"function"===typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,a={},o=!1,s=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){l(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"===typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;r=function(t){var n=s.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},u.setImmediate=function(e){"function"!==typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var o={callback:e,args:t};return a[i]=o,r(i),i++},u.clearImmediate=c}function c(e){delete a[e]}function l(e){if(o)setTimeout(l,0,e);else{var t=a[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{c(e),o=!1}}}}}("undefined"===typeof self?"undefined"===typeof e?this:e:self)}).call(this,n(40),n(95))},function(e,t,n){var r=n(85),i=n(232),a=n(233),o=n(348),s=n(231),u=n(184),c=n(141);function l(e,t){c.call(this),this._accept=e||"application/ld+json;q=1.0",this._customHeaders=t||{}}s.inherits(l,c),l.prototype.get=function(e){return this.request(e,"GET")},l.prototype.request=function(e,t){this.emit("request",e);var n=t||"GET",s=this,c=i.defer(),l=u.parse(e),h={Accept:this._accept};if(Object.keys(s._customHeaders).length>0)for(var f=0,d=Object.entries(s._customHeaders);f<d.length;f++){var p=r(d[f],2),v=p[0],y=p[1];h[v]=y}var g={hostname:l.hostname,port:l.port,path:l.path,headers:h,withCredentials:!1,method:n},m=function(t){var n=t,r=[],i=0;n.on("data",(function(e){i+=e.length,r.push(e)})),t.on("error",(function(e){_(e)})),n.on("end",(function(){s.emit("downloaded",{url:e,totalBytes:i}),_(null,t,r.join(""))}))},b={};function _(t,n,r){var i;if(i=b._xhr?b._xhr.responseURL:b._fetchResponse.url,s.emit("response",i),t)return c.reject(new Error(t));if(n.statusCode>=500)return c.reject(new Error("Request failed: "+e));var a=/^[^;]+/.exec(n.headers["content-type"]||"text/html")[0];c.resolve({url:i,type:a,body:r,status:n.statusCode})}return"https:"===l.protocol?b=o.request(g,m):"http:"===l.protocol?b=a.request(g,m):console.error("Only http or https supported. Not "+l.protocol),b.on("error",(function(e){c.reject(e)})),b.end(null),c.promise},l.prototype.cancelAll=function(){},e.exports=l},function(e,t,n){(function(t,r,i){var a=n(235),o=n(129),s=n(236),u=n(149),c=n(339),l=s.IncomingMessage,h=s.readyStates;var f=e.exports=function(e){var n,r=this;u.Writable.call(r),r._opts=e,r._body=[],r._headers={},e.auth&&r.setHeader("Authorization","Basic "+new t(e.auth).toString("base64")),Object.keys(e.headers).forEach((function(t){r.setHeader(t,e.headers[t])}));var i=!0;if("disable-fetch"===e.mode||"requestTimeout"in e&&!a.abortController)i=!1,n=!0;else if("prefer-streaming"===e.mode)n=!1;else if("allow-wrong-content-type"===e.mode)n=!a.overrideMimeType;else{if(e.mode&&"default"!==e.mode&&"prefer-fast"!==e.mode)throw new Error("Invalid value for opts.mode");n=!0}r._mode=function(e,t){return a.fetch&&t?"fetch":a.mozchunkedarraybuffer?"moz-chunked-arraybuffer":a.msstream?"ms-stream":a.arraybuffer&&e?"arraybuffer":a.vbArray&&e?"text:vbarray":"text"}(n,i),r._fetchTimer=null,r.on("finish",(function(){r._onFinish()}))};o(f,u.Writable),f.prototype.setHeader=function(e,t){var n=e.toLowerCase();-1===d.indexOf(n)&&(this._headers[n]={name:e,value:t})},f.prototype.getHeader=function(e){var t=this._headers[e.toLowerCase()];return t?t.value:null},f.prototype.removeHeader=function(e){delete this._headers[e.toLowerCase()]},f.prototype._onFinish=function(){var e=this;if(!e._destroyed){var n=e._opts,o=e._headers,s=null;"GET"!==n.method&&"HEAD"!==n.method&&(s=a.arraybuffer?c(t.concat(e._body)):a.blobConstructor?new r.Blob(e._body.map((function(e){return c(e)})),{type:(o["content-type"]||{}).value||""}):t.concat(e._body).toString());var u=[];if(Object.keys(o).forEach((function(e){var t=o[e].name,n=o[e].value;Array.isArray(n)?n.forEach((function(e){u.push([t,e])})):u.push([t,n])})),"fetch"===e._mode){var l=null;if(a.abortController){var f=new AbortController;l=f.signal,e._fetchAbortController=f,"requestTimeout"in n&&0!==n.requestTimeout&&(e._fetchTimer=r.setTimeout((function(){e.emit("requestTimeout"),e._fetchAbortController&&e._fetchAbortController.abort()}),n.requestTimeout))}r.fetch(e._opts.url,{method:e._opts.method,headers:u,body:s||void 0,mode:"cors",credentials:n.withCredentials?"include":"same-origin",signal:l}).then((function(t){e._fetchResponse=t,e._connect()}),(function(t){r.clearTimeout(e._fetchTimer),e._destroyed||e.emit("error",t)}))}else{var d=e._xhr=new r.XMLHttpRequest;try{d.open(e._opts.method,e._opts.url,!0)}catch(p){return void i.nextTick((function(){e.emit("error",p)}))}"responseType"in d&&(d.responseType=e._mode.split(":")[0]),"withCredentials"in d&&(d.withCredentials=!!n.withCredentials),"text"===e._mode&&"overrideMimeType"in d&&d.overrideMimeType("text/plain; charset=x-user-defined"),"requestTimeout"in n&&(d.timeout=n.requestTimeout,d.ontimeout=function(){e.emit("requestTimeout")}),u.forEach((function(e){d.setRequestHeader(e[0],e[1])})),e._response=null,d.onreadystatechange=function(){switch(d.readyState){case h.LOADING:case h.DONE:e._onXHRProgress()}},"moz-chunked-arraybuffer"===e._mode&&(d.onprogress=function(){e._onXHRProgress()}),d.onerror=function(){e._destroyed||e.emit("error",new Error("XHR error"))};try{d.send(s)}catch(p){return void i.nextTick((function(){e.emit("error",p)}))}}}},f.prototype._onXHRProgress=function(){(function(e){try{var t=e.status;return null!==t&&0!==t}catch(n){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},f.prototype._connect=function(){var e=this;e._destroyed||(e._response=new l(e._xhr,e._fetchResponse,e._mode,e._fetchTimer),e._response.on("error",(function(t){e.emit("error",t)})),e.emit("response",e._response))},f.prototype._write=function(e,t,n){this._body.push(e),n()},f.prototype.abort=f.prototype.destroy=function(){this._destroyed=!0,r.clearTimeout(this._fetchTimer),this._response&&(this._response._destroyed=!0),this._xhr?this._xhr.abort():this._fetchAbortController&&this._fetchAbortController.abort()},f.prototype.end=function(e,t,n){"function"===typeof e&&(n=e,e=void 0),u.Writable.prototype.end.call(this,e,t,n)},f.prototype.flushHeaders=function(){},f.prototype.setTimeout=function(){},f.prototype.setNoDelay=function(){},f.prototype.setSocketKeepAlive=function(){};var d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"]}).call(this,n(115).Buffer,n(40),n(95))},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),o=r[0],s=r[1],u=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,h=s>0?o-4:o;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(l(e,o,o+16383>s?s:o+16383));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,a=d&(1<<-l)-1,d>>=-l,l+=s;l>0;a=256*a+e[t+h],h+=f,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=f,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,r),a-=c}return(d?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:a-1,p=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(o++,u/=2),o+h>=l?(s=0,o=l):o+h>=1?(s=(t*u-1)*Math.pow(2,i),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[n+d]=255&o,d+=p,o/=256,c-=8);e[n+d-p]|=128*v}},,function(e,t,n){"use strict";var r=n(182).Buffer,i=n(335);e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return r.alloc(0);if(1===this.length)return this.head.data;for(var t,n,i,a=r.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=a,i=s,t.copy(n,i),s+=o.data.length,o=o.next;return a},e}(),i&&i.inspect&&i.inspect.custom&&(e.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e})},,function(e,t,n){(function(t){function n(e){try{if(!t.localStorage)return!1}catch(r){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(n("noDeprecation"))return e;var r=!1;return function(){if(!r){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),r=!0}return e.apply(this,arguments)}}}).call(this,n(40))},function(e,t,n){var r=n(115),i=r.Buffer;function a(e,t){for(var n in e)t[n]=e[n]}function o(e,t,n){return i(e,t,n)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=r:(a(r,t),t.Buffer=o),o.prototype=Object.create(i.prototype),a(i,o),o.from=function(e,t,n){if("number"===typeof e)throw new TypeError("Argument must not be a number");return i(e,t,n)},o.alloc=function(e,t,n){if("number"!==typeof e)throw new TypeError("Argument must be a number");var r=i(e);return void 0!==t?"string"===typeof n?r.fill(t,n):r.fill(t):r.fill(0),r},o.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return i(e)},o.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return r.SlowBuffer(e)}},function(e,t,n){"use strict";e.exports=a;var r=n(241),i=Object.create(n(150));function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}i.inherits=n(129),i.inherits(a,r),a.prototype._transform=function(e,t,n){n(null,e)}},function(e,t,n){var r=n(115).Buffer;e.exports=function(e){if(e instanceof Uint8Array){if(0===e.byteOffset&&e.byteLength===e.buffer.byteLength)return e.buffer;if("function"===typeof e.buffer.slice)return e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)}if(r.isBuffer(e)){for(var t=new Uint8Array(e.length),n=e.length,i=0;i<n;i++)t[i]=e[i];return t.buffer}throw new Error("Argument must be a Buffer")}},function(e,t){e.exports=function(){for(var e={},t=0;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty},function(e,t){e.exports={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},function(e,t,n){(function(e,r){var i;!function(a){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof r&&r;o.global!==o&&o.window!==o&&o.self;var s,u=2147483647,c=/^xn--/,l=/[^\x20-\x7E]/,h=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},d=Math.floor,p=String.fromCharCode;function v(e){throw new RangeError(f[e])}function y(e,t){for(var n=e.length,r=[];n--;)r[n]=t(e[n]);return r}function g(e,t){var n=e.split("@"),r="";return n.length>1&&(r=n[0]+"@",e=n[1]),r+y((e=e.replace(h,".")).split("."),t).join(".")}function m(e){for(var t,n,r=[],i=0,a=e.length;i<a;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<a?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function b(e){return y(e,(function(e){var t="";return e>65535&&(t+=p((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=p(e)})).join("")}function _(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function w(e,t,n){var r=0;for(e=n?d(e/700):e>>1,e+=d(e/t);e>455;r+=36)e=d(e/35);return d(r+36*e/(e+38))}function x(e){var t,n,r,i,a,o,s,c,l,h,f,p=[],y=e.length,g=0,m=128,_=72;for((n=e.lastIndexOf("-"))<0&&(n=0),r=0;r<n;++r)e.charCodeAt(r)>=128&&v("not-basic"),p.push(e.charCodeAt(r));for(i=n>0?n+1:0;i<y;){for(a=g,o=1,s=36;i>=y&&v("invalid-input"),((c=(f=e.charCodeAt(i++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:36)>=36||c>d((u-g)/o))&&v("overflow"),g+=c*o,!(c<(l=s<=_?1:s>=_+26?26:s-_));s+=36)o>d(u/(h=36-l))&&v("overflow"),o*=h;_=w(g-a,t=p.length+1,0==a),d(g/t)>u-m&&v("overflow"),m+=d(g/t),g%=t,p.splice(g++,0,m)}return b(p)}function T(e){var t,n,r,i,a,o,s,c,l,h,f,y,g,b,x,T=[];for(y=(e=m(e)).length,t=128,n=0,a=72,o=0;o<y;++o)(f=e[o])<128&&T.push(p(f));for(r=i=T.length,i&&T.push("-");r<y;){for(s=u,o=0;o<y;++o)(f=e[o])>=t&&f<s&&(s=f);for(s-t>d((u-n)/(g=r+1))&&v("overflow"),n+=(s-t)*g,t=s,o=0;o<y;++o)if((f=e[o])<t&&++n>u&&v("overflow"),f==t){for(c=n,l=36;!(c<(h=l<=a?1:l>=a+26?26:l-a));l+=36)x=c-h,b=36-h,T.push(p(_(h+x%b,0))),c=d(x/b);T.push(p(_(c,0))),a=w(n,g,r==i),n=0,++r}++n,++t}return T.join("")}s={version:"1.4.1",ucs2:{decode:m,encode:b},decode:x,encode:T,toASCII:function(e){return g(e,(function(e){return l.test(e)?"xn--"+T(e):e}))},toUnicode:function(e){return g(e,(function(e){return c.test(e)?x(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return s}.call(t,n,t,e))||(e.exports=i)}()}).call(this,n(343)(e),n(40))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"===typeof e},isObject:function(e){return"object"===typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(346),t.encode=t.stringify=n(347)},function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,a){t=t||"&",n=n||"=";var o={};if("string"!==typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var u=1e3;a&&"number"===typeof a.maxKeys&&(u=a.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,d,p,v=e[l].replace(s,"%20"),y=v.indexOf(n);y>=0?(h=v.substr(0,y),f=v.substr(y+1)):(h=v,f=""),d=decodeURIComponent(h),p=decodeURIComponent(f),r(o,d)?i(o[d])?o[d].push(p):o[d]=[o[d],p]:o[d]=p}return o};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"===typeof e?a(o(e),(function(o){var s=encodeURIComponent(r(o))+n;return i(e[o])?a(e[o],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[o]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function a(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){var r=n(233),i=n(184),a=e.exports;for(var o in r)r.hasOwnProperty(o)&&(a[o]=r[o]);function s(e){if("string"===typeof e&&(e=i.parse(e)),e.protocol||(e.protocol="https:"),"https:"!==e.protocol)throw new Error('Protocol "'+e.protocol+'" not supported. Expected "https:"');return e}a.request=function(e,t){return e=s(e),r.request.call(this,e,t)},a.get=function(e,t){return e=s(e),r.get.call(this,e,t)}},function(e,t,n){e.exports=n(183)},function(e,t,n){e.exports=n(142)},function(e,t,n){e.exports=n(149).Transform},function(e,t,n){e.exports=n(149).PassThrough},function(e,t,n){var r=n(76),i=n(77),a={join:n(243)},o=n(354),s=n(210).DataFactory,u=function(){"use strict";function e(t){r(this,e),this.factory=t||s,this.ns={RDF:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",RDFS:"http://www.w3.org/2000/01/rdf-schema#"},this.nodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12},this.bnodes={},this.why=null,this.reify=!1}return i(e,[{key:"getAttributeNodeNS",value:function(e,t,n){var r=null;if(e.getAttributeNodeNS)r=e.getAttributeNodeNS(t,n);else for(var i,a=e.attributes,o=0;o<a.length;++o)if((i=a[o]).namespaceURI===t&&(i.prefix?i.prefix+":"+n:n)===i.nodeName){r=i;break}return r}},{key:"parse",value:function(e,t,n,r){var i=this;r?n=this.factory.namedNode(n):(r=n,n=this.factory.defaultGraph()),this.writeTriple=function(e,t,n,a){r(i.factory.quad(e,t,n,a))},this.finalize=function(){r(null)};var a,s=e.childNodes;if(this.cleanParser(),e.nodeType===this.nodeType.DOCUMENT){for(var u=0;u<s.length;u++)if(s[u].nodeType===this.nodeType.ELEMENT){a=s[u];break}}else{if(e.nodeType!==this.nodeType.ELEMENT)throw new Error("RDFXMLProcessor: can't find root in "+t+". Halting. ");a=e}this.why=n;var c=new o(this);this.base=t,c.base=t,c.lang=null,this.parseDOM(this.buildFrame(c,a))}},{key:"parseDOM",value:function(e){for(var t,n=function(e){var t="";if(null==e.namespaceURI)throw new Error("RDF/XML syntax error: No namespace for "+e.localName+" in "+this.base);return e.namespaceURI&&(t+=e.namespaceURI),e.localName?t+=e.localName:e.nodeName&&(e.nodeName.indexOf(":")>=0?t+=e.nodeName.split(":")[1]:t+=e.nodeName),t}.bind(this),r=!0;e.parent;){var i=e.element,o=i.attributes;if(i.nodeType===this.nodeType.TEXT||i.nodeType===this.nodeType.CDATA_SECTION)e.parent.nodeType===e.NODE&&(e.addArc(this.ns.RDF+"value"),e=this.buildFrame(e)),e.addLiteral(i.nodeValue);else if(n(i)!==this.ns.RDF+"RDF")if(e.parent&&e.parent.collection&&(e.addCollectionArc(),(e=this.buildFrame(e,e.element)).parent.element=null),e.parent&&e.parent.nodeType&&e.parent.nodeType!==e.ARC){e.addArc(n(i)),this.reify&&(t=this.getAttributeNodeNS(i,this.ns.RDF,"ID"))&&(e.rdfid=t.nodeValue,i.removeAttributeNode(t));var s=this.getAttributeNodeNS(i,this.ns.RDF,"parseType"),u=this.getAttributeNodeNS(i,this.ns.RDF,"datatype");if(u&&(e.datatype=u.nodeValue,i.removeAttributeNode(u)),s){var c=s.nodeValue;"Literal"===c?(e.datatype=this.ns.RDF+"XMLLiteral",(e=this.buildFrame(e)).addLiteral(i.childNodes),r=!1):"Resource"===c?((e=this.buildFrame(e,e.element)).parent.element=null,e.addBNode()):"Collection"===c&&((e=this.buildFrame(e,e.element)).parent.element=null,e.addCollection()),i.removeAttributeNode(s)}if(0!==o.length){var l=this.getAttributeNodeNS(i,this.ns.RDF,"resource"),h=this.getAttributeNodeNS(i,this.ns.RDF,"nodeID");e=this.buildFrame(e),l?(e.addNode(l.nodeValue),i.removeAttributeNode(l)):h?(e.addBNode(h.nodeValue),i.removeAttributeNode(h)):e.addBNode();for(var f=o.length-1;f>=0;f--){var d=this.buildFrame(e);d.addArc(n(o[f])),n(o[f])===this.ns.RDF+"type"?this.buildFrame(d).addNode(o[f].nodeValue):this.buildFrame(d).addLiteral(o[f].nodeValue)}}else 0===i.childNodes.length&&this.buildFrame(e).addLiteral("")}else{var p=this.getAttributeNodeNS(i,this.ns.RDF,"about");if(t=this.getAttributeNodeNS(i,this.ns.RDF,"ID"),p&&t)throw new Error("RDFXMLProcessor: "+i.nodeName+" has both rdf:id and rdf:about. Halting. Only one of these properties may be specified on a node.");if(!p&&t)e.addNode("#"+t.nodeValue),i.removeAttributeNode(t);else if(null==p&&null==t){var v=this.getAttributeNodeNS(i,this.ns.RDF,"nodeID");v?(e.addBNode(v.nodeValue),i.removeAttributeNode(v)):e.addBNode()}else e.addNode(p.nodeValue),i.removeAttributeNode(p);var y=this.getAttributeNodeNS(i,this.ns.RDF,"type");this.ns.RDF+"Description"!==n(i)&&(y={nodeValue:n(i)}),null!=y&&(this.writeTriple(e.node,this.factory.namedNode(this.ns.RDF+"type"),this.factory.namedNode(a.join(y.nodeValue,e.base)),this.why),y.nodeName&&i.removeAttributeNode(y));for(var g=o.length-1;g>=0;g--)this.writeTriple(e.node,this.factory.namedNode(n(o[g])),this.factory.literal(o[g].nodeValue,e.lang),this.why)}for(i=e.element;e.parent;){for(var m=e;null==i;)i=(e=e.parent).element;var b=i.childNodes&&i.childNodes[e.lastChild];if(b&&r){if((b.nodeType===this.nodeType.ELEMENT||b.nodeType===this.nodeType.TEXT||b.nodeType===this.nodeType.CDATA_SECTION)&&(b.nodeType!==this.nodeType.TEXT&&b.nodeType!==this.nodeType.CDATA_SECTION||1===i.childNodes.length)){e.lastChild++,e=this.buildFrame(m,i.childNodes[e.lastChild-1]);break}e.lastChild++}else{if(e.terminateFrame(),!(e=e.parent))break;i=e.element,r=!0}}}this.finalize()}},{key:"cleanParser",value:function(){this.bnodes={},this.why=null}},{key:"buildFrame",value:function(e,t){var n=new o(this,e,t);if(e&&(n.base=e.base,n.lang=e.lang),!t||t.nodeType===this.nodeType.TEXT||t.nodeType===this.nodeType.CDATA_SECTION)return n;var r=t.attributes,i=t.getAttributeNode("xml:base");null!=i&&(n.base=i.nodeValue,t.removeAttribute("xml:base"));var s=t.getAttributeNode("xml:lang");null!=s&&(n.lang=s.nodeValue,t.removeAttribute("xml:lang"));for(var u=r.length-1;u>=0;u--)if("xml"===r[u].nodeName.substr(0,3)){if("xmlns:"===r[u].name.slice(0,6)){var c=r[u].nodeValue;this.base&&(c=a.join(c,this.base))}t.removeAttributeNode(r[u])}return n}}]),e}();e.exports=u},function(e,t,n){var r=n(76),i=n(77),a={join:n(243)};e.exports=function(){"use strict";function e(t,n,i){r(this,e),this.ns=t.ns,this.NODE=1,this.ARC=2,this.parent=n,this.parser=t,this.factory=t.factory,this.element=i,this.lastChild=0,this.base=null,this.lang=null,this.node=null,this.nodeType=null,this.listIndex=1,this.rdfid=null,this.datatype=null,this.collection=!1,this.restTriple=null}return i(e,[{key:"terminateFrame",value:function(){this.collection&&this.parser.writeTriple(this.parser.restTriple.s,this.parser.restTriple.p,this.ns.RDF+"nil",this.parser.restTriple.g)}},{key:"addSymbol",value:function(e,t){t=a.join(t,this.base),this.node=this.factory.namedNode(t),this.nodeType=e}},{key:"loadTriple",value:function(){if(this.parent.parent.collection){this.parser.restTriple&&this.parser.writeTriple(this.parser.restTriple.s,this.parser.restTriple.p,this.parser.restTriple.o,this.parser.restTriple.g),this.parser.writeTriple(this.parent.parent.node,this.ns.RDF+"first",this.node,this.parser.why);var e=this.factory.blankNode();this.parser.restTriple={s:this.parent.parent.node,p:this.ns.RDF+"rest",o:e,g:this.parser.why},this.parent.parent.node=e}else this.parser.writeTriple(this.parent.parent.node,this.parent.node,this.node,this.parser.why);if(null!=this.parent.rdfid){var t=this.factory.namedNode(a.join("#"+this.parent.rdfid,this.base));this.parser.writeTriple(t,this.factory.namedNode(this.ns.RDF+"type"),this.factory.namedNode(this.ns.RDF+"Statement"),this.parser.why),this.parser.writeTriple(t,this.factory.namedNode(this.ns.RDF+"subject"),this.parent.parent.node,this.parser.why),this.parser.writeTriple(t,this.factory.namedNode(this.ns.RDF+"predicate"),this.parent.node,this.parser.why),this.parser.writeTriple(t,this.factory.namedNode(this.ns.RDF+"object"),this.node,this.parser.why)}}},{key:"isTripleToLoad",value:function(){return null!=this.parent&&null!=this.parent.parent&&this.nodeType===this.NODE&&this.parent.nodeType===this.ARC&&this.parent.parent.nodeType===this.NODE}},{key:"addNode",value:function(e){this.addSymbol(this.NODE,e),this.isTripleToLoad()&&this.loadTriple()}},{key:"addCollection",value:function(){this.nodeType=this.NODE,this.node=this.factory.blankNode(),this.collection=!0,this.isTripleToLoad()&&this.loadTriple()}},{key:"addCollectionArc",value:function(){this.nodeType=this.ARC}},{key:"addBNode",value:function(e){null!=e?null!=this.parser.bnodes[e]?this.node=this.parser.bnodes[e]:this.node=this.parser.bnodes[e]=this.factory.blankNode():this.node=this.factory.blankNode(),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}},{key:"addArc",value:function(e){e===this.ns.RDF+"li"&&(e=this.ns.RDF+"_"+this.parent.listIndex,this.parent.listIndex++),this.addSymbol(this.ARC,e)}},{key:"addLiteral",value:function(e){this.parent.datatype?this.node=this.factory.literal(e,"",this.parent.datatype):this.node=this.factory.literal(e,this.lang),this.nodeType=this.NODE,this.isTripleToLoad()&&this.loadTriple()}}]),e}()},function(e,t,n){function r(e){this.options=e||{locator:{}}}function i(){this.cdata=!1}function a(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}function o(e){if(e)return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}function s(e,t,n){return"string"==typeof e?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+"":e}function u(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}r.prototype.parseFromString=function(e,t){var n=this.options,r=new c,a=n.domBuilder||new i,s=n.errorHandler,u=n.locator,l=n.xmlns||{},h={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return u&&a.setDocumentLocator(u),r.errorHandler=function(e,t,n){if(!e){if(t instanceof i)return t;e=t}var r={},a=e instanceof Function;function s(t){var i=e[t];!i&&a&&(i=2==e.length?function(n){e(t,n)}:e),r[t]=i&&function(e){i("[xmldom "+t+"]\t"+e+o(n))}||function(){}}return n=n||{},s("warning"),s("error"),s("fatalError"),r}(s,a,u),r.domBuilder=n.domBuilder||a,/\/x?html?$/.test(t)&&(h.nbsp="\xa0",h.copy="\xa9",l[""]="http://www.w3.org/1999/xhtml"),l.xml=l.xml||"http://www.w3.org/XML/1998/namespace",e?r.parse(e,l,h):r.errorHandler.error("invalid doc source"),a.doc},i.prototype={startDocument:function(){this.doc=(new l).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,o=i.createElementNS(e,n||t),s=r.length;u(this,o),this.currentElement=o,this.locator&&a(this.locator,o);for(var c=0;c<s;c++){e=r.getURI(c);var l=r.getValue(c),h=(n=r.getQName(c),i.createAttributeNS(e,n));this.locator&&a(r.getLocator(c),h),h.value=h.nodeValue=l,o.setAttributeNode(h)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName;this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&a(this.locator,n),u(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=s.apply(this,arguments)){if(this.cdata)var r=this.doc.createCDATASection(e);else r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&a(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=s.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&a(this.locator,r),u(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&a(this.locator,i),u(this,i)}},warning:function(e){console.warn("[xmldom warning]\t"+e,o(this.locator))},error:function(e){console.error("[xmldom error]\t"+e,o(this.locator))},fatalError:function(e){throw console.error("[xmldom fatalError]\t"+e,o(this.locator)),e}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(e){i.prototype[e]=function(){return null}}));var c=n(356).XMLReader,l=t.DOMImplementation=n(244).DOMImplementation;t.XMLSerializer=n(244).XMLSerializer,t.DOMParser=r},function(e,t){var n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=new RegExp("[\\-\\.0-9"+n.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),i=new RegExp("^"+n.source+r.source+"*(?::"+n.source+r.source+"*)?$");function a(){}function o(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function s(e,t,n,r,i,a){for(var o,s=++t,u=0;;){var c=e.charAt(s);switch(c){case"=":if(1===u)o=e.slice(t,s),u=3;else{if(2!==u)throw new Error("attribute equal must after attrName");u=3}break;case"'":case'"':if(3===u||1===u){if(1===u&&(a.warning('attribute value must after "="'),o=e.slice(t,s)),t=s+1,!((s=e.indexOf(c,t))>0))throw new Error("attribute value no end '"+c+"' match");l=e.slice(t,s).replace(/&#?\w+;/g,i),n.add(o,l,t-1),u=5}else{if(4!=u)throw new Error('attribute value must after "="');l=e.slice(t,s).replace(/&#?\w+;/g,i),n.add(o,l,t),a.warning('attribute "'+o+'" missed start quot('+c+")!!"),t=s+1,u=5}break;case"/":switch(u){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:u=7,n.closed=!0;case 4:case 1:case 2:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return a.error("unexpected end of input"),0==u&&n.setTagName(e.slice(t,s)),s;case">":switch(u){case 0:n.setTagName(e.slice(t,s));case 5:case 6:case 7:break;case 4:case 1:"/"===(l=e.slice(t,s)).slice(-1)&&(n.closed=!0,l=l.slice(0,-1));case 2:2===u&&(l=o),4==u?(a.warning('attribute "'+l+'" missed quot(")!!'),n.add(o,l.replace(/&#?\w+;/g,i),t)):("http://www.w3.org/1999/xhtml"===r[""]&&l.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+l+'" missed value!! "'+l+'" instead!!'),n.add(l,l,t));break;case 3:throw new Error("attribute value missed!!")}return s;case"\x80":c=" ";default:if(c<=" ")switch(u){case 0:n.setTagName(e.slice(t,s)),u=6;break;case 1:o=e.slice(t,s),u=2;break;case 4:var l=e.slice(t,s).replace(/&#?\w+;/g,i);a.warning('attribute "'+l+'" missed quot(")!!'),n.add(o,l,t);case 5:u=6}else switch(u){case 2:n.tagName;"http://www.w3.org/1999/xhtml"===r[""]&&o.match(/^(?:disabled|checked|selected)$/i)||a.warning('attribute "'+o+'" missed value!! "'+o+'" instead2!!'),n.add(o,o,t),t=s,u=1;break;case 5:a.warning('attribute space is required"'+o+'"!!');case 6:u=1,t=s;break;case 3:u=4,t=s;break;case 7:throw new Error("elements closed character '/' and '>' must be connected to")}}s++}}function u(e,t,n){for(var r=e.tagName,i=null,a=e.length;a--;){var o=e[a],s=o.qName,u=o.value;if((d=s.indexOf(":"))>0)var c=o.prefix=s.slice(0,d),l=s.slice(d+1),f="xmlns"===c&&l;else l=s,c=null,f="xmlns"===s&&"";o.localName=l,!1!==f&&(null==i&&(i={},h(n,n={})),n[f]=i[f]=u,o.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(f,u))}for(a=e.length;a--;){(c=(o=e[a]).prefix)&&("xml"===c&&(o.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==c&&(o.uri=n[c||""]))}var d;(d=r.indexOf(":"))>0?(c=e.prefix=r.slice(0,d),l=e.localName=r.slice(d+1)):(c=null,l=e.localName=r);var p=e.uri=n[c||""];if(t.startElement(p,l,r,e),!e.closed)return e.currentNSMap=n,e.localNSMap=i,!0;if(t.endElement(p,l,r),i)for(c in i)t.endPrefixMapping(c)}function c(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf("</"+n+">",t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function l(e,t,n,r){var i=r[n];return null==i&&((i=e.lastIndexOf("</"+n+">"))<t&&(i=e.lastIndexOf("</"+n)),r[n]=i),i<t}function h(e,t){for(var n in e)t[n]=e[n]}function f(e,t,n,r){switch(e.charAt(t+2)){case"-":return"-"===e.charAt(t+3)?(i=e.indexOf("--\x3e",t+4))>t?(n.comment(e,t+4,i-t-4),i+3):(r.error("Unclosed comment"),-1):-1;default:if("CDATA["==e.substr(t+3,6)){var i=e.indexOf("]]>",t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var a=function(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;i.lastIndex=t,i.exec(e);for(;n=i.exec(e);)if(r.push(n),n[1])return r}(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],u=o>3&&/^public$/i.test(a[2][0])&&a[3][0],c=o>4&&a[4][0],l=a[o-1];return n.startDTD(s,u&&u.replace(/^(['"])(.*?)\1$/,"$2"),c&&c.replace(/^(['"])(.*?)\1$/,"$2")),n.endDTD(),l.index+l[0].length}}return-1}function d(e,t,n){var r=e.indexOf("?>",t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(i){i[0].length;return n.processingInstruction(i[1],i[2]),r+2}return-1}return-1}function p(e){}function v(e,t){return e.__proto__=t,e}a.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),h(t,t={}),function(e,t,n,r,i){function a(e){var t=e.slice(1,-1);return t in n?n[t]:"#"===t.charAt(0)?function(e){if(e>65535){var t=55296+((e-=65536)>>10),n=56320+(1023&e);return String.fromCharCode(t,n)}return String.fromCharCode(e)}(parseInt(t.substr(1).replace("x","0x"))):(i.error("entity not found:"+e),e)}function h(t){if(t>x){var n=e.substring(x,t).replace(/&#?\w+;/g,a);b&&v(x),r.characters(n,0,t-x),x=t}}function v(t,n){for(;t>=g&&(n=m.exec(e));)y=n.index,g=y+n[0].length,b.lineNumber++;b.columnNumber=t-y+1}var y=0,g=0,m=/.*(?:\r\n?|\n)|.*$/g,b=r.locator,_=[{currentNSMap:t}],w={},x=0;for(;;){try{var T=e.indexOf("<",x);if(T<0){if(!e.substr(x).match(/^\s*$/)){var S=r.doc,k=S.createTextNode(e.substr(x));S.appendChild(k),r.currentElement=k}return}switch(T>x&&h(T),e.charAt(T+1)){case"/":var M=e.indexOf(">",T+3),P=e.substring(T+2,M),I=_.pop();M<0?(P=e.substring(T+2).replace(/[\s<].*/,""),i.error("end tag name: "+P+" is not complete:"+I.tagName),M=T+1+P.length):P.match(/\s</)&&(P=P.replace(/[\s<].*/,""),i.error("end tag name: "+P+" maybe not complete"),M=T+1+P.length);var j=I.localNSMap,O=I.tagName==P;if(O||I.tagName&&I.tagName.toLowerCase()==P.toLowerCase()){if(r.endElement(I.uri,I.localName,P),j)for(var R in j)r.endPrefixMapping(R);O||i.fatalError("end tag name: "+P+" is not match the current start tagName:"+I.tagName)}else _.push(I);M++;break;case"?":b&&v(T),M=d(e,T,r);break;case"!":b&&v(T),M=f(e,T,r,i);break;default:b&&v(T);var N=new p,C=_[_.length-1].currentNSMap,A=(M=s(e,T,N,C,a,i),N.length);if(!N.closed&&l(e,M,N.tagName,w)&&(N.closed=!0,n.nbsp||i.warning("unclosed xml attribute")),b&&A){for(var E=o(b,{}),D=0;D<A;D++){var L=N[D];v(L.offset),L.locator=o(b,{})}r.locator=E,u(N,r,C)&&_.push(N),r.locator=b}else u(N,r,C)&&_.push(N);"http://www.w3.org/1999/xhtml"!==N.uri||N.closed?M++:M=c(e,M,N.tagName,a,r)}}catch(B){i.error("element parse error: "+B),M=-1}M>x?x=M:h(Math.max(T,x)+1)}}(e,t,n,r,this.errorHandler),r.endDocument()}},p.prototype={setTagName:function(e){if(!i.test(e))throw new Error("invalid tagName:"+e);this.tagName=e},add:function(e,t,n){if(!i.test(e))throw new Error("invalid attribute:"+e);this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}},v({},v.prototype)instanceof v||(v=function(e,t){function n(){}for(t in n.prototype=t,n=new n,e)n[t]=e[t];return n}),t.XMLReader=a},function(e,t,n){var r=n(76),i=n(77),a=n(187),o=n(195);e.exports=function(){"use strict";function e(t){r(this,e),this.documentIRI=t.documentIRI,this.factory=t.factory||o}return i(e,[{key:"term",value:function(e){switch(e.termType){case"NamedNode":return o.namedNode(e.value);case"BlankNode":return o.blankNode(e.value.substr(2));case"Literal":return o.literal(e.value,e.language||o.namedNode(e.datatype.value));case"DefaultGraph":return o.defaultGraph();default:throw Error("unknown termType: "+e.termType)}}},{key:"addEqualsMethodToQuad",value:function(e){return e.subject=this.term(e.subject),e.predicate=this.term(e.predicate),e.object=this.term(e.object),e.graph=this.term(e.graph),e}},{key:"parse",value:function(e,t){var n=this;a.toRDF(JSON.parse(e),{base:this.documentIRI},(function(e,r){for(var i in r){var a=r[i];t(null,n.addEqualsMethodToQuad(a)),i==r.length-1&&t(null,null)}e&&t(e)}))}}]),e}()},function(e,t,n){var r=n(359);e.exports=function(e,t){if(null==e)return{};var n,i,a=r(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(143);e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.maxCallStackDepth,i=void 0===n?500:n,a=t.maxTotalCallStackDepth,o=void 0===a?4294967295:a,s=t.timeSlice,u=void 0===s?10:s;r(this,e),this.schedule={},this.schedule.MAX_DEPTH=i,this.schedule.MAX_TOTAL_DEPTH=o,this.schedule.depth=0,this.schedule.totalDepth=0,this.schedule.timeSlice=u}return i(e,[{key:"doWork",value:function(e,t){var n=this.schedule;if(n.totalDepth>=n.MAX_TOTAL_DEPTH)return t(new Error("Maximum total call stack depth exceeded; canonicalization aborting."));!function r(){if(n.depth===n.MAX_DEPTH)return n.depth=0,n.running=!1,a.nextTick(r);var i=Date.now();if(n.running||(n.start=Date.now(),n.deadline=n.start+n.timeSlice),i<n.deadline)return n.running=!0,n.depth++,n.totalDepth++,e((function(e,r){n.depth--,n.totalDepth--,t(e,r)}));n.depth=0,n.running=!1,a.setImmediate(r)}()}},{key:"forEach",value:function(e,t,n){var r,i,a=this,o=0;if(Array.isArray(e))i=e.length,r=function(){return o!==i&&(r.value=e[o++],r.key=o,!0)};else{var s=Object.keys(e);i=s.length,r=function(){return o!==i&&(r.key=s[o++],r.value=e[r.key],!0)}}!function e(i){return i?n(i):r()?a.doWork((function(){return t(r.value,r.key,e)})):void n()}()}},{key:"waterfall",value:function(e,t){var n=this;n.forEach(e,(function(e,t,r){return n.doWork(e,r)}),t)}},{key:"whilst",value:function(e,t,n){var r=this;!function i(a){return a?n(a):e()?void r.doWork(t,i):n()}()}}]),e}()},function(e,t,n){var r=n(152);n(190),n(247);var i=e.exports=r.sha1=r.sha1||{};r.md.sha1=r.md.algorithms.sha1=i,i.create=function(){o||(a=String.fromCharCode(128),a+=r.util.fillString(String.fromCharCode(0),64),o=!0);var e=null,t=r.util.createBuffer(),n=new Array(80),i={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,a=0;a<n;++a)i.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},i}};return i.start(),i.update=function(a,o){"utf8"===o&&(a=r.util.encodeUtf8(a));var u=a.length;i.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=u[1],u[1]=u[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,u[0]=u[1]/4294967296>>>0;return t.putBytes(a),s(e,n,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=r.util.createBuffer();o.putBytes(t.bytes());var u,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;o.putBytes(a.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(u=8*i.fullMessageLength[h+1])/4294967296>>>0,o.putInt32(l>>>0),l=u>>>0;o.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};s(f,n,o);var d=r.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},i};var a=null,o=!1;function s(e,t,n){for(var r,i,a,o,s,u,c,l=n.length();l>=64;){for(i=e.h0,a=e.h1,o=e.h2,s=e.h3,u=e.h4,c=0;c<16;++c)r=n.getInt32(),t[c]=r,r=(i<<5|i>>>27)+(s^a&(o^s))+u+1518500249+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;for(;c<20;++c)r=(r=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|r>>>31,t[c]=r,r=(i<<5|i>>>27)+(s^a&(o^s))+u+1518500249+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;for(;c<32;++c)r=(r=t[c-3]^t[c-8]^t[c-14]^t[c-16])<<1|r>>>31,t[c]=r,r=(i<<5|i>>>27)+(a^o^s)+u+1859775393+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;for(;c<40;++c)r=(r=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|r>>>30,t[c]=r,r=(i<<5|i>>>27)+(a^o^s)+u+1859775393+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;for(;c<60;++c)r=(r=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|r>>>30,t[c]=r,r=(i<<5|i>>>27)+(a&o|s&(a^o))+u+2400959708+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;for(;c<80;++c)r=(r=t[c-6]^t[c-16]^t[c-28]^t[c-32])<<2|r>>>30,t[c]=r,r=(i<<5|i>>>27)+(a^o^s)+u+3395469782+r,u=s,s=o,o=(a<<30|a>>>2)>>>0,a=i,i=r;e.h0=e.h0+i|0,e.h1=e.h1+a|0,e.h2=e.h2+o|0,e.h3=e.h3+s|0,e.h4=e.h4+u|0,l-=64}}},function(e,t,n){(function(t){var n={};e.exports=n;var r={};n.encode=function(e,t,n){if("string"!==typeof t)throw new TypeError('"alphabet" must be a string.');if(void 0!==n&&"number"!==typeof n)throw new TypeError('"maxline" must be a number.');var r="";if(e instanceof Uint8Array){var i=0,a=t.length,o=t.charAt(0),s=[0];for(i=0;i<e.length;++i){for(var u=0,c=e[i];u<s.length;++u)c+=s[u]<<8,s[u]=c%a,c=c/a|0;for(;c>0;)s.push(c%a),c=c/a|0}for(i=0;0===e[i]&&i<e.length-1;++i)r+=o;for(i=s.length-1;i>=0;--i)r+=t[s[i]]}else r=function(e,t){var n=0,r=t.length,i=t.charAt(0),a=[0];for(n=0;n<e.length();++n){for(var o=0,s=e.at(n);o<a.length;++o)s+=a[o]<<8,a[o]=s%r,s=s/r|0;for(;s>0;)a.push(s%r),s=s/r|0}var u="";for(n=0;0===e.at(n)&&n<e.length()-1;++n)u+=i;for(n=a.length-1;n>=0;--n)u+=t[a[n]];return u}(e,t);if(n){var l=new RegExp(".{1,"+n+"}","g");r=r.match(l).join("\r\n")}return r},n.decode=function(e,n){if("string"!==typeof e)throw new TypeError('"input" must be a string.');if("string"!==typeof n)throw new TypeError('"alphabet" must be a string.');var i=r[n];if(!i){i=r[n]=[];for(var a=0;a<n.length;++a)i[n.charCodeAt(a)]=a}e=e.replace(/\s/g,"");var o=n.length,s=n.charAt(0),u=[0];for(a=0;a<e.length;a++){var c=i[e.charCodeAt(a)];if(void 0===c)return;for(var l=0,h=c;l<u.length;++l)h+=u[l]*o,u[l]=255&h,h>>=8;for(;h>0;)u.push(255&h),h>>=8}for(var f=0;e[f]===s&&f<e.length-1;++f)u.push(0);return"undefined"!==typeof t?t.from(u.reverse()):new Uint8Array(u.reverse())}}).call(this,n(115).Buffer)},function(e,t,n){var r=n(152);n(190),n(247);var i=e.exports=r.sha256=r.sha256||{};r.md.sha256=r.md.algorithms.sha256=i,i.create=function(){o||(a=String.fromCharCode(128),a+=r.util.fillString(String.fromCharCode(0),64),s=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],o=!0);var e=null,t=r.util.createBuffer(),n=new Array(64),i={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8,start:function(){i.messageLength=0,i.fullMessageLength=i.messageLength64=[];for(var n=i.messageLengthSize/4,a=0;a<n;++a)i.fullMessageLength.push(0);return t=r.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},i}};return i.start(),i.update=function(a,o){"utf8"===o&&(a=r.util.encodeUtf8(a));var s=a.length;i.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var c=i.fullMessageLength.length-1;c>=0;--c)i.fullMessageLength[c]+=s[1],s[1]=s[0]+(i.fullMessageLength[c]/4294967296>>>0),i.fullMessageLength[c]=i.fullMessageLength[c]>>>0,s[0]=s[1]/4294967296>>>0;return t.putBytes(a),u(e,n,t),(t.read>2048||0===t.length())&&t.compact(),i},i.digest=function(){var o=r.util.createBuffer();o.putBytes(t.bytes());var s,c=i.fullMessageLength[i.fullMessageLength.length-1]+i.messageLengthSize&i.blockLength-1;o.putBytes(a.substr(0,i.blockLength-c));for(var l=8*i.fullMessageLength[0],h=0;h<i.fullMessageLength.length-1;++h)l+=(s=8*i.fullMessageLength[h+1])/4294967296>>>0,o.putInt32(l>>>0),l=s>>>0;o.putInt32(l);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};u(f,n,o);var d=r.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},i};var a=null,o=!1,s=null;function u(e,t,n){for(var r,i,a,o,u,c,l,h,f,d,p,v,y,g=n.length();g>=64;){for(u=0;u<16;++u)t[u]=n.getInt32();for(;u<64;++u)r=((r=t[u-2])>>>17|r<<15)^(r>>>19|r<<13)^r>>>10,i=((i=t[u-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=r+t[u-7]+i+t[u-16]|0;for(c=e.h0,l=e.h1,h=e.h2,f=e.h3,d=e.h4,p=e.h5,v=e.h6,y=e.h7,u=0;u<64;++u)a=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),o=c&l|h&(c^l),r=y+((d>>>6|d<<26)^(d>>>11|d<<21)^(d>>>25|d<<7))+(v^d&(p^v))+s[u]+t[u],y=v,v=p,p=d,d=f+r>>>0,f=h,h=l,l=c,c=r+(i=a+o)>>>0;e.h0=e.h0+c|0,e.h1=e.h1+l|0,e.h2=e.h2+h|0,e.h3=e.h3+f|0,e.h4=e.h4+d|0,e.h5=e.h5+p|0,e.h6=e.h6+v|0,e.h7=e.h7+y|0,g-=64}}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=n(245),u=n(143);e.exports=function(e){o(n,e);var t=a(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).name="URGNA2012",i.hashAlgorithm="sha1",i}return i(n,[{key:"modifyFirstDegreeComponent",value:function(e,t,n){return"BlankNode"!==t.termType||((t=u.clone(t)).value="name"===n?"_:g":t.value===e?"_:a":"_:z"),t}},{key:"getRelatedPredicate",value:function(e){return e.predicate.value}},{key:"createHashToRelated",value:function(e,t,n){var r=this,i={},a=r.blankNodeInfo[e].quads;r.forEach(a,(function(n,a,o){var s,u;if("BlankNode"===n.subject.termType&&n.subject.value!==e)u=n.subject.value,s="p";else{if("BlankNode"!==n.object.termType||n.object.value===e)return o();u=n.object.value,s="r"}r.hashRelatedBlankNode(u,n,t,s,(function(e,t){if(e)return o(e);t in i?i[t].push(u):i[t]=[u],o()}))}),(function(e){return n(e,i)}))}}]),n}(s)},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=n(249),u=n(143);e.exports=function(e){o(n,e);var t=a(n);function n(){var e;return r(this,n),(e=t.call(this)).name="URGNA2012",e.hashAlgorithm="sha1",e}return i(n,[{key:"modifyFirstDegreeComponent",value:function(e,t,n){return"BlankNode"!==t.termType||((t=u.clone(t)).value="name"===n?"_:g":t.value===e?"_:a":"_:z"),t}},{key:"getRelatedPredicate",value:function(e){return e.predicate.value}},{key:"createHashToRelated",value:function(e,t){for(var n={},r=this.blankNodeInfo[e].quads,i=0;i<r.length;++i){var a=r[i],o=void 0,s=void 0;if("BlankNode"===a.subject.termType&&a.subject.value!==e)s=a.subject.value,o="p";else{if("BlankNode"!==a.object.termType||a.object.value===e)continue;s=a.object.value,o="r"}var u=this.hashRelatedBlankNode(s,a,t,o);u in n?n[u].push(s):n[u]=[s]}return n}}]),n}(s)},,function(e,t){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},function(e,t,n){var r=n(181),i=n(226);function a(t,n,o){return i()?e.exports=a=Reflect.construct:e.exports=a=function(e,t,n){var i=[null];i.push.apply(i,t);var a=new(Function.bind.apply(e,i));return n&&r(a,n.prototype),a},a.apply(null,arguments)}e.exports=a},function(e,t,n){"use strict";e.exports=n(188).NQuads},function(e,t,n){"use strict";var r,i=n(76),a=n(77),o=n(153),s=o.RDF_LANGSTRING,u=o.RDF_PLAIN_LITERAL,c=o.RDF_OBJECT,l=o.RDF_XML_LITERAL,h=o.XSD_STRING;function f(){return"undefined"===typeof XMLSerializer?n(371).XMLSerializer:XMLSerializer}r="undefined"!==typeof Node?Node:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},e.exports=function(){function e(){i(this,e)}return a(e,[{key:"parse",value:function(e){for(var t={"@default":[]},n=e.getSubjects(),i=0;i<n.length;++i){var a=n[i];if(null!==a){var o=e.getSubjectTriples(a);if(null!==o){var d=o.predicates;for(var p in d)for(var v=d[p].objects,y=0;y<v.length;++y){var g=v[y],m={};0===a.indexOf("_:")?m.subject={type:"blank node",value:a}:m.subject={type:"IRI",value:a},0===p.indexOf("_:")?m.predicate={type:"blank node",value:p}:m.predicate={type:"IRI",value:p};var b=g.value;if(g.type===l){var _=new(f());b="";for(var w=0;w<g.value.length;w++)g.value[w].nodeType===r.ELEMENT_NODE?b+=_.serializeToString(g.value[w]):g.value[w].nodeType===r.TEXT_NODE&&(b+=g.value[w].nodeValue)}m.object={},g.type===c?0===g.value.indexOf("_:")?m.object.type="blank node":m.object.type="IRI":(m.object.type="literal",g.type===u?g.language?(m.object.datatype=s,m.object.language=g.language):m.object.datatype=h:m.object.datatype=g.type),m.object.value=b,t["@default"].push(m)}}}}return t}}]),e}()},,function(e,t,n){"use strict";var r=n(82),i=n(107),a=n(104),o=a.isArray,s=a.isObject,u=a.isEmptyObject,c=a.isString,l=a.isUndefined,h=n(116),f=h.isList,d=h.isValue,p=h.isGraph,v=n(144),y=v.expandIri,g=v.getContextValue,m=v.isKeyword,b=v.process,_=v.processingMode,w=n(154).isAbsolute,x=n(97),T=x.addValue,S=x.asArray,k=x.getValues,M=x.validateTypeValue,P={};function I(e,t,n){var a,s=[],u=Object.keys(t).sort(),l=r(u);try{for(l.s();!(a=l.n()).done;){var h=a.value,f=y(e,h,{vocab:!0},n),d=t[h];o(d)||(d=[d]);var p,v=r(d);try{for(v.s();!(p=v.n()).done;){var g=p.value;if(null!==g){if(!c(g))throw new i("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:t});var m={"@value":g};"@none"!==f&&(m["@language"]=h.toLowerCase()),s.push(m)}}}catch(b){v.e(b)}finally{v.f()}}}catch(b){l.e(b)}finally{l.f()}return s}function j(e){var t,n=e.activeCtx,i=e.options,a=e.activeProperty,s=e.value,u=e.expansionMap,c=e.asGraph,h=e.indexKey,f=[],d=Object.keys(s).sort(),v="@type"===h,m=r(d);try{for(m.s();!(t=m.n()).done;){var _=t.value;if(v){var w=g(n,_,"@context");l(w)||(n=b({activeCtx:n,localCtx:w,isTypeScopedContext:!0,options:i}))}var x=s[_];o(x)||(x=[x]);var T=y(n,_,{vocab:!0},i);"@id"===h?_=y(n,_,{base:!0},i):v&&(_=T),x=P.expand({activeCtx:n,activeProperty:a,element:x,options:i,insideList:!1,insideIndex:!0,expansionMap:u});var S,k=r(x);try{for(k.s();!(S=k.n()).done;){var M=S.value;c&&!p(M)&&(M={"@graph":[M]}),"@type"===h?"@none"===T||(M["@type"]?M["@type"]=[_].concat(M["@type"]):M["@type"]=[_]):"@none"===T||h in M||(M[h]=_),f.push(M)}}catch(I){k.e(I)}finally{k.f()}}}catch(I){m.e(I)}finally{m.f()}return f}e.exports=P,P.expand=function(e){var t=e.activeCtx,n=e.activeProperty,a=void 0===n?null:n,h=e.element,v=e.options,x=void 0===v?{}:v,O=e.insideList,R=void 0!==O&&O,N=e.insideIndex,C=void 0!==N&&N,A=e.typeScopedContext,E=void 0===A?null:A,D=e.expansionMap,L=void 0===D?function(){}:D;if(null===h||void 0===h)return null;if("@default"===a&&(x=Object.assign({},x,{isFrame:!1})),!o(h)&&!s(h)){if(!R&&(null===a||"@graph"===y(t,a,{vocab:!0},x))){var B=L({unmappedValue:h,activeCtx:t,activeProperty:a,options:x,insideList:R});return void 0===B?null:B}return function(e){var t=e.activeCtx,n=e.activeProperty,r=e.value,i=e.options;if(null===r||void 0===r)return null;var a=y(t,n,{vocab:!0},i);if("@id"===a)return y(t,r,{base:!0},i);if("@type"===a)return y(t,r,{vocab:!0,base:!0},i);var o=g(t,n,"@type");if(("@id"===o||"@graph"===a)&&c(r))return{"@id":y(t,r,{base:!0},i)};if("@vocab"===o&&c(r))return{"@id":y(t,r,{vocab:!0,base:!0},i)};if(m(a))return r;var s={};if(o&&!["@id","@vocab"].includes(o))s["@type"]=o;else if(c(r)){var u=g(t,n,"@language");null!==u&&(s["@language"]=u)}["boolean","number","string"].includes(typeof r)||(r=r.toString());return s["@value"]=r,s}({activeCtx:t,activeProperty:a,value:h,options:x})}if(o(h)){var F=[],U=g(t,a,"@container")||[];R=R||U.includes("@list");for(var q=0;q<h.length;++q){var G=P.expand({activeCtx:t,activeProperty:a,element:h[q],options:x,expansionMap:L,insideIndex:C,typeScopedContext:E});R&&o(G)&&(G={"@list":G}),null===G&&void 0===(G=L({unmappedValue:h[q],activeCtx:t,activeProperty:a,parent:h,index:q,options:x,expandedParent:F,insideList:R}))||(o(G)?F=F.concat(G):F.push(G))}return F}var z=y(t,a,{vocab:!0},x);E=E||(t.previousContext?t:null);var W=Object.keys(h).sort(),V=!C;if(V&&E&&W.length<=2&&!W.includes("@context")){var H,X=r(W);try{for(X.s();!(H=X.n()).done;){var Q=H.value,Y=y(E,Q,{vocab:!0},x);if("@value"===Y){V=!1,t=E;break}if("@id"===Y&&1===W.length){V=!1;break}}}catch(de){X.e(de)}finally{X.f()}}V&&(t=t.revertTypeScopedContext()),"@context"in h&&(t=b({activeCtx:t,localCtx:h["@context"],options:x}));var J,K=r(W);try{for(K.s();!(J=K.n()).done;){var Z=J.value;if("@type"===y(t,Z,{vocab:!0},x)){var $,ee=h[Z],te=Array.isArray(ee)?ee.length>1?ee.slice().sort():ee:[ee],ne=r(te);try{for(ne.s();!($=ne.n()).done;){var re=$.value,ie=g(t.previousContext||t,re,"@context");l(ie)||(t=b({activeCtx:t,localCtx:ie,options:x,isTypeScopedContext:!0}))}}catch(de){ne.e(de)}finally{ne.f()}}}}catch(de){K.e(de)}finally{K.f()}var ae={};!function e(t){var n,a=t.activeCtx,h=t.activeProperty,v=t.expandedActiveProperty,x=t.element,k=t.expandedParent,O=t.options,R=void 0===O?{}:O,N=t.insideList,C=t.expansionMap,A=Object.keys(x).sort(),E=[],D=r(A);try{for(D.s();!(n=D.n()).done;){var L=n.value,B=x[L],F=void 0;if("@context"!==L){var U=y(a,L,{vocab:!0},R);if(null!==U&&(w(U)||m(U))||void 0!==(U=C({unmappedProperty:L,activeCtx:a,activeProperty:h,parent:x,options:R,insideList:N,value:B,expandedParent:k}))){if(m(U)){if("@reverse"===v)throw new i("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:B});if(U in k)throw new i("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:U})}if("@id"!==U)if("@type"!==U){if("@graph"===U&&!s(B)&&!o(B))throw new i('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:B});if("@value"!==U)if("@language"!==U)if("@index"!==U)if("@reverse"!==U)if("@nest"!==U){var q=a,G=g(a,L,"@context");l(G)||(q=b({activeCtx:a,localCtx:G,isPropertyTermScopedContext:!0,options:R}));var z=g(q,L,"@container")||[];if(z.includes("@language")&&s(B))F=I(q,B,R);else if(z.includes("@index")&&s(B)){var W=z.includes("@graph");F=j({activeCtx:q,options:R,activeProperty:L,value:B,expansionMap:C,asGraph:W,indexKey:"@index"})}else if(z.includes("@id")&&s(B)){var V=z.includes("@graph");F=j({activeCtx:q,options:R,activeProperty:L,value:B,expansionMap:C,asGraph:V,indexKey:"@id"})}else if(z.includes("@type")&&s(B))F=j({activeCtx:q.revertTypeScopedContext(),options:R,activeProperty:L,value:B,expansionMap:C,asGraph:!1,indexKey:"@type"});else{var H="@list"===U;if(H||"@set"===U){var X=h;H&&"@graph"===v&&(X=null),F=P.expand({activeCtx:q,activeProperty:X,element:B,options:R,insideList:H,expansionMap:C})}else F="@json"===g(a,L,"@type")?{"@type":"@json","@value":B}:P.expand({activeCtx:q,activeProperty:L,element:B,options:R,insideList:!1,expansionMap:C})}if(null!==F||"@value"===U||void 0!==(F=C({unmappedValue:B,expandedProperty:U,activeCtx:q,activeProperty:h,parent:x,options:R,insideList:N,key:L,expandedParent:k})))if("@list"!==U&&!f(F)&&z.includes("@list")&&(F={"@list":S(F)}),z.includes("@graph")&&!z.some((function(e){return"@id"===e||"@index"===e}))&&(F=S(F).map((function(e){return p(e)?e:{"@graph":S(e)}}))),q.mappings.has(L)&&q.mappings.get(L).reverse){var Q=k["@reverse"]=k["@reverse"]||{};F=S(F);for(var Y=0;Y<F.length;++Y){var J=F[Y];if(d(J)||f(J))throw new i('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:F});T(Q,U,J,{propertyIsArray:!0})}}else{var K=!["@index","@id","@type","@value","@language"].includes(U);T(k,U,F,{propertyIsArray:K})}}else E.push(L);else{if(!s(B))throw new i('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:B});if("@reverse"in(F=P.expand({activeCtx:a,activeProperty:"@reverse",element:B,options:R,expansionMap:C})))for(var Z in F["@reverse"])T(k,Z,F["@reverse"][Z],{propertyIsArray:!0});var $=k["@reverse"]||null;for(var ee in F)if("@reverse"!==ee){null===$&&($=k["@reverse"]={}),T($,ee,[],{propertyIsArray:!0});for(var te=F[ee],ne=0;ne<te.length;++ne){var re=te[ne];if(d(re)||f(re))throw new i('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:F});T($,ee,re,{propertyIsArray:!0})}}}else{if(!c(B))throw new i('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:B});T(k,"@index",B)}else{if(null===B)continue;if(!c(B)&&!R.isFrame)throw new i('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:B});B=S(B).map((function(e){return c(e)?e.toLowerCase():e})),T(k,"@language",B,{propertyIsArray:R.isFrame})}else T(k,"@value",B,{propertyIsArray:R.isFrame})}else M(B),T(k,"@type",S(B).map((function(e){return c(e)?y(a.previousContext||a,e,{base:!0,vocab:!0},R):e})),{propertyIsArray:R.isFrame});else{if(!c(B)){if(!R.isFrame)throw new i('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:B});if(s(B)){if(!u(B))throw new i('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:B})}else{if(!o(B))throw new i('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:B});if(!B.every((function(e){return c(e)})))throw new i('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:B})}}T(k,"@id",S(B).map((function(e){return c(e)?y(a,e,{base:!0},R):e})),{propertyIsArray:R.isFrame})}}}}}catch(de){D.e(de)}finally{D.f()}if("@value"in x){var ie=x["@value"];if("@json"===x["@type"]&&_(a,1.1));else if((s(ie)||o(ie))&&!R.isFrame)throw new i('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:ie})}for(var ae=0,oe=E;ae<oe.length;ae++){var se,ue=oe[ae],ce=o(x[ue])?x[ue]:[x[ue]],le=r(ce);try{for(le.s();!(se=le.n()).done;){var he=se.value;if(!s(he)||Object.keys(he).some((function(e){return"@value"===y(a,e,{vocab:!0},R)})))throw new i("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:he});e({activeCtx:a,activeProperty:h,expandedActiveProperty:v,element:he,expandedParent:k,options:R,insideList:N,expansionMap:C})}}catch(de){le.e(de)}finally{le.f()}}}({activeCtx:t,activeProperty:a,expandedActiveProperty:z,element:h,expandedParent:ae,options:x,insideList:R,typeScopedContext:E,expansionMap:L});var oe=(W=Object.keys(ae)).length;if("@value"in ae){if("@type"in ae&&"@language"in ae)throw new i('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:ae});var se=oe-1;if("@type"in ae&&(se-=1),"@index"in ae&&(se-=1),"@language"in ae&&(se-=1),0!==se)throw new i('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and at most one other property which can be "@type" or "@language".',"jsonld.SyntaxError",{code:"invalid value object",element:ae});var ue=null===ae["@value"]?[]:S(ae["@value"]),ce=k(ae,"@type");if(0===ue.length){var le=L({unmappedValue:ae,activeCtx:t,activeProperty:a,element:h,options:x,insideList:R});ae=void 0!==le?le:null}else{if(!ue.every((function(e){return c(e)||u(e)}))&&"@language"in ae)throw new i("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:ae});if(_(t,1.1)&&ce.includes("@json")&&1===ce.length);else if(!ce.every((function(e){return w(e)&&!(c(e)&&0===e.indexOf("_:"))||u(e)})))throw new i('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:ae})}}else if("@type"in ae&&!o(ae["@type"]))ae["@type"]=[ae["@type"]];else if("@set"in ae||"@list"in ae){if(oe>1&&(2!==oe||!("@index"in ae)))throw new i('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:ae});"@set"in ae&&(ae=ae["@set"],oe=(W=Object.keys(ae)).length)}else if(1===oe&&"@language"in ae){var he=L(ae,{unmappedValue:ae,activeCtx:t,activeProperty:a,element:h,options:x,insideList:R});ae=void 0!==he?he:null}if(s(ae)&&!x.keepFreeFloatingNodes&&!R&&(null===a||"@graph"===z)&&(0===oe||"@value"in ae||"@list"in ae||1===oe&&"@id"in ae)){var fe=L({unmappedValue:ae,activeCtx:t,activeProperty:a,element:h,options:x,insideList:R});ae=void 0!==fe?fe:null}return ae}},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(97).clone;e.exports=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;r(this,e),this.order=[],this.cache=new Map,this.size=t}return i(e,[{key:"get",value:function(e,t){var n=this.cache.get(e);if(n){var r=JSON.stringify(t);return n.get(r)||null}return null}},{key:"set",value:function(e,t,n){if(this.order.length===this.size){var r=this.order.shift();this.cache.get(r.activeCtx).delete(r.localCtx)}var i=JSON.stringify(t);this.order.push({activeCtx:e,localCtx:i});var o=this.cache.get(e);o||(o=new Map,this.cache.set(e,o)),o.set(i,a(n))}}]),e}()},function(e,t,n){"use strict";var r=n(116).isSubjectReference,i=n(170).createMergedNodeMap,a={};e.exports=a,a.flatten=function(e){for(var t=i(e),n=[],a=Object.keys(t).sort(),o=0;o<a.length;++o){var s=t[a[o]];r(s)||n.push(s)}return n}},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(107),s=n(116),u=n(104),c=n(97),l=n(153),h=l.RDF_LIST,f=l.RDF_FIRST,d=l.RDF_REST,p=l.RDF_NIL,v=l.RDF_TYPE,y=l.RDF_JSON_LITERAL,g=l.XSD_BOOLEAN,m=l.XSD_DOUBLE,b=l.XSD_INTEGER,_=l.XSD_STRING,w={};function x(e,t){if(e.termType.endsWith("Node"))return{"@id":e.value};var n={"@value":e.value};if(e.language)n["@language"]=e.language;else{var r=e.datatype.value;if(r||(r=_),r===y){r="@json";try{n["@value"]=JSON.parse(n["@value"])}catch(a){throw new o("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:n["@value"],cause:a})}}if(t){if(r===g)"true"===n["@value"]?n["@value"]=!0:"false"===n["@value"]&&(n["@value"]=!1);else if(u.isNumeric(n["@value"]))if(r===b){var i=parseInt(n["@value"],10);i.toFixed(0)===n["@value"]&&(n["@value"]=i)}else r===m&&(n["@value"]=parseFloat(n["@value"]));[g,b,m,_].includes(r)||(n["@type"]=r)}else r!==_&&(n["@type"]=r)}return n}e.exports=w,w.fromRDF=function(){var e=a(r.mark((function e(t,n){var a,o,l,y,g,m,b,_,w,T,S,k,M,P,I,j,O,R,N,C,A,E,D,L,B,F,U,q,G,z,W,V,H,X,Q,Y,J,K,Z,$,ee,te,ne,re,ie,ae,oe;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.useRdfType,o=void 0!==a&&a,l=n.useNativeTypes,y=void 0!==l&&l,m={"@default":g={}},b={},_=i(t),e.prev=5,_.s();case 7:if((w=_.n()).done){e.next=28;break}if(T=w.value,(S="DefaultGraph"===T.graph.termType?"@default":T.graph.value)in m||(m[S]={}),"@default"===S||S in g||(g[S]={"@id":S}),k=m[S],M=T.subject.value,P=T.predicate.value,I=T.object,M in k||(k[M]={"@id":M}),j=k[M],(O=I.termType.endsWith("Node"))&&!(I.value in k)&&(k[I.value]={"@id":I.value}),P!==v||o||!O){e.next=23;break}return c.addValue(j,"@type",I.value,{propertyIsArray:!0}),e.abrupt("continue",26);case 23:R=x(I,y),c.addValue(j,P,R,{propertyIsArray:!0}),O&&(I.value===p?("usages"in(N=k[I.value])||(N.usages=[]),N.usages.push({node:j,property:P,value:R})):I.value in b?b[I.value]=!1:b[I.value]={node:j,property:P,value:R});case 26:e.next=7;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(5),_.e(e.t0);case 33:return e.prev=33,_.f(),e.finish(33);case 36:e.t1=r.keys(m);case 37:if((e.t2=e.t1()).done){e.next=84;break}if(C=e.t2.value,A=m[C],p in A){e.next=42;break}return e.abrupt("continue",37);case 42:if((E=A[p]).usages){e.next=45;break}return e.abrupt("continue",37);case 45:D=i(E.usages),e.prev=46,D.s();case 48:if((L=D.n()).done){e.next=73;break}B=L.value,F=B.node,U=B.property,q=B.value,G=[],z=[],W=Object.keys(F).length;case 56:if(!(U===d&&u.isObject(b[F["@id"]])&&u.isArray(F[f])&&1===F[f].length&&u.isArray(F[d])&&1===F[d].length&&(3===W||4===W&&u.isArray(F["@type"])&&1===F["@type"].length&&F["@type"][0]===h))){e.next=68;break}if(G.push(F[f][0]),z.push(F["@id"]),B=b[F["@id"]],F=B.node,U=B.property,q=B.value,W=Object.keys(F).length,s.isBlankNode(F)){e.next=66;break}return e.abrupt("break",68);case 66:e.next=56;break;case 68:for(delete q["@id"],q["@list"]=G.reverse(),V=0,H=z;V<H.length;V++)X=H[V],delete A[X];case 71:e.next=48;break;case 73:e.next=78;break;case 75:e.prev=75,e.t3=e.catch(46),D.e(e.t3);case 78:return e.prev=78,D.f(),e.finish(78);case 81:delete E.usages,e.next=37;break;case 84:Q=[],Y=Object.keys(g).sort(),J=i(Y);try{for(J.s();!(K=J.n()).done;){if(Z=K.value,$=g[Z],Z in m){ee=$["@graph"]=[],te=m[Z],ne=Object.keys(te).sort(),re=i(ne);try{for(re.s();!(ie=re.n()).done;)ae=ie.value,oe=te[ae],s.isSubjectReference(oe)||ee.push(oe)}catch(se){re.e(se)}finally{re.f()}}s.isSubjectReference($)||Q.push($)}}catch(se){J.e(se)}finally{J.f()}return e.abrupt("return",Q);case 89:case"end":return e.stop()}}),e,null,[[5,30,33,36],[46,75,78,81]])})));return function(t,n){return e.apply(this,arguments)}}()},function(e,t,n){"use strict";var r=n(82),i=n(170).createNodeMap,a=n(144).isKeyword,o=n(116),s=n(377),u=n(104),c=n(97),l=n(153),h=l.RDF_FIRST,f=l.RDF_REST,d=l.RDF_NIL,p=l.RDF_TYPE,v=l.RDF_JSON_LITERAL,y=l.RDF_LANGSTRING,g=l.XSD_BOOLEAN,m=l.XSD_DOUBLE,b=l.XSD_INTEGER,_=l.XSD_STRING,w=n(154).isAbsolute,x={};function T(e,t,n,i,o){var s,u=Object.keys(t).sort(),c=r(u);try{for(c.s();!(s=c.n()).done;){var l,h=s.value,f=t[h],d=Object.keys(f).sort(),v=r(d);try{for(v.s();!(l=v.n()).done;){var y=l.value,g=f[y];if("@type"===y)y=p;else if(a(y))continue;var m,b=r(g);try{for(b.s();!(m=b.n()).done;){var _=m.value,x={termType:h.startsWith("_:")?"BlankNode":"NamedNode",value:h};if(w(h)){var T={termType:y.startsWith("_:")?"BlankNode":"NamedNode",value:y};if(w(y)&&("BlankNode"!==T.termType||o.produceGeneralizedRdf)){var k=S(_,i,e,n);k&&e.push({subject:x,predicate:T,object:k,graph:n})}}}}catch(M){b.e(M)}finally{b.f()}}}catch(M){v.e(M)}finally{v.f()}}}catch(M){c.e(M)}finally{c.f()}}function S(e,t,n,i){var a={};if(o.isValue(e)){a.termType="Literal",a.value=void 0,a.datatype={termType:"NamedNode"};var c=e["@value"],l=e["@type"]||null;"@json"===l?(a.value=s(c),a.datatype.value=v):u.isBoolean(c)?(a.value=c.toString(),a.datatype.value=l||g):u.isDouble(c)||l===m?(u.isDouble(c)||(c=parseFloat(c)),a.value=c.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),a.datatype.value=l||m):u.isNumber(c)?(a.value=c.toFixed(0),a.datatype.value=l||b):"@language"in e?(a.value=c,a.datatype.value=l||y,a.language=e["@language"]):(a.value=c,a.datatype.value=l||_)}else if(o.isList(e)){var p=function(e,t,n,i){var a,o={termType:"NamedNode",value:h},s={termType:"NamedNode",value:f},u={termType:"NamedNode",value:d},c=e.pop(),l=c?{termType:"BlankNode",value:t.getId()}:u,p=l,v=r(e);try{for(v.s();!(a=v.n()).done;){var y=S(a.value,t,n,i),g={termType:"BlankNode",value:t.getId()};n.push({subject:p,predicate:o,object:y,graph:i}),n.push({subject:p,predicate:s,object:g,graph:i}),p=g}}catch(b){v.e(b)}finally{v.f()}if(c){var m=S(c,t,n,i);n.push({subject:p,predicate:o,object:m,graph:i}),n.push({subject:p,predicate:s,object:u,graph:i})}return l}(e["@list"],t,n,i);a.termType=p.termType,a.value=p.value}else{var x=u.isObject(e)?e["@id"]:e;a.termType=x.startsWith("_:")?"BlankNode":"NamedNode",a.value=x}return"NamedNode"!==a.termType||w(a.value)?a:null}e.exports=x,x.toRDF=function(e,t){var n=new c.IdentifierIssuer("_:b"),a={"@default":{}};i(e,a,"@default",n);var o,s=[],u=Object.keys(a).sort(),l=r(u);try{for(l.s();!(o=l.n()).done;){var h=o.value,f=void 0;if("@default"===h)f={termType:"DefaultGraph",value:""};else{if(!w(h))continue;(f=h.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"}).value=h}T(s,a[h],f,n,t)}}catch(d){l.e(d)}finally{l.f()}return s}},function(e,t,n){"use strict";e.exports=function(e){return function e(t){if(null===t||"object"!==typeof t||null!=t.toJSON)return JSON.stringify(t);if(Array.isArray(t)&&0===t.length)return"[]";if(Array.isArray(t)&&1===t.length)return"["+e(t[0])+"]";if(Array.isArray(t))return"["+t.reduce((function(t,n,r){return(t=1===r?e(t):t)+","+e(n)}))+"]";var n=Object.keys(t);if(0===n.length)return"{}";if(1===n.length)return"{"+e(n[0])+":"+e(t[n[0]])+"}";return"{"+n.sort().reduce((function(n,r,i){return(n=1===i?e(n)+":"+e(t[n]):n)+","+e(r)+":"+e(t[r])}))+"}"}(e)}},function(e,t,n){"use strict";var r=n(192),i=n(82),a=n(144).isKeyword,o=n(116),s=n(104),u=n(97),c=n(107),l=n(170),h=l.createNodeMap,f=l.mergeNodeMapGraphs,d={};function p(e){var t={};for(var n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function v(e,t,n){for(var r=n.length-1;r>=0;--r){var i=n[r];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function y(e,t,n){var r="@"+n,i=r in e?e[r][0]:t[n];return"embed"===n&&(!0===i?i="@last":!1===i?i="@never":"@always"!==i&&"@never"!==i&&"@link"!==i&&(i="@last")),i}function g(e){if(!s.isArray(e)||1!==e.length||!s.isObject(e[0]))throw new c("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e})}function m(e,t,n,r){var a,o={},s=i(t);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=e.graphMap[e.graph][u];b(e,c,n,r)&&(o[u]=c)}}catch(l){s.e(l)}finally{s.f()}return o}function b(e,t,n,r){var c=!0,l=!1,h=function(h){var f=!1,d=u.getValues(t,h),p=0===u.getValues(n,h).length;if(a(h)){if("@id"!==h&&"@type"!==h)return"continue";if(c=!1,"@id"===h)return n["@id"].length>=0&&!s.isEmptyObject(n["@id"][0])?{v:n["@id"].includes(d[0])}:(f=!0,"continue");if("@type"in n)if(p){if(d.length>0)return{v:!1};f=!0}else{if(1!==n["@type"].length||!s.isEmptyObject(n["@type"][0])){var v,y=i(n["@type"]);try{var m=function(){var e=v.value;if(d.some((function(t){return t===e})))return{v:{v:!0}}};for(y.s();!(v=y.n()).done;){var b=m();if("object"===typeof b)return b.v}}catch(M){y.e(M)}finally{y.f()}return{v:!1}}f=d.length>0}}var _=u.getValues(n,h)[0],w=!1;if(_&&(g([_]),w="@default"in _),c=!1,0===d.length&&w)return"continue";if(d.length>0&&p)return{v:!1};if(void 0===_){if(d.length>0)return{v:!1};f=!0}else if(s.isObject(_))f=d.length>0;else if(o.isValue(_))f=d.some((function(e){return T(_,e)}));else if(o.isSubject(_)||o.isSubjectReference(_))f=d.some((function(t){return x(e,_,t,r)}));else if(o.isList(_)){var S=_["@list"][0];if(o.isList(d[0])){var k=d[0]["@list"];o.isValue(S)?f=k.some((function(e){return T(S,e)})):(o.isSubject(S)||o.isSubjectReference(S))&&(f=k.some((function(t){return x(e,S,t,r)})))}else f=!1}if(!f&&r.requireAll)return{v:!1};l=l||f};for(var f in n){var d=h(f);switch(d){case"continue":continue;default:if("object"===typeof d)return d.v}}return c||l}function _(e,t){var n=e.uniqueEmbeds[e.graph],r=n[t],i=r.parent,a=r.property,o={"@id":t};if(s.isArray(i)){for(var c=0;c<i.length;++c)if(u.compareValues(i[c],o)){i[c]=o;break}}else{var l=s.isArray(i[a]);u.removeValue(i,a,o,{propertyIsArray:l}),u.addValue(i,a,o,{propertyIsArray:l})}!function e(t){for(var r=0,i=Object.keys(n);r<i.length;r++){var a=i[r];a in n&&s.isObject(n[a].parent)&&n[a].parent["@id"]===t&&(delete n[a],e(a))}}(t)}function w(e,t,n){s.isObject(e)?u.addValue(e,t,n,{propertyIsArray:!0}):e.push(n)}function x(e,t,n,r){if(!("@id"in n))return!1;var i=e.subjects[n["@id"]];return i&&b(e,i,t,r)}function T(e,t){var n=t["@value"],r=t["@type"],i=t["@language"],a=e["@value"]?s.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],o=e["@type"]?s.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],u=e["@language"]?s.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===a.length&&0===o.length&&0===u.length||!(!a.includes(n)&&!s.isEmptyObject(a[0]))&&(!!(!r&&0===o.length||o.includes(r)||r&&s.isEmptyObject(o[0]))&&!!(!i&&0===u.length||u.includes(i)||i&&s.isEmptyObject(u[0])))}e.exports=d,d.frameMergedOrDefault=function(e,t,n){var r={options:n,graph:"@default",graphMap:{"@default":{}},graphStack:[],subjectStack:[],link:{},bnodeMap:{}},i=new u.IdentifierIssuer("_:b");h(e,r.graphMap,"@default",i),n.merged&&(r.graphMap["@merged"]=f(r.graphMap),r.graph="@merged"),r.subjects=r.graphMap[r.graph];var a=[];return d.frame(r,Object.keys(r.subjects).sort(),t,a),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(r.bnodeMap).filter((function(e){return 1===r.bnodeMap[e].length}))),a},d.frame=function(e,t,n,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;g(n),n=n[0];var h,f=e.options,b={embed:y(n,f,"embed"),explicit:y(n,f,"explicit"),requireAll:y(n,f,"requireAll")},x=m(e,t,n,b),S=Object.keys(x).sort(),k=i(S);try{var M=function(){var t=h.value,g=x[t];if("@link"===b.embed&&t in e.link)return w(c,l,e.link[t]),"continue";null===l?e.uniqueEmbeds=r({},e.graph,{}):e.uniqueEmbeds[e.graph]=e.uniqueEmbeds[e.graph]||{};var m={};if(m["@id"]=t,0===t.indexOf("_:")&&u.addValue(e.bnodeMap,t,m,{propertyIsArray:!0}),e.link[t]=m,"@never"===b.embed||v(g,e.graph,e.subjectStack))return w(c,l,m),"continue";if("@last"===b.embed&&(t in e.uniqueEmbeds[e.graph]&&_(e,t),e.uniqueEmbeds[e.graph][t]={parent:c,property:l}),e.subjectStack.push({subject:g,graph:e.graph}),t in e.graphMap){var S=!1,k=null;"@graph"in n?(k=n["@graph"][0],s.isObject(k)||(k={}),S=!("@merged"===t||"@default"===t)):(S="@merged"!==e.graph,k={}),S&&(e.graphStack.push(e.graph),e.graph=t,d.frame(e,Object.keys(e.graphMap[t]).sort(),[k],m,"@graph"),e.graph=e.graphStack.pop)}var M,P=i(Object.keys(g).sort());try{for(P.s();!(M=P.n()).done;){var I=M.value;if(a(I)){if(m[I]=u.clone(g[I]),"@type"===I){var j,O=i(g["@type"]);try{for(O.s();!(j=O.n()).done;){var R=j.value;0===R.indexOf("_:")&&u.addValue(e.bnodeMap,R,m,{propertyIsArray:!0})}}catch(Z){O.e(Z)}finally{O.f()}}}else if(!b.explicit||I in n){var N,C=i(g[I]);try{for(C.s();!(N=C.n()).done;){var A=N.value,E=I in n?n[I]:p(b);if(o.isList(A)){var D={"@list":[]};w(m,I,D);var L=A["@list"];for(var B in L)if(A=L[B],o.isSubjectReference(A)){var F=I in n?n[I][0]["@list"]:p(b);d.frame(e,[A["@id"]],F,D,"@list")}else w(D,"@list",u.clone(A))}else o.isSubjectReference(A)?d.frame(e,[A["@id"]],E,m,I):T(E[0],A)&&w(m,I,u.clone(A))}}catch(Z){C.e(Z)}finally{C.f()}}}}catch(Z){P.e(Z)}finally{P.f()}var U,q=i(Object.keys(n).sort());try{for(q.s();!(U=q.n()).done;){var G=U.value;if(!a(G)){var z=n[G][0]||{};if(!y(z,f,"omitDefault")&&!(G in m)){var W="@null";"@default"in z&&(W=u.clone(z["@default"])),s.isArray(W)||(W=[W]),m[G]=[{"@preserve":W}]}}}}catch(Z){q.e(Z)}finally{q.f()}if("@reverse"in n){var V,H=i(Object.keys(n["@reverse"]).sort());try{for(H.s();!(V=H.n()).done;)for(var X=V.value,Q=n["@reverse"][X],Y=0,J=Object.keys(e.subjects);Y<J.length;Y++){var K=J[Y];u.getValues(e.subjects[K],X).some((function(e){return e["@id"]===t}))&&(m["@reverse"]=m["@reverse"]||{},u.addValue(m["@reverse"],X,[],{propertyIsArray:!0}),d.frame(e,[K],Q,m["@reverse"][X],l))}}catch(Z){H.e(Z)}finally{H.f()}}w(c,l,m),e.subjectStack.pop()};for(k.s();!(h=k.n()).done;)M()}catch(P){k.e(P)}finally{k.f()}}},function(e,t,n){"use strict";var r=n(193),i=n(192),a=n(82),o=n(107),s=n(104),u=s.isArray,c=s.isObject,l=s.isString,h=s.isUndefined,f=n(116),d=f.isList,p=f.isValue,v=f.isGraph,y=f.isSimpleGraph,g=f.isSubjectReference,m=n(144),b=m.expandIri,_=m.getContextValue,w=m.isKeyword,x=m.process,T=n(154).removeBase,S=n(97),k=S.addValue,M=S.asArray,P=S.compareShortestLeast,I={};function j(e,t,n){if("@nest"!==b(e,t,{vocab:!0},n))throw new o("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}e.exports=I,I.compact=function(e){var t=e.activeCtx,n=e.activeProperty,s=void 0===n?null:n,l=e.element,f=e.options,m=void 0===f?{}:f,b=e.compactionMap,T=void 0===b?function(){}:b;if(u(l)){for(var S=[],P=0;P<l.length;++P){var O=I.compact({activeCtx:t,activeProperty:s,element:l[P],options:m,compactionMap:T});null===O&&void 0===(O=T({unmappedValue:l[P],activeCtx:t,activeProperty:s,parent:l,index:P,options:m}))||S.push(O)}if(m.compactArrays&&1===S.length)0===(_(t,s,"@container")||[]).length&&(S=S[0]);return S}var R=_(t,s,"@context");if(h(R)||(t=x({activeCtx:t,localCtx:R,isPropertyTermScopedContext:!0,options:m})),c(l)){if(m.link&&"@id"in l&&m.link.hasOwnProperty(l["@id"]))for(var N=m.link[l["@id"]],C=0;C<N.length;++C)if(N[C].expanded===l)return N[C].compacted;if(p(l)||g(l)){var A=I.compactValue({activeCtx:t,activeProperty:s,value:l,options:m});return m.link&&g(l)&&(m.link.hasOwnProperty(l["@id"])||(m.link[l["@id"]]=[]),m.link[l["@id"]].push({expanded:l,compacted:A})),A}if(d(l))if((_(t,s,"@container")||[]).includes("@list"))return I.compact({activeCtx:t,activeProperty:s,element:l["@list"],options:m,compactionMap:T});var E="@reverse"===s,D={};t=t.revertTypeScopedContext(),m.link&&"@id"in l&&(m.link.hasOwnProperty(l["@id"])||(m.link[l["@id"]]=[]),m.link[l["@id"]].push({expanded:l,compacted:D}));var L=l["@type"]||[];L.length>1&&(L=Array.from(L).sort());var B,F=t,U=a(L);try{for(U.s();!(B=U.n()).done;){var q=B.value,G=I.compactIri({activeCtx:F,iri:q,relativeTo:{vocab:!0}}),z=_(F,G,"@context");h(z)||(t=x({activeCtx:t,localCtx:z,options:m,isTypeScopedContext:!0}))}}catch(Pe){U.e(Pe)}finally{U.f()}var W,V=Object.keys(l).sort(),H=a(V);try{for(H.s();!(W=H.n()).done;){var X=W.value,Q=l[X];if("@id"===X||"@type"===X)if("continue"===function(){var e="@type"===X,n=e&&t.previousContext||t,r=M(Q).map((function(t){return I.compactIri({activeCtx:n,iri:t,relativeTo:{vocab:e}})}));1===r.length&&(r=r[0]);var i=I.compactIri({activeCtx:t,iri:X,relativeTo:{vocab:!0}}),a=u(r)&&0===Q.length;return k(D,i,r,{propertyIsArray:a}),"continue"}())continue;if("@reverse"!==X)if("@preserve"!==X)if("@index"!==X)if("@graph"!==X&&"@list"!==X&&w(X)){var Y=I.compactIri({activeCtx:t,iri:X,relativeTo:{vocab:!0}});k(D,Y,Q)}else{if(!u(Q))throw new o("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===Q.length){var J=I.compactIri({activeCtx:t,iri:X,value:Q,relativeTo:{vocab:!0},reverse:E}),K=t.mappings.has(J)?t.mappings.get(J)["@nest"]:null,Z=D;K&&(j(t,K,m),c(D[K])||(D[K]={}),Z=D[K]),k(Z,J,Q,{propertyIsArray:!0})}var $,ee=a(Q);try{for(ee.s();!($=ee.n()).done;){var te=$.value,ne=I.compactIri({activeCtx:t,iri:X,value:te,relativeTo:{vocab:!0},reverse:E}),re=t.mappings.has(ne)?t.mappings.get(ne)["@nest"]:null,ie=D;re&&(j(t,re,m),c(D[re])||(D[re]={}),ie=D[re]);var ae=_(t,ne,"@container")||[],oe=v(te),se=d(te),ue=void 0;se?ue=te["@list"]:oe&&(ue=te["@graph"]);var ce=I.compact({activeCtx:t,activeProperty:ne,element:se||oe?ue:te,options:m,compactionMap:T});if(se){if(u(ce)||(ce=[ce]),ae.includes("@list")){k(ie,ne,ce,{valueIsArray:!0,allowDuplicate:!0});continue}ce=i({},I.compactIri({activeCtx:t,iri:"@list",relativeTo:{vocab:!0}}),ce),"@index"in te&&(ce[I.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"])}if(oe)if(ae.includes("@graph")&&(ae.includes("@id")||ae.includes("@index")&&y(te))){var le=void 0;ie.hasOwnProperty(ne)?le=ie[ne]:ie[ne]=le={};var he=(ae.includes("@id")?te["@id"]:te["@index"])||I.compactIri({activeCtx:t,iri:"@none",vocab:!0});k(le,he,ce,{propertyIsArray:!m.compactArrays||ae.includes("@set")})}else ae.includes("@graph")&&y(te)||(u(ce)&&1===ce.length&&m.compactArrays&&(ce=ce[0]),ce=i({},I.compactIri({activeCtx:t,iri:"@graph",relativeTo:{vocab:!0}}),ce),"@id"in te&&(ce[I.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}})]=te["@id"]),"@index"in te&&(ce[I.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=te["@index"])),k(ie,ne,ce,{propertyIsArray:!m.compactArrays||ae.includes("@set")});else if(ae.includes("@language")||ae.includes("@index")||ae.includes("@id")||ae.includes("@type")){var fe=void 0;ie.hasOwnProperty(ne)?fe=ie[ne]:ie[ne]=fe={};var de=void 0;if(ae.includes("@language"))p(ce)&&(ce=ce["@value"]),de=te["@language"];else if(ae.includes("@index"))de=te["@index"];else if(ae.includes("@id")){var pe=I.compactIri({activeCtx:t,iri:"@id",vocab:!0});de=ce[pe],delete ce[pe]}else if(ae.includes("@type")){var ve,ye=I.compactIri({activeCtx:t,iri:"@type",vocab:!0}),ge=M(ce[ye]||[]),me=r(ge);switch(de=me[0],(ve=me.slice(1)).length){case 0:delete ce[ye];break;case 1:ce[ye]=ve[0];break;default:ce[ye]=ve}}de||(de=I.compactIri({activeCtx:t,iri:"@none",vocab:!0})),k(fe,de,ce,{propertyIsArray:ae.includes("@set")})}else{var be=!m.compactArrays||ae.includes("@set")||ae.includes("@list")||u(ce)&&0===ce.length||"@list"===X||"@graph"===X;k(ie,ne,ce,{propertyIsArray:be})}}}catch(Pe){ee.e(Pe)}finally{ee.f()}}else{if((_(t,s,"@container")||[]).includes("@index"))continue;var _e=I.compactIri({activeCtx:t,iri:X,relativeTo:{vocab:!0}});k(D,_e,Q)}else{var we=I.compact({activeCtx:t,activeProperty:s,element:Q,options:m,compactionMap:T});u(we)&&0===we.length||k(D,X,we)}else{var xe=I.compact({activeCtx:t,activeProperty:"@reverse",element:Q,options:m,compactionMap:T});for(var Te in xe)if(t.mappings.has(Te)&&t.mappings.get(Te).reverse){var Se=xe[Te],ke=(_(t,Te,"@container")||[]).includes("@set")||!m.compactArrays;k(D,Te,Se,{propertyIsArray:ke}),delete xe[Te]}if(Object.keys(xe).length>0){var Me=I.compactIri({activeCtx:t,iri:X,relativeTo:{vocab:!0}});k(D,Me,xe)}}}}catch(Pe){H.e(Pe)}finally{H.f()}return D}return l},I.compactIri=function(e){var t=e.activeCtx,n=e.iri,r=e.value,i=void 0===r?null:r,o=e.relativeTo,s=void 0===o?{vocab:!1}:o,u=e.reverse,l=void 0!==u&&u;if(null===n)return n;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);var h=t.getInverse();if(w(n)&&n in h&&"@none"in h[n]&&"@type"in h[n]["@none"]&&"@none"in h[n]["@none"]["@type"])return h[n]["@none"]["@type"]["@none"];if(s.vocab&&n in h){var f=t["@language"]||"@none",y=[];c(i)&&"@index"in i&&!("@graph"in i)&&y.push("@index","@index@set"),c(i)&&"@preserve"in i&&(i=i["@preserve"][0]),v(i)?("@index"in i&&y.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i&&y.push("@graph@id","@graph@id@set"),y.push("@graph","@graph@set","@set"),"@index"in i||y.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i||y.push("@graph@id","@graph@id@set")):c(i)&&!p(i)&&y.push("@id","@id@set","@type","@set@type");var m="@language",b="@null";if(l)m="@type",b="@reverse",y.push("@set");else if(d(i)){"@index"in i||y.push("@list");var _=i["@list"];if(0===_.length)m="@any",b="@none";else{for(var x=0===_.length?f:null,S=null,k=0;k<_.length;++k){var M=_[k],j="@none",O="@none";if(p(M)?"@language"in M?j=M["@language"]:"@type"in M?O=M["@type"]:j="@null":O="@id",null===x?x=j:j!==x&&p(M)&&(x="@none"),null===S?S=O:O!==S&&(S="@none"),"@none"===x&&"@none"===S)break}x=x||"@none","@none"!==(S=S||"@none")?(m="@type",b=S):b=x}}else p(i)?"@language"in i&&!("@index"in i)?(y.push("@language","@language@set"),b=i["@language"]):"@type"in i&&(m="@type",b=i["@type"]):(m="@type",b="@id"),y.push("@set");y.push("@none"),c(i)&&!("@index"in i)&&y.push("@index","@index@set"),p(i)&&1===Object.keys(i).length&&y.push("@language","@language@set");var R=function(e,t,n,r,i,a){null===a&&(a="@null");var o=[];if("@id"!==a&&"@reverse"!==a||!g(n))o.push(a);else{"@reverse"===a&&o.push("@reverse");var s=I.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:!0}});e.mappings.has(s)&&e.mappings.get(s)&&e.mappings.get(s)["@id"]===n["@id"]?o.push.apply(o,["@vocab","@id"]):o.push.apply(o,["@id","@vocab"])}o.push("@none");for(var u=e.inverse[t],c=0;c<r.length;++c){var l=r[c];if(l in u)for(var h=u[l][i],f=0;f<o.length;++f){var d=o[f];if(d in h)return h[d]}}return null}(t,n,i,y,m,b);if(null!==R)return R}if(s.vocab&&"@vocab"in t){var N=t["@vocab"];if(0===n.indexOf(N)&&n!==N){var C=n.substr(N.length);if(!t.mappings.has(C))return C}}for(var A=null,E=[],D=t.fastCurieMap,L=n.length-1,B=0;B<L&&n[B]in D;++B)""in(D=D[n[B]])&&E.push(D[""][0]);for(var F=E.length-1;F>=0;--F){var U,q=E[F],G=q.terms,z=a(G);try{for(z.s();!(U=z.n()).done;){var W=U.value,V=W+":"+n.substr(q.iri.length);t.mappings.get(W)._prefix&&(!t.mappings.has(V)||null===i&&t.mappings.get(V)["@id"]===n)&&(null===A||P(V,A)<0)&&(A=V)}}catch(H){z.e(H)}finally{z.f()}}return null!==A?A:s.vocab?n:T(t["@base"],n)},I.compactValue=function(e){var t=e.activeCtx,n=e.activeProperty,r=e.value,a=e.options;if(p(r)){var o=_(t,n,"@type"),s=_(t,n,"@language"),u=_(t,n,"@container")||[],c="@index"in r&&!u.includes("@index");if(!c&&(r["@type"]===o||r["@language"]===s))return r["@value"];var h=Object.keys(r).length,f=1===h||2===h&&"@index"in r&&!c,d="@language"in t,v=l(r["@value"]),y=t.mappings.has(n)&&null===t.mappings.get(n)["@language"];if(f&&(!d||!v||y))return r["@value"];var g={};return c&&(g[I.compactIri({activeCtx:t,iri:"@index",relativeTo:{vocab:!0}})]=r["@index"]),"@type"in r?g[I.compactIri({activeCtx:t,iri:"@type",relativeTo:{vocab:!0}})]=I.compactIri({activeCtx:t,iri:r["@type"],relativeTo:{vocab:!0}}):"@language"in r&&(g[I.compactIri({activeCtx:t,iri:"@language",relativeTo:{vocab:!0}})]=r["@language"]),g[I.compactIri({activeCtx:t,iri:"@value",relativeTo:{vocab:!0}})]=r["@value"],g}var m=b(t,n,{vocab:!0},a),w=_(t,n,"@type"),x=I.compactIri({activeCtx:t,iri:r["@id"],relativeTo:{vocab:"@vocab"===w}});return"@id"===w||"@vocab"===w||"@graph"===m?x:i({},I.compactIri({activeCtx:t,iri:"@id",relativeTo:{vocab:!0}}),x)},I.removePreserve=function(e,t,n){if(u(t)){for(var r=[],i=0;i<t.length;++i){var a=I.removePreserve(e,t[i],n);null!==a&&r.push(a)}t=r}else if(c(t)){if("@preserve"in t)return"@null"===t["@preserve"]?null:t["@preserve"];if(p(t))return t;if(d(t))return t["@list"]=I.removePreserve(e,t["@list"],n),t;var o=I.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}});if(t.hasOwnProperty(o)){var s=t[o];if(n.link.hasOwnProperty(s)){var l=n.link[s].indexOf(t);if(-1!==l)return n.link[s][l];n.link[s].push(t)}else n.link[s]=[t]}var h=I.compactIri({activeCtx:e,iri:"@graph",relativeTo:{vocab:!0}});for(var f in t)if(f===o&&n.bnodesToClear.includes(t[f]))delete t[o];else{var v=I.removePreserve(e,t[f],n),y=_(e,f,"@container")||[];n.compactArrays&&u(v)&&1===v.length&&0===y.length&&f!==h&&(v=v[0]),t[f]=v}}return t}},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(97),o=a.parseLinkHeader,s=a.buildHeaders,u=n(153).LINK_HEADER_REL,c=n(107),l=n(194);function h(e,t){return new Promise((function(n,r){e(t,(function(e,t,i){e?r(e):n({res:t,body:i})}))}))}e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{strictSSL:!0,maxRedirects:-1,headers:{}},t=e.secure,a=e.strictSSL,f=void 0===a||a,d=e.maxRedirects,p=void 0===d?-1:d,v=e.request,y=e.headers,g=void 0===y?{}:y;g=s(g),v=v||n(381);var m=n(382),b=new l;return b.wrapLoader((function(e){return _(e,[])}));function _(e,t){return w.apply(this,arguments)}function w(){return(w=i(r.mark((function e(n,i){var a,s,l,d,y,b,w;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===n.indexOf("http:")||0===n.indexOf("https:")){e.next=2;break}throw new c('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:n});case 2:if(!t||0===n.indexOf("https")){e.next=4;break}throw new c('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:n});case 4:if(null===(a=null)){e.next=7;break}return e.abrupt("return",a);case 7:return e.prev=7,e.next=10,h(v,{url:n,headers:g,strictSSL:f,followRedirect:!1});case 10:s=e.sent,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(7),new c("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:n,cause:e.t0});case 16:if(d=(l=s).res,y=l.body,a={contextUrl:null,documentUrl:n,document:y||null},b=m.STATUS_CODES[d.statusCode],!(d.statusCode>=400)){e.next=21;break}throw new c("URL could not be dereferenced: "+b,"jsonld.InvalidUrl",{code:"loading document failed",url:n,httpStatusCode:d.statusCode});case 21:if(!d.headers.link||"application/ld+json"===d.headers["content-type"]){e.next=26;break}if(w=o(d.headers.link)[u],!Array.isArray(w)){e.next=25;break}throw new c("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:n});case 25:w&&(a.contextUrl=w.target);case 26:if(!(d.statusCode>=300&&d.statusCode<400&&d.headers.location)){e.next=33;break}if(i.length!==p){e.next=29;break}throw new c("URL could not be dereferenced; there were too many redirects.","jsonld.TooManyRedirects",{code:"loading document failed",url:n,httpStatusCode:d.statusCode,redirects:i});case 29:if(-1===i.indexOf(n)){e.next=31;break}throw new c("URL could not be dereferenced; infinite redirection was detected.","jsonld.InfiniteRedirectDetected",{code:"recursive context inclusion",url:n,httpStatusCode:d.statusCode,redirects:i});case 31:return i.push(n),e.abrupt("return",_(d.headers.location,i));case 33:return i.push(n),e.abrupt("return",a);case 35:case"end":return e.stop()}}),e,null,[[7,13]])})))).apply(this,arguments)}}},,,function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(97),o=a.parseLinkHeader,s=a.buildHeaders,u=n(153).LINK_HEADER_REL,c=n(107),l=n(194),h=/(^|(\r\n))link:/i;function f(e,t,n){var r=new(e=e||XMLHttpRequest);return new Promise((function(e,i){for(var a in r.onload=function(){return e(r)},r.onerror=function(e){return i(e)},r.open("GET",t,!0),n)r.setRequestHeader(a,n[a]);r.send()}))}e.exports=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{headers:{}},t=e.secure,n=e.headers,a=void 0===n?{}:n,d=e.xhr;a=s(a);var p=new l;return p.wrapLoader(v);function v(e){return y.apply(this,arguments)}function y(){return(y=i(r.mark((function e(n){var i,s,l,p;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===n.indexOf("http:")||0===n.indexOf("https:")){e.next=2;break}throw new c('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:n});case 2:if(!t||0===n.indexOf("https")){e.next=4;break}throw new c('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:n});case 4:return e.prev=4,e.next=7,f(d,n,a);case 7:i=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),new c("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:n,cause:e.t0});case 13:if(!(i.status>=400)){e.next=15;break}throw new c("URL could not be dereferenced: "+i.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:n,httpStatusCode:i.status});case 15:if(s={contextUrl:null,documentUrl:n,document:i.response},l=i.getResponseHeader("Content-Type"),h.test(i.getAllResponseHeaders())&&(p=i.getResponseHeader("Link")),!p||"application/ld+json"===l){e.next=23;break}if(p=o(p)[u],!Array.isArray(p)){e.next=22;break}throw new c("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:n});case 22:p&&(s.contextUrl=p.target);case 23:return e.abrupt("return",s);case 24:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}}},function(e,t,n){"use strict";var r=n(76),i=n(77);e.exports=function(e){var t=function(){function e(){r(this,e)}return i(e,[{key:"toString",value:function(){return"[object JsonLdProcessor]"}}]),e}();return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}},function(e,t,n){var r=n(386),i=n(250),a=n(387),o=n(251),s=n(388),u=n(389);function c(){}c.namedNode=function(e){return new o(e)},c.blankNode=function(e){return new r(e)},c.literal=function(e,t){return"string"===typeof t?-1===t.indexOf(":")?new a(e,t):new a(e,null,c.namedNode(t)):new a(e,null,t)},c.defaultGraph=function(){return c.defaultGraphInstance},c.variable=function(e){return new u(e)},c.triple=function(e,t,n){return c.quad(e,t,n)},c.quad=function(e,t,n,r){return new s(e,t,n,r||c.defaultGraphInstance)},c.defaultGraphInstance=new i,e.exports=c},function(e,t){function n(e){this.value=e||"b"+ ++n.nextId}n.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},n.prototype.termType="BlankNode",n.nextId=0,e.exports=n},function(e,t,n){var r=n(251);function i(e,t,n){this.value=e,this.datatype=i.stringDatatype,this.language="",t?(this.language=t,this.datatype=i.langStringDatatype):n&&(this.datatype=n)}i.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)},i.prototype.termType="Literal",i.langStringDatatype=new r("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),i.stringDatatype=new r("http://www.w3.org/2001/XMLSchema#string"),e.exports=i},function(e,t,n){var r=n(250);function i(e,t,n,i){this.subject=e,this.predicate=t,this.object=n,this.graph=i||new r}i.prototype.equals=function(e){return!!e&&e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)},e.exports=i},function(e,t){function n(e){this.value=e}n.prototype.equals=function(e){return!!e&&e.termType===this.termType&&e.value===this.value},n.prototype.termType="Variable",e.exports=n},function(e,t,n){var r=n(76),i=n(77),a=n(391).RDFaProcessor,o=n(195);e.exports=function(){"use strict";function e(t){r(this,e),this.documentIRI=t.documentIRI,this.factory=t.factory||o}return i(e,[{key:"parse",value:function(e,t){try{var n=new a(null,this.factory);n.onTriple=function(e){t(null,e)},n.process(e,{baseURI:this.documentIRI})}catch(r){t(r)}}}]),e}()},function(e,t,n){e.exports={RDFaProcessor:n(392)}},function(e,t,n){var r=n(76),i=n(77),a=n(393),o=n(210).DataFactory,s=function(){"use strict";function e(t,n){r(this,e),this.uriresolver=new a,this.factory=n||o,this.XMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#XMLLiteral",this.HTMLLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#HTML",this.PlainLiteralURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#PlainLiteral",this.objectURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#object",this.typeURI="http://www.w3.org/1999/02/22-rdf-syntax-ns#type",this.nameChar="[-A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c-\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd\u10000-\uefffF.0-9\xb7\u0300-\u036f\u203f-\u2040]",this.nameStartChar="[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u0131\u0134-\u013e\u0141-\u0148\u014a-\u017e\u0180-\u01c3\u01cd-\u01f0\u01f4-\u01f5\u01fa-\u0217\u0250-\u02a8\u02bb-\u02c1\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03d6\u03da\u03dc\u03de\u03e0\u03e2-\u03f3\u0401-\u040c\u040e-\u044f\u0451-\u045c\u045e-\u0481\u0490-\u04c4\u04c7-\u04c8\u04cb-\u04cc\u04d0-\u04eb\u04ee-\u04f5\u04f8-\u04f9\u0531-\u0556\u0559\u0561-\u0586\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0641-\u064a\u0671-\u06b7\u06ba-\u06be\u06c0-\u06ce\u06d0-\u06d3\u06d5\u06e5-\u06e6\u0905-\u0939\u093d\u0958-\u0961\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8b\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ae0\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b36-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb5\u0bb7-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0e01-\u0e2e\u0e30\u0e32-\u0e33\u0e40-\u0e45\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eae\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0f40-\u0f47\u0f49-\u0f69\u10a0-\u10c5\u10d0-\u10f6\u1100\u1102-\u1103\u1105-\u1107\u1109\u110b-\u110c\u110e-\u1112\u113c\u113e\u1140\u114c\u114e\u1150\u1154-\u1155\u1159\u115f-\u1161\u1163\u1165\u1167\u1169\u116d-\u116e\u1172-\u1173\u1175\u119e\u11a8\u11ab\u11ae-\u11af\u11b7-\u11b8\u11ba\u11bc-\u11c2\u11eb\u11f0\u11f9\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2126\u212a-\u212b\u212e\u2180-\u2182\u3041-\u3094\u30a1-\u30fa\u3105-\u312c\uac00-\ud7a3\u4e00-\u9fa5\u3007\u3021-\u3029_]",this.NCNAME=new RegExp("^"+this.nameStartChar+this.nameChar+"*$"),this.target=t||{graph:{subjects:{},prefixes:{},terms:{}}},this.theOne="_:"+(new Date).getTime(),this.language=null,this.vocabulary=null,this.blankCounter=0,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.inXHTMLMode=!1,this.absURIRE=/[\w\_\-]+:\S+/,this.finishedHandlers=[],this.init()}return i(e,[{key:"newBlankNode",value:function(){return this.blankCounter++,"_:"+this.blankCounter}},{key:"trim",value:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}},{key:"tokenize",value:function(e){return this.trim(e).split(/\s+/)}},{key:"parseSafeCURIEOrCURIEOrURI",value:function(e,t,n){return"["==(e=this.trim(e)).charAt(0)&&"]"==e.charAt(e.length-1)?0==(e=(e=e.substring(1,e.length-1)).trim(e)).length?null:"_:"==e?this.theOne:this.parseCURIE(e,t,n):this.parseCURIEOrURI(e,t,n)}},{key:"parseCURIE",value:function(e,t,n){var r=e.indexOf(":");if(r>=0){var i,a=e.substring(0,r);if(""==a)return(i=t[""])?i+e.substring(r+1):null;if("_"==a)return"_:"+e.substring(r+1);if(this.NCNAME.test(a)&&(i=t[a]))return i+e.substring(r+1)}return null}},{key:"parseCURIEOrURI",value:function(e,t,n){var r=this.parseCURIE(e,t,n);return r||this.resolveAndNormalize(n,e)}},{key:"parsePredicate",value:function(e,t,n,r,i,a){if(""==e)return null;var o=this.parseTermOrCURIEOrAbsURI(e,t,a?null:n,r,i);return o&&0==o.indexOf("_:")?null:o}},{key:"parseTermOrCURIEOrURI",value:function(e,t,n,r,i){e=this.trim(e);var a=this.parseCURIE(e,r,i);if(a)return a;var o=n[e];return o||((o=n[e.toLowerCase()])?o:t&&!this.absURIRE.exec(e)?t+e:this.resolveAndNormalize(i,e))}},{key:"parseTermOrCURIEOrAbsURI",value:function(e,t,n,r,i){e=this.trim(e);var a=this.parseCURIE(e,r,i);if(a)return a;if(n){if(t&&!this.absURIRE.exec(e))return t+e;var o=n[e];if(o)return o;if(o=n[e.toLowerCase()])return o}return this.absURIRE.exec(e)?this.resolveAndNormalize(i,e):null}},{key:"resolveAndNormalize",value:function(e,t){var n=e.resolve(t),r=this.uriresolver.parseURI(n);return r.normalize(),r.spec}},{key:"parsePrefixMappings",value:function(e,t){for(var n=this.tokenize(e),r=null,i=0;i<n.length;i++)":"==n[i][n[i].length-1]?r=n[i].substring(0,n[i].length-1):r&&(t[r]=this.target.baseURI?this.target.baseURI.resolve(n[i]):n[i],r=null)}},{key:"copyMappings",value:function(e){var t={};for(var n in e)t[n]=e[n];return t}},{key:"ancestorPath",value:function(e){for(var t="";e&&9!=e.nodeType;)t="/"+e.localName+t,e=e.parentNode;return t}},{key:"setContext",value:function(e){if("html"==e.localName&&"XHTML+RDFa 1.1"==e.getAttribute("version"))this.setXHTMLContext();else if("html"==e.localName||"http://www.w3.org/1999/xhtml"==e.namespaceURI)if(e.ownerDocument.doctype){var t=e.ownerDocument;"-//W3C//DTD XHTML+RDFa 1.0//EN"==t.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd"==t.doctype.systemId?this.setHTMLContext():"-//W3C//DTD XHTML+RDFa 1.1//EN"==t.doctype.publicId&&"http://www.w3.org/MarkUp/DTD/xhtml-rdfa-2.dtd"==t.doctype.systemId?this.setXHTMLContext():this.setHTMLContext()}else this.setHTMLContext();else this.setXMLContext()}},{key:"setInitialContext",value:function(){this.vocabulary=null,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"}],this.target.graph.prefixes.as="https://www.w3.org/ns/activitystreams#",this.target.graph.prefixes.dqv="http://www.w3.org/ns/dqv#",this.target.graph.prefixes.duv="https://www.w3.org/TR/vocab-duv#",this.target.graph.prefixes.cat="http://www.w3.org/ns/dcat#",this.target.graph.prefixes.qb="http://purl.org/linked-data/cube#",this.target.graph.prefixes.grddl="http://www.w3.org/2003/g/data-view#",this.target.graph.prefixes.ldp="http://www.w3.org/ns/ldp#",this.target.graph.prefixes.oa="http://www.w3.org/ns/oa#",this.target.graph.prefixes.ma="http://www.w3.org/ns/ma-ont#",this.target.graph.prefixes.owl="http://www.w3.org/2002/07/owl#",this.target.graph.prefixes.rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#",this.target.graph.prefixes.rdfa="http://www.w3.org/ns/rdfa#",this.target.graph.prefixes.rdfs="http://www.w3.org/2000/01/rdf-schema#",this.target.graph.prefixes.rif="http://www.w3.org/2007/rif#",this.target.graph.prefixes.rr="http://www.w3.org/ns/r2rml#",this.target.graph.prefixes.skos="http://www.w3.org/2004/02/skos/core#",this.target.graph.prefixes.skosxl="http://www.w3.org/2008/05/skos-xl#",this.target.graph.prefixes.wdr="http://www.w3.org/2007/05/powder#",this.target.graph.prefixes.void="http://rdfs.org/ns/void#",this.target.graph.prefixes.wdrs="http://www.w3.org/2007/05/powder-s#",this.target.graph.prefixes.xhv="http://www.w3.org/1999/xhtml/vocab#",this.target.graph.prefixes.xml="http://www.w3.org/XML/1998/namespace",this.target.graph.prefixes.xsd="http://www.w3.org/2001/XMLSchema#",this.target.graph.prefixes.prov="http://www.w3.org/ns/prov#",this.target.graph.prefixes.sd="http://www.w3.org/ns/sparql-service-description#",this.target.graph.prefixes.org="http://www.w3.org/ns/org#",this.target.graph.prefixes.gldp="http://www.w3.org/ns/people#",this.target.graph.prefixes.cnt="http://www.w3.org/2008/content#",this.target.graph.prefixes.dcat="http://www.w3.org/ns/dcat#",this.target.graph.prefixes.earl="http://www.w3.org/ns/earl#",this.target.graph.prefixes.ht="http://www.w3.org/2006/http#",this.target.graph.prefixes.ptr="http://www.w3.org/2009/pointers#",this.target.graph.prefixes.cc="http://creativecommons.org/ns#",this.target.graph.prefixes.ctag="http://commontag.org/ns#",this.target.graph.prefixes.dc="http://purl.org/dc/terms/",this.target.graph.prefixes.dc11="http://purl.org/dc/elements/1.1/",this.target.graph.prefixes.dcterms="http://purl.org/dc/terms/",this.target.graph.prefixes.foaf="http://xmlns.com/foaf/0.1/",this.target.graph.prefixes.gr="http://purl.org/goodrelations/v1#",this.target.graph.prefixes.ical="http://www.w3.org/2002/12/cal/icaltzd#",this.target.graph.prefixes.og="http://ogp.me/ns#",this.target.graph.prefixes.rev="http://purl.org/stuff/rev#",this.target.graph.prefixes.sioc="http://rdfs.org/sioc/ns#",this.target.graph.prefixes.v="http://rdf.data-vocabulary.org/#",this.target.graph.prefixes.vcard="http://www.w3.org/2006/vcard/ns#",this.target.graph.prefixes.schema="http://schema.org/",this.target.graph.prefixes.describedby="http://www.w3.org/2007/05/powder-s#describedby",this.target.graph.prefixes.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.prefixes.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.prefixes.ssn="http://www.w3.org/ns/ssn/",this.target.graph.prefixes.sosa="http://www.w3.org/ns/sosa/",this.target.graph.prefixes.time="http://www.w3.org/2006/time#"}},{key:"setXMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!1,this.inHTMLMode=!1}},{key:"setHTMLContext",value:function(){this.setInitialContext(),this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.inXHTMLMode=!1,this.inHTMLMode=!0}},{key:"setXHTMLContext",value:function(){this.setInitialContext(),this.inXHTMLMode=!0,this.inHTMLMode=!1,this.langAttributes=[{namespaceURI:"http://www.w3.org/XML/1998/namespace",localName:"lang"},{namespaceURI:null,localName:"lang"}],this.target.graph.terms.alternate="http://www.w3.org/1999/xhtml/vocab#alternate",this.target.graph.terms.appendix="http://www.w3.org/1999/xhtml/vocab#appendix",this.target.graph.terms.bookmark="http://www.w3.org/1999/xhtml/vocab#bookmark",this.target.graph.terms.cite="http://www.w3.org/1999/xhtml/vocab#cite",this.target.graph.terms.chapter="http://www.w3.org/1999/xhtml/vocab#chapter",this.target.graph.terms.contents="http://www.w3.org/1999/xhtml/vocab#contents",this.target.graph.terms.copyright="http://www.w3.org/1999/xhtml/vocab#copyright",this.target.graph.terms.first="http://www.w3.org/1999/xhtml/vocab#first",this.target.graph.terms.glossary="http://www.w3.org/1999/xhtml/vocab#glossary",this.target.graph.terms.help="http://www.w3.org/1999/xhtml/vocab#help",this.target.graph.terms.icon="http://www.w3.org/1999/xhtml/vocab#icon",this.target.graph.terms.index="http://www.w3.org/1999/xhtml/vocab#index",this.target.graph.terms.last="http://www.w3.org/1999/xhtml/vocab#last",this.target.graph.terms.license="http://www.w3.org/1999/xhtml/vocab#license",this.target.graph.terms.meta="http://www.w3.org/1999/xhtml/vocab#meta",this.target.graph.terms.next="http://www.w3.org/1999/xhtml/vocab#next",this.target.graph.terms.prev="http://www.w3.org/1999/xhtml/vocab#prev",this.target.graph.terms.previous="http://www.w3.org/1999/xhtml/vocab#previous",this.target.graph.terms.section="http://www.w3.org/1999/xhtml/vocab#section",this.target.graph.terms.stylesheet="http://www.w3.org/1999/xhtml/vocab#stylesheet",this.target.graph.terms.subsection="http://www.w3.org/1999/xhtml/vocab#subsection",this.target.graph.terms.start="http://www.w3.org/1999/xhtml/vocab#start",this.target.graph.terms.top="http://www.w3.org/1999/xhtml/vocab#top",this.target.graph.terms.up="http://www.w3.org/1999/xhtml/vocab#up",this.target.graph.terms.p3pv1="http://www.w3.org/1999/xhtml/vocab#p3pv1",this.target.graph.terms.related="http://www.w3.org/1999/xhtml/vocab#related",this.target.graph.terms.role="http://www.w3.org/1999/xhtml/vocab#role",this.target.graph.terms.transformation="http://www.w3.org/1999/xhtml/vocab#transformation",this.dateTimeTypes=[{pattern:/-?P(?:[0-9]+Y)?(?:[0-9]+M)?(?:[0-9]+D)?(?:T(?:[0-9]+H)?(?:[0-9]+M)?(?:[0-9]+(?:\.[0-9]+)?S)?)?/,type:"http://www.w3.org/2001/XMLSchema#duration"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9]T(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#dateTime"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]-[0-9][0-9](?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#date"},{pattern:/(?:[0-1][0-9]|2[0-4]):[0-5][0-9]:[0-5][0-9](?:\.[0-9]+)?(?:Z|[+\-][0-9][0-9]:[0-9][0-9])?/,type:"http://www.w3.org/2001/XMLSchema#time"},{pattern:/-?(?:[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9])-[0-9][0-9]/,type:"http://www.w3.org/2001/XMLSchema#gYearMonth"},{pattern:/-?[1-9][0-9][0-9][0-9]|0[1-9][0-9][0-9]|00[1-9][0-9]|000[1-9]/,type:"http://www.w3.org/2001/XMLSchema#gYear"}]}},{key:"init",value:function(){}},{key:"newSubjectOrigin",value:function(e,t){}},{key:"addTriple",value:function(e,t,n,r){var i=this.factory.namedNode(this.options.baseURI)||this.factory.defaultGraph();t="_:"===t.substr(0,2)?this.factory.blankNode(t.substr(2)):this.factory.namedNode(t),n="_:"===n.substr(0,2)?this.factory.blankNode(n.substr(2)):this.factory.namedNode(n),r="http://www.w3.org/1999/02/22-rdf-syntax-ns#object"===r.type?"_:"===r.value.substr(0,2)?this.factory.blankNode(r.value.substr(2)):this.factory.namedNode(r.value):r.language?this.factory.literal(r.value,r.language):this.factory.literal(r.value,this.factory.namedNode(r.type));var a=this.factory.quad(t,n,r,i);this.onTriple(a)}},{key:"onTriple",value:function(e){}},{key:"deriveDateTimeType",value:function(e){for(var t=0;t<this.dateTimeTypes.length;t++){var n=this.dateTimeTypes[t].pattern.exec(e);if(n&&n[0].length==e.length)return this.dateTimeTypes[t].type}return null}},{key:"process",value:function(e,t){this.options=t,9==e.nodeType?(e=e.documentElement,this.setContext(e)):9==e.parentNode.nodeType&&this.setContext(e);var n=[],r=function(e){if(!e&&t&&t.baseURI)return t.baseURI;var n=e.indexOf("#");return n>=0&&(e=e.substring(0,n)),t&&t.baseURIMap&&(e=t.baseURIMap(e)),e};for(n.push({current:e,context:this.push(null,r(e.baseURI))});n.length>0;){var i=n.shift();if(i.parent){if(i.context.parent&&i.context.parent.listMapping==i.listMapping)continue;for(var a in i.listMapping){if(0!=(Y=i.listMapping[a]).length){for(var o=[],s=0;s<Y.length;s++)o.push(this.newBlankNode());for(s=0;s<o.length;s++)this.addTriple(i.parent,o[s],"http://www.w3.org/1999/02/22-rdf-syntax-ns#first",Y[s]),this.addTriple(i.parent,o[s],"http://www.w3.org/1999/02/22-rdf-syntax-ns#rest",{type:this.objectURI,value:s+1<o.length?o[s+1]:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"});this.addTriple(i.parent,i.subject,a,{type:this.objectURI,value:o[0]})}else this.addTriple(i.parent,i.subject,a,{type:this.objectURI,value:"http://www.w3.org/1999/02/22-rdf-syntax-ns#nil"})}}else{var u=i.current,c=i.context,l=!1,h=null,f=null,d=null,p=c.prefixes,v=!1,y=[],g=c.listMapping,m=!c.parent,b=c.language,_=c.vocabulary,w=this.uriresolver.parseURI(r(u.baseURI));u.item=null;var x=u.getAttributeNode("vocab");if(x)if((I=this.trim(x.value)).length>0){_=I;var T=w.spec;this.addTriple(u,T,"http://www.w3.org/ns/rdfa#usesVocabulary",{type:this.objectURI,value:_})}else _=this.vocabulary;for(s=0;s<u.attributes.length;s++){var S=u.attributes[s];if("x"==S.nodeName.charAt(0)&&0==S.nodeName.indexOf("xmlns:")){v||(p=this.copyMappings(p),v=!0);var k=S.nodeName.substring(6),M=this.trim(S.value);p[k]=this.target.baseURI?this.target.baseURI.resolve(M):M}}var P=u.getAttributeNode("prefix");P&&(v||(p=this.copyMappings(p),v=!0),this.parsePrefixMappings(P.value,p));var I,j=null;for(s=0;!j&&s<this.langAttributes.length;s++)j=u.getAttributeNodeNS(this.langAttributes[s].namespaceURI,this.langAttributes[s].localName);if(j)b=(I=this.trim(j.value)).length>0?I:null;var O=u.getAttributeNode("rel"),R=u.getAttributeNode("rev"),N=u.getAttributeNode("typeof"),C=u.getAttributeNode("property"),A=u.getAttributeNode("datatype"),E=this.inHTMLMode?u.getAttributeNode("datetime"):null,D=u.getAttributeNode("content"),L=u.getAttributeNode("about"),B=u.getAttributeNode("src"),F=u.getAttributeNode("resource"),U=u.getAttributeNode("href"),q=u.getAttributeNode("inlist"),G=[];if(O){var z=this.tokenize(O.value);for(s=0;s<z.length;s++){(a=this.parsePredicate(z[s],_,c.terms,p,w,this.inHTMLMode&&null!=C))&&G.push(a)}}var W=[];if(R)for(z=this.tokenize(R.value),s=0;s<z.length;s++){(a=this.parsePredicate(z[s],_,c.terms,p,w,this.inHTMLMode&&null!=C))&&W.push(a)}!this.inHTMLMode||null==O&&null==R||null==C||(0==G.length&&(O=null),0==W.length&&(R=null)),O||R?(L&&(h=this.parseSafeCURIEOrCURIEOrURI(L.value,p,w)),N&&(d=h),h||(9==u.parentNode.nodeType?h=r(u.baseURI):c.parentObject&&(h=r(u.parentNode.baseURI)==c.parentObject?r(u.baseURI):c.parentObject)),F&&(f=this.parseSafeCURIEOrCURIEOrURI(F.value,p,w)),f||(U?f=this.resolveAndNormalize(w,encodeURI(U.value)):B?f=this.resolveAndNormalize(w,encodeURI(B.value)):!N||L||this.inXHTMLMode&&("head"==u.localName||"body"==u.localName)||(f=this.newBlankNode())),!N||L||!this.inXHTMLMode||"head"!=u.localName&&"body"!=u.localName?N&&!L&&(d=f):d=h):!C||D||A?(L&&(h=this.parseSafeCURIEOrCURIEOrURI(L.value,p,w)),!h&&F&&(h=this.parseSafeCURIEOrCURIEOrURI(F.value,p,w)),!h&&U&&(h=this.resolveAndNormalize(w,encodeURI(U.value))),!h&&B&&(h=this.resolveAndNormalize(w,encodeURI(B.value))),h||(9==u.parentNode.nodeType?h=r(u.baseURI):!this.inXHTMLMode&&!this.inHTMLMode||"head"!=u.localName&&"body"!=u.localName?N?h=this.newBlankNode():c.parentObject&&(h=r(u.parentNode.baseURI)==c.parentObject?r(u.baseURI):c.parentObject,C||(l=!0)):h=r(u.parentNode.baseURI)==c.parentObject?r(u.baseURI):c.parentObject),N&&(d=h)):(L&&(h=this.parseSafeCURIEOrCURIEOrURI(L.value,p,w),N&&(d=h)),h||9!=u.parentNode.nodeType?!h&&c.parentObject&&(h=r(u.parentNode.baseURI)==c.parentObject?r(u.baseURI):c.parentObject):(h=r(u.baseURI),N&&(d=h)),N&&!d&&(F&&(d=this.parseSafeCURIEOrCURIEOrURI(F.value,p,w)),!d&&U&&(d=this.resolveAndNormalize(w,encodeURI(U.value))),!d&&B&&(d=this.resolveAndNormalize(w,encodeURI(B.value))),d||!this.inXHTMLMode&&!this.inHTMLMode||"head"!=u.localName&&"body"!=u.localName||(d=h),d||(d=this.newBlankNode()),f=d));if(h&&(L||F||d)){var V=h;N&&!L&&!F&&f&&(V=f),this.newSubjectOrigin(u,V)}if(d)for(z=this.tokenize(N.value),s=0;s<z.length;s++){var H=this.parseTermOrCURIEOrAbsURI(z[s],_,c.terms,p,w);H&&this.addTriple(u,d,this.typeURI,{type:this.objectURI,value:H})}if(h&&h!=c.parentObject&&(g={},m=!0),f){if(O&&q)for(s=0;s<G.length;s++){(Y=g[G[s]])||(Y=[],g[G[s]]=Y),Y.push({type:this.objectURI,value:f})}else if(O)for(s=0;s<G.length;s++)this.addTriple(u,h,G[s],{type:this.objectURI,value:f});if(R)for(s=0;s<W.length;s++)this.addTriple(u,f,W[s],{type:this.objectURI,value:h})}else{if(h&&!f&&(O||R)&&(f=this.newBlankNode()),O&&q)for(s=0;s<G.length;s++){(Y=g[G[s]])||(Y=[],g[a]=Y),y.push({predicate:G[s],list:Y})}else if(O)for(s=0;s<G.length;s++)y.push({predicate:G[s],forward:!0});if(R)for(s=0;s<W.length;s++)y.push({predicate:W[s],forward:!1})}if(C){var X=null,Q=null;A?(X=""==A.value?this.PlainLiteralURI:this.parseTermOrCURIEOrAbsURI(A.value,_,c.terms,p,w),Q=E&&!D?E.value:X==this.XMLLiteralURI||X==this.HTMLLiteralURI?null:D?D.value:u.textContent):D?(X=this.PlainLiteralURI,Q=D.value):E?(Q=E.value,(X=this.deriveDateTimeType(Q))||(X=this.PlainLiteralURI)):O||R||(F&&(Q=this.parseSafeCURIEOrCURIEOrURI(F.value,p,w)),!Q&&U?Q=this.resolveAndNormalize(w,encodeURI(U.value)):!Q&&B&&(Q=this.resolveAndNormalize(w,encodeURI(B.value))),Q&&(X=this.objectURI)),X||(N&&!L?(X=this.objectURI,Q=d):(Q=u.textContent,this.inHTMLMode&&"time"==u.localName&&(X=this.deriveDateTimeType(Q)),X||(X=this.PlainLiteralURI)));for(z=this.tokenize(C.value),s=0;s<z.length;s++){var Y;if(a=this.parsePredicate(z[s],_,c.terms,p,w))if(q)(Y=g[a])||(Y=[],g[a]=Y),Y.push(X==this.XMLLiteralURI||X==this.HTMLLiteralURI?{type:X,value:u.innerHTML}:{type:X||this.PlainLiteralURI,value:Q,language:b});else X==this.XMLLiteralURI||X==this.HTMLLiteralURI?this.addTriple(u,h,a,{type:X,value:u.innerHTML}):this.addTriple(u,h,a,{type:X||this.PlainLiteralURI,value:Q,language:b})}}if(h&&!l)for(s=0;s<c.incomplete.length;s++)c.incomplete[s].list?c.incomplete[s].list.push({type:this.objectURI,value:h}):c.incomplete[s].forward?this.addTriple(u,c.subject,c.incomplete[s].predicate,{type:this.objectURI,value:h}):this.addTriple(u,h,c.incomplete[s].predicate,{type:this.objectURI,value:c.subject});var J=null,K=h;l?((J=this.push(c,c.subject)).parentObject=r(u.parentNode.baseURI)==c.parentObject?r(u.baseURI):c.parentObject,J.incomplete=c.incomplete,J.language=b,J.prefixes=p,J.vocabulary=_):((J=this.push(c,h)).parentObject=f||(h||c.subject),J.prefixes=p,J.incomplete=y,f&&(K=f,g={},m=!0),J.listMapping=g,J.language=b,J.vocabulary=_),m&&n.unshift({parent:u,context:c,subject:K,listMapping:g});for(var Z=u.lastChild;Z;Z=Z.previousSibling)1==Z.nodeType&&n.unshift({current:Z,context:J})}}this.inHTMLMode&&this.copyProperties();for(s=0;s<this.finishedHandlers.length;s++)this.finishedHandlers[s](e);this.onTriple(null)}},{key:"copyProperties",value:function(){}},{key:"push",value:function(e,t){return{parent:e,subject:t||(e?e.subject:null),parentObject:null,incomplete:[],listMapping:e?e.listMapping:{},language:e?e.language:this.language,prefixes:e?e.prefixes:this.target.graph.prefixes,terms:e?e.terms:this.target.graph.terms,vocabulary:e?e.vocabulary:this.vocabulary}}}]),e}();e.exports=s},function(e,t,n){var r=n(76),i=n(77),a=/^[A-Za-z][A-Za-z0-9\+\-\.]*\:/,o=function(){"use strict";function e(){r(this,e)}return i(e,[{key:"parseURI",value:function(e){var t=a.exec(e);if(!t)throw"Bad URI value, no scheme: "+e;var n={spec:e};return n.scheme=t[0].substring(0,t[0].length-1),n.schemeSpecificPart=n.spec.substring(t[0].length),"/"==n.schemeSpecificPart.charAt(0)&&"/"==n.schemeSpecificPart.charAt(1)?this.parseGeneric(n):n.isGeneric=!1,n.normalize=function(){if(this.isGeneric&&0!=this.segments.length){if(this.path.length>1&&"/."==this.path.substring(this.path.length-2))return this.path=this.path.substring(0,this.path.length-1),this.segments.splice(this.segments.length-1,1),this.schemeSpecificPart="//"+this.authority+this.path,"undefined"!=typeof this.query&&(this.schemeSpecificPart+="?"+this.query),"undefined"!=typeof this.fragment&&(this.schemeSpecificPart+="#"+this.fragment),void(this.spec=this.scheme+":"+this.schemeSpecificPart);var e=this.path.charAt(this.path.length-1);"/"!=e&&(e="");for(var t=0;t<this.segments.length;t++)t>0&&".."==this.segments[t]&&(this.segments.splice(t-1,2),t-=2),"."==this.segments[t]&&(this.segments.splice(t,1),t--);this.path=0==this.segments.length?"/":"/"+this.segments.join("/")+e,this.schemeSpecificPart="//"+this.authority+this.path,"undefined"!=typeof this.query&&(this.schemeSpecificPart+="?"+this.query),"undefined"!=typeof this.fragment&&(this.schemeSpecificPart+="#"+this.fragment),this.spec=this.scheme+":"+this.schemeSpecificPart}},n.resolve=function(e){if(!e)return this.spec;if("#"==e.charAt(0)){var t=this.spec.lastIndexOf("#");return t<0?this.spec+e:this.spec.substring(0,t)+e}if(!this.isGeneric)throw"Cannot resolve uri against non-generic URI: "+this.spec;e.indexOf(":");if("/"==e.charAt(0))return this.scheme+"://"+this.authority+e;if("."==e.charAt(0)&&"/"==e.charAt(1)){if("/"==this.path.charAt(this.path.length-1))return this.scheme+"://"+this.authority+this.path+e.substring(2);var n=this.path.lastIndexOf("/");return this.scheme+"://"+this.authority+this.path.substring(0,n)+e.substring(1)}if(a.test(e))return e;if("?"==e.charAt(0))return this.scheme+"://"+this.authority+this.path+e;if("/"==this.path.charAt(this.path.length-1))return this.scheme+"://"+this.authority+this.path+e;n=this.path.lastIndexOf("/");return this.scheme+"://"+this.authority+this.path.substring(0,n+1)+e},n.relativeTo=function(e){if(e.scheme!=this.scheme)return this.spec;if(!this.isGeneric)throw"A non generic URI cannot be made relative: "+this.spec;if(!e.isGeneric)throw"Cannot make a relative URI against a non-generic URI: "+e.spec;if(e.authority!=this.authority)return this.spec;for(var t=0;t<this.segments.length&&t<e.segments.length;t++)if(this.segments[t]!=e.segments[t]){for(var n="/"==e.path.charAt(e.path.length-1)?0:-1,r="",i=t;i<e.segments.length+n;i++)r+="../";for(i=t;i<this.segments.length;i++)r+=this.segments[i],i+1<this.segments.length&&(r+="/");return"/"==this.path.charAt(this.path.length-1)&&(r+="/"),r}if(this.segments.length==e.segments.length)return this.hash?this.hash:this.query?this.query:"";if(t<this.segments.length){for(r="",i=t;i<this.segments.length;i++)r+=this.segments[i],i+1<this.segments.length&&(r+="/");return"/"==this.path.charAt(this.path.length-1)&&(r+="/"),r}throw"Cannot calculate a relative URI for "+this.spec+" against "+e.spec},n}},{key:"parseGeneric",value:function(e){if("/"!=e.schemeSpecificPart.charAt(0)||"/"!=e.schemeSpecificPart.charAt(1))throw"Generic URI values should start with '//':"+e.spec;var t=e.schemeSpecificPart.substring(2),n=t.indexOf("/");e.authority=n<0?t:t.substring(0,n),e.path=n<0?"":t.substring(n);var r=e.path.indexOf("#");r>=0&&(e.fragment=e.path.substring(r+1),e.path=e.path.substring(0,r));var i=e.path.indexOf("?");if(i>=0&&(e.query=e.path.substring(i+1),e.path=e.path.substring(0,i)),"/"==e.path||""==e.path)e.segments=[];else{e.segments=e.path.split(/\//),e.segments.length>0&&""==e.segments[0]&&e.path.length>1&&"/"!=e.path.charAt(1)&&e.segments.shift(),e.segments.length>0&&e.path.length>0&&"/"==e.path.charAt(e.path.length-1)&&""==e.segments[e.segments.length-1]&&e.path.length>1&&"/"!=e.path.charAt(e.path.length-2)&&e.segments.pop();for(var a=0;a<e.segments.length;a++)for(var o=e.segments[a].split(/%[A-Za-z0-9][A-Za-z0-9]|[\ud800-\udfff][\ud800-\udfff]|[A-Za-z0-9\-\._~!$&'()*+,;=@:\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/),s=0;s<o.length;s++)if(o[s].length>0)throw"Unecaped character "+o[s].charAt(0)+" ("+o[s].charCodeAt(0)+") in URI "+e.spec}e.isGeneric=!0}}]),e}();e.exports=o},function(e,t){e.exports=function(e,t){var n=(new DOMParser).parseFromString(e,"text/html");return n.URL=t,n.documentURI=t,n}},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.Catalog=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.Dataset=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,[{key:"addEntity",value:function(e){this.contents=e}},{key:"getContents",value:function(){return this.contents}}]),e}();t.SingleThingViewResult=a},function(e,t,n){"use strict";n.r(t),n.d(t,"Headers",(function(){return d})),n.d(t,"Request",(function(){return _})),n.d(t,"Response",(function(){return T})),n.d(t,"DOMException",(function(){return k})),n.d(t,"fetch",(function(){return M}));var r="URLSearchParams"in self,i="Symbol"in self&&"iterator"in Symbol,a="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in self,s="ArrayBuffer"in self;if(s)var u=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],c=ArrayBuffer.isView||function(e){return e&&u.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!==typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function h(e){return"string"!==typeof e&&(e=String(e)),e}function f(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function p(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function v(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function y(e){var t=new FileReader,n=v(t);return t.readAsArrayBuffer(e),n}function g(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var t;this._bodyInit=e,e?"string"===typeof e?this._bodyText=e:a&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:r&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():s&&a&&((t=e)&&DataView.prototype.isPrototypeOf(t))?(this._bodyArrayBuffer=g(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):s&&(ArrayBuffer.prototype.isPrototypeOf(e)||c(e))?this._bodyArrayBuffer=g(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"===typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):r&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},a&&(this.blob=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?p(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(y)}),this.text=function(){var e=p(this);if(e)return e;if(this._bodyBlob)return function(e){var t=new FileReader,n=v(t);return t.readAsText(e),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),r=0;r<t.length;r++)n[r]=String.fromCharCode(t[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}d.prototype.append=function(e,t){e=l(e),t=h(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},d.prototype.delete=function(e){delete this.map[l(e)]},d.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},d.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},d.prototype.set=function(e,t){this.map[l(e)]=h(t)},d.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},d.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),f(e)},d.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),f(e)},d.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),f(e)},i&&(d.prototype[Symbol.iterator]=d.prototype.entries);var b=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function _(e,t){var n=(t=t||{}).body;if(e instanceof _){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new d(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new d(t.headers)),this.method=function(e){var t=e.toUpperCase();return b.indexOf(t)>-1?t:e}(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function w(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(r),decodeURIComponent(i))}})),t}function x(e){var t=new d;return e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();t.append(r,i)}})),t}function T(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new d(t.headers),this.url=t.url||"",this._initBody(e)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})},m.call(_.prototype),m.call(T.prototype),T.prototype.clone=function(){return new T(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},T.error=function(){var e=new T(null,{status:0,statusText:""});return e.type="error",e};var S=[301,302,303,307,308];T.redirect=function(e,t){if(-1===S.indexOf(t))throw new RangeError("Invalid status code");return new T(null,{status:t,headers:{location:e}})};var k=self.DOMException;try{new k}catch(P){(k=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack}).prototype=Object.create(Error.prototype),k.prototype.constructor=k}function M(e,t){return new Promise((function(n,r){var i=new _(e,t);if(i.signal&&i.signal.aborted)return r(new k("Aborted","AbortError"));var o=new XMLHttpRequest;function s(){o.abort()}o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:x(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;n(new T(t,e))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.onabort=function(){r(new k("Aborted","AbortError"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&a&&(o.responseType="blob"),i.headers.forEach((function(e,t){o.setRequestHeader(t,e)})),i.signal&&(i.signal.addEventListener("abort",s),o.onreadystatechange=function(){4===o.readyState&&i.signal.removeEventListener("abort",s)}),o.send("undefined"===typeof i._bodyInit?null:i._bodyInit)}))}M.polyfill=!0,self.fetch||(self.fetch=M,self.Headers=d,self.Request=_,self.Response=T)},function(e,t,n){var r=n(103);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(79),o=n(76),s=n(77),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=n(131),l=u(n(86)),h=u(n(156)),f=u(n(402)),d=n(157),p=u(n(403)),v=function(){function e(t,n,r){o(this,e),this.pages={};n.accessUrl;var i=n.travelMode;this.source=n,this.fetcher=t(i),this.templateFetcher=r}return s(e,[{key:"addConnectionSource",value:function(e){throw new Error("Method not implemented.")}},{key:"getSources",value:function(){return[this.source]}},{key:"getByUrl",value:function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pages[t]||(this.pages[t]=this.fetcher.get(t)),e.next=3,this.pages[t];case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getByTime",value:function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdForTime(t,n);case 2:return r=e.sent,e.abrupt("return",this.getByUrl(r));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getIdForTime",value:function(){var e=a(i.mark((function e(t,n){var r;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTemplate();case 2:if(r=e.sent,!n){e.next=7;break}return e.abrupt("return",r.fill({"http://www.opengis.net/ont/geosparql#hasGeometry":n.id,"http://semweb.mmlab.be/ns/linkedconnections#departureTimeQuery":t.toISOString()}));case 7:return e.abrupt("return",r.fill({"http://semweb.mmlab.be/ns/linkedconnections#departureTimeQuery":t.toISOString()}));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"prefetchConnections",value:function(e,t){this.createIterator({upperBoundDate:t,lowerBoundDate:e,region:null}).then((function(e){e.on("readable",(function(){for(;e.read(););}))}))}},{key:"appendIterator",value:function(){var e=a(i.mark((function e(t,n){var a,o,s,u,v,y,g,m,b,_,w,x,T,S,k,M,P,I,j;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.default.getInstance().emit(c.EventType.ConnectionIteratorView,{lowerBound:t.lowerBoundDate,upperBound:t.upperBoundDate}),a=t.backward?d.backwardsConnectionsSelector:d.forwardsConnectionSelector,!t.backward){e.next=10;break}return s=t.upperBoundDate,e.next=6,this.getIdForTime(s,t.region);case 6:u=e.sent,o=new f.default(this,t,u),e.next=15;break;case 10:return v=t.lowerBoundDate,e.next=13,this.getIdForTime(v,t.region);case 13:y=e.sent,o=new p.default(this,t,y);case 15:g=n.listeners("data"),m=n.listeners("readable"),b=n.listeners("end"),n.removeAllListeners(),_=new h.default([o,n],a,!0),w=r(g);try{for(w.s();!(x=w.n()).done;)T=x.value,_.addListener("data",T)}catch(i){w.e(i)}finally{w.f()}S=r(m);try{for(S.s();!(k=S.n()).done;)M=k.value,_.addListener("readable",M)}catch(i){S.e(i)}finally{S.f()}P=r(b);try{for(P.s();!(I=P.n()).done;)j=I.value,_.addListener("end",j)}catch(i){P.e(i)}finally{P.f()}return e.abrupt("return",_);case 27:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createIterator",value:function(){var e=a(i.mark((function e(t){var n,r,a,o,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l.default.getInstance().emit(c.EventType.ConnectionIteratorView,{lowerBound:t.lowerBoundDate,upperBound:t.upperBoundDate}),!t.backward){e.next=9;break}return r=t.upperBoundDate,e.next=5,this.getIdForTime(r,t.region);case 5:a=e.sent,n=new f.default(this,t,a),e.next=14;break;case 9:return o=t.lowerBoundDate,e.next=12,this.getIdForTime(o,t.region);case 12:s=e.sent,n=new p.default(this,t,s);case 14:return e.abrupt("return",n.on("end",(function(){l.default.getInstance().emit(c.EventType.ConnectionIteratorView,{lowerBound:t.lowerBoundDate,upperBound:t.upperBoundDate,finished:!0})})));case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTemplate",value:function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.template||(this.template=this.templateFetcher.get(this.source.accessUrl)),e.abrupt("return",this.template);case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();t.default=v},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(83),u=n(84);Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){u(n,e);var t=s(n);function n(e,r,i){var o;return a(this,n),(o=t.call(this)).connectionsProvider=e,o.options=r,o.waiting=!1,o.fetchPage(i),o}return o(n,[{key:"fetchPage",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.waiting){e.next=11;break}return this.readable=!1,this.waiting=!0,this.currentPage=null,e.next=6,this.connectionsProvider.getByUrl(t);case 6:this.currentPage=e.sent,this.waiting=!1,this.currentIndex=this.currentPage.getConnections().length-1,this.readable=!0,this.currentPage.getPreviousPageId()&&this.connectionsProvider.getByUrl(this.currentPage.getPreviousPageId());case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(){if(!this.closed)if(this.waiting)this.readable=!1;else{if(!(this.currentIndex<0)){var e=this.currentPage.getConnections()[this.currentIndex];return this.currentIndex-=1,this.options.lowerBoundDate&&e.departureTime<this.options.lowerBoundDate&&this.close(),e}this.fetchPage(this.currentPage.getPreviousPageId())}}}]),n}(n(89).AsyncIterator);t.default=c},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(83),u=n(84);Object.defineProperty(t,"__esModule",{value:!0});var c=function(e){u(n,e);var t=s(n);function n(e,r,i){var o;return a(this,n),(o=t.call(this)).count=0,o.connectionsProvider=e,o.options=r,o.waiting=!1,o.fetchPage(i),o}return o(n,[{key:"fetchPage",value:function(){var e=i(r.mark((function e(t){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.waiting){e.next=12;break}return this.readable=!1,this.waiting=!0,this.currentPage=null,e.next=6,this.connectionsProvider.getByUrl(t);case 6:this.currentPage=e.sent,this.count+=1,this.waiting=!1,this.currentIndex=0,this.readable=!0,this.currentPage.getNextPageId()&&this.connectionsProvider.getByUrl(this.currentPage.getNextPageId());case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"read",value:function(){if(!this.closed)if(this.waiting)this.readable=!1;else{if(this.count>25)return this.close(),null;if(!(this.currentIndex>=this.currentPage.getConnections().length)){var e=this.currentPage.getConnections()[this.currentIndex];return this.currentIndex+=1,this.options.upperBoundDate&&e.departureTime>this.options.upperBoundDate&&this.close(),e}this.fetchPage(this.currentPage.getNextPageId())}}}]),n}(n(89).AsyncIterator);t.default=c},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84);Object.defineProperty(t,"__esModule",{value:!0});var s=n(405),u=function(e){o(n,e);var t=a(n);function n(){return r(this,n),t.apply(this,arguments)}return i(n,[{key:"createResultObject",value:function(){return new s.IndexThingViewResult}}]),n}(n(155).ThingView);t.IndexThingView=u},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e),this.contents={}}return i(e,[{key:"addEntity",value:function(e){this.contents[e.id]=e}},{key:"getContents",value:function(){return this.contents}}]),e}();t.IndexThingViewResult=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.HydraTemplateMapping=a},function(e,t,n){"use strict";var r=n(82),i=n(76),a=n(77);Object.defineProperty(t,"__esModule",{value:!0});var o=n(408),s=function(){function e(t){i(this,e),this.id=t}return a(e,[{key:"fill",value:function(e){var t,n=o(this.template),i={},a=r(this.mappings);try{for(a.s();!(t=a.n()).done;){var s=t.value;e[s.property]&&(i[s.variable]=e[s.property])}}catch(u){a.e(u)}finally{a.f()}return n.fill(i)}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.HydraTemplate=s},function(e,t,n){var r,i,a;i=[],void 0===(a="function"===typeof(r=function(){var e={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"&":!0},t={"*":!0};function n(e){return encodeURI(e).replace(/%25[0-9][0-9]/g,(function(e){return"%"+e.substring(3)}))}function r(e){return e=e.replace(/%../g,""),encodeURIComponent(e)===e}function i(i){var a="";e[i.charAt(0)]&&(a=i.charAt(0),i=i.substring(1));var o="",s="",u=!0,c=!1,l=!1;"+"==a?u=!1:"."==a?(s=".",o="."):"/"==a?(s="/",o="/"):"#"==a?(s="#",u=!1):";"==a?(s=";",o=";",c=!0,l=!0):"?"==a?(s="?",o="&",c=!0):"&"==a&&(s="&",o="&",c=!0);for(var h=[],f=i.split(","),d=[],p={},v=0;v<f.length;v++){var y=f[v],g=null;if(-1!=y.indexOf(":")){var m=y.split(":");y=m[0],g=parseInt(m[1])}for(var b={};t[y.charAt(y.length-1)];)b[y.charAt(y.length-1)]=!0,y=y.substring(0,y.length-1);var _={truncate:g,name:y,suffices:b};d.push(_),p[y]=_,h.push(y)}return{varNames:h,prefix:s,substitution:function(e){for(var t="",r=0,i=0;i<d.length;i++){var a=d[i],h=e(a.name);if(null==h||Array.isArray(h)&&0==h.length||"object"==typeof h&&0==Object.keys(h).length)r++;else if(t+=i==r?s:o||",",Array.isArray(h)){c&&(t+=a.name+"=");for(var f=0;f<h.length;f++)f>0&&(t+=a.suffices["*"]&&o||",",a.suffices["*"]&&c&&(t+=a.name+"=")),t+=u?encodeURIComponent(h[f]).replace(/!/g,"%21"):n(h[f])}else if("object"==typeof h){c&&!a.suffices["*"]&&(t+=a.name+"=");var p=!0;for(var v in h)p||(t+=a.suffices["*"]&&o||","),p=!1,t+=u?encodeURIComponent(v).replace(/!/g,"%21"):n(v),t+=a.suffices["*"]?"=":",",t+=u?encodeURIComponent(h[v]).replace(/!/g,"%21"):n(h[v])}else c&&(t+=a.name,l&&""==h||(t+="=")),null!=a.truncate&&(h=h.substring(0,a.truncate)),t+=u?encodeURIComponent(h).replace(/!/g,"%21"):n(h)}return t},unSubstitution:function(e,t,n){if(s&&(e=e.substring(s.length)),1==d.length&&d[0].suffices["*"]){for(var i=(T=d[0]).name,a=T.suffices["*"]?e.split(o||","):[e],l=u&&-1!=e.indexOf("="),h=1;h<a.length;h++)e=a[h],l&&-1==e.indexOf("=")&&(a[h-1]+=(o||",")+e,a.splice(h,1),h--);for(h=0;h<a.length;h++)e=a[h],u&&-1!=e.indexOf("=")&&(l=!0),1==(m=e.split(",")).length?a[h]=m[0]:a[h]=m;if(c||l){for(var f=t[i]||{},v=0;v<a.length;v++){var y=e;if(!c||y){if("string"==typeof a[v]){var g=(e=a[v]).split("=",1)[0];if(e=e.substring(g.length+1),u){if(n&&!r(e))return;e=decodeURIComponent(e)}y=e}else{if(g=(e=a[v][0]).split("=",1)[0],e=e.substring(g.length+1),u){if(n&&!r(e))return;e=decodeURIComponent(e)}a[v][0]=e,y=a[v]}if(u){if(n&&!r(g))return;g=decodeURIComponent(g)}void 0!==f[g]?Array.isArray(f[g])?f[g].push(y):f[g]=[f[g],y]:f[g]=y}}1==Object.keys(f).length&&void 0!==f[i]?t[i]=f[i]:t[i]=f}else{if(u)for(v=0;v<a.length;v++){var m=a[v];if(Array.isArray(m))for(var b=0;b<m.length;b++){if(n&&!r(m[b]))return;m[b]=decodeURIComponent(m[b])}else{if(n&&!r(m))return;a[v]=decodeURIComponent(m)}}void 0!==t[i]?Array.isArray(t[i])?t[i]=t[i].concat(a):t[i]=[t[i]].concat(a):1!=a.length||T.suffices["*"]?t[i]=a:t[i]=a[0]}}else{a=1==d.length?[e]:e.split(o||",");var _={};for(h=0;h<a.length;h++){for(var w=0;w<d.length-1&&w<h&&!d[w].suffices["*"];w++);if(w!=h){for(var x=d.length-1;x>0&&d.length-x<a.length-h&&!d[x].suffices["*"];x--);d.length-x!=a.length-h?_[h]=w:_[h]=x}else _[h]=h}for(h=0;h<a.length;h++)if((e=a[h])||!c){if(m=e.split(","),l=!1,c){i=(e=m[0]).split("=",1)[0],e=e.substring(i.length+1),m[0]=e;var T=p[i]||d[0]}else i=(T=d[_[h]]).name;for(v=0;v<m.length;v++)if(u){if(n&&!r(m[v]))return;m[v]=decodeURIComponent(m[v])}(c||T.suffices["*"])&&void 0!==t[i]?Array.isArray(t[i])?t[i]=t[i].concat(m):t[i]=[t[i]].concat(m):1!=m.length||T.suffices["*"]?t[i]=m:t[i]=m[0]}}return 1}}}function a(e){if(!(this instanceof a))return new a(e);for(var t=e.split("{"),n=[t.shift()],r=[],o=[],s=[],u=[];t.length>0;){var c=t.shift(),l=c.split("}")[0],h=c.substring(l.length+1),f=i(l);o.push(f.substitution),s.push(f.unSubstitution),r.push(f.prefix),n.push(h),u=u.concat(f.varNames)}this.fill=function(e){if(e&&"function"!==typeof e){var t=e;e=function(e){return t[e]}}for(var r=n[0],i=0;i<o.length;i++)r+=(0,o[i])(e),r+=n[i+1];return r},this.fromUri=function(e,t){t=t||{};for(var i={},a=0;a<n.length;a++){var o=n[a];if(e.substring(0,o.length)!==o)return;if(e=e.substring(o.length),a>=n.length-1){if(""==e)break;return}var u=r[a];if(!u||e.substring(0,u.length)===u){for(var c=n[a+1],l=a;;){if(l==n.length-2){var h=e.substring(e.length-c.length);if(h!==c)return;var f=e.substring(0,e.length-c.length);e=h}else if(c){var d=e.indexOf(c);f=e.substring(0,d),e=e.substring(d)}else if(r[l+1])-1===(d=e.indexOf(r[l+1]))&&(d=e.length),f=e.substring(0,d),e=e.substring(d);else{if(n.length>l+2){l++,c=n[l+1];continue}f=e,e=""}break}if(!s[a](f,i,t.strict))return}}return i},this.varNames=u,this.template=e}return a.prototype={toString:function(){return this.template},fillFromObject:function(e){return this.fill(e)},test:function(e,t){return!!this.fromUri(e,t)}},a})?r.apply(t,i):r)||(e.exports=a)},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(103),o=n(132),s=n(83),u=n(84),c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){u(n,e);var t=s(n);function n(e){var i;return r(this,n),(i=t.call(this,e)).accessCache={},i.onewayCache={},i.speedCache={},i.priorityCache={},i.id=e,i}return i(n,[{key:"getID",value:function(){return this.id}},{key:"isOneWay",value:function(e){var t=this.getWayCharacteristic(e);if(void 0!==this.onewayCache[t])return this.onewayCache[t];var r=o(a(n.prototype),"isOneWay",this).call(this,e);return this.onewayCache[t]=r,r}},{key:"hasAccess",value:function(e){var t=this.getWayCharacteristic(e);if(void 0!==this.accessCache[t])return this.accessCache[t];var r=o(a(n.prototype),"hasAccess",this).call(this,e);return this.accessCache[t]=r,r}},{key:"getSpeed",value:function(e){var t=this.getWayCharacteristic(e);if(void 0!==this.speedCache[t])return this.speedCache[t];var r=o(a(n.prototype),"getSpeed",this).call(this,e);return this.speedCache[t]=r,r}},{key:"getMultiplier",value:function(e){var t=this.getWayCharacteristic(e);if(void 0!==this.priorityCache[t])return this.priorityCache[t];var r=o(a(n.prototype),"getMultiplier",this).call(this,e);return this.priorityCache[t]=r,r}},{key:"getWayCharacteristic",value:function(e){return e.reachable+Object.values(e.definedTags).join()}}],[{key:"create",value:function(e){return new n(e)}}]),n}(c(n(410)).default);t.default=l},function(e,t,n){"use strict";var r=n(82),i=n(76),a=n(77),o=n(83),s=n(84),u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=u(n(99)),l=function(e){s(n,e);var t=o(n);function n(e){var r;return i(this,n),(r=t.call(this)).id=e,r.accessRules=[],r.onewayRules=[],r.speedRules=[],r.priorityRules=[],r.obstacleRules=[],r.obstacleTimeRules=[],r.proximityRules=[],r.maxSpeed=10,r.usePublicTransport=!0,r}return a(n,[{key:"getID",value:function(){return this.id}},{key:"isOneWay",value:function(e){var t,n=r(this.onewayRules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0!==i.conclusion.isOneway){if(void 0===i.condition)return i.conclusion.isOneway;if(e.definedTags[i.condition.predicate]===i.condition.object)return i.conclusion.isOneway}}}catch(a){n.e(a)}finally{n.f()}}},{key:"hasAccess",value:function(e){var t,n=r(this.accessRules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0!==i.conclusion.hasAccess){if(void 0===i.condition)return i.conclusion.hasAccess;if(e.definedTags[i.condition.predicate]===i.condition.object)return i.conclusion.hasAccess}}}catch(a){n.e(a)}finally{n.f()}}},{key:"getDefaultSpeed",value:function(){return 5}},{key:"getMaxSpeed",value:function(){return this.maxSpeed||300}},{key:"getSpeed",value:function(e){var t,n=Math.min(e.maxSpeed||1/0,this.getMaxSpeed()),i=r(this.speedRules);try{for(i.s();!(t=i.n()).done;){var a=t.value;if(void 0!==a.conclusion.speed&&void 0!==a.condition)if(e.definedTags[a.condition.predicate]===a.condition.object){if("number"===typeof a.conclusion.speed)return Math.min(a.conclusion.speed,n)}else if("number"===typeof a.conclusion.speed)return Math.min(a.conclusion.speed,n)}}catch(o){i.e(o)}finally{i.f()}return Math.min(n,this.getDefaultSpeed())}},{key:"getDistance",value:function(e,t,n){return c.default.getDistanceBetweenLocations(e,t)}},{key:"getDuration",value:function(e,t,n){return 60*(this.getDistance(e,t,n)/1e3/this.getSpeed(n))*60*1e3}},{key:"getMultiplier",value:function(e){var t,n=r(this.priorityRules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0!==i.conclusion.priority){if(void 0===i.condition)return 1-(i.conclusion.priority-1);if(e.definedTags[i.condition.predicate]===i.condition.object)return 1-(i.conclusion.priority-1)}}}catch(a){n.e(a)}finally{n.f()}}},{key:"getCost",value:function(e,t,n){var r=this.getNodeWeight(t),i=this.getNodeWeight(e);return Math.max(r,i)*this.getMultiplier(n)*(this.getDuration(e,t,n)+this.getObstacleTime(t))}},{key:"getNodeWeight",value:function(e){var t=1,n=1;if(e.proximity){var i,a=r(this.proximityRules);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(void 0!==o.conclusion.priority&&void 0!==o.condition&&e.proximity[o.condition.object]){var s=o.conclusion.priority;t+=e.proximity[o.condition.object],n+=s*e.proximity[o.condition.object]}}}catch(u){a.e(u)}finally{a.f()}}return 1/(n*n/(t*t))}},{key:"isObstacle",value:function(e){if(!e.definedTags)return!1;var t,n=r(this.obstacleRules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0!==i.conclusion.isObstacle){if(void 0===i.condition)return i.conclusion.isObstacle;if(e.definedTags[i.condition.predicate]===i.condition.object)return i.conclusion.isObstacle}}}catch(a){n.e(a)}finally{n.f()}}},{key:"getObstacleTime",value:function(e){if(!e.definedTags)return 0;var t,n=r(this.obstacleTimeRules);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(void 0!==i.conclusion.obstacleTime){if(void 0===i.condition)return 1e3*i.conclusion.obstacleTime;var a=i.condition.predicate;if(e.definedTags[a]&&void 0===i.condition.object)return 1e3*i.conclusion.obstacleTime;if(e.definedTags[a]===i.condition.object&&void 0!==i.condition.object)return 1e3*i.conclusion.obstacleTime}}}catch(o){n.e(o)}finally{n.f()}return 0}}],[{key:"create",value:function(e){return new n(e)}}]),n}(u(n(411)).default);t.default=l},function(e,t,n){"use strict";var r=n(76);Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(){r(this,e)}},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,[{key:"getID",value:function(){return this.id}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,[{key:"getID",value:function(){return this.id}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,[{key:"getID",value:function(){return this.id}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,n){"use strict";var r,i=n(78),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(80),d=h(n(128)),p=h(n(81)),v=h(n(416)),y=function(){function e(t){o(this,e),this.ldFetch=t,this.loadStops()}return s(e,[{key:"addStopSource",value:function(e){throw new Error("Method not implemented.")}},{key:"getSources",value:function(){return[{accessUrl:this.accessUrl}]}},{key:"setAccessUrl",value:function(e){this.accessUrl=e}},{key:"prefetchStops",value:function(){this.ensureStopsLoaded()}},{key:"getStopById",value:function(){var e=a(i.mark((function e(t){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureStopsLoaded();case 2:return e.abrupt("return",this.stops[t]);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllStops",value:function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.ensureStopsLoaded();case 2:return e.abrupt("return",Object.values(this.stops));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"ensureStopsLoaded",value:function(){var e=a(i.mark((function e(){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadPromise||this.stops||this.loadStops(),!this.loadPromise){e.next=4;break}return e.next=4,this.loadPromise;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadStops",value:function(){var e=this;this.accessUrl&&(this.loadPromise=this.ldFetch.get(this.accessUrl).then((function(t){e.stops=e.parseTriples(t.triples),e.loadPromise=null})).catch((function(e){console.log(e)})))}},{key:"transformPredicate",value:function(e){return v.default.transformPredicate({"http://xmlns.com/foaf/0.1/name":"name","http://schema.org/name":"name","http://www.w3.org/2003/01/geo/wgs84_pos#lat":"latitude","http://www.w3.org/2003/01/geo/wgs84_pos#long":"longitude"},e)}},{key:"parseTriples",value:function(e){var t=this;return e.reduce((function(e,n){var r=n=t.transformPredicate(n),i=r.subject.value,a=r.predicate.value,o=r.object.value;return i in e||(e[i]={id:i}),e[i][a]="longitude"===a||"latitude"===a?parseFloat(o):o,e}),{})}}]),e}();y=u([f.injectable(),l(0,f.inject(p.default.LDFetch)),c("design:paramtypes",["function"===typeof(r="undefined"!==typeof d.default&&d.default)?r:Object])],y),t.default=y},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,null,[{key:"matchesTriple",value:function(e,t,n){return function(r){return(!e||r.subject.value===e)&&((!t||r.predicate.value===t)&&(!n||r.object.value===n))}}},{key:"transformPredicate",value:function(e,t){return t.predicate.value in e&&(t.predicate.value=e[t.predicate.value]),t}},{key:"transformObject",value:function(e,t){return t.object.value in e&&(t.object.value=e[t.object.value]),t}},{key:"logTripleTable",value:function(e){console.table(e.map((function(e){return{subject:e.subject.value,predicate:e.predicate.value,object:e.object.value}})))}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t,this.definedTags={},this.freeformTags=[],this.proximity={}}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.RoutableTileNode=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t,this.distances=[[]],this.definedTags={},this.freeformTags=[]}return i(e,[{key:"mergeDefinitions",value:function(t){var n=new e(this.id);Object.assign(n,this),Object.assign(n,t);var r=Object.assign({},this.definedTags,t.definedTags);return n.definedTags=r,!1!==this.reachable&&!1!==t.reachable||(n.reachable=!1),n.segments=[],n.segments=n.segments.concat(this.segments),n.segments=n.segments.concat(t.segments),n.distances=[],n.distances=n.distances.concat(this.distances),n.distances=n.distances.concat(t.distances),n.freeformTags=[],n.freeformTags=n.freeformTags.concat(this.freeformTags),n.freeformTags=n.freeformTags.concat(t.freeformTags),n}},{key:"getParts",value:function(){for(var e=[],t=0;t<this.segments.length;t++)for(var n=this.distances[t],r=this.segments[t],i=0;i<r.length-1;i++)e.push({from:r[i],to:r[i+1],distance:n[i]});return e}}],[{key:"create",value:function(t){return new e(t)}}]),e}();t.RoutableTileWay=a},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(90)),d=l(n(81)),p=function(e){o(n,e);var t=a(n);function n(e,i){return r(this,n),t.call(this,e,i)}return i(n,[{key:"getIdForTileCoords",value:function(e){return"https://hdelva.be/tiles/transit/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}}]),n}(l(n(98)).default);p=s([h.injectable(),c(0,h.inject(d.default.PathfinderProvider)),c(1,h.inject(d.default.RoutableTileFetcher)),u("design:paramtypes",[f.default,Object])],p),t.default=p},function(e,t,n){"use strict";var r=n(85),i=n(82),a=n(78),o=n(112),s=n(79),u=n(76),c=n(77),l=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},h=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(80),p=f(n(173)),v=f(n(148)),y=function(){function e(t){u(this,e),this.graph=t,this.useWeightedCost=!0}return c(e,[{key:"setUseWeightedCost",value:function(e){this.useWeightedCost=e}},{key:"setBreakPoint",value:function(e,t){this.graph.setBreakPoint(e,t)}},{key:"removeBreakPoint",value:function(e){this.graph.removeBreakPoint(e)}},{key:"start",value:function(){var e=s(a.mark((function e(t,n){var r;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.costs=o(Array(this.graph.getAdjacencyList().length)).fill(1/0),this.previousNodes=o(Array(this.graph.getAdjacencyList().length)).fill(void 0),r=this.graph.getNodeIndex(t),this.costs[r]=0,this.nextQueue=[{distance:0,duration:0,cost:0,position:r}],e.abrupt("return",this.continue(n));case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"continue",value:function(){var e=s(a.mark((function e(t){var n,o,s,u,c,l,h,f,d,v,y,g,m,b,_,w,x,T;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=new p.default(this.nextQueue,(function(e,t){return e.duration-t.duration})),this.nextQueue=[];case 2:if(!n.length){e.next=12;break}if(o=n.pop(),s=o.position,u=o.distance,c=o.duration,l=o.cost,!(c>this.getCost(s))){e.next=6;break}return e.abrupt("continue",2);case 6:if(!this.graph.getBreakPoint(s)){e.next=9;break}return e.next=9,this.graph.getBreakPoint(s)(this.graph.getLabel(s));case 9:if(l>t)this.nextQueue.push({duration:c,distance:u,cost:l,position:s});else{h=i(this.graph.getAdjacencyList()[s]);try{for(h.s();!(f=h.n()).done;)d=f.value,(v={distance:u+d.distance,duration:c+d.duration,cost:l+d.cost,position:d.node,previousPosition:s}).duration<this.getCost(v.position)&&(n.push(v),this.costs[v.position]=v.duration,this.previousNodes[v.position]=s,this.graph.getBreakPoint(v.position)&&this.graph.getBreakPoint(v.position)(this.graph.getLabel(v.position)))}catch(a){h.e(a)}finally{h.f()}}e.next=2;break;case 12:y={},g=i(this.costs.entries());try{for(g.s();!(m=g.n()).done;)b=r(m.value,2),_=b[0],w=b[1],x=this.graph.getLabel(_),T=this.graph.getLabel(this.previousNodes[_]),y[x]={duration:w,previousNode:T}}catch(a){g.e(a)}finally{g.f()}return e.abrupt("return",y);case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getCost",value:function(e){if(e>=this.costs.length){var t=this.graph.getAdjacencyList().length-this.costs.length;this.costs=this.costs.concat(o(Array(t)).fill(1/0)),this.previousNodes=this.previousNodes.concat(o(Array(t)).fill(void 0))}return this.costs[e]}}]),e}();y=l([d.injectable(),h("design:paramtypes",[v.default])],y),t.default=y},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=n(103),u=n(132),c=n(83),l=n(84);Object.defineProperty(t,"__esModule",{value:!0});var h=function(e){l(n,e);var t=c(n);function n(e,r){var i;return a(this,n),(i=t.call(this,r||{autoStart:!1})).sourceGetter=e,i}return o(n,[{key:"loadSource",value:function(){var e=i(r.mark((function e(){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.source){e.next=4;break}return e.next=3,this.sourceGetter();case 3:this.source=e.sent;case 4:return e.abrupt("return",this.source);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_read",value:function(e,t){var r=this;this.source?u(s(n.prototype),"_read",this).call(this,e,t):this.loadSource().then((function(i){u(s(n.prototype),"_read",r).call(r,e,t)})).catch((function(e){return r.emit("error",e)}))}}]),n}(n(89).TransformIterator);t.PromiseProxyIterator=h},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84);Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){o(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this,e,{maxBufferSize:1,autoStart:!1})).comparator=i,a.store=[],a}return i(n,[{key:"_filter",value:function(e){var t=this,n=!this.store.some((function(n){return t.comparator(e,n)}));return n&&this.store.push(e),n}}]),n}(n(89).SimpleTransformIterator);t.default=s},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84);Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){o(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this)).isLastResultIterator=!1,a.queryIterator=e,a.callback=i,a.queryIterator.once("end",(function(){a.isLastResultIterator=!0})),a.readable=!0,a}return i(n,[{key:"read",value:function(){var e=this;if(this.closed)return null;if(!this.currentResultIterator){var t=this.queryIterator.read();t?this.runQuery(t):(this.readable=!1,this.queryIterator.once("readable",(function(){e.readable=!0})))}if(this.currentResultIterator){var n=this.currentResultIterator.read();return n||(this.readable=!1),n}return null}},{key:"runQuery",value:function(e){var t=this;this.currentResultIterator=this.callback(e),this.readable=this.currentResultIterator.readable,this.currentResultIterator.on("readable",(function(){t.readable=!0})),this.currentResultIterator.on("end",(function(){t.isLastResultIterator&&t.close(),t.currentResultIterator=null,t.readable=!0}))}}]),n}(n(89).AsyncIterator);t.default=s},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84);Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){o(n,e);var t=a(n);function n(e,i){var a;return r(this,n),(a=t.call(this)).baseQuery=e,a.timespan=i,a.readable=!0,a}return i(n,[{key:"read",value:function(){if(this.closed)return null;var e=this.baseQuery.minimumDepartureTime,t=new Date(e.getTime()+this.timespan);return this.timespan*=2,this.timespan>1728e5&&this.close(),Object.assign({},this.baseQuery,{maximumArrivalTime:t})}}]),n}(n(89).AsyncIterator);t.default=s},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(111)),d=l(n(263)),p=l(n(81)),v=function(){function e(t){a(this,e),this.stopsProvider=t,this.tileRegistry=f.default.getInstance()}return o(e,[{key:"resolve",value:function(){var e=i(r.mark((function e(t){var n,i,a;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=4;break}if(!this.isId(t)){e.next=3;break}return e.abrupt("return",this.resolveById(t));case 3:return e.abrupt("return",Promise.reject(new d.default('Location "'.concat(t,'" is a string, but not an ID'))));case 4:if(i="latitude"in(n=t)&&"longitude"in n,!("id"in n)){e.next=12;break}return e.next=10,this.resolveById(n.id);case 10:return a=e.sent,e.abrupt("return",Object.assign({},n,a));case 12:if(i){e.next=14;break}return e.abrupt("return",Promise.reject(new d.default('Location "'.concat(JSON.stringify(t),'" should have latitude and longitude'))));case 14:return"number"!==typeof n.latitude&&(n.latitude=parseFloat(n.latitude)),"number"!==typeof n.longitude&&(n.longitude=parseFloat(n.longitude)),e.abrupt("return",n);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resolveById",value:function(){var e=i(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.tileRegistry.getNode(t))){e.next=3;break}return e.abrupt("return",n);case 3:return e.next=5,this.stopsProvider.getStopById(t);case 5:if(!(i=e.sent)){e.next=8;break}return e.abrupt("return",i);case 8:return e.abrupt("return",Promise.reject(new d.default("No fetcher for id ".concat(t))));case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isId",value:function(e){return 0===e.indexOf("http://")||0===e.indexOf("https://")}}]),e}();v=s([h.injectable(),c(0,h.inject(p.default.StopsProvider)),u("design:paramtypes",[Object])],v),t.default=v},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(85),o=n(79),s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var u=n(427),c=n(280),l=s(n(437));function h(){return(h=o(r.mark((function e(t,n,a){var o,s,c,l,h,f,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=[],s=i(a.getNodes());try{for(s.s();!(c=s.n()).done;)l=c.value,(h=t[l.id])&&h.duration<n&&o.push([l.longitude,l.latitude])}catch(r){s.e(r)}finally{s.f()}return f=[],o.length>0&&(d=u(o,2),f=[[d.map((function(e){return{longitude:e[0],latitude:e[1]}}))]]),e.abrupt("return",{isochrones:f});case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return c.Delaunay.from(e,(function(e){return e.longitude}),(function(e){return e.latitude}))}function d(e,t,n){var r,a=new l.default(e.length),o=i(Array(e.length).keys());try{for(o.s();!(r=o.n()).done;){var s=r.value;if(t[s]){var u,c=n.neighbors(s),h=i(c);try{for(h.s();!(u=h.n()).done;){var f=u.value;t[f]&&a.union(s,f)}}catch(g){h.e(g)}finally{h.f()}}}}catch(g){o.e(g)}finally{o.f()}for(var d=a.getClusters(),p=0,v=Object.keys(d);p<v.length;p++){var y=v[p];t[y]||delete d[y]}return Object.values(d)}function p(e,t,n,r){var i=n[e.id],a=n[t.id];if(i===1/0&&a===1/0)return null;if(i===1/0)return t;if(a===1/0)return e;var o=Math.abs(i-r),s=Math.abs(a-r),u=1-o/(o+s),c=1-s/(o+s),l=u+c,h=(e.latitude*u+t.latitude*c)/l,f=(e.longitude*u+t.longitude*c)/l;return isNaN(h)||isNaN(f)?null:{latitude:h,longitude:f}}t.visualizeConcaveIsochrone=function(e,t,n){return h.apply(this,arguments)},t.visualizeIsochrone=function(e,t,n){for(var r=[],o={},s=0,u=Object.entries(t);s<u.length;s++){var c=a(u[s],2),l=c[0],h=c[1].duration,v=e.getNode(l);v&&h!==1/0&&(r.push(v),o[v.id]=h)}r.push({latitude:90,longitude:180,id:"1",definedTags:{},freeformTags:[],proximity:{}}),r.push({latitude:-90,longitude:180,id:"2",definedTags:{},freeformTags:[],proximity:{}}),r.push({latitude:90,longitude:-180,id:"3",definedTags:{},freeformTags:[],proximity:{}}),r.push({latitude:-90,longitude:-180,id:"4",definedTags:{},freeformTags:[],proximity:{}}),o[1]=1/0,o[2]=1/0,o[3]=1/0,o[4]=1/0;var y=f(r),g=r.map((function(e){return o[e.id]<n})),m=g.map((function(e){return!e})),b=d(r,g,y),_=d(r,m,y);return{isochrones:b.filter((function(e){return e.size>1})).map((function(e){return function(e,t,n,r,a,o){var s,u=[],c=i(a);try{for(c.s();!(s=c.n()).done;){var l,h=s.value,d=[],v=(new Set,i(Array(n.length).keys()));try{for(v.s();!(l=v.n()).done;){var y=l.value;if(!h.has(y)&&r.has(y)){var g,m=i(o.neighbors(y));try{for(m.s();!(g=m.n()).done;){var b=g.value;if(h.has(b)){var _=p(n[y],n[b],e,t);_&&d.push(_)}}}catch(S){m.e(S)}finally{m.f()}}}}catch(S){v.e(S)}finally{v.f()}if(d.length>0){for(var w=f(d).hull,x=[d[w.i]],T=w.next;T.i!==w.i;)x.push(d[T.i]),T=T.next;u.push(x)}}}catch(S){c.e(S)}finally{c.f()}return u.filter((function(e){return e.length>0})).sort((function(e,t){return t.length-e.length}))}(o,n,r,e,_,y)})).filter((function(e){return e.length>0}))}}},function(e,t,n){"use strict";var r=n(428),i=n(430),a=n(435),o=n(436),s=n(264)[3];function u(e,t,n){t=Math.max(0,void 0===t?2:t),n=n||0;for(var a,s=function(e){for(var t=e[0],n=e[0],r=e[0],a=e[0],s=0;s<e.length;s++){var u=e[s];u[0]<t[0]&&(t=u),u[0]>r[0]&&(r=u),u[1]<n[1]&&(n=u),u[1]>a[1]&&(a=u)}var c=[t,n,r,a],l=c.slice();for(s=0;s<e.length;s++)o(e[s],c)||l.push(e[s]);var h=i(l),f=[];for(s=0;s<h.length;s++)f.push(l[h[s]]);return f}(e),u=r(16,["[0]","[1]","[0]","[1]"]).load(e),l=[],h=0;h<s.length;h++){var f=s[h];u.remove(f),a=v(f,a),l.push(a)}var d=r(16);for(h=0;h<l.length;h++)d.insert(p(l[h]));for(var g=t*t,m=n*n;l.length;){var b=l.shift(),_=b.p,w=b.next.p,x=y(_,w);if(!(x<m)){var T=x/g;(f=c(u,b.prev.p,_,w,b.next.next.p,T,d))&&Math.min(y(f,_),y(f,w))<=T&&(l.push(b),l.push(v(f,b)),u.remove(f),d.remove(b),d.insert(p(b)),d.insert(p(b.next)))}}b=a;var S=[];do{S.push(b.p),b=b.next}while(b!==a);return S.push(b.p),S}function c(e,t,n,r,i,o,s){for(var u=new a(null,l),c=e.data;c;){for(var f=0;f<c.children.length;f++){var p=c.children[f],v=c.leaf?g(p,n,r):h(n,r,p);v>o||u.push({node:p,dist:v})}for(;u.length&&!u.peek().node.children;){var y=u.pop(),m=y.node,b=g(m,t,n),_=g(m,r,i);if(y.dist<b&&y.dist<_&&d(n,m,s)&&d(r,m,s))return m}(c=u.pop())&&(c=c.node)}return null}function l(e,t){return e.dist-t.dist}function h(e,t,n){if(f(e,n)||f(t,n))return 0;var r=m(e[0],e[1],t[0],t[1],n.minX,n.minY,n.maxX,n.minY);if(0===r)return 0;var i=m(e[0],e[1],t[0],t[1],n.minX,n.minY,n.minX,n.maxY);if(0===i)return 0;var a=m(e[0],e[1],t[0],t[1],n.maxX,n.minY,n.maxX,n.maxY);if(0===a)return 0;var o=m(e[0],e[1],t[0],t[1],n.minX,n.maxY,n.maxX,n.maxY);return 0===o?0:Math.min(r,i,a,o)}function f(e,t){return e[0]>=t.minX&&e[0]<=t.maxX&&e[1]>=t.minY&&e[1]<=t.maxY}function d(e,t,n){for(var r,i,a,o,u=Math.min(e[0],t[0]),c=Math.min(e[1],t[1]),l=Math.max(e[0],t[0]),h=Math.max(e[1],t[1]),f=n.search({minX:u,minY:c,maxX:l,maxY:h}),d=0;d<f.length;d++)if(r=f[d].p,i=f[d].next.p,a=e,r!==(o=t)&&i!==a&&s(r,i,a)>0!==s(r,i,o)>0&&s(a,o,r)>0!==s(a,o,i)>0)return!1;return!0}function p(e){var t=e.p,n=e.next.p;return e.minX=Math.min(t[0],n[0]),e.minY=Math.min(t[1],n[1]),e.maxX=Math.max(t[0],n[0]),e.maxY=Math.max(t[1],n[1]),e}function v(e,t){var n={p:e,prev:null,next:null,minX:0,minY:0,maxX:0,maxY:0};return t?(n.next=t.next,n.prev=t,t.next.prev=n,t.next=n):(n.prev=n,n.next=n),n}function y(e,t){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function g(e,t,n){var r=t[0],i=t[1],a=n[0]-r,o=n[1]-i;if(0!==a||0!==o){var s=((e[0]-r)*a+(e[1]-i)*o)/(a*a+o*o);s>1?(r=n[0],i=n[1]):s>0&&(r+=a*s,i+=o*s)}return(a=e[0]-r)*a+(o=e[1]-i)*o}function m(e,t,n,r,i,a,o,s){var u,c,l,h,f=n-e,d=r-t,p=o-i,v=s-a,y=e-i,g=t-a,m=f*f+d*d,b=f*p+d*v,_=p*p+v*v,w=f*y+d*g,x=p*y+v*g,T=m*_-b*b,S=T,k=T;0===T?(c=0,S=1,h=x,k=_):(h=m*x-b*w,(c=b*x-_*w)<0?(c=0,h=x,k=_):c>S&&(c=S,h=x+b,k=_)),h<0?(h=0,-w<0?c=0:-w>m?c=S:(c=-w,S=m)):h>k&&(h=k,-w+b<0?c=0:-w+b>m?c=S:(c=-w+b,S=m));var M=(1-(l=0===h?0:h/k))*i+l*o-((1-(u=0===c?0:c/S))*e+u*n),P=(1-l)*a+l*s-((1-u)*t+u*r);return M*M+P*P}e.exports=u,e.exports.default=u},function(e,t,n){"use strict";e.exports=i,e.exports.default=i;var r=n(429);function i(e,t){if(!(this instanceof i))return new i(e,t);this._maxEntries=Math.max(4,e||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),t&&this._initFormat(t),this.clear()}function a(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function o(e,t){s(e,0,e.children.length,t,e)}function s(e,t,n,r,i){i||(i=y(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a,o=t;o<n;o++)a=e.children[o],u(i,e.leaf?r(a):a);return i}function u(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function c(e,t){return e.minX-t.minX}function l(e,t){return e.minY-t.minY}function h(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function f(e){return e.maxX-e.minX+(e.maxY-e.minY)}function d(e,t){var n=Math.max(e.minX,t.minX),r=Math.max(e.minY,t.minY),i=Math.min(e.maxX,t.maxX),a=Math.min(e.maxY,t.maxY);return Math.max(0,i-n)*Math.max(0,a-r)}function p(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function v(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function y(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function g(e,t,n,i,a){for(var o,s=[t,n];s.length;)(n=s.pop())-(t=s.pop())<=i||(o=t+Math.ceil((n-t)/i/2)*i,r(e,o,t,n,a),s.push(t,o,o,n))}i.prototype={all:function(){return this._all(this.data,[])},search:function(e){var t=this.data,n=[],r=this.toBBox;if(!v(e,t))return n;for(var i,a,o,s,u=[];t;){for(i=0,a=t.children.length;i<a;i++)o=t.children[i],v(e,s=t.leaf?r(o):o)&&(t.leaf?n.push(o):p(e,s)?this._all(o,n):u.push(o));t=u.pop()}return n},collides:function(e){var t=this.data,n=this.toBBox;if(!v(e,t))return!1;for(var r,i,a,o,s=[];t;){for(r=0,i=t.children.length;r<i;r++)if(a=t.children[r],v(e,o=t.leaf?n(a):a)){if(t.leaf||p(e,o))return!0;s.push(a)}t=s.pop()}return!1},load:function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0,n=e.length;t<n;t++)this.insert(e[t]);return this}var r=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===r.height)this._splitRoot(this.data,r);else{if(this.data.height<r.height){var i=this.data;this.data=r,r=i}this._insert(r,this.data.height-r.height-1,!0)}else this.data=r;return this},insert:function(e){return e&&this._insert(e,this.data.height-1),this},clear:function(){return this.data=y([]),this},remove:function(e,t){if(!e)return this;for(var n,r,i,o,s=this.data,u=this.toBBox(e),c=[],l=[];s||c.length;){if(s||(s=c.pop(),r=c[c.length-1],n=l.pop(),o=!0),s.leaf&&-1!==(i=a(e,s.children,t)))return s.children.splice(i,1),c.push(s),this._condense(c),this;o||s.leaf||!p(s,u)?r?(n++,s=r.children[n],o=!1):s=null:(c.push(s),l.push(n),n=0,r=s,s=s.children[0])}return this},toBBox:function(e){return e},compareMinX:c,compareMinY:l,toJSON:function(){return this.data},fromJSON:function(e){return this.data=e,this},_all:function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},_build:function(e,t,n,r){var i,a=n-t+1,s=this._maxEntries;if(a<=s)return o(i=y(e.slice(t,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(a)/Math.log(s)),s=Math.ceil(a/Math.pow(s,r-1))),(i=y([])).leaf=!1,i.height=r;var u,c,l,h,f=Math.ceil(a/s),d=f*Math.ceil(Math.sqrt(s));for(g(e,t,n,d,this.compareMinX),u=t;u<=n;u+=d)for(g(e,u,l=Math.min(u+d-1,n),f,this.compareMinY),c=u;c<=l;c+=f)h=Math.min(c+f-1,l),i.children.push(this._build(e,c,h,r-1));return o(i,this.toBBox),i},_chooseSubtree:function(e,t,n,r){for(var i,a,o,s,u,c,l,f,d,p;r.push(t),!t.leaf&&r.length-1!==n;){for(l=f=1/0,i=0,a=t.children.length;i<a;i++)u=h(o=t.children[i]),d=e,p=o,(c=(Math.max(p.maxX,d.maxX)-Math.min(p.minX,d.minX))*(Math.max(p.maxY,d.maxY)-Math.min(p.minY,d.minY))-u)<f?(f=c,l=u<l?u:l,s=o):c===f&&u<l&&(l=u,s=o);t=s||t.children[0]}return t},_insert:function(e,t,n){var r=this.toBBox,i=n?e:r(e),a=[],o=this._chooseSubtree(i,this.data,t,a);for(o.children.push(e),u(o,i);t>=0&&a[t].children.length>this._maxEntries;)this._split(a,t),t--;this._adjustParentBBoxes(i,a,t)},_split:function(e,t){var n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var a=this._chooseSplitIndex(n,i,r),s=y(n.children.splice(a,n.children.length-a));s.height=n.height,s.leaf=n.leaf,o(n,this.toBBox),o(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},_splitRoot:function(e,t){this.data=y([e,t]),this.data.height=e.height+1,this.data.leaf=!1,o(this.data,this.toBBox)},_chooseSplitIndex:function(e,t,n){var r,i,a,o,u,c,l,f;for(c=l=1/0,r=t;r<=n-t;r++)o=d(i=s(e,0,r,this.toBBox),a=s(e,r,n,this.toBBox)),u=h(i)+h(a),o<c?(c=o,f=r,l=u<l?u:l):o===c&&u<l&&(l=u,f=r);return f},_chooseSplitAxis:function(e,t,n){var r=e.leaf?this.compareMinX:c,i=e.leaf?this.compareMinY:l;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r)},_allDistMargin:function(e,t,n,r){e.children.sort(r);var i,a,o=this.toBBox,c=s(e,0,t,o),l=s(e,n-t,n,o),h=f(c)+f(l);for(i=t;i<n-t;i++)a=e.children[i],u(c,e.leaf?o(a):a),h+=f(c);for(i=n-t-1;i>=t;i--)a=e.children[i],u(l,e.leaf?o(a):a),h+=f(l);return h},_adjustParentBBoxes:function(e,t,n){for(var r=n;r>=0;r--)u(t[r],e)},_condense:function(e){for(var t,n=e.length-1;n>=0;n--)0===e[n].children.length?n>0?(t=e[n-1].children).splice(t.indexOf(e[n]),1):this.clear():o(e[n],this.toBBox)},_initFormat:function(e){var t=["return a"," - b",";"];this.compareMinX=new Function("a","b",t.join(e[0])),this.compareMinY=new Function("a","b",t.join(e[1])),this.toBBox=new Function("a","return {minX: a"+e[0]+", minY: a"+e[1]+", maxX: a"+e[2]+", maxY: a"+e[3]+"};")}}},function(e,t,n){e.exports=function(){"use strict";function e(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function t(e,t){return e<t?-1:e>t?1:0}return function(n,r,i,a,o){!function t(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1),f=Math.max(i,Math.floor(r-u*l/s+h)),d=Math.min(a,Math.floor(r+(s-u)*l/s+h));t(n,r,f,d,o)}var p=n[r],v=i,y=a;for(e(n,i,r),o(n[a],p)>0&&e(n,i,a);v<y;){for(e(n,v,y),v++,y--;o(n[v],p)<0;)v++;for(;o(n[y],p)>0;)y--}0===o(n[i],p)?e(n,i,y):(y++,e(n,y,a)),y<=r&&(i=y+1),r<=y&&(a=y-1)}}(n,r,i||0,a||n.length-1,o||t)}}()},function(e,t,n){"use strict";e.exports=function(e){var t=e.length;if(t<3){for(var n=new Array(t),i=0;i<t;++i)n[i]=i;return 2===t&&e[0][0]===e[1][0]&&e[0][1]===e[1][1]?[0]:n}var a=new Array(t);for(i=0;i<t;++i)a[i]=i;a.sort((function(t,n){var r=e[t][0]-e[n][0];return r||e[t][1]-e[n][1]}));var o=[a[0],a[1]],s=[a[0],a[1]];for(i=2;i<t;++i){for(var u=a[i],c=e[u],l=o.length;l>1&&r(e[o[l-2]],e[o[l-1]],c)<=0;)l-=1,o.pop();for(o.push(u),l=s.length;l>1&&r(e[s[l-2]],e[s[l-1]],c)>=0;)l-=1,s.pop();s.push(u)}n=new Array(s.length+o.length-2);for(var h=0,f=(i=0,o.length);i<f;++i)n[h++]=o[i];for(var d=s.length-2;d>0;--d)n[h++]=s[d];return n};var r=n(264)[3]},function(e,t,n){"use strict";e.exports=function(e,t){var n=0|e.length,r=0|t.length;if(1===n&&1===r)return function(e,t){var n=e+t,r=n-e,i=e-(n-r)+(t-r);if(i)return[i,n];return[n]}(e[0],t[0]);var i,a,o=new Array(n+r),s=0,u=0,c=0,l=Math.abs,h=e[u],f=l(h),d=t[c],p=l(d);f<p?(a=h,(u+=1)<n&&(h=e[u],f=l(h))):(a=d,(c+=1)<r&&(d=t[c],p=l(d)));u<n&&f<p||c>=r?(i=h,(u+=1)<n&&(h=e[u],f=l(h))):(i=d,(c+=1)<r&&(d=t[c],p=l(d)));var v,y,g=i+a,m=g-i,b=a-m,_=b,w=g;for(;u<n&&c<r;)f<p?(i=h,(u+=1)<n&&(h=e[u],f=l(h))):(i=d,(c+=1)<r&&(d=t[c],p=l(d))),(b=(a=_)-(m=(g=i+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v;for(;u<n;)(b=(a=_)-(m=(g=(i=h)+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v,(u+=1)<n&&(h=e[u]);for(;c<r;)(b=(a=_)-(m=(g=(i=d)+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v,(c+=1)<r&&(d=t[c]);_&&(o[s++]=_);w&&(o[s++]=w);s||(o[s++]=0);return o.length=s,o}},function(e,t,n){"use strict";var r=n(265),i=n(433);e.exports=function(e,t){var n=e.length;if(1===n){var a=r(e[0],t);return a[0]?a:[a[1]]}var o=new Array(2*n),s=[.1,.1],u=[.1,.1],c=0;r(e[0],t,s),s[0]&&(o[c++]=s[0]);for(var l=1;l<n;++l){r(e[l],t,u);var h=s[1];i(h,u[0],s),s[0]&&(o[c++]=s[0]);var f=u[1],d=s[1],p=f+d,v=d-(p-f);s[1]=p,v&&(o[c++]=v)}s[1]&&(o[c++]=s[1]);0===c&&(o[c++]=0);return o.length=c,o}},function(e,t,n){"use strict";e.exports=function(e,t,n){var r=e+t,i=r-e,a=t-i,o=e-(r-i);if(n)return n[0]=o+a,n[1]=r,n;return[o+a,r]}},function(e,t,n){"use strict";e.exports=function(e,t){var n=0|e.length,r=0|t.length;if(1===n&&1===r)return function(e,t){var n=e+t,r=n-e,i=e-(n-r)+(t-r);if(i)return[i,n];return[n]}(e[0],-t[0]);var i,a,o=new Array(n+r),s=0,u=0,c=0,l=Math.abs,h=e[u],f=l(h),d=-t[c],p=l(d);f<p?(a=h,(u+=1)<n&&(h=e[u],f=l(h))):(a=d,(c+=1)<r&&(d=-t[c],p=l(d)));u<n&&f<p||c>=r?(i=h,(u+=1)<n&&(h=e[u],f=l(h))):(i=d,(c+=1)<r&&(d=-t[c],p=l(d)));var v,y,g=i+a,m=g-i,b=a-m,_=b,w=g;for(;u<n&&c<r;)f<p?(i=h,(u+=1)<n&&(h=e[u],f=l(h))):(i=d,(c+=1)<r&&(d=-t[c],p=l(d))),(b=(a=_)-(m=(g=i+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v;for(;u<n;)(b=(a=_)-(m=(g=(i=h)+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v,(u+=1)<n&&(h=e[u]);for(;c<r;)(b=(a=_)-(m=(g=(i=d)+a)-i))&&(o[s++]=b),_=w-((v=w+g)-(y=v-w))+(g-y),w=v,(c+=1)<r&&(d=-t[c]);_&&(o[s++]=_);w&&(o[s++]=w);s||(o[s++]=0);return o.length=s,o}},function(e,t,n){"use strict";function r(e,t){if(!(this instanceof r))return new r(e,t);if(this.data=e||[],this.length=this.data.length,this.compare=t||i,this.length>0)for(var n=(this.length>>1)-1;n>=0;n--)this._down(n)}function i(e,t){return e<t?-1:e>t?1:0}e.exports=r,e.exports.default=r,r.prototype={push:function(e){this.data.push(e),this.length++,this._up(this.length-1)},pop:function(){if(0!==this.length){var e=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),e}},peek:function(){return this.data[0]},_up:function(e){for(var t=this.data,n=this.compare,r=t[e];e>0;){var i=e-1>>1,a=t[i];if(n(r,a)>=0)break;t[e]=a,e=i}t[e]=r},_down:function(e){for(var t=this.data,n=this.compare,r=this.length>>1,i=t[e];e<r;){var a=1+(e<<1),o=a+1,s=t[a];if(o<this.length&&n(t[o],s)<0&&(a=o,s=t[o]),n(s,i)>=0)break;t[e]=s,e=a}t[e]=i}}},function(e,t){e.exports=function(e,t){for(var n=e[0],r=e[1],i=!1,a=0,o=t.length-1;a<t.length;o=a++){var s=t[a][0],u=t[a][1],c=t[o][0],l=t[o][1];u>r!=l>r&&n<(c-s)*(r-u)/(l-u)+s&&(i=!i)}return i}},function(e,t,n){"use strict";var r=n(85),i=n(82),a=n(112),o=n(76),s=n(77);Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(t){o(this,e),this.connections=a(Array(t).keys()),this.ranks=a(Array(t).keys())}return s(e,[{key:"union",value:function(e,t){var n=this.find(e),r=this.find(t);if(n!==r){if(this.ranks[n]<this.ranks[r]){var i=[r,n];n=i[0],r=i[1]}this.connections[r]=n,this.ranks[n]===this.ranks[r]&&(this.ranks[n]+=1)}}},{key:"find",value:function(e){return this.connections[e]!==e&&(this.connections[e]=this.find(this.connections[e])),this.connections[e]}},{key:"getClusters",value:function(){var e,t={},n=i(this.connections.entries());try{for(n.s();!(e=n.n()).done;){var a=r(e.value,2),o=a[0];o===a[1]&&(t[o]=new Set)}}catch(l){n.e(l)}finally{n.f()}var s,u=i(this.connections.keys());try{for(u.s();!(s=u.n()).done;){var c=s.value;t[this.find(c)].add(c)}}catch(l){u.e(l)}finally{u.f()}return t}}]),e}();t.default=u},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(204)),d=r(n(119)),p=r(n(109)),v=r(n(120)),y=r(n(106)),g=r(n(137)),m=r(n(121)),b=r(n(122)),_=r(n(98)),w=r(n(205)),x=n(94),T=r(n(123)),S=r(n(176)),k=r(n(90)),M=r(n(145)),P=r(n(124)),I=r(n(133)),j=r(n(134)),O=r(n(201)),R=r(n(125)),N=r(n(177)),C=r(n(81)),A=new i.Container;A.bind(C.default.Context).to(a.default).inSingletonScope(),A.bind(C.default.QueryRunner).to(N.default),A.bind(C.default.LocationResolver).to(R.default),A.bind(C.default.HydraTemplateFetcher).to(d.default).inSingletonScope(),A.bind(C.default.JourneyExtractor).to(P.default),A.bind(C.default.PublicTransportPlanner).to(M.default),A.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),A.bind(C.default.RoadPlanner).to(I.default),A.bind(C.default.ShortestPathTreeAlgorithm).to(T.default).inSingletonScope(),A.bind(C.default.ShortestPathAlgorithm).to(S.default).inSingletonScope(),A.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),A.bind(C.default.ProfileFetcher).to(v.default).inSingletonScope(),A.bind(C.default.ProfileProvider).to(y.default).inSingletonScope(),A.bind(C.default.FootpathsProvider).to(f.default).inSingletonScope(),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Initial),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Transfer),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Final),A.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),A.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),A.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),A.bind(C.default.ConnectionsFetcher).to(l.default),A.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),A.bind(C.default.StopsProvider).to(m.default).inSingletonScope(),A.bind(C.default.StopsFetcher).to(g.default),A.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),A.bind(C.default.RoutableTileFetcher).to(b.default).inSingletonScope(),A.bind(C.default.RoutableTileProvider).to(_.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),A.bind(C.default.RoutableTileProvider).to(w.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),A.bind(C.default.LDFetch).to(p.default).inSingletonScope(),A.bind(C.default.LDLoader).to(x.LDLoader),t.default=A},function(e,t,n){"use strict";var r=n(78),i=n(85),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(99)),d=n(271),p=n(256),v=l(n(148)),y=function(){function e(t,n){o(this,e),this.bidir=new d.BidirDijkstraInstance(t),this.classic=new p.DijkstraInstance(t),this.locationResolver=n}return s(e,[{key:"setUseWeightedCost",value:function(e){this.bidir.setUseWeightedCost(e),this.classic.setUseWeightedCost(e)}},{key:"setBreakPoint",value:function(e,t){this.bidir.setBreakPoint(e,t),this.classic.setBreakPoint(e,t)}},{key:"removeBreakPoint",value:function(e){this.bidir.removeBreakPoint(e),this.classic.removeBreakPoint(e)}},{key:"queryPath",value:function(){var e=a(r.mark((function e(t,n){var a,o,s,u,c,l,h=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=h.length>2&&void 0!==h[2]?h[2]:1/0,o=[this.locationResolver.resolve(t),this.locationResolver.resolve(n)],e.next=4,Promise.all(o);case 4:if(s=e.sent,u=i(s,2),c=u[0],l=u[1],!(f.default.getDistanceBetweenLocations(c,l)<1e3)){e.next=13;break}return e.abrupt("return",this.classic.queryPath(t,n,a));case 13:return e.abrupt("return",this.bidir.queryPath(t,n,a));case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();y=u([h.injectable(),c("design:paramtypes",[v.default,Object])],y),t.MixedDijkstraInstance=y},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(119)),d=r(n(109)),p=r(n(120)),v=r(n(106)),y=r(n(137)),g=r(n(121)),m=r(n(122)),b=r(n(98)),_=r(n(206)),w=r(n(207)),x=n(94),T=n(208),S=r(n(123)),k=r(n(90)),M=r(n(443)),P=r(n(124)),I=r(n(133)),j=r(n(209)),O=r(n(134)),R=r(n(160)),N=r(n(125)),C=r(n(81)),A=new i.Container;A.bind(C.default.Context).to(a.default).inSingletonScope(),A.bind(C.default.QueryRunner).to(R.default),A.bind(C.default.LocationResolver).to(N.default),A.bind(C.default.JourneyExtractor).to(P.default),A.bind(C.default.PublicTransportPlanner).to(M.default),A.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),A.bind(C.default.RoadPlanner).to(I.default),A.bind(C.default.HydraTemplateFetcher).to(f.default).inSingletonScope(),A.bind(C.default.HypermediaTreeFetcher).to(_.default).inSingletonScope(),A.bind(C.default.HypermediaTreeProvider).to(w.default).inSingletonScope(),A.bind(C.default.ShortestPathTreeAlgorithm).to(S.default).inSingletonScope(),A.bind(C.default.ShortestPathAlgorithm).to(T.BidirDijkstra).inSingletonScope(),A.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),A.bind(C.default.ProfileFetcher).to(p.default).inSingletonScope(),A.bind(C.default.ProfileProvider).to(v.default).inSingletonScope(),A.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),A.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Initial),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Transfer),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Final),A.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),A.bind(C.default.ConnectionsFetcher).to(l.default),A.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),A.bind(C.default.StopsProvider).to(g.default).inSingletonScope(),A.bind(C.default.StopsFetcher).to(y.default),A.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),A.bind(C.default.RoutableTileFetcher).to(m.default).inSingletonScope(),A.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),A.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),A.bind(C.default.LDFetch).to(d.default).inSingletonScope(),A.bind(C.default.LDLoader).to(x.LDLoader),t.default=A},function(e,t,n){"use strict";var r,i=n(76),a=n(77);Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.GEOSPATIALLYC_CONTAINS="https://w3id.org/tree#GeospatiallyContainsRelation"}(r||(r={}));var o=function(){function e(t){i(this,e),this.id=t}return a(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=o},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){r(this,e),this.id=t}return i(e,null,[{key:"create",value:function(t){return new e(t)}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(89),d=n(80),p=h(n(158)),v=h(n(174)),y=h(n(175)),g=h(n(100)),m=h(n(101)),b=h(n(86)),_=h(n(87)),w=n(157),x=h(n(81)),T=h(n(99)),S=h(n(156)),k=h(n(444)),M=h(n(445)),P=h(n(446)),I=h(n(199)),j=h(n(258)),O=function(){function e(t,n,r,i,a,s){o(this,e),this.connectionsProvider=t,this.locationResolver=n,this.initialReachableStopsFinder=r,this.transferReachableStopsFinder=i,this.finalReachableStopsFinder=a,this.journeyExtractor=s,this.eventBus=b.default.getInstance()}return s(e,[{key:"plan",value:function(){var e=a(i.mark((function e(t){var n,r,a,o,s,u,c,l,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.minimumDepartureTime,r=t.maximumArrivalTime,a=new I.default(!0),e.next=4,this.connectionsProvider.createIterator({backward:!0,upperBoundDate:r,lowerBoundDate:n,excludedModes:t.excludedTravelModes,region:null});case 4:return o=e.sent,s=new S.default([o,a],w.backwardsConnectionsSelector,!0),u={query:t,profilesByStop:{},earliestArrivalByTrip:{},durationToTargetByStop:{},gtfsTripByConnection:{},initialReachableStops:[],footpathQueue:a,connectionsIterator:s},e.next=9,this.initDurationToTargetByStop(u);case 9:return c=e.sent,e.next=12,this.initInitialReachableStops(u);case 12:if(l=e.sent,c&&l){e.next=15;break}return e.abrupt("return",Promise.resolve(new f.ArrayIterator([])));case 15:return h=this,e.abrupt("return",new Promise((function(e,t){var n=!1,r=function(){n||(u.connectionsIterator.close(),h.journeyExtractor.extractJourneys(u.profilesByStop,u.query).then((function(t){e(t)})),n=!0)};u.connectionsIterator.on("readable",(function(){return h.processNextConnection(u,r)})),o.on("end",(function(){return r()})),h.processNextConnection(u,r)})));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"processNextConnection",value:function(){var e=a(i.mark((function e(t,n){var r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t.connectionsIterator.read();case 1:if(!r){e.next=22;break}if(!(r.departureTime<t.query.minimumDepartureTime)){e.next=6;break}return t.connectionsIterator.close(),n(),e.abrupt("break",22);case 6:if(!(r.arrivalTime>t.query.maximumArrivalTime)||t.connectionsIterator.closed){e.next=9;break}return r=t.connectionsIterator.read(),e.abrupt("continue",1);case 9:if(this.eventBus&&this.eventBus.emit(_.default.ConnectionScan,r),this.discoverConnection(t,r),a=this.calculateEarliestArrivalTime(t,r),this.updateEarliestArrivalByTrip(t,r,a),this.isDominated(t,r,a)||!this.hasValidRoute(t,a,r.departureTime.getTime())){e.next=16;break}return e.next=16,this.getFootpathsForDepartureStop(t,r,a);case 16:if(t.connectionsIterator.closed){e.next=19;break}return r=t.connectionsIterator.read(),e.abrupt("continue",1);case 19:r=void 0,e.next=1;break;case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"hasValidRoute",value:function(e,t,n){if(!e.query.maximumTravelDuration)return!0;var i,a=r(t);try{for(a.s();!(i=a.n()).done;){if(i.value.arrivalTime-n<=e.query.maximumTravelDuration)return!0}}catch(o){a.e(o)}finally{a.f()}return!1}},{key:"discoverConnection",value:function(e,t){e.gtfsTripByConnection[t.id]=t.tripId,e.profilesByStop[t.departureStop]||(e.profilesByStop[t.departureStop]=[M.default.create(e.query.maximumTransfers)]),e.profilesByStop[t.arrivalStop]||(e.profilesByStop[t.arrivalStop]=[M.default.create(e.query.maximumTransfers)]),e.earliestArrivalByTrip[t.tripId]||(e.earliestArrivalByTrip[t.tripId]=P.default.create(e.query.maximumTransfers))}},{key:"getTripIdsFromConnection",value:function(e,t){return[t.tripId]}},{key:"calculateEarliestArrivalTime",value:function(e,t){var n=this.remainSeated(e,t);if(t.dropOffType===p.default.NotAvailable)return n;var r=this.walkToTarget(e,t),i=this.takeTransfer(e,t);return k.default.minVector((function(e){return e.arrivalTime}),r,n,i)}},{key:"initDurationToTargetByStop",value:function(){var e=a(i.mark((function e(t){var n,a,o,s,u,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.to[0],a=T.default.getId(t.query.to[0]),t.query.to[0].id||(t.query.to[0].id=a,t.query.to[0].name="Arrival location"),e.next=5,this.finalReachableStopsFinder.findReachableStops(n,y.default.Target,t.query.maximumWalkingDuration,t.query.minimumWalkingSpeed,t.query.profileID);case 5:if(!((o=e.sent).length<1)){e.next=9;break}return this.eventBus&&this.eventBus.emit(_.default.AbortQuery,"No reachable stops at arrival location"),e.abrupt("return",!1);case 9:this.eventBus&&this.eventBus.emit(_.default.FinalReachableStops,o),s=r(o);try{for(s.s();!(u=s.n()).done;)0===(c=u.value).duration&&(t.query.to[0]=c.stop),t.durationToTargetByStop[c.stop.id]=c.duration}catch(i){s.e(i)}finally{s.f()}return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initInitialReachableStops",value:function(){var e=a(i.mark((function e(t){var n,a,o,s;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.query.from[0],a=T.default.getId(t.query.from[0]),t.query.from[0].id||(t.query.from[0].id=a,t.query.from[0].name="Departure location"),e.next=5,this.initialReachableStopsFinder.findReachableStops(n,y.default.Source,t.query.maximumWalkingDuration,t.query.minimumWalkingSpeed,t.query.profileID);case 5:t.initialReachableStops=e.sent,o=r(t.initialReachableStops);try{for(o.s();!(s=o.n()).done;)s.value.duration}catch(i){o.e(i)}finally{o.f()}if(!(t.initialReachableStops.length<1)){e.next=11;break}return this.eventBus&&this.eventBus.emit(_.default.AbortQuery,"No reachable stops at departure location"),e.abrupt("return",!1);case 11:return this.eventBus&&this.eventBus.emit(_.default.InitialReachableStops,t.initialReachableStops),e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"walkToTarget",value:function(e,t){var n=e.durationToTargetByStop[t.arrivalStop];return void 0===n||t.dropOffType===p.default.NotAvailable||t.arrivalTime.getTime()+n>e.query.maximumArrivalTime.getTime()?Array(e.query.maximumTransfers+1).fill({arrivalTime:1/0,tripId:t.tripId}):Array(e.query.maximumTransfers+1).fill({arrivalTime:t.arrivalTime.getTime()+n,tripId:t.tripId})}},{key:"remainSeated",value:function(e,t){for(var n=this.getTripIdsFromConnection(e,t),i=[],a=0;a<e.query.maximumTransfers+1;a++){var o,s=i[a],u=s&&s.arrivalTime,c=r(n);try{for(c.s();!(o=c.n()).done;){var l=o.value,h=e.earliestArrivalByTrip[l][a].arrivalTime;(!u||h<u)&&(i[a]={arrivalTime:h,tripId:l},u=h)}}catch(f){c.e(f)}finally{c.f()}}return i}},{key:"takeTransfer",value:function(e,t){var n=j.default.getTransferTimes(e.profilesByStop,t,e.query.maximumTransfers,e.query.minimumTransferDuration,e.query.maximumTransferDuration);return t.travelMode!==m.default.Walking?k.default.shiftVector(n,{arrivalTime:1/0,tripId:t.tripId}):n}},{key:"updateEarliestArrivalByTrip",value:function(e,t,n){var i,a=this.getTripIdsFromConnection(e,t),o=n.map((function(t,n){var r=t.tripId;return e.earliestArrivalByTrip[r][n]})),s=r(a);try{for(s.s();!(i=s.n()).done;){var u=i.value;e.earliestArrivalByTrip[u]=P.default.createByConnection(o,t,n)}}catch(c){s.e(c)}finally{s.f()}}},{key:"isDominated",value:function(e,t,n){var r=e.profilesByStop[t.departureStop];return r[r.length-1].isDominated(n,t.departureTime.getTime())}},{key:"getFootpathsForDepartureStop",value:function(){var e=a(i.mark((function e(t,n,a){var o,s,u,c,l,h,f,d,g,b,w,x,T,S;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=t.query.from[0],s=t.profilesByStop[n.departureStop],u=s[s.length-1],c=k.default.minVector((function(e){return e.arrivalTime}),a,u.getArrivalTimeByTransfers()),(l=t.initialReachableStops.find((function(e){return e.stop.id===n.departureStop})))&&this.incorporateInProfile(t,n,l.duration,o,c),e.prev=6,e.next=9,this.locationResolver.resolve(n.departureStop);case 9:return h=e.sent,e.next=12,this.transferReachableStopsFinder.findReachableStops(h,y.default.Target,t.query.maximumTransferDuration,t.query.minimumWalkingSpeed,t.query.profileID);case 12:if(f=e.sent,this.incorporateInProfile(t,n,0,h,c)){d=r(f);try{for(d.s();!(g=d.n()).done;)b=g.value,w=b.stop,(x=b.duration)&&w.id&&(T=new Date(n.departureTime.getTime()-x))>=t.query.minimumDepartureTime&&(S={id:"TRANSFER_TO:".concat(w.id),tripId:"TRANSFER_TO:".concat(w.id),travelMode:m.default.Walking,departureTime:T,departureStop:w.id,arrivalTime:n.departureTime,arrivalStop:n.departureStop,dropOffType:p.default.Regular,pickupType:v.default.Regular,headsign:w.id},t.footpathQueue.write(S))}catch(i){d.e(i)}finally{d.f()}}e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),this.eventBus&&this.eventBus.emit(_.default.Warning,e.t0);case 20:case"end":return e.stop()}}),e,this,[[6,17]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"emitTransferProfile",value:function(){var e=a(i.mark((function e(t,n){var r,a;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.locationResolver.resolve(t.enterConnection.departureStop);case 3:return r=e.sent,e.next=6,this.locationResolver.resolve(t.exitConnection.arrivalStop);case 6:a=e.sent,this.eventBus.emit(_.default.AddedNewTransferProfile,{departureStop:r,arrivalStop:a,amountOfTransfers:n}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),this.eventBus.emit(_.default.Warning,e.t0);case 13:case"end":return e.stop()}}),e,this,[[0,10]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"incorporateInProfile",value:function(e,t,n,r,i){var a=t.departureTime.getTime()-n,o=this.hasValidRoute(e,i,a);if(!(a<e.query.minimumDepartureTime.getTime())&&o){var s=e.profilesByStop[r.id];s||(s=e.profilesByStop[r.id]=[M.default.create(e.query.maximumTransfers)]);var u=s[s.length-1],c=!1;if(!u.isDominated(i,a)){c=!0;for(var l=u.transferProfiles,h=[],f=0;f<l.length;f++){var d=l[f],y={exitConnection:void 0,enterConnection:void 0,arrivalTime:1/0,departureTime:1/0},g=e.earliestArrivalByTrip[t.tripId][f].connection||t;i[f].arrivalTime<d.arrivalTime&&t.pickupType!==v.default.NotAvailable&&g.dropOffType!==p.default.NotAvailable?(y.enterConnection=t,y.exitConnection=g,y.departureTime=a,this.eventBus&&this.eventBus.listenerCount(_.default.AddedNewTransferProfile)>0&&this.emitTransferProfile(y,f)):(y.enterConnection=d.enterConnection,y.exitConnection=d.exitConnection,y.departureTime=d.departureTime),y.exitConnection&&y.enterConnection&&(y.arrivalTime=i[f].arrivalTime),h.push(y)}if(!h.reduce((function(e,t){var n=t.arrivalTime;return e||n&&n!==1/0}),!1))return!1;var m=M.default.createFromTransfers(a,h),b=s.length-1,w=s[b];if(w.departureTime===1/0)s[b]=m;else{for(;b>0&&w.departureTime<a;)s[b+1]=w,w=s[--b];s[b+1]=m}return c}}}}]),e}();O=u([d.injectable(),l(0,d.inject(x.default.ConnectionsProvider)),l(1,d.inject(x.default.LocationResolver)),l(2,d.inject(x.default.ReachableStopsFinder)),l(2,d.tagged("phase",g.default.Initial)),l(3,d.inject(x.default.ReachableStopsFinder)),l(3,d.tagged("phase",g.default.Transfer)),l(4,d.inject(x.default.ReachableStopsFinder)),l(4,d.tagged("phase",g.default.Final)),l(5,d.inject(x.default.JourneyExtractor)),c("design:paramtypes",[Object,Object,Object,Object,Object,Object])],O),t.default=O},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){r(this,e)}return i(e,null,[{key:"shiftVector",value:function(e,t){return e.unshift(t),e.pop(),e}},{key:"minVector",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(n&&n[0]){for(var i=n[0],a=0;a<n[0].length&&n.length>1;a++)for(var o=e(i[a]),s=1;s<n.length;s++){var u=n[s],c=e(u[a]);c<o&&(i[a]=u[a],o=c)}return i}}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i){r(this,e),this.departureTime=n||1/0,this.transferProfiles=i||Array(t+1).fill({exitConnection:void 0,enterConnection:void 0,arrivalTime:1/0})}return i(e,[{key:"isDominated",value:function(e,t){return this.transferProfiles.reduce((function(n,r,i){return n&&r.arrivalTime<=e[i].arrivalTime&&(!r.departureTime||r.departureTime>=t)}),!0)}},{key:"getArrivalTimeByTransfers",value:function(e){return this.transferProfiles.map((function(t){return{arrivalTime:t.arrivalTime,tripId:e}}))}}],[{key:"create",value:function(t){return new e(t)}},{key:"createFromTransfers",value:function(t,n){return new e(n.length,t,n)}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77),a=n(83),o=n(84),s=n(169);Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){o(n,e);var t=a(n);function n(e){var i;r(this,n),i=t.call(this);for(var a=0;a<e+1;a++)i[a]={arrivalTime:1/0,connection:void 0};return i}return i(n,null,[{key:"create",value:function(e){return new n(e)}},{key:"createByConnection",value:function(e,t,n){return e.map((function(e,r){return n[r].arrivalTime<e.arrivalTime?{connection:t,arrivalTime:n[r].arrivalTime}:e}))}}]),n}(s(Array));t.default=u},function(e,t,n){"use strict";var r=n(78),i=n(79),a=n(76),o=n(77),s=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},u=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},c=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var h=n(80),f=l(n(81)),d=l(n(99)),p=l(n(135)),v=function(){function e(t){a(this,e),this.stopsProvider=t}return o(e,[{key:"findReachableStops",value:function(){var e=i(r.mark((function e(t,n,i,a){var o;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[{stop:t,duration:0}],e.next=3,this.stopsProvider.getAllStops();case 3:return e.sent.forEach((function(e){if(Math.abs(t.latitude-e.latitude)<.05&&Math.abs(t.longitude-e.longitude)<.05){var n=d.default.getDistanceBetweenStops(t,e),r=p.default.toDuration(n,a);r>=0&&r<=i&&o.push({stop:e,duration:r})}})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()}]),e}();v=s([h.injectable(),c(0,h.inject(f.default.StopsProvider)),u("design:paramtypes",[Object])],v),t.default=v},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(119)),d=r(n(109)),p=r(n(120)),v=r(n(106)),y=r(n(137)),g=r(n(121)),m=r(n(122)),b=r(n(98)),_=r(n(206)),w=r(n(207)),x=n(94),T=n(208),S=r(n(123)),k=r(n(90)),M=r(n(145)),P=r(n(124)),I=r(n(133)),j=r(n(209)),O=r(n(134)),R=r(n(125)),N=r(n(177)),C=r(n(81)),A=new i.Container;A.bind(C.default.Context).to(a.default).inSingletonScope(),A.bind(C.default.QueryRunner).to(N.default),A.bind(C.default.LocationResolver).to(R.default),A.bind(C.default.JourneyExtractor).to(P.default),A.bind(C.default.PublicTransportPlanner).to(M.default),A.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),A.bind(C.default.RoadPlanner).to(I.default),A.bind(C.default.HydraTemplateFetcher).to(f.default).inSingletonScope(),A.bind(C.default.HypermediaTreeFetcher).to(_.default).inSingletonScope(),A.bind(C.default.HypermediaTreeProvider).to(w.default).inSingletonScope(),A.bind(C.default.ShortestPathTreeAlgorithm).to(S.default).inSingletonScope(),A.bind(C.default.ShortestPathAlgorithm).to(T.BidirDijkstra).inSingletonScope(),A.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),A.bind(C.default.ProfileFetcher).to(p.default).inSingletonScope(),A.bind(C.default.ProfileProvider).to(v.default).inSingletonScope(),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Initial),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Transfer),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Final),A.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),A.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),A.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),A.bind(C.default.ConnectionsFetcher).to(l.default),A.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),A.bind(C.default.StopsProvider).to(g.default).inSingletonScope(),A.bind(C.default.StopsFetcher).to(y.default),A.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),A.bind(C.default.RoutableTileFetcher).to(m.default).inSingletonScope(),A.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),A.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),A.bind(C.default.LDFetch).to(d.default).inSingletonScope(),A.bind(C.default.LDLoader).to(x.LDLoader),t.default=A},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(119)),d=r(n(109)),p=r(n(120)),v=r(n(106)),y=r(n(137)),g=r(n(121)),m=r(n(122)),b=r(n(98)),_=r(n(206)),w=r(n(207)),x=n(94),T=n(208),S=r(n(123)),k=r(n(90)),M=r(n(450)),P=r(n(124)),I=r(n(133)),j=r(n(209)),O=r(n(178)),R=r(n(125)),N=r(n(177)),C=r(n(81)),A=r(n(204)),E=new i.Container;E.bind(C.default.Context).to(a.default).inSingletonScope(),E.bind(C.default.QueryRunner).to(N.default),E.bind(C.default.LocationResolver).to(R.default),E.bind(C.default.HydraTemplateFetcher).to(f.default).inSingletonScope(),E.bind(C.default.HypermediaTreeFetcher).to(_.default).inSingletonScope(),E.bind(C.default.HypermediaTreeProvider).to(w.default).inSingletonScope(),E.bind(C.default.JourneyExtractor).to(P.default),E.bind(C.default.PublicTransportPlanner).to(M.default),E.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),E.bind(C.default.RoadPlanner).to(I.default),E.bind(C.default.ShortestPathTreeAlgorithm).to(S.default).inSingletonScope(),E.bind(C.default.ShortestPathAlgorithm).to(T.BidirDijkstra).inSingletonScope(),E.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),E.bind(C.default.ProfileFetcher).to(p.default).inSingletonScope(),E.bind(C.default.ProfileProvider).to(v.default).inSingletonScope(),E.bind(C.default.FootpathsProvider).to(A.default).inSingletonScope(),E.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Initial),E.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Transfer),E.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Final),E.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),E.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),E.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),E.bind(C.default.ConnectionsFetcher).to(l.default),E.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),E.bind(C.default.StopsProvider).to(g.default).inSingletonScope(),E.bind(C.default.StopsFetcher).to(y.default),E.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),E.bind(C.default.RoutableTileFetcher).to(m.default).inSingletonScope(),E.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),E.bind(C.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),E.bind(C.default.LDFetch).to(d.default).inSingletonScope(),E.bind(C.default.LDLoader).to(x.LDLoader),t.default=E},function(e,t,n){"use strict";var r=n(82),i=n(78),a=n(85),o=n(79),s=n(76),u=n(77),c=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},l=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},h=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=n(89),p=n(80),v=f(n(158)),y=f(n(174)),g=f(n(175)),m=f(n(100)),b=f(n(101)),_=f(n(86)),w=f(n(87)),x=n(157),T=f(n(81)),S=f(n(99)),k=f(n(156)),M=f(n(199)),P=f(n(257)),I=function(){function e(t,n,r,i,a,o,u){s(this,e),this.reachedClusters=new Set,this.treeProvider=o,this.connectionsProvider=t,this.locationResolver=n,this.transferReachableStopsFinder=r,this.initialReachableStopsFinder=i,this.finalReachableStopsFinder=a,this.eventBus=_.default.getInstance(),this.journeyExtractor=new P.default(n),this.stopsProvider=u}return u(e,[{key:"plan",value:function(){var e=o(i.mark((function e(t){var n,r,o,s,u,c,l,h,f,p,v,y,g,m;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.minimumDepartureTime,r=t.maximumArrivalTime,e.next=3,this.treeProvider.getAllTrees();case 3:return o=e.sent,e.next=6,this.clusterStops(o);case 6:return s=e.sent,u=s[S.default.getId(t.from[0])],this.reachedClusters.add(u.id),c=new M.default,e.next=12,this.connectionsProvider.createIterator({upperBoundDate:r,lowerBoundDate:n,excludedModes:t.excludedTravelModes,region:u});case 12:return l=e.sent,h=new k.default([l,c],x.forwardsConnectionSelector,!0),f={finalReachableStops:{},profilesByStop:{},enterConnectionByTrip:{},footpathsQueue:c,connectionsIterator:l,clusterStops:s,mergedQueue:h,lowerBoundDate:n},e.next=17,Promise.all([this.initInitialReachableStops(f,t),this.initFinalReachableStops(f,t)]);case 17:if(p=e.sent,v=a(p,2),y=v[0],g=v[1],y&&g){e.next=23;break}return e.abrupt("return",Promise.resolve(new d.ArrayIterator([])));case 23:return m=this,e.abrupt("return",new Promise((function(e,n){var r=!1,i=function(){r||(h.close(),m.extractJourneys(f,t).then((function(t){e(t)})),r=!0)};l.on("readable",(function(){return m.processConnections(f,t,i)})),l.on("end",(function(){return i()})),m.processConnections(f,t,i)})));case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clusterStops",value:function(){var e=o(i.mark((function e(t){var n,a,o,s,u,c;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.stopsProvider.getAllStops();case 2:n=e.sent,a={},o=r(n);try{for(o.s();!(s=o.n()).done;)u=s.value,c=this.placeLocation(u,t),a[S.default.getId(u)]=c}catch(i){o.e(i)}finally{o.f()}return e.abrupt("return",a);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"placeLocation",value:function(e,t){var n,i=r(t);try{for(i.s();!(n=i.n()).done;){var a,o=n.value,s=r(o.relations);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u.geoValue.contains(e))return u.geoValue}}catch(c){s.e(c)}finally{s.f()}}}catch(c){i.e(c)}finally{i.f()}}},{key:"updateProfile",value:function(){var e=o(i.mark((function e(t,n,r){var a,o,s,u,c,l,h;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.tripId,o=r.departureTime.getTime(),s=r.arrivalTime.getTime(),u={departureTime:o,arrivalTime:s,exitConnection:r,enterConnection:t.enterConnectionByTrip[a]},t.profilesByStop[r.arrivalStop]=u,!(c=t.clusterStops[r.arrivalStop])||this.reachedClusters.has(c.id)){e.next=14;break}return l=n.maximumArrivalTime,this.reachedClusters.add(c.id),e.next=11,this.connectionsProvider.appendIterator({upperBoundDate:l,lowerBoundDate:r.departureTime,excludedModes:n.excludedTravelModes,region:c},t.connectionsIterator);case 11:h=e.sent,t.connectionsIterator=h,t.mergedQueue=new k.default([h,t.footpathsQueue],x.forwardsConnectionSelector,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"extractJourneys",value:function(){var e=o(i.mark((function e(t,n){return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.journeyExtractor.extractJourneys(t.profilesByStop,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"processConnections",value:function(){var e=o(i.mark((function e(t,n,r){var a,o,s,u,c,l,h,f,d,p;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=n.from,o=n.to,n.minimumDepartureTime,s=a[0].id,u=o[0].id,c=t.mergedQueue.read();case 4:if(!c||t.connectionsIterator.closed){e.next=29;break}if(!(c.departureTime<t.lowerBoundDate)||t.connectionsIterator.closed){e.next=8;break}return c=t.mergedQueue.read(),e.abrupt("continue",4);case 8:if(t.lowerBoundDate=c.departureTime,!(this.getProfile(t,u).arrivalTime<c.departureTime.getTime())){e.next=11;break}return e.abrupt("return",r());case 11:if(l=c.tripId,h=c.departureTime.getTime(),f=t.enterConnectionByTrip[l],d=(c.departureStop===s||this.getProfile(t,c.departureStop).arrivalTime<=h)&&c.pickupType!==y.default.NotAvailable,!f&&!d){e.next=23;break}if(t.enterConnectionByTrip[l]||(t.enterConnectionByTrip[l]=c),p=c.arrivalTime.getTime()<this.getProfile(t,c.arrivalStop).arrivalTime,!(c.dropOffType!==v.default.NotAvailable)||!p){e.next=23;break}return this.updateProfile(t,n,c),e.next=23,this.scheduleExtraConnections(t,n,c);case 23:if(t.connectionsIterator.closed){e.next=26;break}return c=t.mergedQueue.read(),e.abrupt("continue",4);case 26:c=void 0,e.next=4;break;case 29:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getProfile",value:function(e,t){return e.profilesByStop[t]||(e.profilesByStop[t]={departureTime:1/0,arrivalTime:1/0}),e.profilesByStop[t]}},{key:"scheduleExtraConnections",value:function(){var e=o(i.mark((function e(t,n,a){var o,s,u,c,l,h,f,d,p,m,_;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.locationResolver.resolve(a.arrivalStop);case 3:return o=e.sent,e.next=6,this.transferReachableStopsFinder.findReachableStops(o,g.default.Source,n.maximumTransferDuration,n.minimumWalkingSpeed,n.profileID);case 6:s=e.sent,t.finalReachableStops[o.id]&&s.push(t.finalReachableStops[o.id]),u=r(s);try{for(u.s();!(c=u.n()).done;)l=c.value,h=l.stop,(f=l.duration)&&h.id&&(d=this.getProfile(t,h.id).arrivalTime,p=new Date(a.arrivalTime.getTime()+f),d>p.getTime()&&p<=n.maximumArrivalTime&&(m="TRANSFER_TO:".concat(a.arrivalStop,"@").concat(a.arrivalTime.getTime()),_={id:"".concat(m,"-").concat(h.id),tripId:m,travelMode:b.default.Walking,departureTime:a.arrivalTime,departureStop:a.arrivalStop,arrivalTime:new Date(a.arrivalTime.getTime()+f),arrivalStop:h.id,dropOffType:v.default.Regular,pickupType:y.default.Regular,headsign:h.id},t.footpathsQueue.write(_)))}catch(i){u.e(i)}finally{u.f()}e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),this.eventBus&&this.eventBus.emit(w.default.Warning,e.t0);case 15:case"end":return e.stop()}}),e,this,[[0,12]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"initInitialReachableStops",value:function(){var e=o(i.mark((function e(t,n){var a,o,s,u,c,l,h,f,d;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.from[0],o=S.default.getId(a),a.id||(n.from[0].id=o,n.from[0].name="Departure location"),e.next=5,this.initialReachableStopsFinder.findReachableStops(a,g.default.Source,n.maximumWalkingDuration,n.minimumWalkingSpeed,n.profileID);case 5:if(0!==(s=e.sent).length){e.next=9;break}return this.eventBus.emit(w.default.AbortQuery,"No reachable stops at departure location"),e.abrupt("return",!1);case 9:this.eventBus&&this.eventBus.emit(w.default.InitialReachableStops,s),u=r(s);try{for(u.s();!(c=u.n()).done;)l=c.value,h=l.stop,(f=l.duration)&&(d={id:"MOVE_TO:".concat(h.id),tripId:"MOVE_TO:".concat(h.id),travelMode:b.default.Walking,departureTime:n.minimumDepartureTime,departureStop:a.id,arrivalTime:new Date(n.minimumDepartureTime.getTime()+f),arrivalStop:h.id,dropOffType:v.default.Regular,pickupType:y.default.Regular,headsign:h.id},t.footpathsQueue.write(d))}catch(i){u.e(i)}finally{u.f()}return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"initFinalReachableStops",value:function(){var e=o(i.mark((function e(t,n){var a,o,s,u,c,l;return i.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.to[0],o=S.default.getId(a),a.id||(n.to[0].id=o,n.to[0].name="Arrival location"),e.next=5,this.finalReachableStopsFinder.findReachableStops(a,g.default.Target,n.maximumWalkingDuration,n.minimumWalkingSpeed,n.profileID);case 5:if(0!==(s=e.sent).length){e.next=9;break}return this.eventBus.emit(w.default.AbortQuery,"No reachable stops at arrival location"),e.abrupt("return",!1);case 9:this.eventBus&&this.eventBus.emit(w.default.FinalReachableStops,s),u=r(s);try{for(u.s();!(c=u.n()).done;)(l=c.value).duration>0&&(t.finalReachableStops[l.stop.id]={stop:a,duration:l.duration})}catch(i){u.e(i)}finally{u.f()}return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();I=c([p.injectable(),h(0,p.inject(T.default.ConnectionsProvider)),h(1,p.inject(T.default.LocationResolver)),h(2,p.inject(T.default.ReachableStopsFinder)),h(2,p.tagged("phase",m.default.Transfer)),h(3,p.inject(T.default.ReachableStopsFinder)),h(3,p.tagged("phase",m.default.Initial)),h(4,p.inject(T.default.ReachableStopsFinder)),h(4,p.tagged("phase",m.default.Final)),h(5,p.inject(T.default.HypermediaTreeProvider)),h(6,p.inject(T.default.StopsProvider)),l("design:paramtypes",[Object,Object,Object,Object,Object,Object,Object])],I),t.default=I},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(172)),d=r(n(119)),p=r(n(109)),v=r(n(120)),y=r(n(106)),g=r(n(137)),m=r(n(121)),b=r(n(122)),_=r(n(98)),w=r(n(205)),x=n(94),T=r(n(123)),S=n(255),k=r(n(90)),M=r(n(145)),P=r(n(124)),I=r(n(452)),j=r(n(134)),O=r(n(178)),R=r(n(160)),N=r(n(125)),C=r(n(81)),A=new i.Container;A.bind(C.default.Context).to(a.default).inSingletonScope(),A.bind(C.default.QueryRunner).to(R.default),A.bind(C.default.LocationResolver).to(N.default),A.bind(C.default.HydraTemplateFetcher).to(d.default).inSingletonScope(),A.bind(C.default.JourneyExtractor).to(P.default),A.bind(C.default.PublicTransportPlanner).to(M.default),A.bind(C.default.PublicTransportPlannerFactory).toAutoFactory(C.default.PublicTransportPlanner),A.bind(C.default.RoadPlanner).to(I.default),A.bind(C.default.ShortestPathTreeAlgorithm).to(T.default).inSingletonScope(),A.bind(C.default.ShortestPathAlgorithm).to(S.Dijkstra).inSingletonScope(),A.bind(C.default.PathfinderProvider).to(k.default).inSingletonScope(),A.bind(C.default.ProfileFetcher).to(v.default).inSingletonScope(),A.bind(C.default.ProfileProvider).to(y.default).inSingletonScope(),A.bind(C.default.FootpathsProvider).to(f.default).inSingletonScope(),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Initial),A.bind(C.default.ReachableStopsFinder).to(O.default).whenTargetTagged("phase",o.default.Transfer),A.bind(C.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Final),A.bind(C.default.CatalogFetcher).to(u.default).inSingletonScope(),A.bind(C.default.CatalogProvider).to(c.default).inSingletonScope(),A.bind(C.default.ConnectionsProvider).to(h.default).inSingletonScope(),A.bind(C.default.ConnectionsFetcher).to(l.default),A.bind(C.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),A.bind(C.default.StopsProvider).to(m.default).inSingletonScope(),A.bind(C.default.StopsFetcher).to(g.default),A.bind(C.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(C.default.StopsFetcher);return n.setAccessUrl(t),n}})),A.bind(C.default.RoutableTileFetcher).to(b.default).inSingletonScope(),A.bind(C.default.RoutableTileProvider).to(_.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),A.bind(C.default.RoutableTileProvider).to(w.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),A.bind(C.default.LDFetch).to(p.default).inSingletonScope(),A.bind(C.default.LDLoader).to(x.LDLoader),t.default=A},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},c=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},l=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var f=n(89),d=n(80),p=h(n(171)),v=h(n(111)),y=h(n(113)),g=h(n(93)),m=h(n(101)),b=h(n(86)),_=h(n(87)),w=h(n(90)),x=h(n(81)),T=h(n(99)),S=n(139),k=h(n(159)),M=h(n(146)),P=function(){function e(t,n,r,i,a){o(this,e),this.baseTileProvider=t,this.transitTileProvider=n,this.pathfinderProvider=r,this.profileProvider=i,this.locationResolver=a,this.registry=v.default.getInstance(),this.eventBus=b.default.getInstance(),this.reachedTiles=new Set}return s(e,[{key:"plan",value:function(){var e=a(r.mark((function e(t){var n,a,o,s,u,c,l,h,d,p,v,y;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.from,a=t.to,o=t.profileID,s=[],e.next=4,this.profileProvider.getProfile(o);case 4:if(u=e.sent,!(n&&a&&n.length&&a.length)){e.next=40;break}c=i(n),e.prev=7,c.s();case 9:if((l=c.n()).done){e.next=32;break}h=l.value,d=i(a),e.prev=12,d.s();case 14:if((p=d.n()).done){e.next=22;break}return v=p.value,e.next=18,this.getPathBetweenLocations(h,v,u);case 18:(y=e.sent)&&s.push(y);case 20:e.next=14;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),d.e(e.t0);case 27:return e.prev=27,d.f(),e.finish(27);case 30:e.next=9;break;case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(7),c.e(e.t1);case 37:return e.prev=37,c.f(),e.finish(37);case 40:return e.abrupt("return",new f.ArrayIterator(s));case 41:case"end":return e.stop()}}),e,this,[[7,34,37,40],[12,24,27,30]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPathBetweenLocations",value:function(){var e=a(r.mark((function e(t,n,i){return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.localTiles=[S.toTileCoordinate(t.latitude,t.longitude),S.toTileCoordinate(n.latitude,n.longitude)],e.next=3,Promise.all([this.embedLocation(t),this.embedLocation(n,!0)]);case 3:return e.abrupt("return",this._innerPath(t,n,i));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"_innerPath",value:function(){var e=a(r.mark((function e(t,n,a){var o,s,u,c,l,h,f,d,p,v;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.pathfinderProvider.getShortestPathAlgorithm(a);case 2:return o=e.sent,s=5*T.default.getDistanceBetweenLocations(t,n),e.next=6,o.queryPath(T.default.getId(t),T.default.getId(n),s);case 6:u=e.sent,c=[],l=i(u),e.prev=9,l.s();case 11:if((h=l.n()).done){e.next=22;break}return f=h.value,e.next=15,this.locationResolver.resolve(f.to);case 15:return d=e.sent,e.next=18,this.locationResolver.resolve(f.from);case 18:p=e.sent,c.push({startLocation:p,stopLocation:d,duration:{average:f.duration},distance:f.distance});case 20:e.next=11;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(9),l.e(e.t0);case 27:return e.prev=27,l.f(),e.finish(27);case 30:return v=new k.default(m.default.Profile,c),e.abrupt("return",new M.default([v]));case 32:case"end":return e.stop()}}),e,this,[[9,24,27,30]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"pickTile",value:function(e){for(var t,n=8;n<15;n++){t=S.toTileCoordinate(e.latitude,e.longitude,n);var r,a=!0,o=i(this.localTiles);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(t.contains(s)){a=!1;break}}}catch(u){o.e(u)}finally{o.f()}if(a)return t}return t}},{key:"fetchTile",value:function(){var e=a(r.mark((function e(t){var n,o,s,u,c,l,h=this;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=!1,o=i(this.localTiles),e.prev=2,o.s();case 4:if((s=o.n()).done){e.next=11;break}if(u=s.value,t.x!==u.x||t.y!==u.y||t.zoom!==u.zoom){e.next=9;break}return n=!0,e.abrupt("break",11);case 9:e.next=4;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(2),o.e(e.t0);case 16:return e.prev=16,o.f(),e.finish(16);case 19:if(c=this.baseTileProvider.getIdForTileCoords(t),l=this.transitTileProvider.getIdForTileCoords(t),this.reachedTiles.has(l)||this.reachedTiles.has(c)){e.next=23;break}return e.delegateYield(r.mark((function e(){var o,s,u,f,d,p,v,y,g,m,b,w,x,T;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h.eventBus.emit(_.default.ReachableTile,t),!n){e.next=9;break}return e.next=4,h.baseTileProvider.getByTileCoords(t);case 4:o=e.sent,h.reachedTiles.add(c),h.reachedTiles.add(l),e.next=13;break;case 9:return e.next=11,h.transitTileProvider.getByTileCoords(t);case 11:o=e.sent,h.reachedTiles.add(l);case 13:s=new Set,u=i(o.getNodes());try{for(u.s();!(f=u.n()).done;)d=f.value,p=h.registry.getNode(d),o.contains(p)||s.add(d)}catch(S){u.e(S)}finally{u.f()}return v=h,e.t0=i,e.next=20,h.profileProvider.getProfiles();case 20:e.t1=e.sent,y=(0,e.t0)(e.t1);try{for(y.s();!(g=y.n()).done;){m=g.value,b=h.pathfinderProvider.getGraphForProfile(m),w=i(s);try{for(w.s();!(x=w.n()).done;)T=x.value,b.setBreakPoint(T,function(){var e=a(r.mark((function e(t){var n,i;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v.registry.getNode(t),i=h.pickTile(n),e.next=4,v.fetchTile(i);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}catch(S){w.e(S)}finally{w.f()}}}catch(S){y.e(S)}finally{y.f()}case 23:case"end":return e.stop()}}),e)}))(),"t1",23);case 23:case"end":return e.stop()}}),e,this,[[2,13,16,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"embedLocation",value:function(){var e=a(r.mark((function e(t){var n,i,a,o,s,u,c=this,l=arguments;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=l.length>1&&void 0!==l[1]&&l[1],i=14,a=.005,o={top:t.latitude+a,bottom:t.latitude-a,left:t.longitude-a,right:t.longitude+a},s=p.default.tilesInBbox(o,i).map((function(e){var t=new y.default(i,e.x,e.y);return c.fetchTile(t),t})),e.next=7,this.baseTileProvider.getMultipleByTileCoords(s);case 7:return u=e.sent,e.next=10,this.pathfinderProvider.embedLocation(t,u,n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();P=u([d.injectable(),l(0,d.inject(x.default.RoutableTileProvider)),l(0,d.tagged("phase",g.default.Base)),l(1,d.inject(x.default.RoutableTileProvider)),l(1,d.tagged("phase",g.default.Transit)),l(2,d.inject(x.default.PathfinderProvider)),l(3,d.inject(x.default.ProfileProvider)),l(4,d.inject(x.default.LocationResolver)),c("design:paramtypes",[Object,Object,w.default,Object,Object])],P),t.default=P},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(117)),c=r(n(118)),l=r(n(204)),h=r(n(119)),f=r(n(109)),d=r(n(120)),p=r(n(106)),v=r(n(137)),y=r(n(121)),g=r(n(122)),m=r(n(98)),b=r(n(205)),_=n(94),w=r(n(123)),x=r(n(176)),T=r(n(90)),S=r(n(145)),k=r(n(124)),M=r(n(133)),P=r(n(134)),I=r(n(454)),j=r(n(125)),O=r(n(177)),R=r(n(81)),N=new i.Container;N.bind(R.default.Context).to(a.default).inSingletonScope(),N.bind(R.default.QueryRunner).to(O.default),N.bind(R.default.LocationResolver).to(j.default),N.bind(R.default.HydraTemplateFetcher).to(h.default).inSingletonScope(),N.bind(R.default.JourneyExtractor).to(k.default),N.bind(R.default.PublicTransportPlanner).to(S.default),N.bind(R.default.PublicTransportPlannerFactory).toAutoFactory(R.default.PublicTransportPlanner),N.bind(R.default.RoadPlanner).to(M.default),N.bind(R.default.ShortestPathTreeAlgorithm).to(w.default).inSingletonScope(),N.bind(R.default.ShortestPathAlgorithm).to(x.default).inSingletonScope(),N.bind(R.default.PathfinderProvider).to(T.default).inSingletonScope(),N.bind(R.default.ProfileFetcher).to(d.default).inSingletonScope(),N.bind(R.default.ProfileProvider).to(p.default).inSingletonScope(),N.bind(R.default.FootpathsProvider).to(l.default).inSingletonScope(),N.bind(R.default.ReachableStopsFinder).to(P.default).whenTargetTagged("phase",o.default.Initial),N.bind(R.default.ReachableStopsFinder).to(I.default).whenTargetTagged("phase",o.default.Transfer),N.bind(R.default.ReachableStopsFinder).to(P.default).whenTargetTagged("phase",o.default.Final),N.bind(R.default.ConnectionsProvider).to(c.default).inSingletonScope(),N.bind(R.default.ConnectionsFetcher).to(u.default),N.bind(R.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(R.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),N.bind(R.default.StopsProvider).to(y.default).inSingletonScope(),N.bind(R.default.StopsFetcher).to(v.default),N.bind(R.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(R.default.StopsFetcher);return n.setAccessUrl(t),n}})),N.bind(R.default.RoutableTileFetcher).to(g.default).inSingletonScope(),N.bind(R.default.RoutableTileProvider).to(m.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),N.bind(R.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),N.bind(R.default.LDFetch).to(f.default).inSingletonScope(),N.bind(R.default.LDLoader).to(_.LDLoader),t.default=N},function(e,t,n){"use strict";var r=n(78),i=n(82),a=n(79),o=n(76),s=n(77),u=n(103),c=n(132),l=n(83),h=n(84),f=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},d=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},p=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},v=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var y=n(80),g=v(n(86)),m=v(n(87)),b=v(n(81)),_=function(e){h(n,e);var t=l(n);function n(e,r){var i;return o(this,n),(i=t.call(this,e,r)).done=new Set,i}return s(n,[{key:"findReachableStops",value:function(){var e=a(r.mark((function e(t,a,o,s){var l,h,f,d;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(u(n.prototype),"findReachableStops",this).call(this,t,a,o,s);case 2:if(l=e.sent,!this.done.has(t.id)){this.done.add(t.id),h=i(l);try{for(h.s();!(f=h.n()).done;)d=f.value,g.default.getInstance().emit(m.default.ReachableTransfer,{from:t,to:d.stop})}catch(r){h.e(r)}finally{h.f()}}return e.abrupt("return",l);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r,i){return e.apply(this,arguments)}}()}]),n}(v(n(201)).default);_=f([y.injectable(),p(0,y.inject(b.default.StopsProvider)),p(1,y.inject(b.default.FootpathsProvider)),d("design:paramtypes",[Object,Object])],_),t.default=_},function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=n(80),a=r(n(114)),o=r(n(100)),s=r(n(93)),u=r(n(127)),c=r(n(130)),l=r(n(117)),h=r(n(118)),f=r(n(172)),d=r(n(119)),p=r(n(109)),v=r(n(120)),y=r(n(106)),g=r(n(137)),m=r(n(121)),b=r(n(456)),_=r(n(122)),w=n(94),x=r(n(123)),T=r(n(176)),S=r(n(90)),k=r(n(145)),M=r(n(124)),P=r(n(133)),I=r(n(134)),j=r(n(178)),O=r(n(160)),R=r(n(125)),N=r(n(81)),C=new i.Container;C.bind(N.default.Context).to(a.default).inSingletonScope(),C.bind(N.default.QueryRunner).to(O.default),C.bind(N.default.LocationResolver).to(R.default),C.bind(N.default.HydraTemplateFetcher).to(d.default).inSingletonScope(),C.bind(N.default.JourneyExtractor).to(M.default),C.bind(N.default.PublicTransportPlanner).to(k.default),C.bind(N.default.PublicTransportPlannerFactory).toAutoFactory(N.default.PublicTransportPlanner),C.bind(N.default.RoadPlanner).to(P.default),C.bind(N.default.ShortestPathTreeAlgorithm).to(x.default).inSingletonScope(),C.bind(N.default.ShortestPathAlgorithm).to(T.default).inSingletonScope(),C.bind(N.default.PathfinderProvider).to(S.default).inSingletonScope(),C.bind(N.default.ProfileFetcher).to(v.default).inSingletonScope(),C.bind(N.default.ProfileProvider).to(y.default).inSingletonScope(),C.bind(N.default.FootpathsProvider).to(f.default).inSingletonScope(),C.bind(N.default.ReachableStopsFinder).to(I.default).whenTargetTagged("phase",o.default.Initial),C.bind(N.default.ReachableStopsFinder).to(j.default).whenTargetTagged("phase",o.default.Transfer),C.bind(N.default.ReachableStopsFinder).to(I.default).whenTargetTagged("phase",o.default.Final),C.bind(N.default.CatalogFetcher).to(u.default).inSingletonScope(),C.bind(N.default.CatalogProvider).to(c.default).inSingletonScope(),C.bind(N.default.ConnectionsProvider).to(h.default).inSingletonScope(),C.bind(N.default.ConnectionsFetcher).to(l.default),C.bind(N.default.ConnectionsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(N.default.ConnectionsFetcher);return n.setTravelMode(t),n}})),C.bind(N.default.StopsProvider).to(m.default).inSingletonScope(),C.bind(N.default.StopsFetcher).to(g.default),C.bind(N.default.StopsFetcherFactory).toFactory((function(e){return function(t){var n=e.container.get(N.default.StopsFetcher);return n.setAccessUrl(t),n}})),C.bind(N.default.RoutableTileFetcher).to(_.default).inSingletonScope(),C.bind(N.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Base),C.bind(N.default.RoutableTileProvider).to(b.default).inSingletonScope().whenTargetTagged("phase",s.default.Transit),C.bind(N.default.LDFetch).to(p.default).inSingletonScope(),C.bind(N.default.LDLoader).to(w.LDLoader),t.default=C},function(e,t,n){"use strict";var r=n(82),i=n(85),a=n(78),o=n(79),s=n(76),u=n(77),c=n(83),l=n(84),h=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},f=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},d=this&&this.__param||function(e,t){return function(n,r){t(n,r,e)}},p=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},v=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var y=p(n(164)),g=n(80),m=v(n(457)),b=v(n(90)),_=v(n(81)),w=v(n(98)),x=v(n(458)),T=function(e){l(n,e);var t=c(n);function n(e,r){var i;return s(this,n),(i=t.call(this,e,r)).tiles={},i.zoiFetcher=new x.default,i}return u(n,[{key:"getByTileCoords",value:function(){var e=o(a.mark((function e(t){var n,r,i;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getIdForTileCoords(t),r=this.getZoiIdForTileCoords(t),e.next=4,this.getByUrl(n,r);case 4:return(i=e.sent).coordinate=t,e.abrupt("return",i);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdForTileCoords",value:function(e){return"https://hdelva.be/tiles/pedestrian/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}},{key:"getByUrl",value:function(){var e=o(a.mark((function e(t,n){var o,s,u,c,l,h,f,d,p,v,g,b,_,w,x,T,S,k,M,P,I,j;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tiles[t]){e.next=65;break}return this.tiles[t]=this.fetcher.get(t),e.next=4,Promise.all([this.tiles[t],this.zoiFetcher.get(n)]);case 4:o=e.sent,s=i(o,2),u=s[0],c=s[1],(l=new m.default).load(c.getZones().map((function(e){var t=y.bbox(e.getBoundary().area),n=i(t,4);return{minX:n[0],minY:n[1],maxX:n[2],maxY:n[3],zone:e}}))),h=r(u.getNodes()),e.prev=11,h.s();case 13:if((f=h.n()).done){e.next=56;break}d=f.value,p=this.registry.getNode(d),v=l.search({minX:p.longitude,minY:p.latitude,maxX:p.longitude,maxY:p.latitude}),g=v.sort((function(e,t){return t.zone.degree-e.zone.degree})),b=r(g),e.prev=19,b.s();case 21:if((_=b.n()).done){e.next=46;break}w=_.value,x=w.zone,T=!1,S=r(x.getSubject().getValues()),e.prev=26,S.s();case 28:if((k=S.n()).done){e.next=35;break}if(M=k.value,p.proximity[M]&&!(p.proximity[M]<x.getDegree())){e.next=33;break}return T=!0,e.abrupt("break",35);case 33:e.next=28;break;case 35:e.next=40;break;case 37:e.prev=37,e.t0=e.catch(26),S.e(e.t0);case 40:return e.prev=40,S.f(),e.finish(40);case 43:if(T&&x.contains(p)){P=r(x.getSubject().getValues());try{for(P.s();!(I=P.n()).done;)j=I.value,(!p.proximity[j]||p.proximity[j]<x.getDegree())&&(p.proximity[j]=x.getDegree())}catch(a){P.e(a)}finally{P.f()}}case 44:e.next=21;break;case 46:e.next=51;break;case 48:e.prev=48,e.t1=e.catch(19),b.e(e.t1);case 51:return e.prev=51,b.f(),e.finish(51);case 54:e.next=13;break;case 56:e.next=61;break;case 58:e.prev=58,e.t2=e.catch(11),h.e(e.t2);case 61:return e.prev=61,h.f(),e.finish(61);case 64:this.pathfinderProvider.registerEdges(u.getWays());case 65:return e.next=67,this.tiles[t];case 67:return e.abrupt("return",e.sent);case 68:case"end":return e.stop()}}),e,this,[[11,58,61,64],[19,48,51,54],[26,37,40,43]])})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getZoiIdForTileCoords",value:function(e){return"https://hdelva.be/zoi/".concat(e.zoom,"/").concat(e.x,"/").concat(e.y)}}]),n}(w.default);T=h([g.injectable(),d(0,g.inject(_.default.PathfinderProvider)),d(1,g.inject(_.default.RoutableTileFetcher)),f("design:paramtypes",[b.default,Object])],T),t.default=T},function(e,t,n){e.exports=function(){"use strict";function e(e,r,i,a,o){!function e(n,r,i,a,o){for(;a>i;){if(a-i>600){var s=a-i+1,u=r-i+1,c=Math.log(s),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(s-l)/s)*(u-s/2<0?-1:1);e(n,r,Math.max(i,Math.floor(r-u*l/s+h)),Math.min(a,Math.floor(r+(s-u)*l/s+h)),o)}var f=n[r],d=i,p=a;for(t(n,i,r),o(n[a],f)>0&&t(n,i,a);d<p;){for(t(n,d,p),d++,p--;o(n[d],f)<0;)d++;for(;o(n[p],f)>0;)p--}0===o(n[i],f)?t(n,i,p):t(n,++p,a),p<=r&&(i=p+1),r<=p&&(a=p-1)}}(e,r,i||0,a||e.length-1,o||n)}function t(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function n(e,t){return e<t?-1:e>t?1:0}var r=function(e){void 0===e&&(e=9),this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function i(e,t,n){if(!n)return t.indexOf(e);for(var r=0;r<t.length;r++)if(n(e,t[r]))return r;return-1}function a(e,t){o(e,0,e.children.length,t,e)}function o(e,t,n,r,i){i||(i=p(null)),i.minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var a=t;a<n;a++){var o=e.children[a];s(i,e.leaf?r(o):o)}return i}function s(e,t){return e.minX=Math.min(e.minX,t.minX),e.minY=Math.min(e.minY,t.minY),e.maxX=Math.max(e.maxX,t.maxX),e.maxY=Math.max(e.maxY,t.maxY),e}function u(e,t){return e.minX-t.minX}function c(e,t){return e.minY-t.minY}function l(e){return(e.maxX-e.minX)*(e.maxY-e.minY)}function h(e){return e.maxX-e.minX+(e.maxY-e.minY)}function f(e,t){return e.minX<=t.minX&&e.minY<=t.minY&&t.maxX<=e.maxX&&t.maxY<=e.maxY}function d(e,t){return t.minX<=e.maxX&&t.minY<=e.maxY&&t.maxX>=e.minX&&t.maxY>=e.minY}function p(e){return{children:e,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function v(t,n,r,i,a){for(var o=[n,r];o.length;)if(!((r=o.pop())-(n=o.pop())<=i)){var s=n+Math.ceil((r-n)/i/2)*i;e(t,s,n,r,a),o.push(n,s,s,r)}}return r.prototype.all=function(){return this._all(this.data,[])},r.prototype.search=function(e){var t=this.data,n=[];if(!d(e,t))return n;for(var r=this.toBBox,i=[];t;){for(var a=0;a<t.children.length;a++){var o=t.children[a],s=t.leaf?r(o):o;d(e,s)&&(t.leaf?n.push(o):f(e,s)?this._all(o,n):i.push(o))}t=i.pop()}return n},r.prototype.collides=function(e){var t=this.data;if(!d(e,t))return!1;for(var n=[];t;){for(var r=0;r<t.children.length;r++){var i=t.children[r],a=t.leaf?this.toBBox(i):i;if(d(e,a)){if(t.leaf||f(e,a))return!0;n.push(i)}}t=n.pop()}return!1},r.prototype.load=function(e){if(!e||!e.length)return this;if(e.length<this._minEntries){for(var t=0;t<e.length;t++)this.insert(e[t]);return this}var n=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var r=this.data;this.data=n,n=r}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},r.prototype.insert=function(e){return e&&this._insert(e,this.data.height-1),this},r.prototype.clear=function(){return this.data=p([]),this},r.prototype.remove=function(e,t){if(!e)return this;for(var n,r,a,o=this.data,s=this.toBBox(e),u=[],c=[];o||u.length;){if(o||(o=u.pop(),r=u[u.length-1],n=c.pop(),a=!0),o.leaf){var l=i(e,o.children,t);if(-1!==l)return o.children.splice(l,1),u.push(o),this._condense(u),this}a||o.leaf||!f(o,s)?r?(n++,o=r.children[n],a=!1):o=null:(u.push(o),c.push(n),n=0,r=o,o=o.children[0])}return this},r.prototype.toBBox=function(e){return e},r.prototype.compareMinX=function(e,t){return e.minX-t.minX},r.prototype.compareMinY=function(e,t){return e.minY-t.minY},r.prototype.toJSON=function(){return this.data},r.prototype.fromJSON=function(e){return this.data=e,this},r.prototype._all=function(e,t){for(var n=[];e;)e.leaf?t.push.apply(t,e.children):n.push.apply(n,e.children),e=n.pop();return t},r.prototype._build=function(e,t,n,r){var i,o=n-t+1,s=this._maxEntries;if(o<=s)return a(i=p(e.slice(t,n+1)),this.toBBox),i;r||(r=Math.ceil(Math.log(o)/Math.log(s)),s=Math.ceil(o/Math.pow(s,r-1))),(i=p([])).leaf=!1,i.height=r;var u=Math.ceil(o/s),c=u*Math.ceil(Math.sqrt(s));v(e,t,n,c,this.compareMinX);for(var l=t;l<=n;l+=c){var h=Math.min(l+c-1,n);v(e,l,h,u,this.compareMinY);for(var f=l;f<=h;f+=u){var d=Math.min(f+u-1,h);i.children.push(this._build(e,f,d,r-1))}}return a(i,this.toBBox),i},r.prototype._chooseSubtree=function(e,t,n,r){for(;r.push(t),!t.leaf&&r.length-1!==n;){for(var i=1/0,a=1/0,o=void 0,s=0;s<t.children.length;s++){var u=t.children[s],c=l(u),h=(f=e,d=u,(Math.max(d.maxX,f.maxX)-Math.min(d.minX,f.minX))*(Math.max(d.maxY,f.maxY)-Math.min(d.minY,f.minY))-c);h<a?(a=h,i=c<i?c:i,o=u):h===a&&c<i&&(i=c,o=u)}t=o||t.children[0]}var f,d;return t},r.prototype._insert=function(e,t,n){var r=n?e:this.toBBox(e),i=[],a=this._chooseSubtree(r,this.data,t,i);for(a.children.push(e),s(a,r);t>=0&&i[t].children.length>this._maxEntries;)this._split(i,t),t--;this._adjustParentBBoxes(r,i,t)},r.prototype._split=function(e,t){var n=e[t],r=n.children.length,i=this._minEntries;this._chooseSplitAxis(n,i,r);var o=this._chooseSplitIndex(n,i,r),s=p(n.children.splice(o,n.children.length-o));s.height=n.height,s.leaf=n.leaf,a(n,this.toBBox),a(s,this.toBBox),t?e[t-1].children.push(s):this._splitRoot(n,s)},r.prototype._splitRoot=function(e,t){this.data=p([e,t]),this.data.height=e.height+1,this.data.leaf=!1,a(this.data,this.toBBox)},r.prototype._chooseSplitIndex=function(e,t,n){for(var r,i,a,s,u,c,h,f=1/0,d=1/0,p=t;p<=n-t;p++){var v=o(e,0,p,this.toBBox),y=o(e,p,n,this.toBBox),g=(i=v,a=y,s=Math.max(i.minX,a.minX),u=Math.max(i.minY,a.minY),c=Math.min(i.maxX,a.maxX),h=Math.min(i.maxY,a.maxY),Math.max(0,c-s)*Math.max(0,h-u)),m=l(v)+l(y);g<f?(f=g,r=p,d=m<d?m:d):g===f&&m<d&&(d=m,r=p)}return r||n-t},r.prototype._chooseSplitAxis=function(e,t,n){var r=e.leaf?this.compareMinX:u,i=e.leaf?this.compareMinY:c;this._allDistMargin(e,t,n,r)<this._allDistMargin(e,t,n,i)&&e.children.sort(r)},r.prototype._allDistMargin=function(e,t,n,r){e.children.sort(r);for(var i=this.toBBox,a=o(e,0,t,i),u=o(e,n-t,n,i),c=h(a)+h(u),l=t;l<n-t;l++){var f=e.children[l];s(a,e.leaf?i(f):f),c+=h(a)}for(var d=n-t-1;d>=t;d--){var p=e.children[d];s(u,e.leaf?i(p):p),c+=h(u)}return c},r.prototype._adjustParentBBoxes=function(e,t,n){for(var r=n;r>=0;r--)s(t[r],e)},r.prototype._condense=function(e){for(var t=e.length-1,n=void 0;t>=0;t--)0===e[t].children.length?t>0?(n=e[t-1].children).splice(n.indexOf(e[t]),1):this.clear():a(e[t],this.toBBox)},r}()},function(e,t,n){"use strict";var r=n(78),i=n(85),a=n(82),o=n(79),s=n(76),u=n(77),c=n(193),l=this&&this.__decorate||function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(o=(a<3?i(o):a>3?i(t,n,o):i(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o},h=this&&this.__metadata||function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var d=f(n(196)),p=n(80),v=n(252),y=n(131),g=f(n(459)),m=n(460),b=n(461),_=f(n(273)),w=f(n(86)),x=f(n(87)),T=f(n(279));var S=function(){function e(){s(this,e),this.eventBus=w.default.getInstance()}return u(e,[{key:"get",value:function(){var e=o(r.mark((function e(t){var n,o,s,u,c,l,h,f,p,v,g,b,_,S,k,M,P,I,j;return r.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Date,e.next=3,d.default(t);case 3:return o=e.sent,e.next=6,o.text();case 6:if(s=e.sent,200!==o.status&&w.default.getInstance().emit(x.default.Warning,"".concat(t," responded with status code ").concat(o.status)),200!==o.status||!s){e.next=22;break}u=JSON.parse(s),c={},l={},h=[],f=this.parseResponseLength(o),p=(new Date).getTime()-n.getTime(),v=new T.default(u["@context"]),g=a(u["@graph"]);try{for(g.s();!(b=g.n()).done;)"owl:Restriction"===(_=b.value)["@type"]?(S=this.createSubject(_,v),c[S.id]=S):"dct:subject"===_["rdfs:subPropertyOf"]?(k=this.createProperty(_),M=i(k,2),P=M[0],I=M[1],l[P]=I):_["geo:asWKT"]&&(j=this.createZone(_,c,l),this.eventBus.emit(x.default.ZoiZone,j),h.push(j))}catch(r){g.e(r)}finally{g.f()}return w.default.getInstance().emit(x.default.ResourceFetch,{DataType:y.DataType.ZoiTile,url:t,duration:p,size:f}),e.abrupt("return",new m.ZoiTile(t,h));case 22:return e.abrupt("return",new m.ZoiTile(t,[]));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"parseResponseLength",value:function(e){if(e.headers.get("content-length"))return parseInt(e.headers.get("content-length"),10);try{return e.body._outOffset}catch(t){}}},{key:"createSubject",value:function(e,t){var n=e["@id"],r=e["owl:onProperty"],i=e["owl:someValuesFrom"].map((function(e){return t.resolveIdentifier(e)}));return new g.default(n,r,i)}},{key:"createProperty",value:function(e){return[e["@id"],e["truth:degree"]]}},{key:"createZone",value:function(e,t,n){var r=e["@id"],a=new _.default(null);a.area=function(e){var t=e.split(" "),n=c(t),r=n[0],i=n.slice(1);return v("<http://www.opengis.net/def/crs/OGC/1.3/CRS84>"===r?i.join(" "):e)}(e["geo:asWKT"]);for(var o=0,s=Object.entries(e);o<s.length;o++){var u=i(s[o],2),l=u[0],h=u[1];if(n[l]){var f=n[l],d=t[h];return new b.ZoiZone(r,a,d,f)}}}}]),e}();S=l([p.injectable(),h("design:paramtypes",[])],S),t.default=S},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i){r(this,e),this.id=t,this.property=n,this.values=i}return i(e,[{key:"getProperty",value:function(){return this.property}},{key:"getValues",value:function(){return this.values}}]),e}();t.default=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n){r(this,e),this.id=t,this.zones=n}return i(e,[{key:"getZones",value:function(){return this.zones}}]),e}();t.ZoiTile=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;r(this,e),this.id=t,this.boundary=n,this.subject=i,this.degree=a}return i(e,[{key:"getBoundary",value:function(){return this.boundary}},{key:"getSubject",value:function(){return this.subject}},{key:"getDegree",value:function(){return this.degree}},{key:"contains",value:function(e){return this.boundary.contains(e)}}]),e}();t.ZoiZone=a},function(e,t,n){"use strict";var r=n(76),i=n(77);Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t,n,i,a){r(this,e),this.id=t,this.previousPageId=i,this.nextPageId=a,this.connections=n}return i(e,[{key:"getConnections",value:function(){return this.connections}},{key:"getPreviousPageId",value:function(){return this.previousPageId}},{key:"getNextPageId",value:function(){return this.nextPageId}},{key:"getLowerBound",value:function(){return this.connections[0].departureTime}},{key:"getUpperBound",value:function(){return this.connections[this.connections.length-1].departureTime}}]),e}();t.LinkedConnectionsPage=a},function(e,t,n){"use strict";n.r(t);var r=484813681109536e-20,i=Math.PI/2,a=.017453292519943295,o=57.29577951308232,s=Math.PI/4,u=2*Math.PI,c=3.14159265359,l={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667},h={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}},f=/[\s_\-\/\(\)]/g;function d(e,t){if(e[t])return e[t];for(var n,r=Object.keys(e),i=t.toLowerCase().replace(f,""),a=-1;++a<r.length;)if((n=r[a]).toLowerCase().replace(f,"")===i)return e[n]}var p=function(e){var t,n,r,i={},o=e.split("+").map((function(e){return e.trim()})).filter((function(e){return e})).reduce((function(e,t){var n=t.split("=");return n.push(!0),e[n[0].toLowerCase()]=n[1],e}),{}),s={proj:"projName",datum:"datumCode",rf:function(e){i.rf=parseFloat(e)},lat_0:function(e){i.lat0=e*a},lat_1:function(e){i.lat1=e*a},lat_2:function(e){i.lat2=e*a},lat_ts:function(e){i.lat_ts=e*a},lon_0:function(e){i.long0=e*a},lon_1:function(e){i.long1=e*a},lon_2:function(e){i.long2=e*a},alpha:function(e){i.alpha=parseFloat(e)*a},lonc:function(e){i.longc=e*a},x_0:function(e){i.x0=parseFloat(e)},y_0:function(e){i.y0=parseFloat(e)},k_0:function(e){i.k0=parseFloat(e)},k:function(e){i.k0=parseFloat(e)},a:function(e){i.a=parseFloat(e)},b:function(e){i.b=parseFloat(e)},r_a:function(){i.R_A=!0},zone:function(e){i.zone=parseInt(e,10)},south:function(){i.utmSouth=!0},towgs84:function(e){i.datum_params=e.split(",").map((function(e){return parseFloat(e)}))},to_meter:function(e){i.to_meter=parseFloat(e)},units:function(e){i.units=e;var t=d(h,e);t&&(i.to_meter=t.to_meter)},from_greenwich:function(e){i.from_greenwich=e*a},pm:function(e){var t=d(l,e);i.from_greenwich=(t||parseFloat(e))*a},nadgrids:function(e){"@null"===e?i.datumCode="none":i.nadgrids=e},axis:function(e){3===e.length&&-1!=="ewnsud".indexOf(e.substr(0,1))&&-1!=="ewnsud".indexOf(e.substr(1,1))&&-1!=="ewnsud".indexOf(e.substr(2,1))&&(i.axis=e)}};for(t in o)n=o[t],t in s?"function"===typeof(r=s[t])?r(n):i[r]=n:i[t]=n;return"string"===typeof i.datumCode&&"WGS84"!==i.datumCode&&(i.datumCode=i.datumCode.toLowerCase()),i},v=function(e){return new w(e).output()},y=/\s/,g=/[A-Za-z]/,m=/[A-Za-z84]/,b=/[,\]]/,_=/[\d\.E\-\+]/;function w(e){if("string"!==typeof e)throw new Error("not a string");this.text=e.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function x(e,t,n){Array.isArray(t)&&(n.unshift(t),t=null);var r=t?{}:e,i=n.reduce((function(e,t){return T(t,e),e}),r);t&&(e[t]=i)}function T(e,t){if(Array.isArray(e)){var n,r=e.shift();if("PARAMETER"===r&&(r=e.shift()),1===e.length)return Array.isArray(e[0])?(t[r]={},void T(e[0],t[r])):void(t[r]=e[0]);if(e.length)if("TOWGS84"!==r)switch(Array.isArray(r)||(t[r]={}),r){case"UNIT":case"PRIMEM":case"VERT_DATUM":return t[r]={name:e[0].toLowerCase(),convert:e[1]},void(3===e.length&&T(e[2],t[r]));case"SPHEROID":case"ELLIPSOID":return t[r]={name:e[0],a:e[1],rf:e[2]},void(4===e.length&&T(e[3],t[r]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return e[0]=["name",e[0]],void x(t,r,e);default:for(n=-1;++n<e.length;)if(!Array.isArray(e[n]))return T(e,t[r]);return x(t,r,e)}else t[r]=e;else t[r]=!0}else t[e]=!0}w.prototype.readCharicter=function(){var e=this.text[this.place++];if(4!==this.state)for(;y.test(e);){if(this.place>=this.text.length)return;e=this.text[this.place++]}switch(this.state){case 1:return this.neutral(e);case 2:return this.keyword(e);case 4:return this.quoted(e);case 5:return this.afterquote(e);case 3:return this.number(e);case-1:return}},w.prototype.afterquote=function(e){if('"'===e)return this.word+='"',void(this.state=4);if(b.test(e))return this.word=this.word.trim(),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in afterquote yet, index '+this.place)},w.prototype.afterItem=function(e){return","===e?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===e?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},w.prototype.number=function(e){if(!_.test(e)){if(b.test(e))return this.word=parseFloat(this.word),void this.afterItem(e);throw new Error("havn't handled \""+e+'" in number yet, index '+this.place)}this.word+=e},w.prototype.quoted=function(e){'"'!==e?this.word+=e:this.state=5},w.prototype.keyword=function(e){if(m.test(e))this.word+=e;else{if("["===e){var t=[];return t.push(this.word),this.level++,null===this.root?this.root=t:this.currentObject.push(t),this.stack.push(this.currentObject),this.currentObject=t,void(this.state=1)}if(!b.test(e))throw new Error("havn't handled \""+e+'" in keyword yet, index '+this.place);this.afterItem(e)}},w.prototype.neutral=function(e){if(g.test(e))return this.word=e,void(this.state=2);if('"'===e)return this.word="",void(this.state=4);if(_.test(e))return this.word=e,void(this.state=3);if(!b.test(e))throw new Error("havn't handled \""+e+'" in neutral yet, index '+this.place);this.afterItem(e)},w.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)};function S(e){return.017453292519943295*e}var k=function(e){var t=v(e),n=t.shift(),r=t.shift();t.unshift(["name",r]),t.unshift(["type",n]);var i={};return T(t,i),function(e){"GEOGCS"===e.type?e.projName="longlat":"LOCAL_CS"===e.type?(e.projName="identity",e.local=!0):"object"===typeof e.PROJECTION?e.projName=Object.keys(e.PROJECTION)[0]:e.projName=e.PROJECTION,e.UNIT&&(e.units=e.UNIT.name.toLowerCase(),"metre"===e.units&&(e.units="meter"),e.UNIT.convert&&("GEOGCS"===e.type?e.DATUM&&e.DATUM.SPHEROID&&(e.to_meter=e.UNIT.convert*e.DATUM.SPHEROID.a):e.to_meter=e.UNIT.convert));var t=e.GEOGCS;function n(t){return t*(e.to_meter||1)}"GEOGCS"===e.type&&(t=e),t&&(t.DATUM?e.datumCode=t.DATUM.name.toLowerCase():e.datumCode=t.name.toLowerCase(),"d_"===e.datumCode.slice(0,2)&&(e.datumCode=e.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==e.datumCode&&"new_zealand_1949"!==e.datumCode||(e.datumCode="nzgd49"),"wgs_1984"===e.datumCode&&("Mercator_Auxiliary_Sphere"===e.PROJECTION&&(e.sphere=!0),e.datumCode="wgs84"),"_ferro"===e.datumCode.slice(-6)&&(e.datumCode=e.datumCode.slice(0,-6)),"_jakarta"===e.datumCode.slice(-8)&&(e.datumCode=e.datumCode.slice(0,-8)),~e.datumCode.indexOf("belge")&&(e.datumCode="rnb72"),t.DATUM&&t.DATUM.SPHEROID&&(e.ellps=t.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===e.ellps.toLowerCase().slice(0,13)&&(e.ellps="intl"),e.a=t.DATUM.SPHEROID.a,e.rf=parseFloat(t.DATUM.SPHEROID.rf,10)),t.DATUM&&t.DATUM.TOWGS84&&(e.datum_params=t.DATUM.TOWGS84),~e.datumCode.indexOf("osgb_1936")&&(e.datumCode="osgb36"),~e.datumCode.indexOf("osni_1952")&&(e.datumCode="osni52"),(~e.datumCode.indexOf("tm65")||~e.datumCode.indexOf("geodetic_datum_of_1965"))&&(e.datumCode="ire65"),"ch1903+"===e.datumCode&&(e.datumCode="ch1903"),~e.datumCode.indexOf("israel")&&(e.datumCode="isr93")),e.b&&!isFinite(e.b)&&(e.b=e.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",S],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",S],["x0","false_easting",n],["y0","false_northing",n],["long0","central_meridian",S],["lat0","latitude_of_origin",S],["lat0","standard_parallel_1",S],["lat1","standard_parallel_1",S],["lat2","standard_parallel_2",S],["azimuth","Azimuth"],["alpha","azimuth",S],["srsCode","name"]].forEach((function(t){return function(e,t){var n=t[0],r=t[1];!(n in e)&&r in e&&(e[n]=e[r],3===t.length&&(e[n]=t[2](e[n])))}(e,t)})),e.long0||!e.longc||"Albers_Conic_Equal_Area"!==e.projName&&"Lambert_Azimuthal_Equal_Area"!==e.projName||(e.long0=e.longc),e.lat_ts||!e.lat1||"Stereographic_South_Pole"!==e.projName&&"Polar Stereographic (variant B)"!==e.projName||(e.lat0=S(e.lat1>0?90:-90),e.lat_ts=e.lat1)}(i),i};function M(e){var t=this;if(2===arguments.length){var n=arguments[1];"string"===typeof n?"+"===n.charAt(0)?M[e]=p(arguments[1]):M[e]=k(arguments[1]):M[e]=n}else if(1===arguments.length){if(Array.isArray(e))return e.map((function(e){Array.isArray(e)?M.apply(t,e):M(e)}));if("string"===typeof e){if(e in M)return M[e]}else"EPSG"in e?M["EPSG:"+e.EPSG]=e:"ESRI"in e?M["ESRI:"+e.ESRI]=e:"IAU2000"in e?M["IAU2000:"+e.IAU2000]=e:console.log(e);return}}!function(e){e("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),e("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),e("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),e.WGS84=e["EPSG:4326"],e["EPSG:3785"]=e["EPSG:3857"],e.GOOGLE=e["EPSG:3857"],e["EPSG:900913"]=e["EPSG:3857"],e["EPSG:102113"]=e["EPSG:3857"]}(M);var P=M;var I=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"];var j=["3857","900913","3785","102113"];var O=function(e){if(!function(e){return"string"===typeof e}(e))return e;if(function(e){return e in P}(e))return P[e];if(function(e){return I.some((function(t){return e.indexOf(t)>-1}))}(e)){var t=k(e);if(function(e){var t=d(e,"authority");if(t){var n=d(t,"epsg");return n&&j.indexOf(n)>-1}}(t))return P["EPSG:3857"];var n=function(e){var t=d(e,"extension");if(t)return d(t,"proj4")}(t);return n?p(n):t}return function(e){return"+"===e[0]}(e)?p(e):void 0},R=function(e,t){var n,r;if(e=e||{},!t)return e;for(r in t)void 0!==(n=t[r])&&(e[r]=n);return e},N=function(e,t,n){var r=e*t;return n/Math.sqrt(1-r*r)},C=function(e){return e<0?-1:1},A=function(e){return Math.abs(e)<=c?e:e-C(e)*u},E=function(e,t,n){var r=e*n,a=.5*e;return r=Math.pow((1-r)/(1+r),a),Math.tan(.5*(i-t))/r},D=function(e,t){for(var n,r,a=.5*e,o=i-2*Math.atan(t),s=0;s<=15;s++)if(n=e*Math.sin(o),o+=r=i-2*Math.atan(t*Math.pow((1-n)/(1+n),a))-o,Math.abs(r)<=1e-10)return o;return-9999};function L(e){return e}var B=[{init:function(){var e=this.b/this.a;this.es=1-e*e,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=N(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(e){var t,n,r=e.x,a=e.y;if(a*o>90&&a*o<-90&&r*o>180&&r*o<-180)return null;if(Math.abs(Math.abs(a)-i)<=1e-10)return null;if(this.sphere)t=this.x0+this.a*this.k0*A(r-this.long0),n=this.y0+this.a*this.k0*Math.log(Math.tan(s+.5*a));else{var u=Math.sin(a),c=E(this.e,a,u);t=this.x0+this.a*this.k0*A(r-this.long0),n=this.y0-this.a*this.k0*Math.log(c)}return e.x=t,e.y=n,e},inverse:function(e){var t,n,r=e.x-this.x0,a=e.y-this.y0;if(this.sphere)n=i-2*Math.atan(Math.exp(-a/(this.a*this.k0)));else{var o=Math.exp(-a/(this.a*this.k0));if(-9999===(n=D(this.e,o)))return null}return t=A(this.long0+r/(this.a*this.k0)),e.x=t,e.y=n,e},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:L,inverse:L,names:["longlat","identity"]}],F={},U=[];function q(e,t){var n=U.length;return e.names?(U[n]=e,e.names.forEach((function(e){F[e.toLowerCase()]=n})),this):(console.log(t),!0)}var G={start:function(){B.forEach(q)},add:q,get:function(e){if(!e)return!1;var t=e.toLowerCase();return"undefined"!==typeof F[t]&&U[F[t]]?U[F[t]]:void 0}},z={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},W=z.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};z.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var V={};V.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},V.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},V.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},V.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},V.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},V.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},V.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},V.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},V.osni52={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},V.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},V.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},V.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},V.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},V.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},V.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},V.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},V.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"};var H=function(e,t,n,i,a,o){var s={};return s.datum_type=void 0===e||"none"===e?5:4,t&&(s.datum_params=t.map(parseFloat),0===s.datum_params[0]&&0===s.datum_params[1]&&0===s.datum_params[2]||(s.datum_type=1),s.datum_params.length>3&&(0===s.datum_params[3]&&0===s.datum_params[4]&&0===s.datum_params[5]&&0===s.datum_params[6]||(s.datum_type=2,s.datum_params[3]*=r,s.datum_params[4]*=r,s.datum_params[5]*=r,s.datum_params[6]=s.datum_params[6]/1e6+1))),s.a=n,s.b=i,s.es=a,s.ep2=o,s};function X(e,t){if(!(this instanceof X))return new X(e);t=t||function(e){if(e)throw e};var n=O(e);if("object"===typeof n){var r=X.projections.get(n.projName);if(r){if(n.datumCode&&"none"!==n.datumCode){var i=d(V,n.datumCode);i&&(n.datum_params=i.towgs84?i.towgs84.split(","):null,n.ellps=i.ellipse,n.datumName=i.datumName?i.datumName:n.datumCode)}n.k0=n.k0||1,n.axis=n.axis||"enu",n.ellps=n.ellps||"wgs84";var a=function(e,t,n,r,i){if(!e){var a=d(z,r);a||(a=W),e=a.a,t=a.b,n=a.rf}return n&&!t&&(t=(1-1/n)*e),(0===n||Math.abs(e-t)<1e-10)&&(i=!0,t=e),{a:e,b:t,rf:n,sphere:i}}(n.a,n.b,n.rf,n.ellps,n.sphere),o=function(e,t,n,r){var i=e*e,a=t*t,o=(i-a)/i,s=0;return r?(i=(e*=1-o*(.16666666666666666+o*(.04722222222222222+.022156084656084655*o)))*e,o=0):s=Math.sqrt(o),{es:o,e:s,ep2:(i-a)/a}}(a.a,a.b,a.rf,n.R_A),s=n.datum||H(n.datumCode,n.datum_params,a.a,a.b,o.es,o.ep2);R(this,n),R(this,r),this.a=a.a,this.b=a.b,this.rf=a.rf,this.sphere=a.sphere,this.es=o.es,this.e=o.e,this.ep2=o.ep2,this.datum=s,this.init(),t(null,this)}else t(e)}else t(e)}X.projections=G,X.projections.start();var Q=X;function Y(e,t,n){var r,a,o,s,u=e.x,c=e.y,l=e.z?e.z:0;if(c<-i&&c>-1.001*i)c=-i;else if(c>i&&c<1.001*i)c=i;else{if(c<-i)return{x:-1/0,y:-1/0,z:e.z};if(c>i)return{x:1/0,y:1/0,z:e.z}}return u>Math.PI&&(u-=2*Math.PI),a=Math.sin(c),s=Math.cos(c),o=a*a,{x:((r=n/Math.sqrt(1-t*o))+l)*s*Math.cos(u),y:(r+l)*s*Math.sin(u),z:(r*(1-t)+l)*a}}function J(e,t,n,r){var a,o,s,u,c,l,h,f,d,p,v,y,g,m,b,_=e.x,w=e.y,x=e.z?e.z:0;if(a=Math.sqrt(_*_+w*w),o=Math.sqrt(_*_+w*w+x*x),a/n<1e-12){if(m=0,o/n<1e-12)return i,b=-r,{x:e.x,y:e.y,z:e.z}}else m=Math.atan2(w,_);s=x/o,f=(u=a/o)*(1-t)*(c=1/Math.sqrt(1-t*(2-t)*u*u)),d=s*c,g=0;do{g++,l=t*(h=n/Math.sqrt(1-t*d*d))/(h+(b=a*f+x*d-h*(1-t*d*d))),y=(v=s*(c=1/Math.sqrt(1-l*(2-l)*u*u)))*f-(p=u*(1-l)*c)*d,f=p,d=v}while(y*y>1e-24&&g<30);return{x:m,y:Math.atan(v/Math.abs(p)),z:b}}function K(e){return 1===e||2===e}var Z=function(e,t,n){return function(e,t){return e.datum_type===t.datum_type&&(!(e.a!==t.a||Math.abs(e.es-t.es)>5e-11)&&(1===e.datum_type?e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]:2!==e.datum_type||e.datum_params[0]===t.datum_params[0]&&e.datum_params[1]===t.datum_params[1]&&e.datum_params[2]===t.datum_params[2]&&e.datum_params[3]===t.datum_params[3]&&e.datum_params[4]===t.datum_params[4]&&e.datum_params[5]===t.datum_params[5]&&e.datum_params[6]===t.datum_params[6]))}(e,t)||5===e.datum_type||5===t.datum_type?n:e.es!==t.es||e.a!==t.a||K(e.datum_type)||K(t.datum_type)?(n=Y(n,e.es,e.a),K(e.datum_type)&&(n=function(e,t,n){if(1===t)return{x:e.x+n[0],y:e.y+n[1],z:e.z+n[2]};if(2===t){var r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],c=n[6];return{x:c*(e.x-u*e.y+s*e.z)+r,y:c*(u*e.x+e.y-o*e.z)+i,z:c*(-s*e.x+o*e.y+e.z)+a}}}(n,e.datum_type,e.datum_params)),K(t.datum_type)&&(n=function(e,t,n){if(1===t)return{x:e.x-n[0],y:e.y-n[1],z:e.z-n[2]};if(2===t){var r=n[0],i=n[1],a=n[2],o=n[3],s=n[4],u=n[5],c=n[6],l=(e.x-r)/c,h=(e.y-i)/c,f=(e.z-a)/c;return{x:l+u*h-s*f,y:-u*l+h+o*f,z:s*l-o*h+f}}}(n,t.datum_type,t.datum_params)),J(n,t.es,t.a,t.b)):n},$=function(e,t,n){var r,i,a,o=n.x,s=n.y,u=n.z||0,c={};for(a=0;a<3;a++)if(!t||2!==a||void 0!==n.z)switch(0===a?(r=o,i="x"):1===a?(r=s,i="y"):(r=u,i="z"),e.axis[a]){case"e":c[i]=r;break;case"w":c[i]=-r;break;case"n":c[i]=r;break;case"s":c[i]=-r;break;case"u":void 0!==n[i]&&(c.z=r);break;case"d":void 0!==n[i]&&(c.z=-r);break;default:return null}return c},ee=function(e){var t={x:e[0],y:e[1]};return e.length>2&&(t.z=e[2]),e.length>3&&(t.m=e[3]),t};function te(e){if("function"===typeof Number.isFinite){if(Number.isFinite(e))return;throw new TypeError("coordinates must be finite numbers")}if("number"!==typeof e||e!==e||!isFinite(e))throw new TypeError("coordinates must be finite numbers")}function ne(e,t,n){var r;return Array.isArray(n)&&(n=ee(n)),function(e){te(e.x),te(e.y)}(n),e.datum&&t.datum&&function(e,t){return(1===e.datum.datum_type||2===e.datum.datum_type)&&"WGS84"!==t.datumCode||(1===t.datum.datum_type||2===t.datum.datum_type)&&"WGS84"!==e.datumCode}(e,t)&&(n=ne(e,r=new Q("WGS84"),n),e=r),"enu"!==e.axis&&(n=$(e,!1,n)),"longlat"===e.projName?n={x:n.x*a,y:n.y*a,z:n.z||0}:(e.to_meter&&(n={x:n.x*e.to_meter,y:n.y*e.to_meter,z:n.z||0}),n=e.inverse(n)),e.from_greenwich&&(n.x+=e.from_greenwich),n=Z(e.datum,t.datum,n),t.from_greenwich&&(n={x:n.x-t.from_greenwich,y:n.y,z:n.z||0}),"longlat"===t.projName?n={x:n.x*o,y:n.y*o,z:n.z||0}:(n=t.forward(n),t.to_meter&&(n={x:n.x/t.to_meter,y:n.y/t.to_meter,z:n.z||0})),"enu"!==t.axis?$(t,!0,n):n}var re=Q("WGS84");function ie(e,t,n){var r,i,a;return Array.isArray(n)?(r=ne(e,t,n)||{x:NaN,y:NaN},n.length>2?"undefined"!==typeof e.name&&"geocent"===e.name||"undefined"!==typeof t.name&&"geocent"===t.name?"number"===typeof r.z?[r.x,r.y,r.z].concat(n.splice(3)):[r.x,r.y,n[2]].concat(n.splice(3)):[r.x,r.y].concat(n.splice(2)):[r.x,r.y]):(i=ne(e,t,n),2===(a=Object.keys(n)).length||a.forEach((function(r){if("undefined"!==typeof e.name&&"geocent"===e.name||"undefined"!==typeof t.name&&"geocent"===t.name){if("x"===r||"y"===r||"z"===r)return}else if("x"===r||"y"===r)return;i[r]=n[r]})),i)}function ae(e){return e instanceof Q?e:e.oProj?e.oProj:Q(e)}var oe=function(e,t,n){e=ae(e);var r,i=!1;return"undefined"===typeof t?(t=e,e=re,i=!0):("undefined"!==typeof t.x||Array.isArray(t))&&(n=t,t=e,e=re,i=!0),t=ae(t),n?ie(e,t,n):(r={forward:function(n){return ie(e,t,n)},inverse:function(n){return ie(t,e,n)}},i&&(r.oProj=t),r)},se=73,ue=79,ce={forward:le,inverse:function(e){var t=pe(ge(e.toUpperCase()));if(t.lat&&t.lon)return[t.lon,t.lat,t.lon,t.lat];return[t.left,t.bottom,t.right,t.top]},toPoint:he};function le(e,t){return t=t||5,function(e,t){var n="00000"+e.easting,r="00000"+e.northing;return e.zoneNumber+e.zoneLetter+function(e,t,n){var r=ye(n),i=Math.floor(e/1e5),a=Math.floor(t/1e5)%20;return function(e,t,n){var r=n-1,i="AJSAJS".charCodeAt(r),a="AFAFAF".charCodeAt(r),o=i+e-1,s=a+t,u=!1;o>90&&(o=o-90+65-1,u=!0);(o===se||i<se&&o>se||(o>se||i<se)&&u)&&o++;(o===ue||i<ue&&o>ue||(o>ue||i<ue)&&u)&&++o===se&&o++;o>90&&(o=o-90+65-1);s>86?(s=s-86+65-1,u=!0):u=!1;(s===se||a<se&&s>se||(s>se||a<se)&&u)&&s++;(s===ue||a<ue&&s>ue||(s>ue||a<ue)&&u)&&++s===se&&s++;s>86&&(s=s-86+65-1);return String.fromCharCode(o)+String.fromCharCode(s)}(i,a,r)}(e.easting,e.northing,e.zoneNumber)+n.substr(n.length-5,t)+r.substr(r.length-5,t)}(function(e){var t,n,r,i,a,o,s,u=e.lat,c=e.lon,l=6378137,h=fe(u),f=fe(c);s=Math.floor((c+180)/6)+1,180===c&&(s=60);u>=56&&u<64&&c>=3&&c<12&&(s=32);u>=72&&u<84&&(c>=0&&c<9?s=31:c>=9&&c<21?s=33:c>=21&&c<33?s=35:c>=33&&c<42&&(s=37));o=fe(6*(s-1)-180+3),.006739496752268451,t=l/Math.sqrt(1-.00669438*Math.sin(h)*Math.sin(h)),n=Math.tan(h)*Math.tan(h),r=.006739496752268451*Math.cos(h)*Math.cos(h),i=Math.cos(h)*(f-o),a=l*(.9983242984503243*h-.002514607064228144*Math.sin(2*h)+2639046602129982e-21*Math.sin(4*h)-3.418046101696858e-9*Math.sin(6*h));var d=.9996*t*(i+(1-n+r)*i*i*i/6+(5-18*n+n*n+72*r-.39089081163157013)*i*i*i*i*i/120)+5e5,p=.9996*(a+t*Math.tan(h)*(i*i/2+(5-n+9*r+4*r*r)*i*i*i*i/24+(61-58*n+n*n+600*r-2.2240339282485886)*i*i*i*i*i*i/720));u<0&&(p+=1e7);return{northing:Math.round(p),easting:Math.round(d),zoneNumber:s,zoneLetter:ve(u)}}({lat:e[1],lon:e[0]}),t)}function he(e){var t=pe(ge(e.toUpperCase()));return t.lat&&t.lon?[t.lon,t.lat]:[(t.left+t.right)/2,(t.top+t.bottom)/2]}function fe(e){return e*(Math.PI/180)}function de(e){return e/Math.PI*180}function pe(e){var t=e.northing,n=e.easting,r=e.zoneLetter,i=e.zoneNumber;if(i<0||i>60)return null;var a,o,s,u,c,l,h,f,d=6378137,p=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),v=n-5e5,y=t;r<"N"&&(y-=1e7),l=6*(i-1)-180+3,f=(h=y/.9996/6367449.145945056)+(3*p/2-27*p*p*p/32)*Math.sin(2*h)+(21*p*p/16-55*p*p*p*p/32)*Math.sin(4*h)+151*p*p*p/96*Math.sin(6*h),a=d/Math.sqrt(1-.00669438*Math.sin(f)*Math.sin(f)),o=Math.tan(f)*Math.tan(f),s=.006739496752268451*Math.cos(f)*Math.cos(f),u=.99330562*d/Math.pow(1-.00669438*Math.sin(f)*Math.sin(f),1.5),c=v/(.9996*a);var g=f-a*Math.tan(f)/u*(c*c/2-(5+3*o+10*s-4*s*s-.06065547077041606)*c*c*c*c/24+(61+90*o+298*s+45*o*o-1.6983531815716497-3*s*s)*c*c*c*c*c*c/720);g=de(g);var m,b=(c-(1+2*o+s)*c*c*c/6+(5-2*s+28*o-3*s*s+.05391597401814761+24*o*o)*c*c*c*c*c/120)/Math.cos(f);if(b=l+de(b),e.accuracy){var _=pe({northing:e.northing+e.accuracy,easting:e.easting+e.accuracy,zoneLetter:e.zoneLetter,zoneNumber:e.zoneNumber});m={top:_.lat,right:_.lon,bottom:g,left:b}}else m={lat:g,lon:b};return m}function ve(e){var t="Z";return 84>=e&&e>=72?t="X":72>e&&e>=64?t="W":64>e&&e>=56?t="V":56>e&&e>=48?t="U":48>e&&e>=40?t="T":40>e&&e>=32?t="S":32>e&&e>=24?t="R":24>e&&e>=16?t="Q":16>e&&e>=8?t="P":8>e&&e>=0?t="N":0>e&&e>=-8?t="M":-8>e&&e>=-16?t="L":-16>e&&e>=-24?t="K":-24>e&&e>=-32?t="J":-32>e&&e>=-40?t="H":-40>e&&e>=-48?t="G":-48>e&&e>=-56?t="F":-56>e&&e>=-64?t="E":-64>e&&e>=-72?t="D":-72>e&&e>=-80&&(t="C"),t}function ye(e){var t=e%6;return 0===t&&(t=6),t}function ge(e){if(e&&0===e.length)throw"MGRSPoint coverting from nothing";for(var t,n=e.length,r=null,i="",a=0;!/[A-Z]/.test(t=e.charAt(a));){if(a>=2)throw"MGRSPoint bad conversion from: "+e;i+=t,a++}var o=parseInt(i,10);if(0===a||a+3>n)throw"MGRSPoint bad conversion from: "+e;var s=e.charAt(a++);if(s<="A"||"B"===s||"Y"===s||s>="Z"||"I"===s||"O"===s)throw"MGRSPoint zone letter "+s+" not handled: "+e;r=e.substring(a,a+=2);for(var u=ye(o),c=function(e,t){var n="AJSAJS".charCodeAt(t-1),r=1e5,i=!1;for(;n!==e.charCodeAt(0);){if(++n===se&&n++,n===ue&&n++,n>90){if(i)throw"Bad character: "+e;n=65,i=!0}r+=1e5}return r}(r.charAt(0),u),l=function(e,t){if(e>"V")throw"MGRSPoint given invalid Northing "+e;var n="AFAFAF".charCodeAt(t-1),r=0,i=!1;for(;n!==e.charCodeAt(0);){if(++n===se&&n++,n===ue&&n++,n>86){if(i)throw"Bad character: "+e;n=65,i=!0}r+=1e5}return r}(r.charAt(1),u);l<me(s);)l+=2e6;var h=n-a;if(h%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+e;var f,d,p,v=h/2,y=0,g=0;return v>0&&(f=1e5/Math.pow(10,v),d=e.substring(a,a+v),y=parseFloat(d)*f,p=e.substring(a+v),g=parseFloat(p)*f),{easting:y+c,northing:g+l,zoneLetter:s,zoneNumber:o,accuracy:f}}function me(e){var t;switch(e){case"C":t=11e5;break;case"D":t=2e6;break;case"E":t=28e5;break;case"F":t=37e5;break;case"G":t=46e5;break;case"H":t=55e5;break;case"J":t=64e5;break;case"K":t=73e5;break;case"L":t=82e5;break;case"M":t=91e5;break;case"N":t=0;break;case"P":t=8e5;break;case"Q":t=17e5;break;case"R":t=26e5;break;case"S":t=35e5;break;case"T":t=44e5;break;case"U":t=53e5;break;case"V":t=62e5;break;case"W":t=7e6;break;case"X":t=79e5;break;default:t=-1}if(t>=0)return t;throw"Invalid zone letter: "+e}function be(e,t,n){if(!(this instanceof be))return new be(e,t,n);if(Array.isArray(e))this.x=e[0],this.y=e[1],this.z=e[2]||0;else if("object"===typeof e)this.x=e.x,this.y=e.y,this.z=e.z||0;else if("string"===typeof e&&"undefined"===typeof t){var r=e.split(",");this.x=parseFloat(r[0],10),this.y=parseFloat(r[1],10),this.z=parseFloat(r[2],10)||0}else this.x=e,this.y=t,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}be.fromMGRS=function(e){return new be(he(e))},be.prototype.toMGRS=function(e){return le([this.x,this.y],e)};var _e=be,we=.01068115234375,xe=function(e){var t=[];t[0]=1-e*(.25+e*(.046875+e*(.01953125+e*we))),t[1]=e*(.75-e*(.046875+e*(.01953125+e*we)));var n=e*e;return t[2]=n*(.46875-e*(.013020833333333334+.007120768229166667*e)),n*=e,t[3]=n*(.3645833333333333-.005696614583333333*e),t[4]=n*e*.3076171875,t},Te=function(e,t,n,r){return n*=t,t*=t,r[0]*e-n*(r[1]+t*(r[2]+t*(r[3]+t*r[4])))},Se=function(e,t,n){for(var r=1/(1-t),i=e,a=20;a;--a){var o=Math.sin(i),s=1-t*o*o;if(i-=s=(Te(i,o,Math.cos(i),n)-e)*(s*Math.sqrt(s))*r,Math.abs(s)<1e-10)return i}return i};var ke={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=xe(this.es),this.ml0=Te(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(e){var t,n,r,i=e.x,a=e.y,o=A(i-this.long0),s=Math.sin(a),u=Math.cos(a);if(this.es){var c=u*o,l=Math.pow(c,2),h=this.ep2*Math.pow(u,2),f=Math.pow(h,2),d=Math.abs(u)>1e-10?Math.tan(a):0,p=Math.pow(d,2),v=Math.pow(p,2);t=1-this.es*Math.pow(s,2),c/=Math.sqrt(t);var y=Te(a,s,u,this.en);n=this.a*(this.k0*c*(1+l/6*(1-p+h+l/20*(5-18*p+v+14*h-58*p*h+l/42*(61+179*v-v*p-479*p)))))+this.x0,r=this.a*(this.k0*(y-this.ml0+s*o*c/2*(1+l/12*(5-p+9*h+4*f+l/30*(61+v-58*p+270*h-330*p*h+l/56*(1385+543*v-v*p-3111*p))))))+this.y0}else{var g=u*Math.sin(o);if(Math.abs(Math.abs(g)-1)<1e-10)return 93;if(n=.5*this.a*this.k0*Math.log((1+g)/(1-g))+this.x0,r=u*Math.cos(o)/Math.sqrt(1-Math.pow(g,2)),(g=Math.abs(r))>=1){if(g-1>1e-10)return 93;r=0}else r=Math.acos(r);a<0&&(r=-r),r=this.a*this.k0*(r-this.lat0)+this.y0}return e.x=n,e.y=r,e},inverse:function(e){var t,n,r,a,o=(e.x-this.x0)*(1/this.a),s=(e.y-this.y0)*(1/this.a);if(this.es)if(t=this.ml0+s/this.k0,n=Se(t,this.es,this.en),Math.abs(n)<i){var u=Math.sin(n),c=Math.cos(n),l=Math.abs(c)>1e-10?Math.tan(n):0,h=this.ep2*Math.pow(c,2),f=Math.pow(h,2),d=Math.pow(l,2),p=Math.pow(d,2);t=1-this.es*Math.pow(u,2);var v=o*Math.sqrt(t)/this.k0,y=Math.pow(v,2);r=n-(t*=l)*y/(1-this.es)*.5*(1-y/12*(5+3*d-9*h*d+h-4*f-y/30*(61+90*d-252*h*d+45*p+46*h-y/56*(1385+3633*d+4095*p+1574*p*d)))),a=A(this.long0+v*(1-y/6*(1+2*d+h-y/20*(5+28*d+24*p+8*h*d+6*h-y/42*(61+662*d+1320*p+720*p*d))))/c)}else r=i*C(s),a=0;else{var g=Math.exp(o/this.k0),m=.5*(g-1/g),b=this.lat0+s/this.k0,_=Math.cos(b);t=Math.sqrt((1-Math.pow(_,2))/(1+Math.pow(m,2))),r=Math.asin(t),s<0&&(r=-r),a=0===m&&0===_?0:A(Math.atan2(m,_)+this.long0)}return e.x=a,e.y=r,e},names:["Transverse_Mercator","Transverse Mercator","tmerc"]},Me=function(e){var t=Math.exp(e);return t=(t-1/t)/2},Pe=function(e,t){e=Math.abs(e),t=Math.abs(t);var n=Math.max(e,t),r=Math.min(e,t)/(n||1);return n*Math.sqrt(1+Math.pow(r,2))},Ie=function(e){var t=Math.abs(e);return t=function(e){var t=1+e,n=t-1;return 0===n?e:e*Math.log(t)/n}(t*(1+t/(Pe(1,t)+1))),e<0?-t:t},je=function(e,t){for(var n,r=2*Math.cos(2*t),i=e.length-1,a=e[i],o=0;--i>=0;)n=r*a-o+e[i],o=a,a=n;return t+n*Math.sin(2*t)},Oe=function(e,t,n){for(var r,i,a=Math.sin(t),o=Math.cos(t),s=Me(n),u=function(e){var t=Math.exp(e);return t=(t+1/t)/2}(n),c=2*o*u,l=-2*a*s,h=e.length-1,f=e[h],d=0,p=0,v=0;--h>=0;)r=p,i=d,f=c*(p=f)-r-l*(d=v)+e[h],v=l*p-i+c*d;return[(c=a*u)*f-(l=o*s)*v,c*v+l*f]};var Re={init:function(){if(void 0===this.es||this.es<=0)throw new Error("incorrect elliptical usage");this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var e=this.es/(1+Math.sqrt(1-this.es)),t=e/(2-e),n=t;this.cgb[0]=t*(2+t*(-2/3+t*(t*(116/45+t*(26/45+t*(-2854/675)))-2))),this.cbg[0]=t*(t*(2/3+t*(4/3+t*(-82/45+t*(32/45+t*(4642/4725)))))-2),n*=t,this.cgb[1]=n*(7/3+t*(t*(-227/45+t*(2704/315+t*(2323/945)))-1.6)),this.cbg[1]=n*(5/3+t*(-16/15+t*(-13/9+t*(904/315+t*(-1522/945))))),n*=t,this.cgb[2]=n*(56/15+t*(-136/35+t*(-1262/105+t*(73814/2835)))),this.cbg[2]=n*(-26/15+t*(34/21+t*(1.6+t*(-12686/2835)))),n*=t,this.cgb[3]=n*(4279/630+t*(-332/35+t*(-399572/14175))),this.cbg[3]=n*(1237/630+t*(t*(-24832/14175)-2.4)),n*=t,this.cgb[4]=n*(4174/315+t*(-144838/6237)),this.cbg[4]=n*(-734/315+t*(109598/31185)),n*=t,this.cgb[5]=n*(601676/22275),this.cbg[5]=n*(444337/155925),n=Math.pow(t,2),this.Qn=this.k0/(1+t)*(1+n*(1/4+n*(1/64+n/256))),this.utg[0]=t*(t*(2/3+t*(-37/96+t*(1/360+t*(81/512+t*(-96199/604800)))))-.5),this.gtu[0]=t*(.5+t*(-2/3+t*(5/16+t*(41/180+t*(-127/288+t*(7891/37800)))))),this.utg[1]=n*(-1/48+t*(-1/15+t*(437/1440+t*(-46/105+t*(1118711/3870720))))),this.gtu[1]=n*(13/48+t*(t*(557/1440+t*(281/630+t*(-1983433/1935360)))-.6)),n*=t,this.utg[2]=n*(-17/480+t*(37/840+t*(209/4480+t*(-5569/90720)))),this.gtu[2]=n*(61/240+t*(-103/140+t*(15061/26880+t*(167603/181440)))),n*=t,this.utg[3]=n*(-4397/161280+t*(11/504+t*(830251/7257600))),this.gtu[3]=n*(49561/161280+t*(-179/168+t*(6601661/7257600))),n*=t,this.utg[4]=n*(-4583/161280+t*(108847/3991680)),this.gtu[4]=n*(34729/80640+t*(-3418889/1995840)),n*=t,this.utg[5]=n*(-20648693/638668800),this.gtu[5]=.6650675310896665*n;var r=je(this.cbg,this.lat0);this.Zb=-this.Qn*(r+function(e,t){for(var n,r=2*Math.cos(t),i=e.length-1,a=e[i],o=0;--i>=0;)n=r*a-o+e[i],o=a,a=n;return Math.sin(t)*n}(this.gtu,2*r))},forward:function(e){var t=A(e.x-this.long0),n=e.y;n=je(this.cbg,n);var r=Math.sin(n),i=Math.cos(n),a=Math.sin(t),o=Math.cos(t);n=Math.atan2(r,o*i),t=Math.atan2(a*i,Pe(r,i*o)),t=Ie(Math.tan(t));var s,u,c=Oe(this.gtu,2*n,2*t);return n+=c[0],t+=c[1],Math.abs(t)<=2.623395162778?(s=this.a*(this.Qn*t)+this.x0,u=this.a*(this.Qn*n+this.Zb)+this.y0):(s=1/0,u=1/0),e.x=s,e.y=u,e},inverse:function(e){var t,n,r=(e.x-this.x0)*(1/this.a),i=(e.y-this.y0)*(1/this.a);if(i=(i-this.Zb)/this.Qn,r/=this.Qn,Math.abs(r)<=2.623395162778){var a=Oe(this.utg,2*i,2*r);i+=a[0],r+=a[1],r=Math.atan(Me(r));var o=Math.sin(i),s=Math.cos(i),u=Math.sin(r),c=Math.cos(r);i=Math.atan2(o*c,Pe(u,c*s)),r=Math.atan2(u,c*s),t=A(r+this.long0),n=je(this.cgb,i)}else t=1/0,n=1/0;return e.x=t,e.y=n,e},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc"]};var Ne={init:function(){var e=function(e,t){if(void 0===e){if((e=Math.floor(30*(A(t)+Math.PI)/Math.PI)+1)<0)return 0;if(e>60)return 60}return e}(this.zone,this.long0);if(void 0===e)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(e)-183)*a,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Re.init.apply(this),this.forward=Re.forward,this.inverse=Re.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"},Ce=function(e,t){return Math.pow((1-e)/(1+e),t)};var Ae={init:function(){var e=Math.sin(this.lat0),t=Math.cos(this.lat0);t*=t,this.rc=Math.sqrt(1-this.es)/(1-this.es*e*e),this.C=Math.sqrt(1+this.es*t*t/(1-this.es)),this.phic0=Math.asin(e/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+s)/(Math.pow(Math.tan(.5*this.lat0+s),this.C)*Ce(this.e*e,this.ratexp))},forward:function(e){var t=e.x,n=e.y;return e.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*n+s),this.C)*Ce(this.e*Math.sin(n),this.ratexp))-i,e.x=this.C*t,e},inverse:function(e){for(var t=e.x/this.C,n=e.y,r=Math.pow(Math.tan(.5*n+s)/this.K,1/this.C),a=20;a>0&&(n=2*Math.atan(r*Ce(this.e*Math.sin(e.y),-.5*this.e))-i,!(Math.abs(n-e.y)<1e-14));--a)e.y=n;return a?(e.x=t,e.y=n,e):null},names:["gauss"]};var Ee={init:function(){Ae.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(e){var t,n,r,i;return e.x=A(e.x-this.long0),Ae.forward.apply(this,[e]),t=Math.sin(e.y),n=Math.cos(e.y),r=Math.cos(e.x),i=this.k0*this.R2/(1+this.sinc0*t+this.cosc0*n*r),e.x=i*n*Math.sin(e.x),e.y=i*(this.cosc0*t-this.sinc0*n*r),e.x=this.a*e.x+this.x0,e.y=this.a*e.y+this.y0,e},inverse:function(e){var t,n,r,i,a;if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,a=Math.sqrt(e.x*e.x+e.y*e.y)){var o=2*Math.atan2(a,this.R2);t=Math.sin(o),n=Math.cos(o),i=Math.asin(n*this.sinc0+e.y*t*this.cosc0/a),r=Math.atan2(e.x*t,a*this.cosc0*n-e.y*this.sinc0*t)}else i=this.phic0,r=0;return e.x=r,e.y=i,Ae.inverse.apply(this,[e]),e.x=A(e.x+this.long0),e},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]};var De={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*(1+C(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=1e-10&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=1e-10&&(this.k0=.5*this.cons*N(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/E(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=N(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-i,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(e){var t,n,r,a,o,s,u=e.x,c=e.y,l=Math.sin(c),h=Math.cos(c),f=A(u-this.long0);return Math.abs(Math.abs(u-this.long0)-Math.PI)<=1e-10&&Math.abs(c+this.lat0)<=1e-10?(e.x=NaN,e.y=NaN,e):this.sphere?(t=2*this.k0/(1+this.sinlat0*l+this.coslat0*h*Math.cos(f)),e.x=this.a*t*h*Math.sin(f)+this.x0,e.y=this.a*t*(this.coslat0*l-this.sinlat0*h*Math.cos(f))+this.y0,e):(n=2*Math.atan(this.ssfn_(c,l,this.e))-i,a=Math.cos(n),r=Math.sin(n),Math.abs(this.coslat0)<=1e-10?(o=E(this.e,c*this.con,this.con*l),s=2*this.a*this.k0*o/this.cons,e.x=this.x0+s*Math.sin(u-this.long0),e.y=this.y0-this.con*s*Math.cos(u-this.long0),e):(Math.abs(this.sinlat0)<1e-10?(t=2*this.a*this.k0/(1+a*Math.cos(f)),e.y=t*r):(t=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*a*Math.cos(f))),e.y=t*(this.cosX0*r-this.sinX0*a*Math.cos(f))+this.y0),e.x=t*a*Math.sin(f)+this.x0,e))},inverse:function(e){var t,n,r,a,o;e.x-=this.x0,e.y-=this.y0;var s=Math.sqrt(e.x*e.x+e.y*e.y);if(this.sphere){var u=2*Math.atan(s/(2*this.a*this.k0));return t=this.long0,n=this.lat0,s<=1e-10?(e.x=t,e.y=n,e):(n=Math.asin(Math.cos(u)*this.sinlat0+e.y*Math.sin(u)*this.coslat0/s),t=Math.abs(this.coslat0)<1e-10?this.lat0>0?A(this.long0+Math.atan2(e.x,-1*e.y)):A(this.long0+Math.atan2(e.x,e.y)):A(this.long0+Math.atan2(e.x*Math.sin(u),s*this.coslat0*Math.cos(u)-e.y*this.sinlat0*Math.sin(u))),e.x=t,e.y=n,e)}if(Math.abs(this.coslat0)<=1e-10){if(s<=1e-10)return n=this.lat0,t=this.long0,e.x=t,e.y=n,e;e.x*=this.con,e.y*=this.con,r=s*this.cons/(2*this.a*this.k0),n=this.con*D(this.e,r),t=this.con*A(this.con*this.long0+Math.atan2(e.x,-1*e.y))}else a=2*Math.atan(s*this.cosX0/(2*this.a*this.k0*this.ms1)),t=this.long0,s<=1e-10?o=this.X0:(o=Math.asin(Math.cos(a)*this.sinX0+e.y*Math.sin(a)*this.cosX0/s),t=A(this.long0+Math.atan2(e.x*Math.sin(a),s*this.cosX0*Math.cos(a)-e.y*this.sinX0*Math.sin(a)))),n=-1*D(this.e,Math.tan(.5*(i+o)));return e.x=t,e.y=n,e},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(e,t,n){return t*=n,Math.tan(.5*(i+e))*Math.pow((1-t)/(1+t),.5*n)}};var Le={init:function(){var e=this.lat0;this.lambda0=this.long0;var t=Math.sin(e),n=this.a,r=1/this.rf,i=2*r-Math.pow(r,2),a=this.e=Math.sqrt(i);this.R=this.k0*n*Math.sqrt(1-i)/(1-i*Math.pow(t,2)),this.alpha=Math.sqrt(1+i/(1-i)*Math.pow(Math.cos(e),4)),this.b0=Math.asin(t/this.alpha);var o=Math.log(Math.tan(Math.PI/4+this.b0/2)),s=Math.log(Math.tan(Math.PI/4+e/2)),u=Math.log((1+a*t)/(1-a*t));this.K=o-this.alpha*s+this.alpha*a/2*u},forward:function(e){var t=Math.log(Math.tan(Math.PI/4-e.y/2)),n=this.e/2*Math.log((1+this.e*Math.sin(e.y))/(1-this.e*Math.sin(e.y))),r=-this.alpha*(t+n)+this.K,i=2*(Math.atan(Math.exp(r))-Math.PI/4),a=this.alpha*(e.x-this.lambda0),o=Math.atan(Math.sin(a)/(Math.sin(this.b0)*Math.tan(i)+Math.cos(this.b0)*Math.cos(a))),s=Math.asin(Math.cos(this.b0)*Math.sin(i)-Math.sin(this.b0)*Math.cos(i)*Math.cos(a));return e.y=this.R/2*Math.log((1+Math.sin(s))/(1-Math.sin(s)))+this.y0,e.x=this.R*o+this.x0,e},inverse:function(e){for(var t=e.x-this.x0,n=e.y-this.y0,r=t/this.R,i=2*(Math.atan(Math.exp(n/this.R))-Math.PI/4),a=Math.asin(Math.cos(this.b0)*Math.sin(i)+Math.sin(this.b0)*Math.cos(i)*Math.cos(r)),o=Math.atan(Math.sin(r)/(Math.cos(this.b0)*Math.cos(r)-Math.sin(this.b0)*Math.tan(i))),s=this.lambda0+o/this.alpha,u=0,c=a,l=-1e3,h=0;Math.abs(c-l)>1e-7;){if(++h>20)return;u=1/this.alpha*(Math.log(Math.tan(Math.PI/4+a/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(c))/2)),l=c,c=2*Math.atan(Math.exp(u))-Math.PI/2}return e.x=s,e.y=c,e},names:["somerc"]};var Be={init:function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var e=Math.sin(this.lat0),t=Math.cos(this.lat0),n=this.e*e;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(t,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-n*n);var r,i,a=E(this.e,this.lat0,e),o=this.bl/t*Math.sqrt((1-this.es)/(1-n*n));if(o*o<1&&(o=1),isNaN(this.longc)){var s=E(this.e,this.lat1,Math.sin(this.lat1)),u=E(this.e,this.lat2,Math.sin(this.lat2));this.lat0>=0?this.el=(o+Math.sqrt(o*o-1))*Math.pow(a,this.bl):this.el=(o-Math.sqrt(o*o-1))*Math.pow(a,this.bl);var c=Math.pow(s,this.bl),l=Math.pow(u,this.bl);i=.5*((r=this.el/c)-1/r);var h=(this.el*this.el-l*c)/(this.el*this.el+l*c),f=(l-c)/(l+c),d=A(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(h*Math.tan(.5*this.bl*d)/f)/this.bl,this.long0=A(this.long0);var p=A(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*p)/i),this.alpha=Math.asin(o*Math.sin(this.gamma0))}else r=this.lat0>=0?o+Math.sqrt(o*o-1):o-Math.sqrt(o*o-1),this.el=r*Math.pow(a,this.bl),i=.5*(r-1/r),this.gamma0=Math.asin(Math.sin(this.alpha)/o),this.long0=this.longc-Math.asin(i*Math.tan(this.gamma0))/this.bl;this.no_off?this.uc=0:this.lat0>=0?this.uc=this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha)):this.uc=-1*this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha))},forward:function(e){var t,n,r,a=e.x,o=e.y,u=A(a-this.long0);if(Math.abs(Math.abs(o)-i)<=1e-10)r=o>0?-1:1,n=this.al/this.bl*Math.log(Math.tan(s+r*this.gamma0*.5)),t=-1*r*i*this.al/this.bl;else{var c=E(this.e,o,Math.sin(o)),l=this.el/Math.pow(c,this.bl),h=.5*(l-1/l),f=.5*(l+1/l),d=Math.sin(this.bl*u),p=(h*Math.sin(this.gamma0)-d*Math.cos(this.gamma0))/f;n=Math.abs(Math.abs(p)-1)<=1e-10?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-p)/(1+p))/this.bl,t=Math.abs(Math.cos(this.bl*u))<=1e-10?this.al*this.bl*u:this.al*Math.atan2(h*Math.cos(this.gamma0)+d*Math.sin(this.gamma0),Math.cos(this.bl*u))/this.bl}return this.no_rot?(e.x=this.x0+t,e.y=this.y0+n):(t-=this.uc,e.x=this.x0+n*Math.cos(this.alpha)+t*Math.sin(this.alpha),e.y=this.y0+t*Math.cos(this.alpha)-n*Math.sin(this.alpha)),e},inverse:function(e){var t,n;this.no_rot?(n=e.y-this.y0,t=e.x-this.x0):(n=(e.x-this.x0)*Math.cos(this.alpha)-(e.y-this.y0)*Math.sin(this.alpha),t=(e.y-this.y0)*Math.cos(this.alpha)+(e.x-this.x0)*Math.sin(this.alpha),t+=this.uc);var r=Math.exp(-1*this.bl*n/this.al),a=.5*(r-1/r),o=.5*(r+1/r),s=Math.sin(this.bl*t/this.al),u=(s*Math.cos(this.gamma0)+a*Math.sin(this.gamma0))/o,c=Math.pow(this.el/Math.sqrt((1+u)/(1-u)),1/this.bl);return Math.abs(u-1)<1e-10?(e.x=this.long0,e.y=i):Math.abs(u+1)<1e-10?(e.x=this.long0,e.y=-1*i):(e.y=D(this.e,c),e.x=A(this.long0-Math.atan2(a*Math.cos(this.gamma0)-s*Math.sin(this.gamma0),Math.cos(this.bl*t/this.al))/this.bl)),e},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]};var Fe={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<1e-10)){var e=this.b/this.a;this.e=Math.sqrt(1-e*e);var t=Math.sin(this.lat1),n=Math.cos(this.lat1),r=N(this.e,t,n),i=E(this.e,this.lat1,t),a=Math.sin(this.lat2),o=Math.cos(this.lat2),s=N(this.e,a,o),u=E(this.e,this.lat2,a),c=E(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>1e-10?this.ns=Math.log(r/s)/Math.log(i/u):this.ns=t,isNaN(this.ns)&&(this.ns=t),this.f0=r/(this.ns*Math.pow(i,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(e){var t=e.x,n=e.y;Math.abs(2*Math.abs(n)-Math.PI)<=1e-10&&(n=C(n)*(i-2e-10));var r,a,o=Math.abs(Math.abs(n)-i);if(o>1e-10)r=E(this.e,n,Math.sin(n)),a=this.a*this.f0*Math.pow(r,this.ns);else{if((o=n*this.ns)<=0)return null;a=0}var s=this.ns*A(t-this.long0);return e.x=this.k0*(a*Math.sin(s))+this.x0,e.y=this.k0*(this.rh-a*Math.cos(s))+this.y0,e},inverse:function(e){var t,n,r,a,o,s=(e.x-this.x0)/this.k0,u=this.rh-(e.y-this.y0)/this.k0;this.ns>0?(t=Math.sqrt(s*s+u*u),n=1):(t=-Math.sqrt(s*s+u*u),n=-1);var c=0;if(0!==t&&(c=Math.atan2(n*s,n*u)),0!==t||this.ns>0){if(n=1/this.ns,r=Math.pow(t/(this.a*this.f0),n),-9999===(a=D(this.e,r)))return null}else a=-i;return o=A(c/this.ns+this.long0),e.x=o,e.y=a,e},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]};var Ue={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(e){var t,n,r,i,a,o,s,u=e.x,c=e.y,l=A(u-this.long0);return t=Math.pow((1+this.e*Math.sin(c))/(1-this.e*Math.sin(c)),this.alfa*this.e/2),n=2*(Math.atan(this.k*Math.pow(Math.tan(c/2+this.s45),this.alfa)/t)-this.s45),r=-l*this.alfa,i=Math.asin(Math.cos(this.ad)*Math.sin(n)+Math.sin(this.ad)*Math.cos(n)*Math.cos(r)),a=Math.asin(Math.cos(n)*Math.sin(r)/Math.cos(i)),o=this.n*a,s=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(i/2+this.s45),this.n),e.y=s*Math.cos(o)/1,e.x=s*Math.sin(o)/1,this.czech||(e.y*=-1,e.x*=-1),e},inverse:function(e){var t,n,r,i,a,o,s,u=e.x;e.x=e.y,e.y=u,this.czech||(e.y*=-1,e.x*=-1),a=Math.sqrt(e.x*e.x+e.y*e.y),i=Math.atan2(e.y,e.x)/Math.sin(this.s0),r=2*(Math.atan(Math.pow(this.ro0/a,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),t=Math.asin(Math.cos(this.ad)*Math.sin(r)-Math.sin(this.ad)*Math.cos(r)*Math.cos(i)),n=Math.asin(Math.cos(r)*Math.sin(i)/Math.cos(t)),e.x=this.long0-n/this.alfa,o=t,s=0;var c=0;do{e.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(t/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(o))/(1-this.e*Math.sin(o)),this.e/2))-this.s45),Math.abs(o-e.y)<1e-10&&(s=1),o=e.y,c+=1}while(0===s&&c<15);return c>=15?null:e},names:["Krovak","krovak"]},qe=function(e,t,n,r,i){return e*i-t*Math.sin(2*i)+n*Math.sin(4*i)-r*Math.sin(6*i)},Ge=function(e){return 1-.25*e*(1+e/16*(3+1.25*e))},ze=function(e){return.375*e*(1+.25*e*(1+.46875*e))},We=function(e){return.05859375*e*e*(1+.75*e)},Ve=function(e){return e*e*e*(35/3072)},He=function(e,t,n){var r=t*n;return e/Math.sqrt(1-r*r)},Xe=function(e){return Math.abs(e)<i?e:e-C(e)*Math.PI},Qe=function(e,t,n,r,i){var a,o;a=e/t;for(var s=0;s<15;s++)if(a+=o=(e-(t*a-n*Math.sin(2*a)+r*Math.sin(4*a)-i*Math.sin(6*a)))/(t-2*n*Math.cos(2*a)+4*r*Math.cos(4*a)-6*i*Math.cos(6*a)),Math.abs(o)<=1e-10)return a;return NaN};var Ye={init:function(){this.sphere||(this.e0=Ge(this.es),this.e1=ze(this.es),this.e2=We(this.es),this.e3=Ve(this.es),this.ml0=this.a*qe(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(e){var t,n,r=e.x,i=e.y;if(r=A(r-this.long0),this.sphere)t=this.a*Math.asin(Math.cos(i)*Math.sin(r)),n=this.a*(Math.atan2(Math.tan(i),Math.cos(r))-this.lat0);else{var a=Math.sin(i),o=Math.cos(i),s=He(this.a,this.e,a),u=Math.tan(i)*Math.tan(i),c=r*Math.cos(i),l=c*c,h=this.es*o*o/(1-this.es);t=s*c*(1-l*u*(1/6-(8-u+8*h)*l/120)),n=this.a*qe(this.e0,this.e1,this.e2,this.e3,i)-this.ml0+s*a/o*l*(.5+(5-u+6*h)*l/24)}return e.x=t+this.x0,e.y=n+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,n,r=e.x/this.a,a=e.y/this.a;if(this.sphere){var o=a+this.lat0;t=Math.asin(Math.sin(o)*Math.cos(r)),n=Math.atan2(Math.tan(r),Math.cos(o))}else{var s=this.ml0/this.a+a,u=Qe(s,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(u)-i)<=1e-10)return e.x=this.long0,e.y=i,a<0&&(e.y*=-1),e;var c=He(this.a,this.e,Math.sin(u)),l=c*c*c/this.a/this.a*(1-this.es),h=Math.pow(Math.tan(u),2),f=r*this.a/c,d=f*f;t=u-c*Math.tan(u)/l*f*f*(.5-(1+3*h)*f*f/24),n=f*(1-d*(h/3+(1+3*h)*h*d/15))/Math.cos(u)}return e.x=A(n+this.long0),e.y=Xe(t),e},names:["Cassini","Cassini_Soldner","cass"]},Je=function(e,t){var n;return e>1e-7?(1-e*e)*(t/(1-(n=e*t)*n)-.5/e*Math.log((1-n)/(1+n))):2*t};var Ke={init:function(){var e,t=Math.abs(this.lat0);if(Math.abs(t-i)<1e-10?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<1e-10?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=Je(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(e){var t,n=[];return n[0]=.3333333333333333*e,t=e*e,n[0]+=.17222222222222222*t,n[1]=.06388888888888888*t,t*=e,n[0]+=.10257936507936508*t,n[1]+=.0664021164021164*t,n[2]=.016415012942191543*t,n}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=Je(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(e){var t,n,r,a,o,u,c,l,h,f,d=e.x,p=e.y;if(d=A(d-this.long0),this.sphere){if(o=Math.sin(p),f=Math.cos(p),r=Math.cos(d),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((n=this.mode===this.EQUIT?1+f*r:1+this.sinph0*o+this.cosph0*f*r)<=1e-10)return null;t=(n=Math.sqrt(2/n))*f*Math.sin(d),n*=this.mode===this.EQUIT?o:this.cosph0*o-this.sinph0*f*r}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(r=-r),Math.abs(p+this.phi0)<1e-10)return null;n=s-.5*p,t=(n=2*(this.mode===this.S_POLE?Math.cos(n):Math.sin(n)))*Math.sin(d),n*=r}}else{switch(c=0,l=0,h=0,r=Math.cos(d),a=Math.sin(d),o=Math.sin(p),u=Je(this.e,o),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(c=u/this.qp,l=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:h=1+this.sinb1*c+this.cosb1*l*r;break;case this.EQUIT:h=1+l*r;break;case this.N_POLE:h=i+p,u=this.qp-u;break;case this.S_POLE:h=p-i,u=this.qp+u}if(Math.abs(h)<1e-10)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:h=Math.sqrt(2/h),n=this.mode===this.OBLIQ?this.ymf*h*(this.cosb1*c-this.sinb1*l*r):(h=Math.sqrt(2/(1+l*r)))*c*this.ymf,t=this.xmf*h*l*a;break;case this.N_POLE:case this.S_POLE:u>=0?(t=(h=Math.sqrt(u))*a,n=r*(this.mode===this.S_POLE?h:-h)):t=n=0}}return e.x=this.a*t+this.x0,e.y=this.a*n+this.y0,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t,n,r,a,o,s,u,c=e.x/this.a,l=e.y/this.a;if(this.sphere){var h,f=0,d=0;if((n=.5*(h=Math.sqrt(c*c+l*l)))>1)return null;switch(n=2*Math.asin(n),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(d=Math.sin(n),f=Math.cos(n)),this.mode){case this.EQUIT:n=Math.abs(h)<=1e-10?0:Math.asin(l*d/h),c*=d,l=f*h;break;case this.OBLIQ:n=Math.abs(h)<=1e-10?this.phi0:Math.asin(f*this.sinph0+l*d*this.cosph0/h),c*=d*this.cosph0,l=(f-Math.sin(n)*this.sinph0)*h;break;case this.N_POLE:l=-l,n=i-n;break;case this.S_POLE:n-=i}t=0!==l||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(c,l):0}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(c/=this.dd,l*=this.dd,(s=Math.sqrt(c*c+l*l))<1e-10)return e.x=0,e.y=this.phi0,e;a=2*Math.asin(.5*s/this.rq),r=Math.cos(a),c*=a=Math.sin(a),this.mode===this.OBLIQ?(u=r*this.sinb1+l*a*this.cosb1/s,o=this.qp*u,l=s*this.cosb1*r-l*this.sinb1*a):(u=l*a/s,o=this.qp*u,l=s*r)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),!(o=c*c+l*l))return e.x=0,e.y=this.phi0,e;u=1-o/this.qp,this.mode===this.S_POLE&&(u=-u)}t=Math.atan2(c,l),n=function(e,t){var n=e+e;return e+t[0]*Math.sin(n)+t[1]*Math.sin(n+n)+t[2]*Math.sin(n+n+n)}(Math.asin(u),this.apa)}return e.x=A(this.long0+t),e.y=n,e},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4},Ze=function(e){return Math.abs(e)>1&&(e=e>1?1:-1),Math.asin(e)};var $e={init:function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=N(this.e3,this.sin_po,this.cos_po),this.qs1=Je(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=N(this.e3,this.sin_po,this.cos_po),this.qs2=Je(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=Je(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>1e-10?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(e){var t=e.x,n=e.y;this.sin_phi=Math.sin(n),this.cos_phi=Math.cos(n);var r=Je(this.e3,this.sin_phi,this.cos_phi),i=this.a*Math.sqrt(this.c-this.ns0*r)/this.ns0,a=this.ns0*A(t-this.long0),o=i*Math.sin(a)+this.x0,s=this.rh-i*Math.cos(a)+this.y0;return e.x=o,e.y=s,e},inverse:function(e){var t,n,r,i,a,o;return e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns0>=0?(t=Math.sqrt(e.x*e.x+e.y*e.y),r=1):(t=-Math.sqrt(e.x*e.x+e.y*e.y),r=-1),i=0,0!==t&&(i=Math.atan2(r*e.x,r*e.y)),r=t*this.ns0/this.a,this.sphere?o=Math.asin((this.c-r*r)/(2*this.ns0)):(n=(this.c-r*r)/this.ns0,o=this.phi1z(this.e3,n)),a=A(i/this.ns0+this.long0),e.x=a,e.y=o,e},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(e,t){var n,r,i,a,o=Ze(.5*t);if(e<1e-10)return o;for(var s=e*e,u=1;u<=25;u++)if(o+=a=.5*(i=1-(r=e*(n=Math.sin(o)))*r)*i/Math.cos(o)*(t/(1-s)-n/i+.5/e*Math.log((1-r)/(1+r))),Math.abs(a)<=1e-7)return o;return null}};var et={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(e){var t,n,r,i,a,o,s,u=e.x,c=e.y;return r=A(u-this.long0),t=Math.sin(c),n=Math.cos(c),i=Math.cos(r),1,(a=this.sin_p14*t+this.cos_p14*n*i)>0||Math.abs(a)<=1e-10?(o=this.x0+1*this.a*n*Math.sin(r)/a,s=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*n*i)/a):(o=this.x0+this.infinity_dist*n*Math.sin(r),s=this.y0+this.infinity_dist*(this.cos_p14*t-this.sin_p14*n*i)),e.x=o,e.y=s,e},inverse:function(e){var t,n,r,i,a,o;return e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,e.x/=this.k0,e.y/=this.k0,(t=Math.sqrt(e.x*e.x+e.y*e.y))?(i=Math.atan2(t,this.rc),n=Math.sin(i),r=Math.cos(i),o=Ze(r*this.sin_p14+e.y*n*this.cos_p14/t),a=Math.atan2(e.x*n,t*this.cos_p14*r-e.y*this.sin_p14*n),a=A(this.long0+a)):(o=this.phic0,a=0),e.x=a,e.y=o,e},names:["gnom"]};var tt={init:function(){this.sphere||(this.k0=N(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(e){var t,n,r=e.x,i=e.y,a=A(r-this.long0);if(this.sphere)t=this.x0+this.a*a*Math.cos(this.lat_ts),n=this.y0+this.a*Math.sin(i)/Math.cos(this.lat_ts);else{var o=Je(this.e,Math.sin(i));t=this.x0+this.a*this.k0*a,n=this.y0+this.a*o*.5/this.k0}return e.x=t,e.y=n,e},inverse:function(e){var t,n;return e.x-=this.x0,e.y-=this.y0,this.sphere?(t=A(this.long0+e.x/this.a/Math.cos(this.lat_ts)),n=Math.asin(e.y/this.a*Math.cos(this.lat_ts))):(n=function(e,t){var n=1-(1-e*e)/(2*e)*Math.log((1-e)/(1+e));if(Math.abs(Math.abs(t)-n)<1e-6)return t<0?-1*i:i;for(var r,a,o,s,u=Math.asin(.5*t),c=0;c<30;c++)if(a=Math.sin(u),o=Math.cos(u),s=e*a,u+=r=Math.pow(1-s*s,2)/(2*o)*(t/(1-e*e)-a/(1-s*s)+.5/e*Math.log((1-s)/(1+s))),Math.abs(r)<=1e-10)return u;return NaN}(this.e,2*e.y*this.k0/this.a),t=A(this.long0+e.x/(this.a*this.k0))),e.x=t,e.y=n,e},names:["cea"]};var nt={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(e){var t=e.x,n=e.y,r=A(t-this.long0),i=Xe(n-this.lat0);return e.x=this.x0+this.a*r*this.rc,e.y=this.y0+this.a*i,e},inverse:function(e){var t=e.x,n=e.y;return e.x=A(this.long0+(t-this.x0)/(this.a*this.rc)),e.y=Xe(this.lat0+(n-this.y0)/this.a),e},names:["Equirectangular","Equidistant_Cylindrical","eqc"]};var rt={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ge(this.es),this.e1=ze(this.es),this.e2=We(this.es),this.e3=Ve(this.es),this.ml0=this.a*qe(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(e){var t,n,r,i=e.x,a=e.y,o=A(i-this.long0);if(r=o*Math.sin(a),this.sphere)Math.abs(a)<=1e-10?(t=this.a*o,n=-1*this.a*this.lat0):(t=this.a*Math.sin(r)/Math.tan(a),n=this.a*(Xe(a-this.lat0)+(1-Math.cos(r))/Math.tan(a)));else if(Math.abs(a)<=1e-10)t=this.a*o,n=-1*this.ml0;else{var s=He(this.a,this.e,Math.sin(a))/Math.tan(a);t=s*Math.sin(r),n=this.a*qe(this.e0,this.e1,this.e2,this.e3,a)-this.ml0+s*(1-Math.cos(r))}return e.x=t+this.x0,e.y=n+this.y0,e},inverse:function(e){var t,n,r,i,a,o,s,u,c;if(r=e.x-this.x0,i=e.y-this.y0,this.sphere)if(Math.abs(i+this.a*this.lat0)<=1e-10)t=A(r/this.a+this.long0),n=0;else{var l;for(o=this.lat0+i/this.a,s=r*r/this.a/this.a+o*o,u=o,a=20;a;--a)if(u+=c=-1*(o*(u*(l=Math.tan(u))+1)-u-.5*(u*u+s)*l)/((u-o)/l-1),Math.abs(c)<=1e-10){n=u;break}t=A(this.long0+Math.asin(r*Math.tan(u)/this.a)/Math.sin(n))}else if(Math.abs(i+this.ml0)<=1e-10)n=0,t=A(this.long0+r/this.a);else{var h,f,d,p,v;for(o=(this.ml0+i)/this.a,s=r*r/this.a/this.a+o*o,u=o,a=20;a;--a)if(v=this.e*Math.sin(u),h=Math.sqrt(1-v*v)*Math.tan(u),f=this.a*qe(this.e0,this.e1,this.e2,this.e3,u),d=this.e0-2*this.e1*Math.cos(2*u)+4*this.e2*Math.cos(4*u)-6*this.e3*Math.cos(6*u),u-=c=(o*(h*(p=f/this.a)+1)-p-.5*h*(p*p+s))/(this.es*Math.sin(2*u)*(p*p+s-2*o*p)/(4*h)+(o-p)*(h*d-2/Math.sin(2*u))-d),Math.abs(c)<=1e-10){n=u;break}h=Math.sqrt(1-this.es*Math.pow(Math.sin(n),2))*Math.tan(n),t=A(this.long0+Math.asin(r*h/this.a)/Math.sin(n))}return e.x=t,e.y=n,e},names:["Polyconic","poly"]};var it={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(e){var t,n=e.x,i=e.y-this.lat0,a=n-this.long0,o=i/r*1e-5,s=a,u=1,c=0;for(t=1;t<=10;t++)u*=o,c+=this.A[t]*u;var l,h=c,f=s,d=1,p=0,v=0,y=0;for(t=1;t<=6;t++)l=p*h+d*f,d=d*h-p*f,p=l,v=v+this.B_re[t]*d-this.B_im[t]*p,y=y+this.B_im[t]*d+this.B_re[t]*p;return e.x=y*this.a+this.x0,e.y=v*this.a+this.y0,e},inverse:function(e){var t,n,i=e.x,a=e.y,o=i-this.x0,s=(a-this.y0)/this.a,u=o/this.a,c=1,l=0,h=0,f=0;for(t=1;t<=6;t++)n=l*s+c*u,c=c*s-l*u,l=n,h=h+this.C_re[t]*c-this.C_im[t]*l,f=f+this.C_im[t]*c+this.C_re[t]*l;for(var d=0;d<this.iterations;d++){var p,v=h,y=f,g=s,m=u;for(t=2;t<=6;t++)p=y*h+v*f,v=v*h-y*f,y=p,g+=(t-1)*(this.B_re[t]*v-this.B_im[t]*y),m+=(t-1)*(this.B_im[t]*v+this.B_re[t]*y);v=1,y=0;var b=this.B_re[1],_=this.B_im[1];for(t=2;t<=6;t++)p=y*h+v*f,v=v*h-y*f,y=p,b+=t*(this.B_re[t]*v-this.B_im[t]*y),_+=t*(this.B_im[t]*v+this.B_re[t]*y);var w=b*b+_*_;h=(g*b+m*_)/w,f=(m*b-g*_)/w}var x=h,T=f,S=1,k=0;for(t=1;t<=9;t++)S*=x,k+=this.D[t]*S;var M=this.lat0+k*r*1e5,P=this.long0+T;return e.x=P,e.y=M,e},names:["New_Zealand_Map_Grid","nzmg"]};var at={init:function(){},forward:function(e){var t=e.x,n=e.y,r=A(t-this.long0),i=this.x0+this.a*r,a=this.y0+this.a*Math.log(Math.tan(Math.PI/4+n/2.5))*1.25;return e.x=i,e.y=a,e},inverse:function(e){e.x-=this.x0,e.y-=this.y0;var t=A(this.long0+e.x/this.a),n=2.5*(Math.atan(Math.exp(.8*e.y/this.a))-Math.PI/4);return e.x=t,e.y=n,e},names:["Miller_Cylindrical","mill"]};var ot={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=xe(this.es)},forward:function(e){var t,n,r=e.x,i=e.y;if(r=A(r-this.long0),this.sphere){if(this.m)for(var a=this.n*Math.sin(i),o=20;o;--o){var s=(this.m*i+Math.sin(i)-a)/(this.m+Math.cos(i));if(i-=s,Math.abs(s)<1e-10)break}else i=1!==this.n?Math.asin(this.n*Math.sin(i)):i;t=this.a*this.C_x*r*(this.m+Math.cos(i)),n=this.a*this.C_y*i}else{var u=Math.sin(i),c=Math.cos(i);n=this.a*Te(i,u,c,this.en),t=this.a*r*c/Math.sqrt(1-this.es*u*u)}return e.x=t,e.y=n,e},inverse:function(e){var t,n,r,a;return e.x-=this.x0,r=e.x/this.a,e.y-=this.y0,t=e.y/this.a,this.sphere?(t/=this.C_y,r/=this.C_x*(this.m+Math.cos(t)),this.m?t=Ze((this.m*t+Math.sin(t))/this.n):1!==this.n&&(t=Ze(Math.sin(t)/this.n)),r=A(r+this.long0),t=Xe(t)):(t=Se(e.y/this.a,this.es,this.en),(a=Math.abs(t))<i?(a=Math.sin(t),n=this.long0+e.x*Math.sqrt(1-this.es*a*a)/(this.a*Math.cos(t)),r=A(n)):a-1e-10<i&&(r=this.long0)),e.x=r,e.y=t,e},names:["Sinusoidal","sinu"]};var st={init:function(){},forward:function(e){for(var t=e.x,n=e.y,r=A(t-this.long0),i=n,a=Math.PI*Math.sin(n);;){var o=-(i+Math.sin(i)-a)/(1+Math.cos(i));if(i+=o,Math.abs(o)<1e-10)break}i/=2,Math.PI/2-Math.abs(n)<1e-10&&(r=0);var s=.900316316158*this.a*r*Math.cos(i)+this.x0,u=1.4142135623731*this.a*Math.sin(i)+this.y0;return e.x=s,e.y=u,e},inverse:function(e){var t,n;e.x-=this.x0,e.y-=this.y0,n=e.y/(1.4142135623731*this.a),Math.abs(n)>.999999999999&&(n=.999999999999),t=Math.asin(n);var r=A(this.long0+e.x/(.900316316158*this.a*Math.cos(t)));r<-Math.PI&&(r=-Math.PI),r>Math.PI&&(r=Math.PI),n=(2*t+Math.sin(2*t))/Math.PI,Math.abs(n)>1&&(n=1);var i=Math.asin(n);return e.x=r,e.y=i,e},names:["Mollweide","moll"]};var ut={init:function(){Math.abs(this.lat1+this.lat2)<1e-10||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=Ge(this.es),this.e1=ze(this.es),this.e2=We(this.es),this.e3=Ve(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=N(this.e,this.sinphi,this.cosphi),this.ml1=qe(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<1e-10?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=N(this.e,this.sinphi,this.cosphi),this.ml2=qe(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=qe(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(e){var t,n=e.x,r=e.y;if(this.sphere)t=this.a*(this.g-r);else{var i=qe(this.e0,this.e1,this.e2,this.e3,r);t=this.a*(this.g-i)}var a=this.ns*A(n-this.long0),o=this.x0+t*Math.sin(a),s=this.y0+this.rh-t*Math.cos(a);return e.x=o,e.y=s,e},inverse:function(e){var t,n,r,i;e.x-=this.x0,e.y=this.rh-e.y+this.y0,this.ns>=0?(n=Math.sqrt(e.x*e.x+e.y*e.y),t=1):(n=-Math.sqrt(e.x*e.x+e.y*e.y),t=-1);var a=0;if(0!==n&&(a=Math.atan2(t*e.x,t*e.y)),this.sphere)return i=A(this.long0+a/this.ns),r=Xe(this.g-n/this.a),e.x=i,e.y=r,e;var o=this.g-n/this.a;return r=Qe(o,this.e0,this.e1,this.e2,this.e3),i=A(this.long0+a/this.ns),e.x=i,e.y=r,e},names:["Equidistant_Conic","eqdc"]};var ct={init:function(){this.R=this.a},forward:function(e){var t,n,r=e.x,a=e.y,o=A(r-this.long0);Math.abs(a)<=1e-10&&(t=this.x0+this.R*o,n=this.y0);var s=Ze(2*Math.abs(a/Math.PI));(Math.abs(o)<=1e-10||Math.abs(Math.abs(a)-i)<=1e-10)&&(t=this.x0,n=a>=0?this.y0+Math.PI*this.R*Math.tan(.5*s):this.y0+Math.PI*this.R*-Math.tan(.5*s));var u=.5*Math.abs(Math.PI/o-o/Math.PI),c=u*u,l=Math.sin(s),h=Math.cos(s),f=h/(l+h-1),d=f*f,p=f*(2/l-1),v=p*p,y=Math.PI*this.R*(u*(f-v)+Math.sqrt(c*(f-v)*(f-v)-(v+c)*(d-v)))/(v+c);o<0&&(y=-y),t=this.x0+y;var g=c+f;return y=Math.PI*this.R*(p*g-u*Math.sqrt((v+c)*(c+1)-g*g))/(v+c),n=a>=0?this.y0+y:this.y0-y,e.x=t,e.y=n,e},inverse:function(e){var t,n,r,i,a,o,s,u,c,l,h,f;return e.x-=this.x0,e.y-=this.y0,h=Math.PI*this.R,a=(r=e.x/h)*r+(i=e.y/h)*i,h=3*(i*i/(u=-2*(o=-Math.abs(i)*(1+a))+1+2*i*i+a*a)+(2*(s=o-2*i*i+r*r)*s*s/u/u/u-9*o*s/u/u)/27)/(c=(o-s*s/3/u)/u)/(l=2*Math.sqrt(-c/3)),Math.abs(h)>1&&(h=h>=0?1:-1),f=Math.acos(h)/3,n=e.y>=0?(-l*Math.cos(f+Math.PI/3)-s/3/u)*Math.PI:-(-l*Math.cos(f+Math.PI/3)-s/3/u)*Math.PI,t=Math.abs(r)<1e-10?this.long0:A(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(r*r-i*i)+a*a))/2/r),e.x=t,e.y=n,e},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]};var lt={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(e){var t,n,r,a,o,s,u,c,l,h,f,d,p,v,y,g,m,b,_,w,x,T,S=e.x,k=e.y,M=Math.sin(e.y),P=Math.cos(e.y),I=A(S-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=1e-10?(e.x=this.x0+this.a*(i-k)*Math.sin(I),e.y=this.y0-this.a*(i-k)*Math.cos(I),e):Math.abs(this.sin_p12+1)<=1e-10?(e.x=this.x0+this.a*(i+k)*Math.sin(I),e.y=this.y0+this.a*(i+k)*Math.cos(I),e):(b=this.sin_p12*M+this.cos_p12*P*Math.cos(I),m=(g=Math.acos(b))/Math.sin(g),e.x=this.x0+this.a*m*P*Math.sin(I),e.y=this.y0+this.a*m*(this.cos_p12*M-this.sin_p12*P*Math.cos(I)),e):(t=Ge(this.es),n=ze(this.es),r=We(this.es),a=Ve(this.es),Math.abs(this.sin_p12-1)<=1e-10?(o=this.a*qe(t,n,r,a,i),s=this.a*qe(t,n,r,a,k),e.x=this.x0+(o-s)*Math.sin(I),e.y=this.y0-(o-s)*Math.cos(I),e):Math.abs(this.sin_p12+1)<=1e-10?(o=this.a*qe(t,n,r,a,i),s=this.a*qe(t,n,r,a,k),e.x=this.x0+(o+s)*Math.sin(I),e.y=this.y0+(o+s)*Math.cos(I),e):(u=M/P,c=He(this.a,this.e,this.sin_p12),l=He(this.a,this.e,M),h=Math.atan((1-this.es)*u+this.es*c*this.sin_p12/(l*P)),_=0===(f=Math.atan2(Math.sin(I),this.cos_p12*Math.tan(h)-this.sin_p12*Math.cos(I)))?Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.abs(Math.abs(f)-Math.PI)<=1e-10?-Math.asin(this.cos_p12*Math.sin(h)-this.sin_p12*Math.cos(h)):Math.asin(Math.sin(I)*Math.cos(h)/Math.sin(f)),d=this.e*this.sin_p12/Math.sqrt(1-this.es),g=c*_*(1-(w=_*_)*(y=(p=this.e*this.cos_p12*Math.cos(f)/Math.sqrt(1-this.es))*p)*(1-y)/6+(x=w*_)/8*(v=d*p)*(1-2*y)+(T=x*_)/120*(y*(4-7*y)-3*d*d*(1-7*y))-T*_/48*v),e.x=this.x0+g*Math.sin(f),e.y=this.y0+g*Math.cos(f),e))},inverse:function(e){var t,n,r,a,o,s,u,c,l,h,f,d,p,v,y,g,m,b,_,w,x,T;if(e.x-=this.x0,e.y-=this.y0,this.sphere){if((t=Math.sqrt(e.x*e.x+e.y*e.y))>2*i*this.a)return;return n=t/this.a,r=Math.sin(n),a=Math.cos(n),o=this.long0,Math.abs(t)<=1e-10?s=this.lat0:(s=Ze(a*this.sin_p12+e.y*r*this.cos_p12/t),u=Math.abs(this.lat0)-i,o=Math.abs(u)<=1e-10?this.lat0>=0?A(this.long0+Math.atan2(e.x,-e.y)):A(this.long0-Math.atan2(-e.x,e.y)):A(this.long0+Math.atan2(e.x*r,t*this.cos_p12*a-e.y*this.sin_p12*r))),e.x=o,e.y=s,e}return c=Ge(this.es),l=ze(this.es),h=We(this.es),f=Ve(this.es),Math.abs(this.sin_p12-1)<=1e-10?(d=this.a*qe(c,l,h,f,i),t=Math.sqrt(e.x*e.x+e.y*e.y),s=Qe((d-t)/this.a,c,l,h,f),o=A(this.long0+Math.atan2(e.x,-1*e.y)),e.x=o,e.y=s,e):Math.abs(this.sin_p12+1)<=1e-10?(d=this.a*qe(c,l,h,f,i),t=Math.sqrt(e.x*e.x+e.y*e.y),s=Qe((t-d)/this.a,c,l,h,f),o=A(this.long0+Math.atan2(e.x,e.y)),e.x=o,e.y=s,e):(t=Math.sqrt(e.x*e.x+e.y*e.y),y=Math.atan2(e.x,e.y),p=He(this.a,this.e,this.sin_p12),g=Math.cos(y),b=-(m=this.e*this.cos_p12*g)*m/(1-this.es),_=3*this.es*(1-b)*this.sin_p12*this.cos_p12*g/(1-this.es),T=1-b*(x=(w=t/p)-b*(1+b)*Math.pow(w,3)/6-_*(1+3*b)*Math.pow(w,4)/24)*x/2-w*x*x*x/6,v=Math.asin(this.sin_p12*Math.cos(x)+this.cos_p12*Math.sin(x)*g),o=A(this.long0+Math.asin(Math.sin(y)*Math.sin(x)/Math.cos(v))),s=Math.atan((1-this.es*T*this.sin_p12/Math.sin(v))*Math.tan(v)/(1-this.es)),e.x=o,e.y=s,e)},names:["Azimuthal_Equidistant","aeqd"]};var ht={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(e){var t,n,r,i,a,o,s,u=e.x,c=e.y;return r=A(u-this.long0),t=Math.sin(c),n=Math.cos(c),i=Math.cos(r),1,((a=this.sin_p14*t+this.cos_p14*n*i)>0||Math.abs(a)<=1e-10)&&(o=1*this.a*n*Math.sin(r),s=this.y0+1*this.a*(this.cos_p14*t-this.sin_p14*n*i)),e.x=o,e.y=s,e},inverse:function(e){var t,n,r,a,o,s,u;return e.x-=this.x0,e.y-=this.y0,t=Math.sqrt(e.x*e.x+e.y*e.y),n=Ze(t/this.a),r=Math.sin(n),a=Math.cos(n),s=this.long0,Math.abs(t)<=1e-10?(u=this.lat0,e.x=s,e.y=u,e):(u=Ze(a*this.sin_p14+e.y*r*this.cos_p14/t),o=Math.abs(this.lat0)-i,Math.abs(o)<=1e-10?(s=this.lat0>=0?A(this.long0+Math.atan2(e.x,-e.y)):A(this.long0-Math.atan2(-e.x,e.y)),e.x=s,e.y=u,e):(s=A(this.long0+Math.atan2(e.x*r,t*this.cos_p14*a-e.y*this.sin_p14*r)),e.x=s,e.y=u,e))},names:["ortho"]},ft=1,dt=2,pt=3,vt=4,yt=5,gt=6,mt=1,bt=2,_t=3,wt=4;function xt(e,t,n,r){var a;return e<1e-10?(r.value=mt,a=0):(a=Math.atan2(t,n),Math.abs(a)<=s?r.value=mt:a>s&&a<=i+s?(r.value=bt,a-=i):a>i+s||a<=-(i+s)?(r.value=_t,a=a>=0?a-c:a+c):(r.value=wt,a+=i)),a}function Tt(e,t){var n=e+t;return n<-c?n+=u:n>+c&&(n-=u),n}var St={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=i-s/2?this.face=yt:this.lat0<=-(i-s/2)?this.face=gt:Math.abs(this.long0)<=s?this.face=ft:Math.abs(this.long0)<=i+s?this.face=this.long0>0?dt:vt:this.face=pt,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(e){var t,n,r,a,o,u,l={x:0,y:0},h={value:0};if(e.x-=this.long0,t=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(e.y)):e.y,n=e.x,this.face===yt)a=i-t,n>=s&&n<=i+s?(h.value=mt,r=n-i):n>i+s||n<=-(i+s)?(h.value=bt,r=n>0?n-c:n+c):n>-(i+s)&&n<=-s?(h.value=_t,r=n+i):(h.value=wt,r=n);else if(this.face===gt)a=i+t,n>=s&&n<=i+s?(h.value=mt,r=-n+i):n<s&&n>=-s?(h.value=bt,r=-n):n<-s&&n>=-(i+s)?(h.value=_t,r=-n-i):(h.value=wt,r=n>0?-n+c:-n-c);else{var f,d,p,v,y,g;this.face===dt?n=Tt(n,+i):this.face===pt?n=Tt(n,+c):this.face===vt&&(n=Tt(n,-i)),v=Math.sin(t),y=Math.cos(t),g=Math.sin(n),f=y*Math.cos(n),d=y*g,p=v,this.face===ft?r=xt(a=Math.acos(f),p,d,h):this.face===dt?r=xt(a=Math.acos(d),p,-f,h):this.face===pt?r=xt(a=Math.acos(-f),p,-d,h):this.face===vt?r=xt(a=Math.acos(-d),p,f,h):(a=r=0,h.value=mt)}return u=Math.atan(12/c*(r+Math.acos(Math.sin(r)*Math.cos(s))-i)),o=Math.sqrt((1-Math.cos(a))/(Math.cos(u)*Math.cos(u))/(1-Math.cos(Math.atan(1/Math.cos(r))))),h.value===bt?u+=i:h.value===_t?u+=c:h.value===wt&&(u+=1.5*c),l.x=o*Math.cos(u),l.y=o*Math.sin(u),l.x=l.x*this.a+this.x0,l.y=l.y*this.a+this.y0,e.x=l.x,e.y=l.y,e},inverse:function(e){var t,n,r,a,o,s,u,l,h,f,d,p,v={lam:0,phi:0},y={value:0};if(e.x=(e.x-this.x0)/this.a,e.y=(e.y-this.y0)/this.a,n=Math.atan(Math.sqrt(e.x*e.x+e.y*e.y)),t=Math.atan2(e.y,e.x),e.x>=0&&e.x>=Math.abs(e.y)?y.value=mt:e.y>=0&&e.y>=Math.abs(e.x)?(y.value=bt,t-=i):e.x<0&&-e.x>=Math.abs(e.y)?(y.value=_t,t=t<0?t+c:t-c):(y.value=wt,t+=i),h=c/12*Math.tan(t),o=Math.sin(h)/(Math.cos(h)-1/Math.sqrt(2)),s=Math.atan(o),(u=1-(r=Math.cos(t))*r*(a=Math.tan(n))*a*(1-Math.cos(Math.atan(1/Math.cos(s)))))<-1?u=-1:u>1&&(u=1),this.face===yt)l=Math.acos(u),v.phi=i-l,y.value===mt?v.lam=s+i:y.value===bt?v.lam=s<0?s+c:s-c:y.value===_t?v.lam=s-i:v.lam=s;else if(this.face===gt)l=Math.acos(u),v.phi=l-i,y.value===mt?v.lam=-s+i:y.value===bt?v.lam=-s:y.value===_t?v.lam=-s-i:v.lam=s<0?-s-c:-s+c;else{var g,m,b;h=(g=u)*g,m=(h+=(b=h>=1?0:Math.sqrt(1-h)*Math.sin(s))*b)>=1?0:Math.sqrt(1-h),y.value===bt?(h=m,m=-b,b=h):y.value===_t?(m=-m,b=-b):y.value===wt&&(h=m,m=b,b=-h),this.face===dt?(h=g,g=-m,m=h):this.face===pt?(g=-g,m=-m):this.face===vt&&(h=g,g=m,m=-h),v.phi=Math.acos(-b)-i,v.lam=Math.atan2(m,g),this.face===dt?v.lam=Tt(v.lam,-i):this.face===pt?v.lam=Tt(v.lam,-c):this.face===vt&&(v.lam=Tt(v.lam,+i))}return 0!==this.es&&(f=v.phi<0?1:0,d=Math.tan(v.phi),p=this.b/Math.sqrt(d*d+this.one_minus_f_squared),v.phi=Math.atan(Math.sqrt(this.a*this.a-p*p)/(this.one_minus_f*p)),f&&(v.phi=-v.phi)),v.lam+=this.long0,e.x=v.lam,e.y=v.phi,e},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]},kt=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Mt=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],Pt=o/5,It=function(e,t){return e[0]+t*(e[1]+t*(e[2]+t*e[3]))};var jt={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(e){var t=A(e.x-this.long0),n=Math.abs(e.y),r=Math.floor(n*Pt);r<0?r=0:r>=18&&(r=17);var i={x:It(kt[r],n=o*(n-.08726646259971647*r))*t,y:It(Mt[r],n)};return e.y<0&&(i.y=-i.y),i.x=i.x*this.a*.8487+this.x0,i.y=i.y*this.a*1.3523+this.y0,i},inverse:function(e){var t={x:(e.x-this.x0)/(.8487*this.a),y:Math.abs(e.y-this.y0)/(1.3523*this.a)};if(t.y>=1)t.x/=kt[18][0],t.y=e.y<0?-i:i;else{var n=Math.floor(18*t.y);for(n<0?n=0:n>=18&&(n=17);;)if(Mt[n][0]>t.y)--n;else{if(!(Mt[n+1][0]<=t.y))break;++n}var r=Mt[n],o=5*(t.y-r[0])/(Mt[n+1][0]-r[0]);o=function(e,t,n,r){for(var i=t;r;--r){var a=e(i);if(i-=a,Math.abs(a)<n)break}return i}((function(e){return(It(r,e)-t.y)/function(e,t){return e[1]+t*(2*e[2]+3*t*e[3])}(r,e)}),o,1e-10,100),t.x/=It(kt[n],o),t.y=(5*n+o)*a,e.y<0&&(t.y=-t.y)}return t.x=A(t.x+this.long0),t},names:["Robinson","robin"]};var Ot,Rt={init:function(){this.name="geocent"},forward:function(e){return Y(e,this.es,this.a)},inverse:function(e){return J(e,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};oe.defaultDatum="WGS84",oe.Proj=Q,oe.WGS84=new oe.Proj("WGS84"),oe.Point=_e,oe.toPoint=ee,oe.defs=P,oe.transform=ne,oe.mgrs=ce,oe.version="__VERSION__",(Ot=oe).Proj.projections.add(ke),Ot.Proj.projections.add(Re),Ot.Proj.projections.add(Ne),Ot.Proj.projections.add(Ee),Ot.Proj.projections.add(De),Ot.Proj.projections.add(Le),Ot.Proj.projections.add(Be),Ot.Proj.projections.add(Fe),Ot.Proj.projections.add(Ue),Ot.Proj.projections.add(Ye),Ot.Proj.projections.add(Ke),Ot.Proj.projections.add($e),Ot.Proj.projections.add(et),Ot.Proj.projections.add(tt),Ot.Proj.projections.add(nt),Ot.Proj.projections.add(rt),Ot.Proj.projections.add(it),Ot.Proj.projections.add(at),Ot.Proj.projections.add(ot),Ot.Proj.projections.add(st),Ot.Proj.projections.add(ut),Ot.Proj.projections.add(ct),Ot.Proj.projections.add(lt),Ot.Proj.projections.add(ht),Ot.Proj.projections.add(St),Ot.Proj.projections.add(jt),Ot.Proj.projections.add(Rt);t.default=oe}])]);
//# sourceMappingURL=4.6ad76ffc.chunk.js.map