(this["webpackJsonpgatesolve-ui"]=this["webpackJsonpgatesolve-ui"]||[]).push([[0],{354:function(e,t,n){},355:function(e,t,n){},560:function(e,t,n){"use strict";n.r(t);var a,o,r,i,c=n(97),l=n.n(c),s=n(188),u=n(187),d=n(207),p=n(132),f=n(0),b=n(3),h=n(556),g=n(551),v=n(213),m=n.n(v),j=n(256),y=n.n(j),O=n(42),x=n(337),w=n(528),k=n(327),C=n(529),E=(n(343),n(344)),_=n(345),S=function(e){return["literal",e]},P=function(e){return["has",e]},M=function(e){return["get",e]},D=function(e){return["var",e]},T=function(e){return["to-boolean",e]},N=function(e){return["!",e]},L=function(e){return["length",e]},z=function(e,t){return[">",e,t]},R=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["any"].concat(t)},I=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["all"].concat(t)},F=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["coalesce"].concat(t)},W=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["format"].concat(Object(d.a)(t.flatMap((function(e){return Object(_.a)(e).slice(0)}))))},A=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["case"].concat(Object(d.a)(t.flatMap((function(e){return Object(_.a)(e).slice(0)}))))},B=[{id:"venue-symbol",type:"symbol",paint:{"text-halo-color":"#fff","text-color":"#af8dbc","text-halo-width":2},layout:{"text-field":["get","@venue-label"],"text-anchor":"center","text-font":["Klokantech Noto Sans Regular"],"text-size":20,"text-offset":[0,-1.55],"text-allow-overlap":!0,"text-ignore-placement":!0,"icon-image":"icon-svg-pin-48-#af8dbc-#fff","icon-anchor":"bottom","icon-allow-overlap":!0,"icon-ignore-placement":!0}}],G=[{id:"route-line",type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-opacity":["coalesce",["get","@opacity"],.8],"line-width":2,"line-color":["get","@color"]},filter:["!",["coalesce",["get","@imaginary"],!1]]},{id:"route-line-interactive",type:"line",paint:{"line-width":16,"line-opacity":0},filter:["coalesce",["get","@interactive"]]},{id:"route-imaginary-line",type:"line",layout:{"line-cap":"round","line-join":"round"},paint:{"line-opacity":["coalesce",["get","@opacity"],.5],"line-width":5,"line-color":["get","@color"],"line-dasharray":[0,2]},filter:["coalesce",["get","@imaginary"],!1]},{id:"route-point",type:"circle",paint:{"circle-opacity":["coalesce",["get","@opacity"],1],"circle-radius":5,"circle-color":["get","@color"]},filter:["==","Point",["geometry-type"]]},{id:"route-point-symbol",type:"symbol",paint:{"text-color":"#000","text-halo-color":"#fff","text-halo-width":3},layout:{"text-field":["get","@label"],"text-anchor":"center","text-font":["Klokantech Noto Sans Regular"],"text-size":24,"text-offset":[0,-.05]},filter:["==","Point",["geometry-type"]]},{id:"route-point-interactive",type:"circle",paint:{"circle-opacity":0,"circle-radius":15},filter:["==","Point",["geometry-type"]]}],q={id:"building-highlight",type:"fill",paint:{"fill-opacity":.3,"fill-color":"#99ff99"}},U=[{id:"parking-area",type:"fill",minzoom:12,paint:{"fill-opacity":.5,"fill-color":"#00afff"}},{id:"parking-point",type:"circle",minzoom:12,paint:{"circle-radius":["interpolate",["linear"],["zoom"],12,1,14,2,15,5],"circle-opacity":.8,"circle-color":"#00afff"},filter:["==","Point",["geometry-type"]]}],H=[{id:"tunnel-point",type:"circle",minzoom:12,paint:{"circle-radius":["interpolate",["linear"],["zoom"],12,1,14,2,15,5],"circle-opacity":.8,"circle-color":"#000000"},filter:["==","Point",["geometry-type"]]},{id:"tunnel-line",type:"line",minzoom:12,layout:{"line-cap":"round","line-join":"round"},paint:{"line-opacity":.8,"line-width":3,"line-color":["step",["to-number",["get","layer"]],"#000000",-4,"#770000",-3,"#ff0000",-2,"#ff7700",-1,"#ffff00"]}},{id:"tunnel-point-symbol",type:"symbol",minzoom:12,paint:{"text-color":"#000","text-halo-color":"#fff","text-halo-width":1},layout:{"text-field":F(M("name"),M("ref"),M("description"),""),"text-anchor":"right","text-font":["Klokantech Noto Sans Regular"],"text-size":12,"text-offset":[-.5,0]},filter:["==","Point",["geometry-type"]]}],K=["let","maybe_space",A([I(P("@house-label"),P("@entrance-label")),"\u2009"],[""]),"house_label_maybe_space",function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return["concat"].concat(t)}(M("@house-label"),A([I(P("@house-label"),P("@entrance-label")),"\u2009"],[""])),["step",["zoom"],(o=D("maybe_space"),W([A([N(T(M("@house-label"))),""],[R(F(M("@secondary"),!1),z(L(M("@house-label")),3)),"\xb7"],[M("@house-label")]),{}],[o,{}],[A([N(T(M("@entrance-label"))),""],[I(F(M("@secondary"),!1)),"\xb7"],[M("@entrance-label")]),{"text-font":["literal",["Klokantech Noto Sans Bold"]]}])),17,function(e){return W([A([(t="@house-label",N(T(M(t)))),""],[R(F(M("@secondary"),!1),z(L(M("@house-label")),3)),"\xb7"],[M("@house-label")]),{}],[e,{}],[A([N(T(M("@entrance-label"))),""],[I(F(M("@secondary"),!1),z(L(M("@entrance-label")),1)),"\xb7"],[M("@entrance-label")]),{"text-font":["literal",["Klokantech Noto Sans Bold"]]}]);var t}(D("maybe_space")),18,(a=D("house_label_maybe_space"),W([a,{}],[M("@entrance-label"),{"text-font":["literal",["Klokantech Noto Sans Bold"]]}]))]],V=function(e){var t=e.missing,n=e.visible,a=e.hidden;return["step",["zoom"],A([N(R(T(M("@house-label")),T(M("@entrance-label")))),t],[I(N(I(T(M("@house-label")),N(T(M("@secondary"))),N(z(L(M("@house-label")),3)))),N(I(T(M("@entrance-label")),N(T(M("@secondary")))))),a],[n]),17,A([N(R(T(M("@house-label")),T(M("@entrance-label")))),t],[I(N(I(T(M("@house-label")),N(T(M("@secondary"))),N(z(L(M("@house-label")),3)))),N(I(T(M("@entrance-label")),R(N(T(M("@secondary"))),N(z(L(M("@entrance-label")),1)))))),a],[n]),18,A([N(R(T(M("@house-label")),T(M("@entrance-label")))),t],[n])]},Z=function(e,t){return V({missing:t,visible:e,hidden:t})},J=[{id:"entrance-point",type:"circle",minzoom:12,maxzoom:16,paint:{"circle-radius":["interpolate",["linear"],["zoom"],12,1,14,2,15,3],"circle-color":"#64be14"}},{id:"entrance-symbol",type:"symbol",minzoom:16,paint:{"text-halo-color":"#fff","text-color":"#64be14","text-halo-width":1,"icon-opacity":Z(S(1),S(.5)),"text-opacity":Z(S(1),S(0))},layout:{"text-field":K,"text-font":["Klokantech Noto Sans Regular"],"text-size":16,"text-offset":["get","@offset"],"text-anchor":["step",["%",["get","@rotate"],360]].concat(function(){var e=["top","top-right","right","bottom-right","bottom","bottom-left","left","top-left"];return[e[0]].concat([22.5,67.5,112.5,157.5,202.5,247.7,292.5,337.5].flatMap((function(t,n){return[t,e[(0+n+1)%e.length]]})))}()),"text-rotation-alignment":"map","text-allow-overlap":!0,"text-ignore-placement":!0,"icon-image":(r=S("icon-svg-triangleDot-28-#64be14-#fff"),i=S("icon-svg-triangle-28-#64be14-#fff"),V({missing:i,visible:i,hidden:r})),"icon-anchor":"center","icon-rotate":["get","@rotate"],"icon-rotation-alignment":"map","icon-allow-overlap":!0,"icon-ignore-placement":!0}}],X=n(9),$="-1 -1 17 17",Y="M7.5 0C5.068 0 2.23 1.486 2.23 5.27c0 2.568 4.054 8.244 5.27 9.73c1.081-1.486 5.27-7.027 5.27-9.73C12.77 1.487 9.932 0 7.5 0z",Q=function(e,t){return'\n<svg xmlns="http://www.w3.org/2000/svg"\n  width="'.concat(e,'px"\n  height="').concat(e,'px"\n  style="').concat(t,'"\n  viewBox="').concat($,'"\n>\n  <path d="').concat(Y,'" />\n</svg>')},ee=function(e){var t=e.height,n=void 0===t?"50":t,a=e.style,o=void 0===a?{fill:"#444",stroke:"none"}:a,r=e.dataTestId;return Object(X.jsxs)("svg",{"data-testid":r,height:n,style:o,viewBox:$,pointerEvents:"none",children:[Object(X.jsx)("path",{fill:"url(#gradient-".concat(o.fill,")"),d:Y,pointerEvents:"visiblepainted",cursor:"pointer"}),Object(X.jsx)("defs",{children:Object(X.jsxs)("linearGradient",{id:"gradient-".concat(o.fill),gradientTransform:"rotate(90)",children:[Object(X.jsx)("stop",{offset:"00%",stopColor:"#FFFFFF",stopOpacity:"0"}),Object(X.jsx)("stop",{offset:"100%",stopColor:o.fill,stopOpacity:"1"})]})})]})},te="-5 -1 25 50",ne="M 8 16 L 0 8 L 16 8 Z",ae=function(e){return"\nM ".concat(8-e," ").concat(32+e,"\na ").concat(e," ").concat(e,", 0, 0, 0, ").concat(2*e," 0\na ").concat(e," ").concat(e,", 0, 0, 0, ").concat(-2*e," 0\n")},oe=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"stroke-width: 1";return'\n<svg xmlns="http://www.w3.org/2000/svg"\n  width="'.concat(e,'px"\n  height="').concat(e,'px"\n  style="').concat(t,'"\n  viewBox="').concat(te,'"\n>\n  <path d="').concat(ne,'" />\n  <path style="').concat(a,'" d="').concat(n&&ae(n)||"",'" />\n</svg>')},re=function(e,t){return oe(e,t,0)},ie=n(545),ce=n(549),le=n(253),se=function(e){return"https://app.olmap.org/#/note/".concat(e)},ue=function(e){return{lat:Number(e.lat),lon:Number(e.lon),id:e.id,type:"olmap"}},de={main:2,yes:1,null:0,"":0,no:-1},pe=function(e){return e.workplace&&e.workplace.workplace_entrances.sort((function(e,t){return de[t.deliveries||"null"]-de[e.deliveries||"null"]})),e},fe=function(){var e=Object(s.a)(l.a.mark((function e(t,n){var a,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==t){e.next=2;break}return e.abrupt("return",void 0);case 2:return e.prev=2,e.next=5,fetch("https://api.olmap.org/rest/osm_features/".concat(t,"/?language=").concat(n));case 5:return a=e.sent,e.prev=6,e.next=9,a.json();case 9:if(o=e.sent,a.ok){e.next=12;break}return e.abrupt("return",{state:"failed",code:a.status,detail:o.detail});case 12:return e.abrupt("return",{state:"success",response:pe(o)});case 15:return e.prev=15,e.t0=e.catch(6),e.abrupt("return",{state:"failed",code:a.status,detail:e.t0});case 18:e.next=23;break;case 20:return e.prev=20,e.t1=e.catch(2),e.abrupt("return",{state:"failed",code:0,detail:e.t1});case 23:case"end":return e.stop()}}),e,null,[[2,20],[6,15]])})));return function(t,n){return e.apply(this,arguments)}}(),be=function(e,t){if("success"!==(null===e||void 0===e?void 0:e.state)||!e.response.workplace)return{type:"FeatureCollection",features:[]};var n=[];return t.forEach((function(e,t){var a="olmap"===e.type?"olmap/".concat(e.id):"http://www.openstreetmap.org/".concat(e.type,"/").concat(e.id);n.push({type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:Object(u.a)(Object(u.a)({"@id":a},e.tags),{},{"@venue-label":Object(le.romanize)(t+1)})})})),{type:"FeatureCollection",features:n}},he=function(e){if("success"!==(null===e||void 0===e?void 0:e.state)||!e.response.workplace)return[[],{}];var t=e.response.workplace.workplace_entrances,n={};return[t.flatMap((function(e){return e.unloading_places.flatMap((function(t){var a=n[t.id],o=e.entrance_data.osm_feature||e.image_note.id;return a?(o&&a.push(o),[]):(n[t.id]=o?[o]:[],[t])}))})),n]},ge=function(e){return he(e)[0]},ve=function(e){var t=e.noteId,n=e.onClose;return Object(X.jsx)(ie.a,{open:!!t,fullWidth:!0,PaperProps:{style:{height:"100%",overflow:"hidden"}},children:t&&Object(X.jsxs)(X.Fragment,{children:[Object(X.jsxs)(ce.a,{children:["Note on OLMap",Object(X.jsx)(g.a,{style:{position:"absolute",top:"8px",right:"8px"},onClick:n,children:Object(X.jsx)(m.a,{})})]}),Object(X.jsx)("div",{style:{height:"100%",borderTop:"1px solid rgba(0, 0, 0, 0.12)"},children:Object(X.jsx)("iframe",{title:"OLMap note editor",src:se(t),style:{border:"none",padding:0,margin:0,width:"100%",height:"100%"}})})]})})},me=function(e){var t,n,a=e.onImageClick,o=e.olmapData,r="success"===(null===o||void 0===o?void 0:o.state)&&(null===o||void 0===o||null===(t=o.response)||void 0===t||null===(n=t.image_notes)||void 0===n?void 0:n.filter((function(e){return e.image})).slice(0,1).map((function(e){return Object(X.jsx)("a",{href:se(e.id),onClick:a,target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex"},children:Object(X.jsx)("img",{style:{maxWidth:"100%",maxHeight:"150px"},src:e.image,alt:"A photo of the entrance"})},e.id)})));return Object(X.jsx)("div",{style:{textAlign:"center"},children:r})},je=function(e){var t=e.dataTestId,n=e.width,a=void 0===n?"40":n,o=e.height,r=void 0===o?"40":o,i=e.stroke,c=void 0===i?"#00afff":i,l=e.strokeWidth,s=void 0===l?"16":l;return Object(X.jsxs)("svg",{"data-testid":t,width:a,height:r,stroke:c,strokeWidth:s,viewBox:"-100 -100 200 200",fill:"transparent",style:{position:"absolute"},children:[Object(X.jsx)("circle",{cx:"0",cy:"0",r:"24"}),Object(X.jsx)("circle",{cx:"0",cy:"0",r:"46"}),Object(X.jsx)("circle",{cx:"0",cy:"0",r:"68"})]})},ye=function(e){var t=e.dataTestId,n=e.onGeolocate,a=e.onGeolocateError,o=e.positionOptions,r=void 0===o?{enableHighAccuracy:!0,timeout:6e3}:o,i=e.onEnable,c=e.onDisable,l=e.enableOnMount,s=void 0===l||l,u=Object(f.useState)(null!=window.navigator.geolocation),d=Object(p.a)(u,1)[0],b=Object(f.useState)(null!=window.navigator.permissions),h=Object(p.a)(b,1)[0],g=Object(f.useState)(null),v=Object(p.a)(g,2),m=v[0],j=v[1],y=Object(f.useState)(null),O=Object(p.a)(y,2),x=O[0],w=O[1],k=Object(f.useState)(!1),C=Object(p.a)(k,2),E=C[0],_=C[1],S=function(e){d&&null==x&&(w(window.navigator.geolocation.watchPosition(n,a,r)),_(!0),null!=i&&i(e))},P=function(){d&&null!=x&&(window.navigator.geolocation.clearWatch(x),w(null),null!=c&&c())},M=function(){console.log("Geolocation is denied. Inform the user.")};Object(f.useEffect)((function(){d||console.log("Geolocation is not supported. Inform the user.")}),[d]),Object(f.useEffect)((function(){d&&h&&null==m&&h&&window.navigator.permissions.query({name:"geolocation"}).then((function(e){j(e.state),e.onchange=function(){j(this.state)}})).catch((function(e){console.error("Permissions API exists but querying it fails:",e)}))}),[]),Object(f.useEffect)((function(){"denied"===m&&(M(),P())}),[m]);var D=!h||null!=m,T=null!=x;Object(f.useEffect)((function(){!s||E||!d||T||h&&(null==m||"denied"===m)||S(!1)}),[s,E,d,T,h,m]);var N=null;if(d){var L=T?"Stop using my location":"Find my location",z=T?"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate mapboxgl-ctrl-geolocate-active":"mapboxgl-ctrl-icon mapboxgl-ctrl-geolocate";N=Object(X.jsx)("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group mapboxgl-ctrl-bottom-left",children:Object(X.jsx)("button",{type:"button",className:z,"data-testid":t,"aria-label":L,"aria-pressed":T,onContextMenu:function(e){return e.preventDefault()},onClick:D?function(e){console.assert(d),console.assert(D),e.preventDefault(),T?P():h&&"denied"===m?M():S(!0)}:void 0,children:Object(X.jsx)("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true"})})})}return N};function Oe(){return(Oe=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function xe(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var we=f.createElement("path",{id:"path862",d:"m -14.2,148 v -19.3 c 0,-7.8 6.4,-14.2 14.2,-14.2 7.8,0 14.2,6.4 14.2,14.2 V 148 Z M 1,83.8 c 20.6,0 37.4,16.7 37.4,37.4 v 48.2 H 49 v -48.2 c 0,-26.5 -21.5,-48 -48,-48 -26.5,0 -48,21.5 -48,48 v 48.2 h 10.6 v -48.2 c 0,-20.7 16.8,-37.4 37.4,-37.4"});function ke(e,t){var n=e.title,a=e.titleId,o=xe(e,["title","titleId"]);return f.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",viewBox:"-63 65 128 128",y:"0px",x:"0px",id:"Layer_1",ref:t,"aria-labelledby":a},o),n?f.createElement("title",{id:a},n):null,we)}var Ce=f.forwardRef(ke),Ee=(n.p,function(e){var t=e.dataTestId,n=e.enabled,a=e.setEnabled,o=n?"Hide tunnels":"Show tunnels",r=n?"#33b5e5":"#333";return Object(X.jsx)("div",{className:"mapboxgl-ctrl mapboxgl-ctrl-group mapboxgl-ctrl-bottom-left",style:{marginBottom:53},children:Object(X.jsx)("button",{type:"button",className:"mapboxgl-ctrl-icon","data-testid":t,"aria-label":o,"aria-pressed":n,onContextMenu:function(e){return e.preventDefault()},onClick:function(e){e.preventDefault(),a(!n)},children:Object(X.jsx)("span",{className:"mapboxgl-ctrl-icon","aria-hidden":"true",children:Object(X.jsx)(Ce,{fill:r})})})})}),_e=/^(https:\/\/w3id.org\/openstreetmap\/terms#|osm:)/,Se=function(e,t,n){var a={"@id":e};return Object.entries(t||{}).forEach((function(e){var t=Object(p.a)(e,2),n=t[0],o=t[1];if((n.startsWith("https://w3id.org/openstreetmap/terms#")||n.startsWith("osm:"))&&"https://w3id.org/openstreetmap/terms#hasTag"!==n&&"osm:hasTag"!==n){var r=n.replace(_e,""),i=o.replace(_e,"");a[r]="NoAccess"===i?"no":"FreeAccess"===i?"yes":"OfficialAccess"===i?"official":"highway"===r&&"UnderConstruction"===i?"construction":"construction"===r&&"UnderConstruction"===i?"yes":i.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()}})),null===n||void 0===n||n.forEach((function(e){var t=e.indexOf("="),n=e.substring(0,t),o=e.substring(t+1);a[n]=o})),a};function Pe(e){var t=[],n=[],a={},o=new Map,r=[];return e.legs[0].getSteps().forEach((function(i,c){var l,s;if(i.startLocation.id||i.stopLocation.id||1===c){var u=i.stopLocation,d=i.through;if(!a[d]){var p=e.context[d],f=Se(d,p.definedTags,p.freeformTags);(f.height||f.maxheight||f["maxheight:physical"])&&n.push({type:d,id:d,lon:i.startLocation.longitude,lat:i.startLocation.latitude,tags:f})}if(a[d]=!0,"https://w3id.org/openstreetmap/terms#Steps"===(null===(l=e.context[d])||void 0===l?void 0:l.definedTags["https://w3id.org/openstreetmap/terms#highway"])){var b;if(!o.has(d)){var h=e.context[d],g=Se(d,h.definedTags,h.freeformTags);o.set(d,[g,[]])}null===(b=o.get(d))||void 0===b||b[1].push([i.startLocation.longitude,i.startLocation.latitude],[i.stopLocation.longitude,i.stopLocation.latitude])}if(null===(s=u.definedTags)||void 0===s?void 0:s["https://w3id.org/openstreetmap/terms#barrier"]){var v=Se(u.id,u.definedTags,u.freeformTags);n.push({type:u.id,id:u.id,lon:u.longitude,lat:u.latitude,tags:v})}t.push([i.startLocation.longitude,i.startLocation.latitude]),t.push([i.stopLocation.longitude,i.stopLocation.latitude])}else r.push([[i.startLocation.longitude,i.startLocation.latitude],[i.stopLocation.longitude,i.stopLocation.latitude]])})),{coordinates:t,obstacles:n,obstacleWays:Array.from(o.values()),imaginaryWays:r}}function Me(e,t,n,a,o,r){var i=[];return e&&i.push({type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:Object(u.a)(Object(u.a)({},e.tags),{},{"@id":"".concat(e.type,"/").concat(e.id),"@color":o})}),t&&t.forEach((function(e){i.push({type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:Object(u.a)(Object(u.a)({},e.tags),{},{"@id":"".concat(e.type,"/").concat(e.id),"@color":r})})})),n&&n.forEach((function(e){var t,n;i.push({type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:{"@color":"#00ffff","@label":(null===(t=e.tags)||void 0===t?void 0:t.ref)||(null===(n=e.tags)||void 0===n?void 0:n["addr:unit"]),"@opacity":0}})})),(null===a||void 0===a?void 0:a.coordinates)&&i.push({type:"Feature",geometry:{type:"LineString",coordinates:a.coordinates},properties:{"@color":"#000"}}),null===a||void 0===a||a.obstacleWays.forEach((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];i.push({type:"Feature",geometry:{type:"LineString",coordinates:a},properties:Object(u.a)(Object(u.a)({},n),{},{"@color":"#dc0451","@opacity":1,"@interactive":!0})})})),(null===a||void 0===a?void 0:a.imaginaryWays)&&i.push({type:"Feature",geometry:{type:"MultiLineString",coordinates:a.imaginaryWays},properties:{"@color":"#000","@imaginary":!0}}),null===a||void 0===a||a.obstacles.forEach((function(e){i.push({type:"Feature",geometry:{type:"Point",coordinates:[e.lon,e.lat]},properties:Object(u.a)(Object(u.a)({},e.tags),{},{"@color":"#dc0451","@label":"!","@obstacle":!0})})})),{type:"FeatureCollection",features:i}}function De(e,t){return Te.apply(this,arguments)}function Te(){return(Te=Object(s.a)(l.a.mark((function e(t,a){var o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([n.e(4),n.e(2)]).then(n.bind(null,559));case 2:o=e.sent,r=o.Planner,t.forEach((function(e){var t=Object(p.a)(e,3),n=t[0],o=t[1],i=t[2],c=void 0===i?"delivery-walking":i,u=new r;u.setProfileID("".concat("https","://").concat("","/").concat(c,".json")).query({from:{latitude:n.lat,longitude:n.lon},to:{latitude:o.lat,longitude:o.lon}}).take(1).on("data",function(){var e=Object(s.a)(l.a.mark((function e(t){var r,i,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.completePath(t);case 2:r=e.sent,console.log("Plan",r,"from",n,"to",o),i=Pe(r),s=Me(n,[o],void 0,i,"delivery-car"===c?"#000000":"#00afff","delivery-car"===c?"#00afff":"#64be14"),a(s);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ne,Le=n(347),ze=n.n(Le),Re=(null===(Ne=Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_OVERPASS_INTERPRETER)||void 0===Ne?void 0:Ne.replace(/\?$/,""))||"https://overpass.fvh.io/api/interpreter",Ie=function(e){var t,n,a=new URL(Re);return a.searchParams.append("data",(t=e.lat,n=e.lon,"\n  [out:json][timeout:25];\n  (\n    relation(around:10, ".concat(t,", ").concat(n,")[building];\n    way(r);\n    way(around:10, ").concat(t,", ").concat(n,')[building];\n  )->.b;\n  (\n    relation(around.b:10)["building:part"];\n    way(r);\n    way(around.b:10)["building:part"];\n  )->.p;\n  // gather results\n  (\n    node(w.b)[entrance];\n    node(w.p)[entrance];\n  );\n  // print results\n  out body;\n  >;\n  out skel qt;\n'))),fetch(a.toString()).then((function(e){return e.json().then((function(e){return e.elements.filter((function(e){return"node"===e.type&&"lat"in e&&null!=e.lat&&"lon"in e&&null!=e.lon&&e.tags&&e.tags.entrance}))}))}))},Fe=function(e,t,n){var a=n.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n");return"\n  [out:json][timeout:25];\n  (\n    way(around:100, ".concat(e,", ").concat(t,')["highway"][name="').concat(a,'"];\n  );\n  // print results as id and geometry for each way in qt (non-sorted) order\n  out ids geom qt;')},We=function(){var e=Object(s.a)(l.a.mark((function e(t,n){var a,o,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new URL(Re)).searchParams.append("data",Fe(t.lat,t.lon,n)),e.next=4,fetch(a.toString());case 4:return o=e.sent,e.next=7,o.json();case 7:return r=e.sent,i=r.elements.map((function(e){return e.geometry.map((function(e){var t=e.lat;return[e.lon,t]}))})),e.abrupt("return",{type:"MultiLineString",coordinates:i});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ae=function(e){return"\n  [out:json][timeout:25];\n  node(id:".concat(e.join(","),");\n  out;\n")},Be=function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=new URL(Re),(a=t.filter((function(e){return e>0}))).length){e.next=4;break}return e.abrupt("return",[]);case 4:return n.searchParams.append("data",Ae(a)),e.next=7,fetch(n.toString());case 7:return o=e.sent,e.next=10,o.json();case 10:return r=e.sent,e.abrupt("return",r.elements);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge=function(e,t){return"\n  [out:json][timeout:25];\n  ".concat(e,"(id:").concat(t.join(","),");\n  out center;\n")},qe=function(){var e=Object(s.a)(l.a.mark((function e(t,n){var a,o,r,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new URL(Re),(o=n.filter((function(e){return e>0}))).length){e.next=4;break}return e.abrupt("return",[]);case 4:return a.searchParams.append("data",Ge(t,o)),e.next=7,fetch(a.toString());case 7:return r=e.sent,e.next=10,r.json();case 10:return i=e.sent,e.abrupt("return",i.elements);case 12:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a,o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URL(Re)).searchParams.append("data",'\n[out:json][timeout:25][bbox];\n(\n  way[layer~"^-[123456789]"][highway!~"^(footway|steps|corridor|cycleway)"][highway][tunnel];\n  node[layer~"^-[123456789]"][barrier=gate];\n  node[layer~"^-[123456789]"][entrance];\n  node[layer~"^-[123456789]"]["parking:condition"=loading];\n);\nout body;\n>;\nout skel qt;\n'),n.searchParams.append("bbox",t),e.next=5,fetch(n.toString());case 5:return a=e.sent,e.next=8,a.json();case 8:return o=e.sent,r=ze()(o),e.abrupt("return",Object(u.a)(Object(u.a)({},r),{},{features:r.features.map((function(e){var t=Object(u.a)({},e.properties);return t["@id"]=t.id,delete t.id,Object(u.a)(Object(u.a)({},e),{},{properties:t})}))}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),He=function(e){var t,n;return{width:null===e||void 0===e||null===(t=e.getContainer())||void 0===t?void 0:t.clientWidth,height:null===e||void 0===e||null===(n=e.getContainer())||void 0===n?void 0:n.clientHeight}},Ke=n(328),Ve=n(115),Ze=n(530),Je=function(e){e.some((function(e){return["staircase","main"].includes(e.properties.entrance)}))&&e.forEach((function(e){["staircase","main"].includes(e.properties.entrance)||(e.properties["@secondary"]=!0)}))},Xe=function(e,t,n,a,o){if(!e["osm:hasNodes"])return[];if("string"===typeof e["osm:hasNodes"])return[];var r=e["osm:hasNodes"];if(r.length<4)return console.log("not an area",e["@id"]),[];r[0]!==r[r.length-1]&&console.log("unclosed",e["@id"]);var i=null,c=[];return r.forEach((function(r,l,s){var d=n[r];if(d){null===i&&(i=Object(Ze.a)(Object(Ve.lineString)(s.map((function(e){return t[e]})))));var p=t[r],f=0===l?t[s[s.length-2]]:t[s[l-1]],b=l===s.length-1?t[s[1]]:t[s[l+1]],h=Object(Ke.a)(p,f),g=Object(Ke.a)(p,b),v=Math.abs(h-g)/2+Math.min(h,g),m=h>g?v+270:v+90,j=i!==!!a?m:m+180,y=d.properties["@entrance-label"],O=d.properties["@house-label"];if(!d.properties["addr:housenumber"]&&!d.properties.ref&&!d.properties["addr:unit"]){var x=$e(o||e);y=y||x.entrance}d.properties=Object(u.a)(Object(u.a)({},d.properties),{},{"@offset":[.2*Math.cos(j/180*Math.PI),.2*Math.sin(j/180*Math.PI)],"@rotate":((j-90)%360+360)%360,"@entrance-label":y,"@house-label":O}),c.push(d)}})),c},$e=function(e){var t,n,a,o,r,i,c=(null===(t=e["osm:hasTag"])||void 0===t||null===(n=t.find((function(e){return e.startsWith("addr:housenumber=")})))||void 0===n?void 0:n.substring(17))||"",l=null===(a=e["osm:hasTag"])||void 0===a||null===(o=a.find((function(e){return e.startsWith("ref=")})))||void 0===o?void 0:o.substring(4),s=null===(r=e["osm:hasTag"])||void 0===r||null===(i=r.find((function(e){return e.startsWith("addr:unit=")})))||void 0===i?void 0:i.substring(10),u=l||s||"";return{house:c.replace(/ /g,"\u2009"),entrance:u.replace(/ /g,"\u2009")}},Ye=function(e){for(var t={},n={},a={},o={},r=0;r<e["@graph"].length;r++){var i=e["@graph"][r];if("osm:Relation"===i["@type"])o[i["@id"]]=i;else if("osm:Way"===i["@type"])a[i["@id"]]=i;else if(i["geo:lat"]&&i["geo:long"]){var c,l=[i["geo:long"],i["geo:lat"]];if(n[i["@id"]]=l,null===(c=i["osm:hasTag"])||void 0===c?void 0:c.find((function(e){return e.startsWith("entrance=")}))){var s=i["@id"],d=Se(s,i,i["osm:hasTag"]),p=$e(i),f={type:"Feature",geometry:{type:"Point",coordinates:l},properties:Object(u.a)(Object(u.a)({},d),{},{"@entrance-label":p.entrance,"@house-label":p.house})};t[s]=f}}}return function(e,t,n,a){Object.values(e).filter((function(e){var t;return null===(t=e["osm:hasTag"])||void 0===t?void 0:t.find((function(e){return e.startsWith("building=")||e.startsWith("building:part=")}))})).forEach((function(e){var o=e["osm:hasMembers"].flatMap((function(o){var r=t[o["@id"]];return r?Xe(r,n,a,"inner"===o.role,e):[]}));Je(o)}))}(o,a,n,t),function(e,t,n){Object.values(e).filter((function(e){var t;return null===(t=e["osm:hasTag"])||void 0===t?void 0:t.find((function(e){return e.startsWith("building=")||e.startsWith("building:part=")}))})).forEach((function(e){Je(Xe(e,t,n))}))}(a,n,t),{type:"FeatureCollection",features:Object.values(t)}},Qe=256,et=12756274*Math.PI;function tt(e,t,n,a){for(var o=function(e){var t=et*e[0]/360,n=Math.sin(e[1]*Math.PI/180),a=et*Math.log((1+n)/(1-n))/(4*Math.PI);return[et/2+t,et-(et/2+a)]}(n),r=[o[0]*Qe*Math.pow(2,a)/et,o[1]*Qe*Math.pow(2,a)/et],i=[Math.floor((r[0]-e/2)/Qe),Math.floor((r[1]-t/2)/Qe),Math.ceil((r[0]+e/2)/Qe),Math.ceil((r[1]+t/2)/Qe)],c=[],l=i[0];l<i[2];++l)for(var s=i[1];s<i[3];++s){var u=l*Qe-r[0]+e/2,d=s*Qe-r[1]+t/2;c.push({x:l,y:s,zoom:a,px:u,py:d})}return c}var nt=n(325),at=Object(nt.default)("+proj=tmerc +lat_0=0 +lon_0=25 +k=1 +x_0=25500000 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs"),ot=function(e){return at.forward(e)},rt=function(e){return at.inverse(e)},it=[16,17,20,22,23,24,25,27,29,39,40,41,42,45,46,47,49,50,51,52,53,54,55,61,67,98,103,104,105,126,142,144,145,146,147,148,166,189,190,191,192,193,194,195,196,207,208,280,327,328,335,342,346,349,351,352,353,354,355,356,357,359,361,362,1298,2295,2842,4437,7167,7168,7216,7354,7419,7459,7460,7461,7462,7463,7464,7465,7467,7468,7497,7505,7542,7543,7544,7545,7614,7640,7667,7690,7691,7692,7693,7694,7795,7834],ct=function(e){return e.filter((function(e){return!it.find((function(t){var n;return t===(null===(n=e.properties)||void 0===n?void 0:n["hel:id"])}))}))},lt=(n(354),n(355),n(558)),st=n(550),ut=n(557),dt=n(561),pt=(n(255),n(356)),ft=n.n(pt),bt=n(357),ht=n.n(bt),gt=n(564),vt=n(552),mt=n(555),jt=n(554),yt=n(553),Ot=function(e){var t=e.workplaceEntrance,n=e.workplace,a=e.label,o=e.onEntranceSelected,r=e.onUnloadingPlaceSelected,i=e.onViewDetails,c=Object(f.useState)(!0),l=Object(p.a)(c,2),s=l[0],u=l[1];return Object(X.jsxs)(vt.a,{variant:"outlined",square:!0,style:{padding:"8px",borderLeft:"none",borderRight:"none",borderBottom:"none"},children:[Object(X.jsx)(yt.a,{style:{padding:0},avatar:Object(X.jsx)(gt.a,{style:{marginRight:0,background:"#af8dbc",color:"#af8dbc",textShadow:"\n0      -1px 0.5px white,\n1px    -1px 0.5px white,\n1px    0    0.5px white,\n1px    1px  0.5px white,\n0      1px  0.5px white,\n-1px   1px  0.5px white,\n-1px   0    0.5px white,\n-1px   -1px 0.5px white,\n2px    -0.5px 0.5px white,\n2px    0.5px  0.5px white,\n-2px   -0.5px 0.5px white,\n-2px   0.5px  0.5px white,\n-0.5px 2px 0.5px white,\n0.5px  2px 0.5px white,\n-0.5px -2px 0.5px white,\n0.5px  -2px 0.5px white,\n-1.5px    1.5px  0.5px white,\n1.5px    -1.5px  0.5px white,\n-1.5px -1.5px 0.5px white,\n1.5px    1.5px  0.5px white,\n2px    0px 0.5px white,\n0px    2px  0.5px white,\n-2px   0px 0.5px white,\n0px    -2px  0.5px white",font:'30px "Noto Sans"'},children:Object(X.jsx)("span",{children:a})}),title:"".concat([t.description_translated||t.description,t.delivery_types.join("; ")].filter((function(e){return e})).join(": ")),subheader:t.delivery_hours||n.delivery_hours,titleTypographyProps:{style:{background:"rgba(255,255,255,0.5)"}},subheaderTypographyProps:{style:{background:"rgba(255,255,255,0.5)"}}}),Object(X.jsx)(jt.a,{style:{padding:0},children:Object(X.jsx)(st.a,{variant:"body2",color:"textSecondary",component:"p",children:t.delivery_instructions_translated||t.delivery_instructions})}),Object(X.jsxs)(mt.a,{style:{padding:0},children:[Object(X.jsx)(h.a,{variant:"contained",size:"small",style:{backgroundColor:"#64be14",color:"#fff"},type:"button","aria-label":"Set destination",onClick:function(){var e=t.entrance_data.osm_feature||t.image_note.id;e&&o(e)},children:"Destination"}),Object(X.jsx)(h.a,{variant:"contained",size:"small",style:{backgroundColor:"#ff5000",color:"#fff"},type:"button","aria-label":"View details",onClick:function(){return i(t.image_note)},children:"View details"}),Object(X.jsx)(h.a,{variant:"text",size:"small",style:{color:"#00afff"},type:"button","aria-label":s?"Show unloading places":"Hide unloading places",onClick:function(){return u(!s)},children:s?"Show parking":"Hide parking"})]}),!s&&t.unloading_places.map((function(e){return Object(X.jsxs)(vt.a,{variant:"outlined",style:{margin:"8px",padding:"4px"},children:[Object(X.jsx)(jt.a,{style:{padding:0},children:Object(X.jsx)(st.a,{variant:"body2",color:"textSecondary",component:"p",children:e.description_translated||e.description})}),Object(X.jsxs)(mt.a,{style:{padding:0},children:[Object(X.jsx)(h.a,{variant:"contained",size:"small",style:{backgroundColor:"#00afff",color:"#fff"},type:"button","aria-label":"Set origin",onClick:function(){return r(e)},children:"Origin"}),Object(X.jsx)(h.a,{variant:"contained",size:"small",style:{backgroundColor:"#ff5000",color:"#fff"},type:"button","aria-label":"View details",onClick:function(){return i(e.image_note)},children:"View details"})]})]},e.id)}))]})};function xt(){return(xt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function wt(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var kt=f.createElement("defs",{id:"defs2"});function Ct(e,t){var n=e.title,a=e.titleId,o=wt(e,["title","titleId"]);return f.createElement("svg",xt({xmlns:"http://www.w3.org/2000/svg",width:"642mm",height:"642mm",viewBox:"0 0 642 642",id:"svg8",ref:t,"aria-labelledby":a},o),n?f.createElement("title",{id:a},n):null,kt,f.createElement("g",{id:"layer1",transform:"translate(0,345)"},f.createElement("circle",{style:{opacity:1,fill:"#ffcd00",fillOpacity:1,fillRule:"nonzero",stroke:"none",strokeWidth:25.76569176,strokeLinecap:"square",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1},id:"path10",cx:321,cy:-24,r:320}),f.createElement("path",{style:{opacity:1,fill:"#000000",fillOpacity:1,fillRule:"nonzero",stroke:"none",strokeWidth:50,strokeLinecap:"square",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1},d:"m 440.99997,-294.00003 -120,120 -120.00001,-120 z",id:"rect888"}),f.createElement("path",{id:"path902",d:"m 200.99996,245.99997 120.00001,-120 120,120 z",style:{opacity:1,fill:"#000000",fillOpacity:1,fillRule:"nonzero",stroke:"none",strokeWidth:50,strokeLinecap:"square",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1}}),f.createElement("path",{id:"path913",d:"M 321.00008,-273.9998 A 250,250 0 0 0 70.999862,-24.000087 250,250 0 0 0 321.00008,226.00016 250,250 0 0 0 570.99981,-24.000087 250,250 0 0 0 321.00008,-273.9998 Z m 0,9.9999 A 240,240 0 0 1 560.99991,-24.000087 240,240 0 0 1 321.00008,215.99976 240,240 0 0 1 80.999772,-24.000087 240,240 0 0 1 321.00008,-263.9999 Z",style:{opacity:1,fill:"#ffcd00",fillOpacity:1,fillRule:"nonzero",stroke:"none",strokeWidth:20.12944603,strokeLinecap:"square",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1}}),f.createElement("path",{style:{opacity:1,fill:"#e4002b",fillOpacity:1,fillRule:"nonzero",stroke:"none",strokeWidth:24.96051407,strokeLinecap:"square",strokeLinejoin:"round",strokeMiterlimit:4,strokeDasharray:"none",strokeDashoffset:0,strokeOpacity:1},d:"M 321.00008,-334.00028 A 309.99998,309.99998 0 0 0 10.999875,-24.000087 309.99998,309.99998 0 0 0 321.00008,286.00012 309.99998,309.99998 0 0 0 630.99977,-24.000087 309.99998,309.99998 0 0 0 321.00008,-334.00028 Z m 0,65.00018 A 245,245 0 0 1 566.00011,-24.000087 245,245 0 0 1 321.00008,220.99996 245,245 0 0 1 76.000072,-24.000087 245,245 0 0 1 321.00008,-269.0001 Z",id:"path915"})))}var Et=f.forwardRef(Ct),_t=(n.p,"English|en,Finnish|fi,Swedish|sv,Afrikaans|af,Albanian|sq,Amharic|am,Arabic|ar,Armenian|hy,Azerbaijani|az,Basque|eu,Belarusian|be,Bengali|bn,Bosnian|bs,Bulgarian|bg,Catalan|ca,Cebuano|ceb,Chinese (Simplified)|zh-CN,Chinese (Traditional)|zh-TW,Corsican|co,Croatian|hr,Czech|cs,Danish|da,Dutch|nl,Esperanto|eo,Estonian|et,French|fr,Frisian|fy,Galician|gl,Georgian|ka,German|de,Greek|el,Gujarati|gu,Haitian Creole|ht,Hausa|ha,Hawaiian|haw,Hebrew|he,Hindi|hi,Hmong|hmn,Hungarian|hu,Icelandic|is,Igbo|ig,Indonesian|id,Irish|ga,Italian|it,Japanese|ja,Javanese|jv,Kannada|kn,Kazakh|kk,Khmer|km,Kinyarwanda|rw,Korean|ko,Kurdish|ku,Kyrgyz|ky,Lao|lo,Latvian|lv,Lithuanian|lt,Luxembourgish|lb,Macedonian|mk,Malagasy|mg,Malay|ms,Malayalam|ml,Maltese|mt,Maori|mi,Marathi|mr,Mongolian|mn,Myanmar (Burmese)|my,Nepali|ne,Norwegian|no,Nyanja (Chichewa)|ny,Odia (Oriya)|or,Pashto|ps,Persian|fa,Polish|pl,Portuguese (Portugal, Brazil)|pt,Punjabi|pa,Romanian|ro,Russian|ru,Samoan|sm,Scots Gaelic|gd,Serbian|sr,Sesotho|st,Shona|sn,Sindhi|sd,Sinhala (Sinhalese)|si,Slovak|sk,Slovenian|sl,Somali|so,Spanish|es,Sundanese|su,Swahili|sw,Tagalog (Filipino)|tl,Tajik|tg,Tamil|ta,Tatar|tt,Telugu|te,Thai|th,Turkish|tr,Turkmen|tk,Ukrainian|uk,Urdu|ur,Uyghur|ug,Uzbek|uz,Vietnamese|vi,Welsh|cy,Xhosa|xh,Yiddish|yi,Yoruba|yo,Zulu|zu".split(",").map((function(e){return e.split("|")}))),St=function(e){return e&&(e.maxheight||e["maxheight:physical"]||e.height)},Pt=function(e,t,n){return Object(X.jsxs)(X.Fragment,{children:[e["".concat(t,"_translated")]||e[t],e["".concat(t,"_translated")]&&e["".concat(t,"_translated")]!==e[t]&&Object(X.jsxs)("span",{children:[" ",Object(X.jsx)("a",{href:"#",style:{display:"inline",color:"#aaa",background:"none",border:"none",textDecoration:"none"},onClick:function(e){e.preventDefault(),n("")},children:"Translated by Google. View original."})]})]})},Mt=function(e){var t,n=e.open,a=e.collapsed,o=e.venue,r=e.venueOlmapData,i=e.restrictions,c=e.locale,l=e.onClose,s=e.onEntranceSelected,u=e.onUnloadingPlaceSelected,d=e.onCollapsingToggled,f=e.onViewDetails,b=e.onRestrictionSelected,h=e.onLocaleSelected;if(!o||!n)return null;var v="success"===(null===r||void 0===r?void 0:r.state)&&r.response.workplace||void 0,j=null===v||void 0===v?void 0:v.workplace_entrances,O=new Map;null===i||void 0===i||i.features.filter((function(e){return St(e.properties)})).forEach((function(e){var t;O.set(null===(t=e.properties)||void 0===t?void 0:t["@id"],e)}));var x=Array.from(O.values());return Object(X.jsxs)(ut.a,{open:n,anchor:"bottom",variant:"persistent",elevation:8,PaperProps:{style:{maxHeight:"45%",width:"100%",maxWidth:"600px",left:"50%",transform:"translateX(-50%)"},elevation:8},children:[Object(X.jsxs)(ce.a,{children:[v&&Object(X.jsx)(g.a,{style:{position:"absolute",top:"8px",left:"8px"},onClick:function(){return d()},children:a?Object(X.jsx)(ft.a,{}):Object(X.jsx)(ht.a,{})}),o&&Object(X.jsx)(g.a,{"aria-label":"Comment",href:"https://app.olmap.org/#/ww/osm/".concat(o.type,"/").concat(o.id),target:"_blank",rel:"noopener noreferrer",style:{position:"absolute",top:"8px",left:"48px"},children:Object(X.jsx)(y.a,{style:{color:"#ff5000"}})}),(null===v||void 0===v?void 0:v.max_vehicle_height)&&Object(X.jsxs)("div",{style:{display:"inline-block",position:"relative",width:"2em",height:"2em",verticalAlign:"middle",marginRight:"0.5em"},children:[Object(X.jsx)(Et,{style:{width:"100%",height:"100%"}}),Object(X.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",fontSize:"0.7em",display:"flex",alignItems:"center",justifyContent:"center"},children:v.max_vehicle_height})]}),(null===v||void 0===v?void 0:v.as_osm_tags.name)||(null===(t=o.tags)||void 0===t?void 0:t.name)||"",Object(X.jsx)(g.a,{style:{position:"absolute",top:"8px",right:"8px"},onClick:l,children:Object(X.jsx)(m.a,{})})]}),v&&Object(X.jsxs)(lt.a,{style:{display:a?"none":"block",overflow:"auto",textAlign:"left",paddingTop:0},children:[Object(X.jsx)("div",{style:{float:"right"},children:Object(X.jsxs)(dt.a,{inputProps:{id:"locale",name:"locale"},onChange:function(e){var t=e.target.value;t!==c&&h(t)},style:{paddingTop:0,maxWidth:90},children:[Object(X.jsx)("option",{value:"",selected:""===c,children:""===c?"Translate":"Original"},""),_t.map((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(X.jsx)("option",{value:a,selected:c===a,children:n},a)}))]})}),x.map((function(e){var t;return Object(X.jsxs)("button",{type:"button",style:{float:"left",position:"relative",width:"2em",height:"2em",border:"none",background:"none",padding:0},onClick:function(){return"Point"===e.geometry.type&&b(e)},children:[Object(X.jsx)(Et,{style:{width:"100%",height:"100%"}}),Object(X.jsx)("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",fontSize:"0.7em",display:"flex",alignItems:"center",justifyContent:"center"},children:St(e.properties)})]},null===(t=e.properties)||void 0===t?void 0:t["@id"])})),Object(X.jsx)(st.a,{variant:"body2",color:"textSecondary",component:"p",children:Pt(v,"delivery_instructions",h)}),Object(X.jsx)("div",{style:{clear:"both"}}),null===j||void 0===j?void 0:j.map((function(e,t){return Object(X.jsx)(Ot,{workplaceEntrance:e,workplace:v,onEntranceSelected:s,onUnloadingPlaceSelected:u,onViewDetails:f,label:Object(le.romanize)(t+1)},e.id)}))]})]})},Dt=500,Tt=function(e){return{id:-1,type:"node",lat:e[0],lon:e[1]}},Nt=function(e){return[e.lat,e.lon]},Lt=function(e){var t,n=null===(t=e.properties)||void 0===t?void 0:t["@id"].split("/").reverse(),a=Object(p.a)(n,2),o=a[0],r=a[1];return{id:parseInt(o,10),type:r,lat:e.geometry.coordinates[1],lon:e.geometry.coordinates[0],tags:e.properties||void 0}},zt={type:"FeatureCollection",features:[]},Rt={entrances:[],route:Me(),highlights:zt,viewport:{latitude:60.17,longitude:24.941,zoom:15,bearing:0,pitch:0},isOriginExplicit:!1,isGeolocating:!1,geolocationPosition:null,popupCoordinates:null,routableTiles:new Map,venueDialogOpen:!1,venueDialogCollapsed:!1,venueFeatures:zt,showTunnels:!1,locale:""},It=[60.17066815612902,24.941510260105133],Ft=function(e){return{url:e.replace("https://static.hsldev.com/mapfonts/Klokantech Noto Sans","https://fonts.openmaptiles.org/Klokantech Noto Sans")}},Wt=function(e,t){return Object(k.a)([e[1],e[0]],[t[1],t[0]],{units:"meters"})},At=function(e){if(e){var t=e.split(",");if(2===t.length&&t[0].length&&t[1].length){var n=t.map(Number),a=Object(p.a)(n,2),o=a[0],r=a[1];if(!Number.isNaN(o)&&r>-90&&r<90)return[o,r]}}},Bt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=new w.a(e),o=t.filter((function(e){return e}));if(!o.length)return e;var r=Math.min.apply(Math,Object(d.a)(o.map((function(e){return e[1]})))),i=Math.max.apply(Math,Object(d.a)(o.map((function(e){return e[1]})))),c=Math.min.apply(Math,Object(d.a)(o.map((function(e){return e[0]})))),l=Math.max.apply(Math,Object(d.a)(o.map((function(e){return e[0]})))),s=20,u=50,p=40,f=n*e.height,b=5,h=a.fitBounds([[r,c],[i,l]],{padding:{top:s+p+u,bottom:s+f+b,left:s+u/2,right:s+u/2},maxZoom:n?void 0:17});return h};t.default=function(){var e,t,n,a,o,r,i,c,v,j,w,k,_=Object(f.useRef)(null),S=Object(f.useRef)(null);Object(f.useEffect)((function(){if(_.current){var e=_.current.getMap();null===e||void 0===e||e.on("styleimagemissing",(function(t){var n=t.id;if(null===n||void 0===n?void 0:n.startsWith("icon-svg-")){var a,o=n.split("-"),r=Object(p.a)(o,6),i=r[2],c=r[3],l=r[4],s=r[5];if("pin"===i)a=Q;else if("triangle"===i)a=re;else{if("triangleDot"!==i)return;a=oe}var u=a(c,"fill: ".concat(l,"; stroke: ").concat(s));!function(e,t,n,a){var o=window.devicePixelRatio,r=document.createElement("canvas");r.width=o*a,r.height=o*a;var i=r.getContext("2d"),c=new Image(a,a),l="data:image/svg+xml,".concat(encodeURIComponent(n));c.onload=function(){if(!i)throw Error("canvas.getContext failed");i.drawImage(c,0,0,o*a,o*a),e.addImage(t,i.getImageData(0,0,o*a,o*a),{pixelRatio:o})},c.src=l}(e,n,u,c)}}))}}),[_]);var P=Object(b.e)({path:"/route/:from?/:to?"}),M=Object(b.e)({path:"/search/:query?"}),D=Object(b.e)({path:"/osm/:type?/:id?"}),T=Object(f.useState)(Rt),N=Object(p.a)(T,2),L=N[0],z=N[1],R=function(e,t,n){var a;return Bt(Object(u.a)(Object(u.a)({},e),He(null===(a=_.current)||void 0===a?void 0:a.getMap())),t,n)};Object(f.useEffect)((function(){if(_.current&&L.viewport.zoom&&!(L.viewport.zoom<12)){var e=He(_.current.getMap()),t=e.width,n=e.height,a=Math.pow(2,13-L.viewport.zoom),o=tt(a*t,a*n,[L.viewport.longitude,L.viewport.latitude],14),r=new Map;o.forEach((function(e){var t=e.zoom,n=e.x,a=e.y,o="".concat(t,"/").concat(n,"/").concat(a);r.set(o,L.routableTiles.get(o)||null)})),z((function(e){return Object(u.a)(Object(u.a)({},e),{},{routableTiles:r})})),o.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a,o,i,c,s,d;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.zoom,a=t.x,o=t.y,i="".concat(n,"/").concat(a,"/").concat(o),null===r.get(i)){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,fetch("https://tile.olmap.org/building-tiles/".concat(n,"/").concat(a,"/").concat(o));case 6:return c=e.sent,e.next=9,c.json();case 9:s=e.sent,d=Ye(s),z((function(e){if(null!==e.routableTiles.get(i))return e;var t=new Map(e.routableTiles);return t.set(i,d),Object(u.a)(Object(u.a)({},e),{},{routableTiles:t})}));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}),[_.current,L.viewport]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a,o,r,i,c,p,f,b,h,g,v;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.current&&L.viewport.zoom){e.next=2;break}return e.abrupt("return");case 2:if(!(L.viewport.zoom<12)){e.next=4;break}return e.abrupt("return");case 4:return n=function(){var e=Object(s.a)(l.a.mark((function e(t,n,a){var o,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://api.olmap.org/kartta.hel.fi/maps/featureloader.ashx",{method:"POST",body:new URLSearchParams({request:"select",id:t,resolution:"1",params:"{}",where:"BBOX 'ENVELOPE(".concat(a,")'"),sort:"",gproj:"",aproj:"",maxfeatures:"50000",skipfeatures:"",ibbox:a,capfeatures:"1",outputType:"geojson",srs:"EPSG:3879"})});case 2:return o=e.sent,e.next=5,o.json();case 5:return r=e.sent,e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}(),a=_.current.getMap().getBounds(),o="".concat(a.getWest(),",").concat(a.getSouth(),",").concat(a.getEast(),",").concat(a.getNorth()),r=ot([a.getWest(),a.getSouth()]),i=ot([a.getEast(),a.getNorth()]),c="".concat(Math.floor(r[0]),",").concat(Math.floor(r[1]),",").concat(Math.floor(i[0]),",").concat(Math.floor(i[1])),p=["pysakointipaikat_kuormauspaikat","pysakointipaikat_pysakointikielto","pysakointipaikat_sallitut_kiellon_ulkopuolella"],e.next=13,Promise.all(p.map((function(e){return n(e,o,c)})));case 13:f=e.sent,b=(t=zt.features).concat.apply(t,Object(d.a)(f.map((function(e){return e.features})))),h=ct(b),g=h.map((function(e){return"Point"===e.geometry.type?Object(u.a)(Object(u.a)({},e),{},{geometry:Object(u.a)(Object(u.a)({},e.geometry),{},{coordinates:rt(e.geometry.coordinates)})}):"Polygon"===e.geometry.type?Object(u.a)(Object(u.a)({},e),{},{geometry:Object(u.a)(Object(u.a)({},e.geometry),{},{coordinates:e.geometry.coordinates.map((function(e){return e.map((function(e){return rt(e)}))}))})}):e})),v={type:"FeatureCollection",features:g},z((function(e){return Object(u.a)(Object(u.a)({},e),{},{parkingData:v})}));case 19:case"end":return e.stop()}}),e)})))().catch((function(e){console.error("Error while fetching parking data:",e)}))}),[_.current,L.viewport]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.current&&L.viewport.zoom){e.next=2;break}return e.abrupt("return");case 2:if(!(L.viewport.zoom<12)){e.next=4;break}return e.abrupt("return");case 4:if(L.showTunnels){e.next=6;break}return e.abrupt("return");case 6:return t=_.current.getMap().getBounds(),n="".concat(t.getWest(),",").concat(t.getSouth(),",").concat(t.getEast(),",").concat(t.getNorth()),e.next=10,Ue(n);case 10:a=e.sent,z((function(e){return Object(u.a)(Object(u.a)({},e),{},{tunnelData:a})}));case 12:case"end":return e.stop()}}),e)})))().catch((function(e){console.error("Error while fetching tunnel data:",e)}))}),[_.current,L.viewport,L.showTunnels]),Object(f.useEffect)((function(){if(_.current){var e=He(_.current.getMap()),t=e.width,n=e.height;if(P&&null!=t&&t>0&&null!=n&&n>0){var a=At(P.params.from),o=At(P.params.to),r=Object(u.a)(Object(u.a)({},L.viewport),{},{width:t,height:n}),i=Bt(r,[a,o]);z((function(e){return Object(u.a)(Object(u.a)({},e),{},{origin:a,isOriginExplicit:null!=a,destination:o&&Tt(o),viewport:Object(u.a)(Object(u.a)({},e.viewport),i)})}))}}}),[_]);var I=Object(b.d)(),F=Object(O.b)(),W=null===F||void 0===F?void 0:F.enqueueSnackbar,A=null===F||void 0===F?void 0:F.closeSnackbar;Object(f.useEffect)((function(){var e=L.destination&&[L.destination.lat,L.destination.lon],t="/route/".concat(L.origin,"/").concat(e,"/");if(I.location.pathname!==t){var n=t;if(/utm_source=/.exec(I.location.search)){var a=new URLSearchParams(I.location.search).get("utm_source");if(null!==a){var o=new URLSearchParams({utm_source:a});n="".concat(t,"?").concat(o)}}I.replace(n)}}),[I,L.origin,L.destination]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a,o,r,i,c,s,d,p,f,b,h,g;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L.destination){e.next=2;break}return e.abrupt("return");case 2:if(n=[],a=L.venueOlmapData,o=L.venueFeatures,-1!==L.destination.id&&(null===(t=L.entrances)||void 0===t?void 0:t.find((function(e){var t;return e.id===(null===(t=L.destination)||void 0===t?void 0:t.id)})))&&(n=L.entrances.slice()),e.prev=5,L.destination.id!==(null===(r=L.venue)||void 0===r?void 0:r.id)||"success"!==(null===(i=a)||void 0===i?void 0:i.state)||(null===(c=a.response.workplace)||void 0===c?void 0:c.osm_feature)!==L.destination.id){e.next=10;break}n=o.features.map((function(e){return Lt(e)})),e.next=22;break;case 10:if(L.destination.id!==(null===(s=L.venue)||void 0===s?void 0:s.id)){e.next=22;break}return e.next=13,fe(L.venue.id,L.locale);case 13:if(a=e.sent,o=zt,"success"!==(null===(d=a)||void 0===d?void 0:d.state)){e.next=22;break}return b=null===(p=a.response.workplace)||void 0===p?void 0:p.workplace_entrances,h=null===b||void 0===b?void 0:b.map((function(e){return e.entrance_data.osm_feature||0})),e.next=20,Be(h||[]);case 20:n=e.sent,(null===(f=a.response.workplace)||void 0===f?void 0:f.workplace_entrances)&&(g=[],null===b||void 0===b||b.forEach((function(e){var t=n.find((function(t){return t.id===e.entrance_data.osm_feature}));t?g.push(t):g.push({lat:Number(e.image_note.lat),lon:Number(e.image_note.lon),id:e.image_note.id,type:"olmap",tags:e.entrance_data.as_osm_tags})})),o=be(a,g),n=g);case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(5),console.error("Error while fetching venue entrances:",e.t0);case 27:if(e.prev=27,n.length){e.next=32;break}return e.next=31,Ie(L.destination);case 31:n=e.sent;case 32:e.next=37;break;case 34:e.prev=34,e.t1=e.catch(27),console.error("Error while fetching building entrances:",e.t1);case 37:z((function(e){if(!L.destination)return e;if(e.destination!==L.destination)return e;var t=n.length?n:[L.destination];return Object(u.a)(Object(u.a)({},e),{},{entrances:t,venueOlmapData:a,venueFeatures:o})}));case 38:case"end":return e.stop()}}),e,null,[[5,24],[27,34]])})))().catch((function(e){console.error("Error while handling entrances:",e)}))}),[L.destination,L.venue]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a,o,r,i,c,s,d,f,b,v,j,y,O,x,w,k,E,_,S,P,M;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L.snackbar&&A(L.snackbar),L.destination&&L.entrances){e.next=3;break}return e.abrupt("return");case 3:if(o=L.origin,r=[],L.entrances.forEach((function(e){L.destination&&L.destination.type===e.type&&L.destination.id===e.id&&(r=[e])})),r.length||(r=L.entrances),z((function(e){return Object(u.a)(Object(u.a)({},e),{},{route:Me()})})),i=[],L.destination.id===(null===(t=L.venue)||void 0===t?void 0:t.id)&&(i=ge(L.venueOlmapData)),!(c="success"===(null===(n=L.venueOlmapData)||void 0===n?void 0:n.state)&&(null===(a=L.venueOlmapData.response.workplace)||void 0===a?void 0:a.workplace_entrances.find((function(e){var t,n;return e.entrance_data.osm_feature===(null===(t=L.destination)||void 0===t?void 0:t.id)||e.image_note.id===(null===(n=L.destination)||void 0===n?void 0:n.id)})))||void 0)||!c.unloading_places.length){e.next=15;break}i=c.unloading_places,e.next=27;break;case 15:if(!i.length){e.next=19;break}L.unloadingPlace&&(s=i.find((function(e){var t;return e.id===(null===(t=L.unloadingPlace)||void 0===t?void 0:t.id)})))&&(i=[s]),e.next=27;break;case 19:if(L.origin&&!(Wt(L.origin,Nt(L.destination))>=Dt)){e.next=27;break}if((null===(d=L.destination.tags)||void 0===d?void 0:d["addr:street"])?(f=L.destination,b=null===(v=L.destination.tags)||void 0===v?void 0:v["addr:street"]):(y=r,O=Object(p.a)(y,1),f=O[0],b=null===(j=f.tags)||void 0===j?void 0:j["addr:street"]),!b){e.next=27;break}return e.next=24,We(f,b);case 24:x=e.sent,w=Object(C.a)(x,[f.lon,f.lat]).geometry.coordinates,o=[w[1],w[0]];case 27:if(o||i.length){e.next=29;break}return e.abrupt("return");case 29:if(!(!i.length&&o&&o===L.origin&&Wt(o,Nt(L.destination))>=Dt)){e.next=34;break}return k=L.isOriginExplicit?"Origin is too far for showing routes.":"Routes show when distance is shorter.",E=W(k,{variant:"info",persist:!0,anchorOrigin:{vertical:"bottom",horizontal:"center"},action:Object(X.jsxs)(X.Fragment,{children:[L.isOriginExplicit&&Object(X.jsx)(h.a,{color:"inherit",onClick:function(){z((function(e){return Object(u.a)(Object(u.a)({},e),{},{origin:e.geolocationPosition||void 0,isOriginExplicit:!1,viewport:R(e.viewport,[e.destination&&Nt(e.destination)])})}))},children:"Undo origin"}),Object(X.jsx)(h.a,{color:"inherit",onClick:function(){z((function(e){return Object(u.a)(Object(u.a)({},e),{},{destination:void 0,entrances:[],viewport:R(e.viewport,[e.origin])})}))},children:"Undo destination"}),Object(X.jsx)(h.a,{color:"inherit",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps/dir/?api=1&origin=".concat(L.origin[0],",").concat(L.origin[1],"&destination=").concat(L.destination.lat,",").concat(L.destination.lon,"&travelmode=driving"),children:"Google Maps"}),Object(X.jsx)(g.a,{"aria-label":"close",onClick:function(){return A(E)},children:Object(X.jsx)(m.a,{})})]})}),z((function(e){return Object(u.a)(Object(u.a)({},e),{},{snackbar:E})})),e.abrupt("return");case 34:return _=[],i.length?L.destination.id===(null===(S=L.venue)||void 0===S?void 0:S.id)?(l=L.venueOlmapData,P=he(l)[1],i.forEach((function(e){P[e.id].forEach((function(t){var n,a,o=null===(n=L.entrances)||void 0===n?void 0:n.find((function(e){return e.id===t}));o&&"olmap"!==o.type&&_.push([ue(e.image_note),o,"delivery-walking"]),null===(a=e.access_points)||void 0===a||a.forEach((function(t){_.push([Tt([Number(t.lat),Number(t.lon)]),Object(u.a)(Object(u.a)({},ue(e.image_note)),{},{lat:Number(e.image_note.lat)+1e-6,lon:Number(e.image_note.lon)+1e-6}),"delivery-car"])}))}))}))):null===c||void 0===c||null===(M=c.unloading_places)||void 0===M||M.forEach((function(e){var t;L.destination&&"olmap"!==L.destination.type&&_.push([ue(e.image_note),L.destination,"delivery-walking"]),null===(t=e.access_points)||void 0===t||t.forEach((function(t){_.push([Tt([Number(t.lat),Number(t.lon)]),Object(u.a)(Object(u.a)({},ue(e.image_note)),{},{lat:Number(e.image_note.lat)+1e-6,lon:Number(e.image_note.lon)+1e-6}),"delivery-car"])}))})):r.forEach((function(e){o&&_.push([Tt(o),e])})),e.next=38,De(_,(function(e){z((function(t){if(L.origin!==t.origin||L.entrances!==t.entrances||L.destination!==t.destination)return t;var n=Object(u.a)(Object(u.a)({},e),{},{features:e.features.concat(t.route.features)});return Object(u.a)(Object(u.a)({},t),{},{route:n})}))}));case 38:case"end":return e.stop()}var l}),e)})))().catch((function(e){console.error("Error while starting route planning:",e)}))}),[L.origin,L.entrances,L.unloadingPlace]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(L.popupCoordinates){e.next=2;break}return e.abrupt("return");case 2:return z((function(e){return e.popupCoordinates!==L.popupCoordinates?e:Object(u.a)(Object(u.a)({},e),{},{olmapData:{state:"loading"}})})),e.next=5,fe(L.popupCoordinates.id,L.locale);case 5:t=e.sent,z((function(e){return e.popupCoordinates!==L.popupCoordinates?e:Object(u.a)(Object(u.a)({},e),{},{olmapData:t})}));case 7:case"end":return e.stop()}}),e)})))().catch((function(e){console.error("Error while fetching OLMap notes:",e)}))}),[L.popupCoordinates,L.locale]),Object(f.useEffect)((function(){var e;"success"===(null===(e=L.venueOlmapData)||void 0===e?void 0:e.state)&&L.venueOlmapData.response.workplace&&z((function(e){var t,n=L.destination&&Nt(L.destination),a=e.origin&&n&&Wt(e.origin,n)<Dt?[e.origin,n]:[n],o=(null===(t=L.entrances)||void 0===t?void 0:t.map(Nt))||[],r=L.venue&&[Nt(L.venue)]||[],i=ge(L.venueOlmapData),c=i.map((function(e){return[Number(e.image_note.lat),Number(e.image_note.lon)]})),l=[];i.forEach((function(e){var t;return null===(t=e.access_points)||void 0===t?void 0:t.forEach((function(e){l.push([Number(e.lat),Number(e.lon)])}))}));var s=R(e.viewport,[].concat(a,Object(d.a)(o),Object(d.a)(r),Object(d.a)(c),l),.5);return Object(u.a)(Object(u.a)({},e),{},{viewport:s})}))}),[L.venueOlmapData]);var K=function(e){var t,n=null===(t=_.current)||void 0===t?void 0:t.getMap().queryRenderedFeatures(e.point)[0];z((function(t){var a,o={type:"FeatureCollection",features:[]},r=Tt([e.lngLat.lat,e.lngLat.lng]);if("parking"===(null===n||void 0===n?void 0:n.source)){var i={};return"Pys\xe4k\xf6inti sallittu pys\xe4k\xf6intikieltoajan ulkopuolella"===n.properties["hel:luokka_nimi"]?i["Pys\xe4k\xf6intikielto"]=n.properties["hel:voimassaolo"]||"":i[n.properties["hel:tyyppi"]]="",n.properties["hel:paikat_ala"]&&(i["Henkil\xf6autoja"]=n.properties["hel:paikat_ala"]),i.ID=n.properties["hel:id"],Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:{type:"node",id:-1,lat:e.lngLat.lat,lon:e.lngLat.lng,tags:i},highlights:o})}if(null===n||void 0===n||null===(a=n.properties["@id"])||void 0===a?void 0:a.startsWith("olmap"))return Object(u.a)(Object(u.a)({},t),{},{editingNote:n.properties["@id"].split("/").reverse()[0]});if((null===n||void 0===n?void 0:n.properties.entrance)||"loading"===(null===n||void 0===n?void 0:n.properties["parking:condition"])){var c=Lt(n);return Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:c,highlights:o})}if((null===n||void 0===n?void 0:n.properties.barrier)||"steps"===(null===n||void 0===n?void 0:n.properties.highway)||(null===n||void 0===n?void 0:n.properties["@obstacle"])){var l=n.properties["@id"].split("/").reverse()[0],s="Point"===n.geometry.type?n.geometry.coordinates:Object(C.a)(n,e.lngLat.toArray()).geometry.coordinates,d=Object(p.a)(s,2),f=d[0],b=d[1];return Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:{id:l,type:n.properties["@type"],lat:b,lon:f,tags:n.properties},highlights:o})}return null!=t.popupCoordinates?Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:null,highlights:o}):"building"===(null===n||void 0===n?void 0:n.sourceLayer)?Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:r,highlights:n.toJSON()}):Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:r,highlights:o})}))},V=function(e){var t,n;return"success"===(null===e||void 0===e?void 0:e.state)&&(null===(t=e.response.image_notes)||void 0===t||null===(n=t[0])||void 0===n?void 0:n.id)},Z=function(e){var t=V(L.olmapData);t&&(z((function(e){return Object(u.a)(Object(u.a)({},e),{},{editingNote:t})})),e.preventDefault())},$=Object(f.useCallback)((function(e){setTimeout((function(){S.current.blur()}));var t=[e.geometry.coordinates[1],e.geometry.coordinates[0]],n=e.properties.source_id.split(":"),a=Object(p.a)(n,2),o=a[0],r=a[1];z((function(n){var a=n.origin&&Wt(n.origin,t)<Dt?[n.origin,t]:[t],i=R(n.viewport,a),c={lat:t[0],lon:t[1],type:o,id:Number(r),tags:{name:e.properties.name,"addr:street":e.properties.street}};return Object(u.a)(Object(u.a)({},n),{},{origin:n.origin,destination:c,entrances:[],venue:c,venueDialogOpen:"venue"===e.properties.layer,venueDialogCollapsed:!1,venueOlmapData:void 0,viewport:Object(u.a)(Object(u.a)({},n.viewport),i),venueFeatures:zt,unloadingPlace:void 0})}))}),[]);return Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null===M||void 0===M?void 0:M.params.query){e.next=3;break}return e.abrupt("return");case 3:return S.current.update(n),e.next=6,S.current.autocomplete(n);case 6:if(e.t1=t=e.sent,e.t0=null===e.t1,e.t0){e.next=10;break}e.t0=void 0===t;case 10:if(!e.t0){e.next=14;break}e.t2=void 0,e.next=15;break;case 14:e.t2=t.features;case 15:(null===(a=e.t2)||void 0===a?void 0:a.length)?1===(null===a||void 0===a?void 0:a.length)?(S.current.update(a[0].properties.label),$(a[0])):S.current.focus():alert("Search did not produce any results");case 17:case"end":return e.stop()}}),e)})))().catch((function(e){console.error("Error while geocoding the query from a link:",e)}))}),[M,$]),Object(f.useEffect)((function(){Object(s.a)(l.a.mark((function e(){var t,n,a,o,r,i,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}return e.abrupt("return");case 2:if(t=null===D||void 0===D?void 0:D.params.type,n=Number(null===D||void 0===D?void 0:D.params.id),-1!==["node","way","relation"].indexOf(t)&&n>0){e.next=7;break}return alert("Broken link"),e.abrupt("return");case 7:if("node"!==t){e.next=13;break}return e.next=10,Be([n]);case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,qe(t,[n]);case 15:e.t0=e.sent;case 16:(a=e.t0).length?(o=a[0],r=o.tags||{},i="".concat(r["addr:street"]||""," ").concat(r["addr:housenumber"]||""," ").concat(r.ref||r["addr:unit"]||""),S.current.update(r.name&&i.replace(/ /g,"")?"".concat(r.name,", ").concat(i):r.name||i),c="center"in o?[o.center.lon,o.center.lat]:[o.lon,o.lat],$({geometry:{coordinates:c},properties:{source_id:"".concat(o.type,":").concat(o.id),street:r["addr:street"],name:r.name,layer:r.name?"venue":void 0}})):alert("Linked map feature not found");case 18:case"end":return e.stop()}}),e)})))().catch((function(e){console.error("Error while resolving the OSM id from a link:",e)}))}),[D,$]),Object(X.jsxs)("div",{"data-testid":"app",className:"App",children:[Object(X.jsx)("header",{className:"App-header",children:Object(X.jsx)("h2",{children:"Gatesolve"})}),Object(X.jsx)("div",{className:"App-shadow"}),Object(X.jsx)(E.ReactAutosuggestGeocoder,{ref:S,url:"https://api.digitransit.fi/geocoding/v1",sources:"oa,osm,nlsfi",highlightFirstSuggestion:!0,inputProps:{placeholder:"Destination name or address"},center:{latitude:(null===(e=L.geolocationPosition)||void 0===e?void 0:e[0])||(null===(t=L.origin)||void 0===t?void 0:t[0])||(null===(n=L.destination)||void 0===n?void 0:n.lat)||It[0],longitude:(null===(a=L.geolocationPosition)||void 0===a?void 0:a[1])||(null===(o=L.origin)||void 0===o?void 0:o[1])||(null===(r=L.destination)||void 0===r?void 0:r.lon)||It[1]},onSuggestionSelected:function(e,t){var n=t.suggestion;$(n)}}),Object(X.jsxs)(x.e,Object(u.a)(Object(u.a)({ref:_},L.viewport),{},{style:{width:"100%",height:"90%"},mapStyle:"https://raw.githubusercontent.com/HSLdevcom/hsl-map-style/master-old/simple-style.json",dragRotate:!1,transformRequest:Ft,onViewportChange:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{viewport:e})}))},onHover:function(e){var t,n=null===(t=e.features)||void 0===t?void 0:t[0],a=(null===n||void 0===n?void 0:n.properties.entrance)?"pointer":"grab",o=document.querySelector(".overlays");o&&(o.style.cursor=a)},onClick:K,onContextmenu:K,children:[Object(X.jsx)(ye,{dataTestId:"geolocate-control",enableOnMount:!0,onEnable:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{isOriginExplicit:!e&&t.isOriginExplicit,isGeolocating:!0})}))},onDisable:function(){z((function(e){return Object(u.a)(Object(u.a)({},e),{},{isGeolocating:!1,geolocationPosition:null})}))},onGeolocate:function(e){return z((function(t){if(t.isGeolocating){var n=null==t.geolocationPosition,a=[e.coords.latitude,e.coords.longitude],o=!n||t.isOriginExplicit||t.venue&&t.destination&&Wt(a,Nt(t.destination))>Dt?t.viewport:R(t.viewport,[a,t.destination&&Nt(t.destination)]),r=Object(u.a)(Object(u.a)({},t),{},{geolocationPosition:a,viewport:o});return!t.isOriginExplicit&&(null==t.origin||Wt(t.origin,a)>20)?Object(u.a)(Object(u.a)({},r),{},{origin:a}):r}return t}))}}),Object(X.jsx)(Ee,{dataTestId:"tunnels-control",enabled:L.showTunnels,setEnabled:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{showTunnels:e})}))}}),null!=L.geolocationPosition&&Object(X.jsx)(x.b,{offset:[-20,-20],longitude:L.geolocationPosition[1],latitude:L.geolocationPosition[0],children:Object(X.jsx)(je,{dataTestId:"user-marker"})}),Array.from(L.routableTiles.entries(),(function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return a&&Object(X.jsx)(x.d,{id:"source-".concat(n),type:"geojson",data:a,children:J.map((function(e){return Object(f.createElement)(x.a,Object(u.a)(Object(u.a)({},e),{},{key:"".concat(e.id,"-").concat(n),id:"".concat(e.id,"-").concat(n),source:"source-".concat(n),before:"housenum_label"}))}))},n)})),Object(X.jsx)(x.d,{id:"parking",type:"geojson",data:L.parkingData||zt,children:U.map((function(e){return Object(f.createElement)(x.a,Object(u.a)(Object(u.a)({},e),{},{key:e.id,source:"parking",before:"housenum_label"}))}))}),Object(X.jsx)(x.d,{id:"tunnels",type:"geojson",data:L.tunnelData||zt,children:L.showTunnels&&H.map((function(e){return Object(f.createElement)(x.a,Object(u.a)(Object(u.a)({},e),{},{key:e.id,source:"tunnels",before:"road_street_label_fisv"}))}))}),Object(X.jsx)(x.d,{id:"highlights",type:"geojson",data:L.highlights,children:Object(X.jsx)(x.a,Object(u.a)(Object(u.a)({},q),{},{source:"highlights",before:"housenum_label"}))}),Object(X.jsx)(x.d,{id:"venue",type:"geojson",data:L.venueFeatures,children:B.map((function(e){return Object(f.createElement)(x.a,Object(u.a)(Object(u.a)({},e),{},{key:e.id,source:"venue"}))}))}),Object(X.jsx)(x.d,{id:"route",type:"geojson",data:L.route,children:G.map((function(e){return Object(f.createElement)(x.a,Object(u.a)(Object(u.a)({},e),{},{key:e.id,source:"route",before:"venue-symbol"}))}))}),L.origin&&Object(X.jsx)(x.b,{className:"PinMarker",draggable:!0,offset:[0,-22.5],onDragEnd:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{origin:[e.lat,e.lng],isOriginExplicit:!0})}))},longitude:L.origin[1],latitude:L.origin[0],children:Object(X.jsx)(ee,{dataTestId:"origin",style:{fill:"#00afff",stroke:"#fff"}})}),L.destination&&Object(X.jsx)(x.b,{className:"PinMarker",draggable:!0,offset:[0,-22.5],onDragEnd:function(e){S.current.clear(),z((function(t){return Object(u.a)(Object(u.a)({},t),{},{destination:Tt([e.lat,e.lng])})}))},longitude:L.destination.lon,latitude:L.destination.lat,children:Object(X.jsx)(ee,{dataTestId:"destination",style:{fill:"#64be14",stroke:"#fff"}})}),L.popupCoordinates&&Object(X.jsxs)(x.c,{open:null!=L.popupCoordinates,latitude:(null===(i=L.popupCoordinates)||void 0===i?void 0:i.lat)||null,longitude:(null===(c=L.popupCoordinates)||void 0===c?void 0:c.lon)||null,maxWidth:"260px",closeButton:!1,closeOnClick:!1,children:[Object(X.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"30px 1fr 30px"},children:[Object(X.jsx)("div",{}),Object(X.jsxs)("div",{style:{fontSize:"14px",fontWeight:"bold"},children:[null===(v=L.popupCoordinates.tags)||void 0===v?void 0:v["addr:street"]," ",null===(j=L.popupCoordinates.tags)||void 0===j?void 0:j["addr:housenumber"]," ",(null===(w=L.popupCoordinates.tags)||void 0===w?void 0:w.ref)||(null===(k=L.popupCoordinates.tags)||void 0===k?void 0:k["addr:unit"])]}),Object(X.jsx)("div",{style:{textAlign:"right"},children:Object(X.jsx)("a",{"aria-label":"Comment",href:function(e,t){if("loading"===(null===t||void 0===t?void 0:t.state))return null;var n,a=V(t);return a?se(a):-1===(n=e).id?"https://app.olmap.org/#/Notes/new/photo/@".concat(n.lat,",").concat(n.lon):"https://app.olmap.org/#/Notes/new/".concat(n.id,"/photo/@").concat(n.lat,",").concat(n.lon)}(L.popupCoordinates,L.olmapData)||"#",target:"_blank",rel:"noopener noreferrer",style:{display:"inline-flex"},onClick:Z,children:Object(X.jsx)(y.a,{style:{color:"#ff5000",backgroundColor:"#fff"}})})})]}),Object(X.jsx)(me,{onImageClick:Z,olmapData:L.olmapData}),L.popupCoordinates.tags&&Object(X.jsx)("table",{style:{marginTop:"10px",marginBottom:"10px",textAlign:"left"},children:Object(X.jsx)("tbody",{children:Object.entries(L.popupCoordinates.tags).filter((function(e){var t=Object(p.a)(e,1)[0];return!t.startsWith("@")&&!["addr:street","addr:housenumber","addr:unit","ref"].includes(t)})).map((function(e){var t=Object(p.a)(e,2),n=t[0],a=t[1];return Object(X.jsxs)("tr",{children:[Object(X.jsx)("td",{style:{padding:"0 5px 0 0",textAlign:"right"},children:n}),Object(X.jsx)("td",{children:a})]},"".concat(n,"-").concat(a))}))})}),Object(X.jsxs)("div",{style:{display:"flex",justifyContent:"center"},children:[Object(X.jsx)(h.a,{"data-testid":"origin-button",variant:"contained",size:"small",style:{backgroundColor:"#00afff",color:"#fff"},type:"button","aria-label":"Set origin",onClick:function(){return z((function(e){return null!=e.popupCoordinates?Object(u.a)(Object(u.a)({},e),{},{origin:Nt(e.popupCoordinates),isOriginExplicit:!0,popupCoordinates:null}):Object(u.a)(Object(u.a)({},e),{},{isOriginExplicit:!0,popupCoordinates:null})}))},children:"Origin"}),Object(X.jsx)("span",{style:{padding:"5px"}}),Object(X.jsx)(h.a,{"data-testid":"destination-button",variant:"contained",size:"small",style:{backgroundColor:"#64be14",color:"#fff"},type:"button","aria-label":"Set destination",onClick:function(){return z((function(e){return null!=e.popupCoordinates?Object(u.a)(Object(u.a)({},e),{},{destination:e.popupCoordinates,popupCoordinates:null}):Object(u.a)(Object(u.a)({},e),{},{popupCoordinates:null})}))},children:"Destination"}),Object(X.jsx)("span",{style:{padding:"5px"}}),Object(X.jsx)(h.a,{"data-testid":"google-maps-button",variant:"contained",size:"small",style:{backgroundColor:"#db4437",color:"#fff"},type:"button","aria-label":"Open Google Maps",target:"_blank",rel:"noreferrer",href:"https://www.google.com/maps/dir/?api=1&destination=".concat(null===L||void 0===L?void 0:L.popupCoordinates.lat,",").concat(null===L||void 0===L?void 0:L.popupCoordinates.lon,"&travelmode=driving"),onClick:function(){return z((function(e){return Object(u.a)(Object(u.a)({},e),{},{popupCoordinates:null})}))},children:"Google"})]})]})]})),Object(X.jsx)(ve,{noteId:L.editingNote,onClose:function(){return z((function(e){return Object(u.a)(Object(u.a)({},e),{},{editingNote:void 0})}))}}),Object(X.jsx)(Mt,{open:L.venueDialogOpen,collapsed:L.venueDialogCollapsed,venue:L.venue,venueOlmapData:L.venueOlmapData,restrictions:L.route,locale:L.locale,onViewDetails:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{editingNote:e.id})}))},onEntranceSelected:function(e){z((function(t){var n=t.venueFeatures.features.filter((function(e){var t;return"Point"===e.geometry.type&&(null===(t=e.properties)||void 0===t?void 0:t.entrance)})),a=t.venueFeatures.features.find((function(t){var n;return null===(n=t.properties)||void 0===n?void 0:n["@id"].endsWith("/".concat(e))}));return Object(u.a)(Object(u.a)({},t),{},{unloadingPlace:void 0,destination:a&&"Point"===a.geometry.type&&Lt(a)||void 0,entrances:n.map((function(e){return Lt(e)}))})}))},onUnloadingPlaceSelected:function(e){z((function(t){var n=t.venueFeatures.features.filter((function(e){var t;return"Point"===e.geometry.type&&(null===(t=e.properties)||void 0===t?void 0:t.entrance)}));return Object(u.a)(Object(u.a)({},t),{},{unloadingPlace:e,destination:t.venue,entrances:n.map((function(e){return Lt(e)}))})}))},onClose:function(){S.current.clear(),z((function(e){return Object(u.a)(Object(u.a)({},e),{},{venueDialogOpen:!1,venueDialogCollapsed:!1,venueOlmapData:void 0,venueFeatures:zt,venue:void 0,origin:e.geolocationPosition||void 0,originIsExplicit:!1,destination:void 0,entrances:[],unloadingPlace:void 0,route:Me()})}))},onCollapsingToggled:function(){return z((function(e){return Object(u.a)(Object(u.a)({},e),{},{venueDialogCollapsed:!L.venueDialogCollapsed})}))},onRestrictionSelected:function(e){z((function(t){return Object(u.a)(Object(u.a)({},t),{},{popupCoordinates:Lt(e)})}))},onLocaleSelected:function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===(n=L.venue)||void 0===n?void 0:n.id)){e.next=6;break}return e.next=3,fe(L.venue.id,t);case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0=void 0;case 7:a=e.t0,z((function(e){return Object(u.a)(Object(u.a)({},e),{},{locale:t,venueOlmapData:a})}));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]})}}},0,[4,2]]);
//# sourceMappingURL=App.44a802fd.chunk.js.map